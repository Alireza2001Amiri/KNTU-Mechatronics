"use strict";(self.webpackChunk_grammarly_denali_app=self.webpackChunk_grammarly_denali_app||[]).push([[9501],{67804:(e,t,i)=>{i.d(t,{RG:()=>f,nF:()=>n,xg:()=>s});var s,n,a=i(23988),o=i(10334),r=i(17171),c=i(45819),l=i(84647),d=i(85791),u=i(38886),m=i(65390),p=i(34717),h=i(66202),_=i(94855),g=i(36840);!function(e){e.Monthly="Monthly",e.Quarterly="Quarterly",e.Annual="Annual"}(s||(s={})),function(e){const t=u.TS({annual:m.none,quarterly:m.none,monthly:m.none},((e,t)=>{switch(t.periodMonths){case 1:return(0,r._)((0,o._)({},e),{monthly:m.some(t)});case 3:return(0,r._)((0,o._)({},e),{quarterly:m.some(t)});case 12:return(0,r._)((0,o._)({},e),{annual:m.some(t)});default:return e}}));function i(e,t){return{pricePerYear:{value:e-t.value,currency:t.currency},percent:`${Math.round(100*(e-t.value)/e)}%`}}e.createOfferBasedOnAnnual=(0,l.flow)(t,(0,c.Jq)(m.Applicative),m.map((({annual:e,quarterly:t,monthly:s})=>({price:e.priceMoney,regularPrice:e.regularPriceMoney,discountPercent:"0%",periodInMonths:12,title:"Annual",savePricedBySwitchingFrom:{monthly:i(12*s.priceMoney.value,e.priceMoney),quarterly:i(4*t.priceMoney.value,e.priceMoney)}}))))}(n||(n={}));class f{get isMonthly(){return 1===this.currentPlan.periodMonths}get isQuarterly(){return 3===this.currentPlan.periodMonths}get savedPrice(){return this.isMonthly?this.offer.savePricedBySwitchingFrom.monthly:this.offer.savePricedBySwitchingFrom.quarterly}get currentPlanType(){return this.isMonthly?s.Monthly:this.isQuarterly?s.Quarterly:s.Annual}get daysToRenewal(){const e=this.nextPaymentDate.getTime(),t=p.Yr.now().getTime();return Math.floor(Math.max(0,e-t)/p.ei)}get shouldShowOffer(){return!!f.enableDebugModeToShowOffer||this.willSubscriptionRenewSoon&&!this.hasAlreadyChangedToAnnual&&!this._isOnTrial}get hasAlreadyChangedToAnnual(){return(0,l.pipe)(this._queuedPlan,m.exists((({periodMonths:e})=>12===e)))}get willSubscriptionRenewSoon(){const e=this.daysToRenewal<2*p.f9;return(this.isMonthly||this.isQuarterly)&&e}static create({currentPlan:e,queuedPlan:t,nextPayDate:i,expirationDate:s,isCancelled:a,plans:o,isOnTrial:r},c){if(null==e)return h.left("Cannot load plans for change plan when user is freemium");if(!i&&!s)return h.left("Cannot change plan when nextPayDate and expirationDate are null");const d={renew:()=>c.renew(),changePlan:e=>c.changePlan(e),getPlans:()=>c.getPlans()},u=n.createOfferBasedOnAnnual(o);return(0,l.pipe)(u,h.fromOption((()=>"Cannot create offer, plans are incomplete, monthly or quarterly or annual are not presented in subscription status")),h.map((n=>new f(n,e,new Date(null!=i?i:s),null!=a&&a,null!=r&&r,m.fromNullable(t),d))))}constructor(e,t,i,s,n,o,r){(0,a._)(this,"offer",void 0),(0,a._)(this,"currentPlan",void 0),(0,a._)(this,"nextPaymentDate",void 0),(0,a._)(this,"_isCancelled",void 0),(0,a._)(this,"_isOnTrial",void 0),(0,a._)(this,"_queuedPlan",void 0),(0,a._)(this,"_subscriptionOps",void 0),(0,a._)(this,"_renew",void 0),(0,a._)(this,"_getPlans",void 0),(0,a._)(this,"_changePlan",void 0),(0,a._)(this,"_extractAnnualPlan",void 0),(0,a._)(this,"changePlan",void 0),this.offer=e,this.currentPlan=t,this.nextPaymentDate=i,this._isCancelled=s,this._isOnTrial=n,this._queuedPlan=o,this._subscriptionOps=r,this._renew=e=>_.TX((()=>!0===e?this._subscriptionOps.renew():Promise.resolve()),(e=>({reason:"Renew failed",originalError:e}))),this._getPlans=()=>_.TX((()=>this._subscriptionOps.getPlans()),(e=>({reason:"Could not get plans",originalError:e}))),this._changePlan=e=>_.TX((()=>this._subscriptionOps.changePlan(e)),(e=>({reason:"Changing plan failed",originalError:e}))),this._extractAnnualPlan=(0,l.flow)(u.i8((e=>12===e.periodMonths)),h.fromOption((()=>({reason:"Expectation failed, we did not receive the annual plan"}))),h.filterOrElse((e=>d.v0.eq.equals(e.priceMoney,this.offer.price)),(()=>({reason:"Expectation failed, we did not receive the annual plan with offered price"}))),h.map((e=>e.id)),_.Mr),this.changePlan=(0,l.pipe)(this._renew(this._isCancelled),_.cy(this._getPlans),_.cy(this._extractAnnualPlan),_.cy(this._changePlan)),(0,g.hJ)("changePlanHookShowOffer",(()=>f.enableDebugModeToShowOffer=!0))}}(0,a._)(f,"enableDebugModeToShowOffer",!1)},12495:(e,t,i)=>{i.d(t,{L:()=>m,N:()=>s});var s,n=i(83531),a=i(23988),o=i(80074),r=i(78339),c=i(19711),l=i(6987),d=i(36094),u=i(36840);class m{enable(){return this._isEnabled.set(!0),this._enable(),()=>{this._isEnabled.set(!1),this._disable()}}recheck(){var e=this;return(0,n._)((function*(){const t=!e._isEnabled.get();t&&e._enable(),yield e._plagiarismCheckingState.pipe(r.p((e=>"idle"===e)),c.$()).toPromise(),t&&e._plagiarismCapiClient.disablePlagiarismSearch()}))()}dispose(){this._subs.forEach((e=>e.unsubscribe()))}constructor(e,t,i){(0,a._)(this,"_documentModel",void 0),(0,a._)(this,"_events",void 0),(0,a._)(this,"_plagiarismCapiClient",void 0),(0,a._)(this,"_plagiarismCheckingState",void 0),(0,a._)(this,"plagiarismCheckedInSession",void 0),(0,a._)(this,"checkingState",void 0),(0,a._)(this,"_subs",void 0),(0,a._)(this,"_isEnabled",void 0),(0,a._)(this,"_enable",void 0),(0,a._)(this,"_disable",void 0),this._documentModel=e,this._events=t,this._plagiarismCapiClient=i,this._plagiarismCheckingState=this._documentModel.asyncChecksState.lens("plagiarism"),this.plagiarismCheckedInSession=this._plagiarismCheckingState.view((e=>"full"!==e)),this.checkingState=this._plagiarismCheckingState,this._subs=[],this._isEnabled=o.s.create(!1),this._enable=()=>{this._plagiarismCheckingState.modify((e=>"idle"===e?"checking":e)),this._documentModel.extraSettings.checkedPlagiarism=!0,this._plagiarismCapiClient.enablePlagiarismSearch()},this._disable=()=>{this._plagiarismCapiClient.disablePlagiarismSearch()},this._subs.push(this._isEnabled.pipe(l.n(d.vh(this._events.pipe(r.p((e=>"session_started"===e.kind)))))).subscribe(this._enable))}}!function(e){e.Mock=class{constructor(){(0,a._)(this,"enable",(()=>u.Yi)),(0,a._)(this,"recheck",(()=>new Promise(u.Yi))),(0,a._)(this,"dispose",u.Yi),(0,a._)(this,"checkingState",o.s.create("idle")),(0,a._)(this,"plagiarismCheckedInSession",o.s.create(!0))}}}(s||(s={}))},80189:(e,t,i)=>{i.d(t,{YJ:()=>a,Yi:()=>s,y5:()=>b});var s,n,a,o=i(23988),r=i(84647),c=i(80074),l=i(90875),d=i(60575),u=i(35413),m=i(15491),p=i(65390),h=i(66202),_=i(77396),g=i(94855),f=i(34717);!function(e){function t(e){return"sending"===e.kind}e.isSending=t,e.isSendingState=p.exists(t)}(s||(s={})),function(e){e.isSuccess=function(e){return e.status===l.c.StatisticsStatus.Success}}(n||(n={}));class b{getPlans(){return this._doc.getProofitPlans().then(h.fold((e=>Promise.reject(e)),(e=>e.status===l.c.PlanStatus.Forbidden?Promise.reject({status:l.c.PlanStatus.Forbidden}):Promise.resolve(e))))}getStatistics(){return u.v(this._proofitStatisticsIO).pipe(m.T(p.fromEither))}placeOrder(e,t,i,s,n){return this.state.set(p.some({kind:"sending"})),_.hq(this._doc.placeProofitOrder({turnaround:e.turnaround,tier:e.tier,userInputs:t,priceOfferId:i,payWithCredits:n},s)).then((e=>this._updateStatus(e.status))).catch((e=>{d.Bx.Logging.getLogger("ProofitModel").warn("Error placing proofit order",e),this.state.set(p.some({kind:"error",errorType:"unknown"}))}))}updateState(e){this._updateStatus(e.status),this.jobDetails.set(p.some({startTime:e.submitted,dueTime:e.due}))}_updateStatus(e){switch(e){case l.c.JobStatus.building:break;case l.c.JobStatus.newJob:this.state.set(p.some({kind:"submitted"}));break;case l.c.JobStatus.completed:this.state.set(p.some({kind:"finished"}));break;case l.c.JobStatus.cancelled:this.state.set(p.some({kind:"cancelled"}));break;case l.c.JobStatus.emptyDocument:this.state.set(p.some({kind:"error",errorType:"emptyDocument"}));break;case l.c.JobStatus.duplicate:this.state.set(p.some({kind:"error",errorType:"alreadyProofread"}));break;case l.c.JobStatus.complexInternalStructure:this.state.set(p.some({kind:"error",errorType:"complexInternalStructure"}));break;case l.c.JobStatus.paymentError:this.state.set(p.some({kind:"error",errorType:"payment"}));break;case l.c.JobStatus.forbidden:case l.c.JobStatus.unknown:default:this.state.set(p.none)}}constructor(e,t){(0,o._)(this,"_doc",void 0),(0,o._)(this,"documentTitle",void 0),(0,o._)(this,"_statisticsCache",void 0),(0,o._)(this,"_proofitStatisticsIO",void 0),(0,o._)(this,"state",void 0),(0,o._)(this,"jobDetails",void 0),this._doc=e,this.documentTitle=t,this._statisticsCache=p.none,this._proofitStatisticsIO=()=>(0,r.pipe)(this._statisticsCache,p.fold((0,r.pipe)(this._doc.getProofitStatistics,g.cy(g.aN(n.isSuccess,(e=>new Error(e.status)))),g.W6((e=>g.L9((()=>{this._statisticsCache=p.some(e)}))))),(e=>Promise.resolve(h.right(e))))),this.state=c.s.create(p.none),this.jobDetails=c.s.create(p.none)}}!function(e){e.Mock=class extends b{constructor(e=l.c.JobStatus.newJob,t=p.none){var i,s,n;super((i=e,s={status:l.c.StatisticsStatus.Success,lastCompletedJobDate:t},n=e=>{this.updateState(e)},{getProofitPlans:()=>Promise.resolve(h.right({status:l.c.PlanStatus.Success,turnaroundOptions:[{enabled:!0,label:"24 hours",minutesToProcess:p.of(1440),hoursToProcess:p.none,perWord:.14,price:140,turnaround:l.c.PlanType.TwentyFourHours,requirePaymentCheck:!1,tier:l.c.PlanTier.Base,credits:p.none},{enabled:!0,label:"3 hours",minutesToProcess:p.of(180),hoursToProcess:p.none,perWord:.18,price:180,turnaround:l.c.PlanType.ThreeHours,requirePaymentCheck:!0,tier:l.c.PlanTier.Base,credits:p.none},{enabled:!0,label:"30 minutes",minutesToProcess:p.of(30),hoursToProcess:p.none,perWord:.3,price:300,turnaround:l.c.PlanType.Instant,requirePaymentCheck:!1,tier:l.c.PlanTier.Base,credits:p.none}],clarityTurnaroundOptions:[{enabled:!0,label:"24 hours",minutesToProcess:p.of(1440),hoursToProcess:p.none,perWord:.14,price:140,turnaround:l.c.PlanType.TwentyFourHours,requirePaymentCheck:!1,tier:l.c.PlanTier.Clarity,credits:p.none},{enabled:!0,label:"3 hours",minutesToProcess:p.of(180),hoursToProcess:p.none,perWord:.18,price:180,turnaround:l.c.PlanType.ThreeHours,requirePaymentCheck:!0,tier:l.c.PlanTier.Clarity,credits:p.none}],words:100,userInputs:{nativeLanguage:p.none,dialect:p.none,quotationType:p.none,spaceType:p.none,noteToEditor:p.none},priceOfferId:l.c.PriceOfferId.create(424242)})),placeProofitOrder:()=>()=>new Promise((e=>{const t=f.Yr.Timestamp.now(),s=f.Yr.Timestamp.toLocal(f.Yr.Timestamp.add(t,3*f.WU)),a={submitted:f.Yr.Timestamp.toLocal(t),corrections:5,due:s,price:666,name:"",completed:p.none,id:1,status:l.c.stringToJobStatus(i),is_dox_applied:!0};setTimeout((()=>e(h.right(a))),0),setTimeout((()=>n(a)),500)})),getProofitStatistics:()=>Promise.resolve(h.right(s))}),c.s.create(""))}}}(a||(a={}))},5875:(e,t,i)=>{i.d(t,{V:()=>s,Md:()=>K,N$:()=>a,_S:()=>n});var s,n,a,o,r=i(23988),c=i(10334),l=i(17171),d=i(84647),u=i(80074),m=i(78323),p=i(90875),h=i(60575),_=i(76005),g=i(2061),f=i(90405),b=i(62723),S=i(19711),v=i(95168),y=i(36094),w=i(78339),E=i(80837),P=i(15491),T=i(6987),M=i(40027),C=i(89769),x=i(86887),k=i(5692),O=i(3346),I=i(88423),D=i(11298),N=i(21216),H=i(54988),A=i(65621),F=i(65390),B=i(86562),q=i(44869),R=i(58193),L=i(66202),U=i(81870),W=i(42543);class V{_closeProofitOrder(){this._closeModal()}dispose(){this._subscriptions.dispose()}constructor(e){(0,r._)(this,"_closeModal",void 0),(0,r._)(this,"actions",void 0),(0,r._)(this,"_subscriptions",void 0),this._closeModal=e,this.actions=new W.B7,this._subscriptions=new E.y.Keeper,this._subscriptions.push(this.actions.subscribe((()=>this._closeProofitOrder())))}}class J{toggleActive(e){return this.active.set(e),this}isRecommended(e){const t=Object.values(p.c.PlanType);return this===[...e].filter((e=>e.details.tier===this.details.tier)).reduce(((e,i)=>t.indexOf(i.details.turnaround)<t.indexOf(e.details.turnaround)?i:e))&&this.details.enabled}constructor(e,t){(0,r._)(this,"details",void 0),(0,r._)(this,"_ops",void 0),(0,r._)(this,"active",void 0),(0,r._)(this,"select",void 0),(0,r._)(this,"unselect",void 0),(0,r._)(this,"placeOrder",void 0),this.details=e,this._ops=t,this.active=u.s.create(!1),this.select=()=>{this._ops._selectPlan(this.details)},this.unselect=()=>{this._ops._selectPlan(null)},this.placeOrder=(e,t)=>this._ops._placeOrder(this.details,e,t)}}!function(e){e.Order="Order",e.Success="Success"}(s||(s={})),function(e){e[e.Step1=0]="Step1",e[e.Step2=1]="Step2"}(n||(n={})),function(e){e[e.Step1=0]="Step1",e[e.Step2=1]="Step2",e[e.Step3=2]="Step3",e[e.Step4=3]="Step4",e[e.Step5=4]="Step5"}(a||(a={})),function(e){e.selectPlanTier=function(e,t){return(0,l._)((0,c._)({},e),{selectedPlanTier:t,selectedPlans:e.plans.filter((e=>e.details.tier===t)).slice(0,3)})},e.selectPlan=function(e,t){const i=F.getEq(p.c.Plan.eq),s=e=>i.equals(t,F.some(e.details)),n=e=>e.toggleActive(s(e));return(0,l._)((0,c._)({},e),{plans:e.plans.map(n),selectedPlans:e.selectedPlans.map(n),selectedPlan:F.fromNullable(e.plans.find(s))})}}(o||(o={}));class K{clearModals(){(0,d.pipe)(this._orderModalViewModelOption,F.map((e=>e.dispose()))),this._orderModalViewModelOption=F.none}newOrderModalViewModel(){const e=new V(this._closeModal);return this._orderModalViewModelOption=F.some(e),e}closeModal(){this.modal.set(F.none),this.leftStep.set(a.Step1),this.rightStep.set(n.Step1),this.freeProofitTermsAgreed.set(!1)}showOrderModal(){this.modal.set(F.some({type:s.Order}))}selectUserInput(e,t){this.viewState.modify(F.map((i=>(0,l._)((0,c._)({},i),{userInputs:(0,l._)((0,c._)({},i.userInputs),{[e]:t})}))))}dispose(){this.clearModals(),this._subscriptions.dispose()}_showPaymentMessage(){return this._notificationsManager.enqueue("paymentSuccess")}_showPaymentError(){return this._notificationsManager.enqueue("paymentError")}_showSuccessModal(){return this._log.info("Show Success Modal"),this._proofit.jobDetails.pipe(f.oE,b.z(this._user.profile,(({dueTime:e},{email:t})=>F.some({type:s.Success,payload:{email:t,dueDate:e}}))),S.$(),v.M(y.H9(this.modal)))}_createErrorNotification(e,t){switch(e){case"payment":return this._notificationsManager.enqueue("proofitPaymentDeclinedError",{paymentMethod:t}).pipe(w.p((e=>"navigateToSubscription"===e)),v.M((()=>window.open(this._config.account.subscription,"_blank"))));case"emptyDocument":return this._notificationsManager.enqueue("proofitEmptyDocumentError");case"alreadyProofread":return this._notificationsManager.enqueue("proofitDocumentProofreadError").pipe(w.p((e=>"navigateToDocuments"===e)),v.M(this._goToMyDocuments));case"complexInternalStructure":return this._notificationsManager.enqueue("proofitComplexInternalStructureError").pipe(w.p((e=>"navigateToDocuments"===e)),v.M(this._goToMyDocuments));case"unknown":return this._notificationsManager.enqueue("error");default:return(0,B.xb)(e)}}_getUserInputs(){return(0,d.pipe)(this.viewState.get(),F.map((({userInputs:e})=>e)),F.getOrElse((0,d.constant)({nativeLanguage:F.none,dialect:F.none,quotationType:F.none,spaceType:F.none,noteToEditor:F.none})))}_updateUserNativeLanguage(){const e=this._getUserInputs();F.getEq(q.w_).equals(e.nativeLanguage,this._initialNativeLanguage)||(0,d.pipe)(e.nativeLanguage,R.Mi((e=>this._user.updateUserNativeLanguage(e)())))}_getPriceOfferId(){const e=this.viewState.get();return(0,B.V1)(!F.isNone(e),"Proofit view state should be initialized"),R.$v(e).priceOfferId}constructor(e,t,i,y,q,R,W){(0,r._)(this,"_subscription",void 0),(0,r._)(this,"_documentModel",void 0),(0,r._)(this,"_ded",void 0),(0,r._)(this,"_user",void 0),(0,r._)(this,"_notificationsManager",void 0),(0,r._)(this,"_router",void 0),(0,r._)(this,"_config",void 0),(0,r._)(this,"modal",void 0),(0,r._)(this,"isVisibleModal",void 0),(0,r._)(this,"noteToEditor",void 0),(0,r._)(this,"isInternalUser",void 0),(0,r._)(this,"freeProofitTermsAgreed",void 0),(0,r._)(this,"requirePaymentCheck",void 0),(0,r._)(this,"viewState",void 0),(0,r._)(this,"subscriptionState",void 0),(0,r._)(this,"braintreeApi",void 0),(0,r._)(this,"leftStep",void 0),(0,r._)(this,"rightStep",void 0),(0,r._)(this,"_orderModalViewModelOption",void 0),(0,r._)(this,"_initialNativeLanguage",void 0),(0,r._)(this,"viewStateAndSubscription",void 0),(0,r._)(this,"_proofit",void 0),(0,r._)(this,"_subscriptions",void 0),(0,r._)(this,"_closeModal",void 0),(0,r._)(this,"changeLeftStep",void 0),(0,r._)(this,"changeRightStep",void 0),(0,r._)(this,"placeOrderAfterAntiFraudCheck",void 0),(0,r._)(this,"onBillingError",void 0),(0,r._)(this,"requestPlans",void 0),(0,r._)(this,"requestStatistics",void 0),(0,r._)(this,"selectPlanTier",void 0),(0,r._)(this,"_selectPlan",void 0),(0,r._)(this,"_placeOrder",void 0),(0,r._)(this,"_onBillingSuccess",void 0),(0,r._)(this,"_log",void 0),(0,r._)(this,"_goToMyDocuments",void 0),this._subscription=e,this._documentModel=t,this._ded=i,this._user=y,this._notificationsManager=q,this._router=R,this._config=W,this.modal=u.s.create(F.none),this.isVisibleModal=this.modal.lens(m.J2.create(F.isSome,((e,t)=>e?t:F.none))),this.viewState=u.s.create(F.none),this.subscriptionState=this._subscription.state,this.braintreeApi=this._subscription.braintreeApi,this.leftStep=u.s.create(a.Step1),this.rightStep=u.s.create(n.Step1),this._orderModalViewModelOption=F.none,this._initialNativeLanguage=F.none,this.viewStateAndSubscription=this.viewState.pipe(b.z(this._subscription.state)),this._subscriptions=new E.y.Keeper,this._closeModal=()=>this.modal.set(F.none),this.changeLeftStep=e=>{this.leftStep.set(e)},this.changeRightStep=e=>{this.rightStep.set(e)},this.placeOrderAfterAntiFraudCheck=e=>{this._log.info("Anti-fraud place order after check"),this._subscriptions.push(this.viewStateAndSubscription.pipe(S.$(),P.T((([e])=>e)),P.T(F.chain((e=>e.selectedPlan))),T.n(F.fold(Promise.resolve,(t=>t.placeOrder(F.some(e),!1))))).subscribe((()=>this._onBillingSuccess()),(()=>this.onBillingError())))},this.onBillingError=()=>{this._subscriptions.push(this._showPaymentError().subscribe())},this.requestPlans=this._ded.contentUpdated.pipe(w.p(_.D_.isTextMaybeWithFormatting),M.Z(1e3),C.Z(void 0),T.n((()=>Promise.all([this._proofit.getPlans(),this._user.getUserNativeLanguage()]))),x.l(k.j.OperationRetrier.RetryStrategy.conditional((e=>"TimeoutError"===e.name||"NotConnectedError"===e.name),k.j.OperationRetrier.RetryStrategy.linear(2,1e3))),v.M((([e,t])=>{this._initialNativeLanguage=(0,d.pipe)(t,L.getOrElse((()=>F.none)));const i=[...e.turnaroundOptions,...e.clarityTurnaroundOptions].map((e=>new J(e,this))),s={words:e.words,selectedPlanTier:p.c.PlanTier.Base,plans:i,selectedPlans:[],selectedPlan:F.none,proofitState:F.none,statistics:F.none,userInputs:(0,d.pipe)(t,L.fold((()=>e.userInputs),(t=>(0,l._)((0,c._)({},e.userInputs),{nativeLanguage:t,noteToEditor:F.none})))),priceOfferId:e.priceOfferId},n=(e,t)=>e.some((({details:e})=>e.tier===t&&(0,d.pipe)(e.credits,F.fold((()=>!1),(e=>e.canBeUsed&&e.balance>0))))),a=n(i,p.c.PlanTier.Base),r=n(i,p.c.PlanTier.Clarity),u=a&&!r?p.c.PlanTier.Base:p.c.PlanTier.Clarity;this.viewState.set(F.some(o.selectPlanTier(s,u)))})),O.W((e=>(this._log.error("Error querying proofit plan options",e),this._notificationsManager.enqueue("error").pipe(w.p(g.H.isCloseAction),v.M((()=>this.modal.set(F.none))))))),I.j((()=>{this.viewState.set(F.none)})),D.u()),this.requestStatistics=()=>this._proofit.getStatistics().pipe(x.l(k.j.OperationRetrier.RetryStrategy.conditional((e=>"NotConnectedError"===e.name),k.j.OperationRetrier.RetryStrategy.linear(2,1e3))),v.M((e=>{this.viewState.modify(F.map((t=>(0,l._)((0,c._)({},t),{statistics:e}))))})),O.W((e=>(this._log.debug("Error querying proofit statistics",e),N.of(F.none))))),this.selectPlanTier=e=>{this.viewState.modify(F.map((t=>o.selectPlan(o.selectPlanTier(t,e),F.none))))},this._selectPlan=e=>{this.viewState.modify(F.map((t=>o.selectPlan(t,F.fromNullable(e)))))},this._placeOrder=(e,t,i)=>(this._updateUserNativeLanguage(),this._proofit.placeOrder(e,this._getUserInputs(),this._getPriceOfferId(),t,i)),this._onBillingSuccess=()=>{this._subscriptions.push(this._showPaymentMessage().subscribe())},this._log=h.Bx.Logging.getLogger("ProofitView"),this._goToMyDocuments=()=>{this._router.navigateAndReload(U.Lz.routes.documents.href(),{proofitSubmitted:!0})},this._proofit=this._documentModel.proofit,this.isInternalUser=this._user.features.denali.isInternalUser,this.noteToEditor=this._user.features.denali.proofitNoteToEditor,this.requirePaymentCheck=this._user.features.denali.requirePaymentCheck?u.s.create(!0):this.viewState.view((0,d.flow)(F.chain((e=>e.selectedPlan)),F.map((e=>e.details.requirePaymentCheck)),F.getOrElse(d.constFalse))),this.freeProofitTermsAgreed=u.s.create(!1),this._subscriptions.push(this._proofit.state.pipe(v.M((e=>this.viewState.modify(F.map((t=>(0,l._)((0,c._)({},t),{proofitState:e})))))),f.oE,T.n((e=>{switch(e.kind){case"submitted":return this._log.info("Document submitted for proofreading"),this._showSuccessModal();case"finished":case"cancelled":case"sending":return H.w;case"error":return this._log.error("Error sending document for proofreading:",e.errorType),this._createErrorNotification(e.errorType,this._subscription.state.get().value.paymentMethod);default:return(0,B.xb)(e)}}))).subscribe()),this._subscriptions.push(this.modal.pipe(A.J(),w.p((([e])=>(0,d.pipe)(e,F.exists((e=>e.type===s.Success)))))).subscribe(this._goToMyDocuments))}}},72204:(e,t,i)=>{i.d(t,{jH:()=>H,zL:()=>A});var s,n=i(23988),a=i(84647),o=i(80074),r=i(60575),c=i(63967),l=i(62597),d=i(22809),u=i(53717),m=i(41797),p=i(95168),h=i(3346),_=i(80837),g=i(38427),f=i(90405),b=i(15491),S=i(74416),v=i(78339),y=i(6987),w=i(96339),E=i(10540),P=i(48209),T=i(82718),M=i(19711),C=i(62822),x=i(36094),k=i(78674),O=i(65390),I=i(66202),D=i(22835),N=i(36840);function H(e){return t=>({id:t.id,categoryHuman:t.toLiteAlert().categoryHuman,lensId:t.lensId,getHighlightRanges:t.getHighlightRanges,content:(0,a.pipe)(t.transform,O.filter((()=>!(c.Fc.isSuperAlert(t)||c.Fc.isOneGap(t)||c.bU.isSimple(t.extraProperties.cardType)||c.bU.isFullSentence(t.extraProperties.cardType)))),O.chain((0,a.flow)(e,I.fold((e=>(r.Bx.Logging.getLogger("ReportViewModel.hydration").error("Could not hydrate alert",e.error),O.none)),O.some))),I.fromOption((()=>t.highlightTexts)))})}class A{_prepareDownload(){return this._engine.sessionModel.extraSettings.checkedPlagiarism&&!this._features.isFree.get()?this._engine.plagiarismModel.recheck():Promise.resolve()}tryToInterrupt(){this._requestSent.get()||this._finishDownload()}_calculateIssues(e){return e.reduce(((e,t)=>{const i=l.J.OutcomeId.fromOutcomeId(t.lensId),s=t.toLiteAlert(),n=s.categoryHuman;return e[i]=Boolean(e[i])?e[i]:{},e[i][n]=e[i][n]||0,e[i][n]+=s.cost,e}),{})}generateReport(e,t,i){this._requestSent.get()||(this._requestSent.set(!0),this._subs.push(m.H(this._engine.sessionModel.generateReport(e,{headerTemplate:t,footerTemplate:i,format:"Letter",marginTop:"70px",marginBottom:"70px"})).pipe(p.M(this._finishDownload),h.W((e=>(this._log.error("generateReport failed",e),this._notificationsManager.enqueue("error"))))).subscribe()))}_getNonPremiumSortedAlerts(e){return e.map(this._alertDataProcessor)}_getFilteredAlerts(e){return(0,a.pipe)(this._engine.checkingDomain.state.get(),d.A.reduce([],((t,i)=>(e(i.alert)&&t.push(i.alert),t))))}dispose(){this._subs.dispose()}constructor(e,t,i,s,d,I,A,F,B,q){(0,n._)(this,"_engine",void 0),(0,n._)(this,"_profile",void 0),(0,n._)(this,"_features",void 0),(0,n._)(this,"_notificationsManager",void 0),(0,n._)(this,"_htmlContent",void 0),(0,n._)(this,"_telemetry",void 0),(0,n._)(this,"reportData",void 0),(0,n._)(this,"downloadStarted",void 0),(0,n._)(this,"_log",void 0),(0,n._)(this,"_subs",void 0),(0,n._)(this,"_requestSent",void 0),(0,n._)(this,"_visitLenses",void 0),(0,n._)(this,"beginDownload",void 0),(0,n._)(this,"_finishDownload",void 0),(0,n._)(this,"_getReportModel",void 0),(0,n._)(this,"_alertDataProcessor",void 0),(0,n._)(this,"_listenDownload",void 0),this._engine=e,this._profile=t,this._features=i,this._notificationsManager=s,this._htmlContent=d,this._telemetry=q,this.reportData=o.s.create(O.none),this.downloadStarted=o.s.create(!1),this._log=r.Bx.Logging.getLogger("ReportViewModelImpl"),this._subs=new _.y.Keeper,this._requestSent=o.s.create(!1),this._visitLenses=e=>{e.activeLensId.get()!==l.J.SpecialId.Plagiarism&&this._engine.sessionModel.extraSettings.checkedPlagiarism&&e.events.next({type:"switchToLens",id:l.J.SpecialId.Plagiarism,focusFirst:!1,actionSource:c.Kz.sidebar}),e.events.next({type:"switchToLens",id:l.J.SpecialId.AllAlerts,focusFirst:!1,actionSource:c.Kz.sidebar})},this.beginDownload=()=>{this._telemetry.gnarSpec.detailedReportDownloadButtonClick(this._telemetry.pageId,(0,a.pipe)(this._engine.sessionModel.score.get(),O.map(D.Up("rank")),O.getOrElse((0,a.constant)(0)))),this.downloadStarted.set(!0)},this._finishDownload=()=>{this.downloadStarted.set(!1),this._requestSent.set(!1),this.reportData.set(O.none)},this._getReportModel=e=>g.zV(this._engine.sessionModel.title.view((e=>Boolean(e)?e:"Untitled")),this._engine.sessionModel.recentDocumentStats.pipe(f.oE),this._engine.sessionModel.score.pipe(f.oE),this._engine.sessionModel.counters,g.zV(this._features.isPremium,e).pipe(b.T((([e,t])=>e?(0,a.pipe)(t,O.map((e=>({score:S.Q.groupSum.concat(S.Q.MAX,S.Q.groupSum.inverse(S.Q.fromRatio(e.percentile))),sources:e.count,state:k.p.PlagiarismCheckingState.CHECKED,sortedAlerts:this._getFilteredAlerts(c.Fc.isPlagiarism)}))),O.alt((()=>O.some({state:k.p.PlagiarismCheckingState.NOT_CHECKED})))):O.none))),this._htmlContent).pipe(b.T((([e,t,i,s,n,a])=>{const o=this._getFilteredAlerts((0,N.M4)((0,N.M4)(c.Fc.isApplicableAlert,(0,N.AU)(c.Fc.isMuted)),c.Fc.isRegistered));return O.some({sortedAlerts:this._getNonPremiumSortedAlerts(o),dedHTML:a,title:e,author:this._profile.get().fullName,stats:t,score:i.rank,criticalIssues:s.critical,advancedIssues:s.advanced,issues:this._calculateIssues(o),plagiarism:n})}))),this._listenDownload=(e,t,i)=>{this._subs.push(this.downloadStarted.pipe(v.p(Boolean),y.n((()=>m.H(this._prepareDownload()).pipe(w.w(24e3),p.M((()=>this._visitLenses(t()))),E.QE(P.$),y.n((()=>e().flush())),T.K(this._getReportModel(i).pipe(M.$())),h.W((e=>(this._log.error("Error while preparing PDF report",e),this._finishDownload(),this._notificationsManager.enqueue("error").pipe(C.u(O.none))))))))).subscribe(x.H9(this.reportData)))},this._alertDataProcessor=H(I),this._listenDownload(A,F,B.view(u.x.lookup(l.J.SpecialId.Plagiarism)))}}!function(e){e.Mock=class{constructor(){(0,n._)(this,"downloadStarted",o.s.create(!1)),(0,n._)(this,"beginDownload",N.Yi),(0,n._)(this,"tryToInterrupt",N.Yi),(0,n._)(this,"generateReport",(()=>{throw new Error("Method not implemented.")})),(0,n._)(this,"reportData",o.s.create(O.none)),(0,n._)(this,"dedHTML",""),(0,n._)(this,"dispose",N.Yi),(0,n._)(this,"sortedAlerts",void 0),(0,n._)(this,"sortedPlagiarismAlerts",void 0)}}}(s||(s={}))},33373:(e,t,i)=>{i.d(t,{M:()=>g,U:()=>s});var s,n=i(23988),a=i(84647),o=i(15618),r=i(65621),c=i(15491),l=i(5692),d=i(89769),u=i(54988),m=i(65390),p=i(36840),h=i(81870),_=i(98719);class g{isUploaded(e,t){const i=(0,a.pipe)(this._appRouter.locationState,m.chain((e=>m.fromNullable(e.uploadedFileType)))),s=(0,a.pipe)(this._appRouter.locationState,m.chain((e=>m.fromNullable(e.uploadedFileName)))),n=void 0!==e?(0,a.pipe)(i,m.exists((t=>t===e))):m.isSome(i),o=void 0!==t?(0,a.pipe)(s,m.exists((e=>t.test(e)))):m.isSome(s);return n||o}dispose(){this.uploadModel.dispose()}constructor(e,t,i,s,a,u){(0,n._)(this,"_doxApi",void 0),(0,n._)(this,"_appRouter",void 0),(0,n._)(this,"_notificationsManager",void 0),(0,n._)(this,"_telemetry",void 0),(0,n._)(this,"_environment",void 0),(0,n._)(this,"_config",void 0),(0,n._)(this,"_upload",void 0),(0,n._)(this,"_navigateToDocument",void 0),(0,n._)(this,"uploadModel",void 0),(0,n._)(this,"state",void 0),this._doxApi=e,this._appRouter=t,this._notificationsManager=i,this._telemetry=s,this._environment=a,this._config=u,this._upload=e=>this._doxApi.createDocument(o.Jo.Create.file(e,o.Jo.UploadFileMode.plain)),this._navigateToDocument=(e,t)=>this._appRouter.navigate(h.Lz.routes.denali_editor.href({docId:e}),t),this.uploadModel=new _.DJ.UploadModelImpl((e=>this._upload(e)),this._navigateToDocument.bind(this),this._telemetry,this._notificationsManager,this._environment,this._config),this.state=this.uploadModel.state.pipe(r.J(),c.T((([e,t])=>l.j.isInProgress(t)?l.j.Status.inProgress:l.j.isOk(t)||l.j.isIdle(t)&&l.j.isOk(e)?l.j.Status.ok:l.j.Status.idle)),d.Z(l.j.Status.idle))}}!function(e){e.Mock=class{isUploaded(e,t){throw new Error("Method not implemented.")}showUploadNotificationIfNeeded(){throw new Error("Method not implemented.")}constructor(){(0,n._)(this,"uploadModel",{navigated:p.Yi}),(0,n._)(this,"state",u.w),(0,n._)(this,"dispose",p.Yi)}}}(s||(s={}))},27024:(e,t,i)=>{i.d(t,{p:()=>d});var s=i(50659),n=i(82608),a=i(86922),o=i(19967),r=i(14973),c=i(34717);const l=JSON.parse('{"Xo":"_809bb1a6-order-success-timeWrapper","kB":"_f52fdec8-order-success-time","p6":"_35082421-order-success-date","h_":"_1fcde546-order-success-description"}'),d=({payload:e,close:t})=>{const i=s.useContext(a.S.Context),d=s.useContext(r.aF.TitleIdContext);return s.createElement("div",null,s.createElement(n.Typography,{nodeType:"h2",styleType:n.Typography.Type.H3,id:d},i.proofitSuccessModal.title),s.createElement("div",{className:l.Xo},s.createElement(n.Typography,{nodeType:"h3",styleType:n.Typography.Type.H2,className:l.kB,"data-name":"success-time"},c.Yr.shortTime(e.dueDate)),s.createElement("div",{className:l.p6,"data-name":"success-date"},c.Yr.fullDate(e.dueDate))),s.createElement(n.Typography.Base,{className:l.h_},i.proofitSuccessModal.description(e.email)),s.createElement(o.$n.Primary,{name:"got-it",onClick:t},i.actions.gotIt))}},24376:(e,t,i)=>{i.d(t,{E:()=>he});var s=i(10334),n=i(17171),a=i(50659),o=i(84647),r=i(53651),c=i(12783),l=i(57035),d=i(87574),u=i(19840),m=i(11864),p=i(21607),h=i(76005),_=i(86922),g=i(35198),f=i(19967),b=i(14737),S=i(27917),v=i(88502),y=i(65873),w=i(19772),E=i(78339),P=i(14342),T=i(82718),M=i(90405),C=i(68745),x=i(95168),k=i(6987),O=i(65141),I=i(15491),D=i(21662),N=i(68533),H=i(42543),A=i(36094),F=i(30396),B=i(89769),q=i(11089),R=i(89011),L=i(82315),U=i(65390),W=i(50581),V=i(58193),J=i(36840),K=i(66202),j=i(86562),$=i(22835),Y=i(20408),G=i(60172),Q=i(93712),X=i(11871),z=i(5731),Z=i(79239),ee=i(26816),te=i(24497),ie=i(80152);const se={display:"flex",width:m.Ks.percent(100),height:m.Ks.percent(100),alignItems:"center"},ne={position:m.Ks.important("fixed"),left:m.Ks.important(m.Ks.rem(18.5)),minWidth:m.Ks.important("auto")},ae={color:te.NeutralGray60,margin:`0 ${m.Ks.rem(1.7)} 0 auto`,fontSize:m.Ks.rem(.75)},oe=m.Ks.prefixedStylesheet("dropdown",{button:[se],item:[{whiteSpace:"nowrap",textTransform:"capitalize"}],popover:[ne],arrow:[ae]}),re={$nest:{"& div":{display:"flex",alignItems:"center",justifyContent:"center",minWidth:m.Ks.rem(2)},"&:hover svg path":{fill:ie.Q.Background.Brand.Default}}},ce={position:"absolute",width:m.Ks.rem(.5),height:m.Ks.rem(.5),borderRadius:m.Ks.percent(100),backgroundColor:ie.Q.Icon.Addition.Default},le=m.Ks.prefixedStylesheet("document-settings",{versionHistory:[re],greenDot:[ce]});var de=i(76720);function ue(e){switch(e){case"chrome":case"firefox":case"edge":case"safari":return e;default:return"other"}}function me(e){switch(e){case"windows":case"mac":case"linux":case"android":case"ios":return e;default:return"other"}}const pe=JSON.parse('{"K8":"_30784b8d-document_settings-leftSidebar","jd":"_70c2ea48-document_settings-documentSettings","wj":"_348ade1e-document_settings-documentSettingsExpanded _70c2ea48-document_settings-documentSettings","Ph":"_870aad65-document_settings-scrollableContent","ZW":"_5a636762-document_settings-toolbarCollapsed _fb8600bc-document_settings-toolbar","R8":"_15e661ea-document_settings-toolbarExpanded _fb8600bc-document_settings-toolbar","SQ":"_3dbbc993-document_settings-expandButtonContainer","Mf":"_d0325687-document_settings-expandButtonHiddenWhenSmall","fJ":"_9d895033-document_settings-expandButtonAnimationWrapperExpanded _237cd7aa-document_settings-expandButtonAnimationWrapper","od":"_291e4f38-document_settings-expandButtonSquashedWhenSmall","$F":"_136e4ceb-document_settings-expandButtonSquashed","lU":"_1f325472-document_settings-expandButtonAnimationWrapperCollapsed _237cd7aa-document_settings-expandButtonAnimationWrapper","X1":"_ed94873c-document_settings-expandButton","oK":"_2974ca1c-document_settings-expandButtonInlineAnimation","$o":"_0f89949d-document_settings-expandMenuIcon","f8":"_6d6371bd-document_settings-toolbarSupportButton","me":"_8dab8e44-document_settings-separator","rL":"_ff4e87bc-document_settings-menuButtonWrapper","AQ":"_333197d8-document_settings-menuButton","e4":"_5651fbaa-document_settings-menuTitle","Tz":"_cdf812a7-document_settings-menuText","Pf":"_8ab3b40d-document_settings-label","Kk":"_917fdd2e-document_settings-icon","wx":"_8fae830c-document_settings-header","TK":"_9d1b94f9-document_settings-headerText","A3":"_d6f0c040-document_settings-userNameHeader _8fae830c-document_settings-header","nT":"_065afd9b-document_settings-userName","UY":"_08a25b52-document_settings-emailHeader _8fae830c-document_settings-header","Rp":"_c5de6f5a-document_settings-email","kZ":"_f564a3b5-document_settings-menuHead","j_":"_9afd9458-document_settings-closeButtonWrapperExpanded _d0ae08ac-document_settings-closeButtonWrapper","R5":"_95e072ff-document_settings-closeButtonWrapperCollapsed _d0ae08ac-document_settings-closeButtonWrapper","g":"_186e70b6-document_settings-closeButtonExpanded _59e89c2a-document_settings-closeButton _333197d8-document_settings-menuButton","ag":"_0c2e3bfd-document_settings-closeButtonCollapsed _59e89c2a-document_settings-closeButton _333197d8-document_settings-menuButton","Uu":"_0471cda7-document_settings-closeButtonTitleExpanded _5651fbaa-document_settings-menuTitle","aw":"_79f093fd-document_settings-closeButtonTitleCollapsed _5651fbaa-document_settings-menuTitle","Dq":"_5348c61e-document_settings-oneItemContainer _ff4e87bc-document_settings-menuButtonWrapper","pU":"_4f2bb3ef-document_settings-accountHeaderLabel","b0":"_ef00e5e1-document_settings-freeLabel _4f2bb3ef-document_settings-accountHeaderLabel","Z8":"_20d57042-document_settings-iconCollapsed","T1":"_e6b5ae1d-document_settings-iconExpanded","xJ":"_0f6dd75f-document_settings-closeIconCollapsed _917fdd2e-document_settings-icon _20d57042-document_settings-iconCollapsed","pH":"_8f766e5d-document_settings-closeIconExpanded _917fdd2e-document_settings-icon _e6b5ae1d-document_settings-iconExpanded","G4":"_d46f3fce-document_settings-onboardingSpot"}'),he=({documentSettingsViewModel:e,isSidebarOpen:t,isDemoMode:i,showOnboardingTourA11yUpdates:s})=>{const{landmark:n}=a.useContext(_.S.Context);return a.createElement("aside",{className:pe.K8,"aria-label":n.documentMenu},a.createElement(_e,{viewModel:e}),a.createElement(Se,{documentSettingsViewModel:e,isSidebarOpen:t,isDemoMode:i,showOnboardingTourA11yUpdates:s}))},_e=({viewModel:e})=>{const{ref:t,onMount:i}=w.R.useElWatcher(),s=a.useContext(_.S.Context);w.R.FocusTrap.useFocusTrap(e.visualState.pipe(E.p(xe.isExpanded),P.c(500),T.K(t)));const n=t.pipe(M.oE),r=new C.t(0),c=e.visualState.pipe(E.p(xe.isExpanded),x.M((()=>r.next(0)))),l=e.visualState.pipe(E.p(xe.isExpanded),k.n((()=>O.R(document,"mousedown").pipe(I.T((e=>U.fromNullable(e.target)))))),D.E(n),E.p((([e,t])=>!(0,o.pipe)(e,U.exists((e=>W.isParent(t,e)))))),x.M((()=>e.visualState.set({type:Z.VV.Collapsed}))));w.R.useSubscriptionTo(c.pipe(N.h(l))),w.R.useSubscriptionTo((0,o.pipe)(n,k.n((t=>e.visualState.view(xe.isExpanded).pipe(x.M((e=>e?t.removeAttribute("inert"):t.setAttribute("inert","true"))))))));const u=new H.B7;return a.createElement(d.F.Fragment,null,e.visualState.view((t=>{const n=xe.isExpanded(t);return a.createElement("nav",{"aria-label":s.documentSettings.label,className:n?pe.wj:pe.jd,ref:i,onMouseEnter:e.onMenuHovered},a.createElement(ye,{viewModel:e}),a.createElement("div",{className:pe.kZ}),a.createElement(v.G,{name:"documentSettingsScroll",showWhenScrollable:!0,className:pe.Ph,scrollTo:r,key:t.type,onScroll:u},e.items.map(((e,i)=>ee.W.Item.isViewItem(e)?xe.isHeader(e.name)?a.createElement(ve,{item:e,key:i}):a.createElement("div",{ref:i=>{t.type===Z.VV.Expanded&&null!==i&&(0,o.pipe)(t.scrollTo,U.filter((t=>t.item===e.name)),V.Mi((e=>r.next(i.getBoundingClientRect().bottom-e.positionY))))},className:xe.getItemClassName(e.name),key:i},a.createElement(we,{item:e,onScroll:u.pipe(I.T(J.Yi))})):a.createElement(Ce,{key:i})))))})))},ge=a.memo(z.B.createComponent({component:d.F.div,section:z.B.create(z.B.Id.menu),focusStrategy:q.a.FocusStrategy.focusRootOrLastFocusable}),o.constTrue),fe=a.memo(z.B.createComponent({component:f.$n,section:z.B.create(z.B.Id.support),behavior:q.a.FocusBehavior.captureTab}),o.constTrue),be=e=>a.createElement("span",{style:{top:m.Ks.rem(e.top),left:m.Ks.rem(e.left)},className:le.greenDot}),Se=({documentSettingsViewModel:e,isSidebarOpen:t,isDemoMode:i,showOnboardingTourA11yUpdates:l})=>{const m=a.useContext(_.S.Context);return a.createElement(d.F.Fragment,null,e.visualState.view((p=>{const h=xe.isExpanded(p);return a.createElement("nav",{"aria-label":m.documentSettings.toolbarLabel,className:h?pe.ZW:pe.R8,key:"documentSettings-toolbar"},a.createElement("div",{className:pe.SQ},a.createElement(d.F.div,(0,s._)({"data-name":"documentSettings-toolbarExpand"},(0,u.Ly)(h?pe.lU:pe.fJ,i?pe.$F:t.view((0,J.Sw)(pe.od,null)))),a.createElement(ge,{className:pe.X1},i?null:a.createElement(a.Fragment,null,a.createElement(f.$n,(0,n._)((0,s._)({name:"documentSettings-toolbarExpand-backToMyGrammarlyInline",title:"Grammarly Home","aria-label":"Grammarly Home"},(0,u.Ly)(pe.oK,t.view((0,J.Sw)(pe.Mf,null)))),{onClick:e.onGoBackToGrammarlyHome}),a.createElement(r.I,{icon:c.c,accessibilityLabel:"Open Grammarly Home",className:h?pe.Z8:pe.T1}))),a.createElement(L.M7,{alignment:"bottom",eventType:"onclick",stepId:R.E.StepId.Step10,title:l?m.documentSettings.detailedOnboarding.title:void 0,message:l?m.documentSettings.detailedOnboarding.message:m.documentSettings.onboarding.message,themes:{spotClassName:pe.G4}},a.createElement(f.$n,{name:"documentSettings-toolbarExpand-openToolbar",title:"Menu","aria-label":"Menu",className:pe.oK,onClick:e.onOpenToolbar},a.createElement(S.In.DocumentSettings.ExpandMenu,{className:pe.$o}),A.wd(e.hasNewItems)(a.createElement(be,{top:.3,left:1}),null)))))),a.createElement(fe,{name:"documentSettings-toolbarSupport",className:pe.f8,title:m.documentSettings.supportTitle,"aria-label":m.documentSettings.supportTitle,onClick:t=>{e.visualState.set({type:Z.VV.Expanded,scrollTo:(0,o.pipe)(xe.getClickEventY(t),U.map((e=>({item:Z.m1.support,positionY:e}))))})}},a.createElement(S.In.QuestionMark,null)))})))},ve=({item:e})=>a.createElement("div",{className:xe.getItemClassName(e.name)},a.createElement(y.Oc,{className:(0,o.pipe)(xe.getTextClassName(e.name),U.toUndefined)},e.title),a.createElement(Me,{item:e})),ye=({viewModel:e})=>{const t=xe.isExpanded(e.visualState.get());return a.createElement("div",{className:t?pe.j_:pe.R5},a.createElement(f.$n.Flat,{name:`documentSettings-${e.head.name}`,active:e.head.active,disabled:e.head.disabled,animationMode:b.g.None,onClick:e.head.onClick,className:t?pe.g:pe.ag},a.createElement(S.In.Close,{className:t?pe.pH:pe.xJ}),a.createElement("span",{className:t?pe.Uu:pe.aw},e.head.title)))},we=({item:e,onScroll:t})=>{const i=a.useContext(Y._.Context),r=a.useContext(Q.OH.Context),c=xe.getLink(e.name,i,r),l=xe.getUploadModel(e),u=a.useRef(null),m=()=>{e.onClick(),null!==u.current&&u.current.click()},p=a.createElement(a.Fragment,null,(0,o.pipe)(xe.getIcon(e),U.fold((()=>a.createElement("span",{id:e.name,className:pe.Tz},e.title)),(t=>a.createElement(a.Fragment,null,a.createElement(d.F.div,{"aria-hidden":!0,className:pe.Kk},t,(0,o.pipe)(e.showGreenDot,U.map((e=>A.wd(e)(a.createElement(be,{top:.3,left:1.95}),null))),U.toNullable)),a.createElement("span",{className:pe.e4},e.title))))),a.createElement(Me,{item:e})),h=(0,o.pipe)(l,U.map((e=>a.createElement(X.k,{documentUpload:e,multiple:!1,mount:e=>u.current=e,hideTooltip:!0,ariaHidden:!0}))),U.toNullable);return a.createElement(a.Fragment,null,(0,o.pipe)(c,U.map((t=>a.createElement(Te,{item:e,link:t,onClick:m},p))),V.NW((0,o.pipe)(e.nestedItem,U.chain(U.fromEither),U.filter(Z.LU.is),U.map((e=>a.createElement(Pe,(0,n._)((0,s._)({},xe.getDropdownProps(e)),{onScroll:t}),p))))),U.getOrElse((()=>a.createElement(Ee,{item:e,onClick:m},p)))),h)},Ee=({item:e,children:t,onClick:i})=>a.createElement(f.$n.Flat,{name:`documentSettings-${e.name}`,active:e.active,disabled:e.disabled,onClick:i,className:pe.AQ},t),Pe=({children:e,items:t,selected:i,onAction:o,onOpenChange:r,onScroll:c})=>a.createElement(d.F.Fragment,null,c.pipe(F.S((e=>++e),0),B.Z(0),I.T((c=>a.createElement(p.W.DropdownLifted,{key:c,label:a.createElement(a.Fragment,null,e,a.createElement("span",{className:oe.arrow,"aria-hidden":!0},"▶")),selectionMode:"single",placement:"right",theme:oe,button:f.$n.Flat,selectedKeys:i,onAction:o,items:i.view((e=>t.map((t=>(0,n._)((0,s._)({},t),{selected:e.has(t.text)}))))),onOpenChange:r},(e=>a.createElement(p.W.Item,{key:e.text,textValue:e.text},e.icon,a.createElement(p.W.ItemContent,null,`${e.text} English`)))))))),Te=({item:e,link:t,onClick:i,children:s})=>a.createElement(f.$n.Flat,{name:`documentSettings-${e.name}`,active:e.active,disabled:e.disabled,className:pe.AQ,onClick:i,href:t,target:"_blank"},s),Me=({item:e})=>(0,o.pipe)(e.nestedItem,U.map(K.fold((e=>a.createElement(y.Oc,{className:pe.Pf},e)),xe.renderNestedItem)),U.toNullable),Ce=()=>a.createElement("div",{className:pe.me});var xe;!function(e){function t(e){switch(e){case"american":return a.createElement(S.In.DocumentSettings.USFlag,null);case"british":return a.createElement(S.In.DocumentSettings.GBFlag,null);case"canadian":return a.createElement(S.In.DocumentSettings.CanadianFlag,null);case"australian":return a.createElement(S.In.DocumentSettings.AustralianFlag,null);case"indian":return a.createElement(S.In.DocumentSettings.IndianFlag,null);default:return(0,j.xb)(e)}}function i(e){const t=e.getBoundingClientRect();return t.bottom-t.height/2}e.getDropdownProps=e=>function(e){return{items:Object.values(G.Vi).map((e=>({text:e,icon:t(e)}))),selected:e.dialectSettings.dialectOrDefault.view((e=>new Set([e]))),onAction:e.changeDialect.bind(e),onOpenChange:e.onStateChange.bind(e)}}(e),e.renderNestedItem=e=>{switch(e.type){case Z.W7.uploadFile:return a.createElement(y.Oc,{className:pe.Pf},e.label);case Z.W7.accountHeaderLabel:return a.createElement(d.F.Fragment,null,e.brandingSet.view((e=>(0,o.pipe)(e,U.fold((()=>null),(e=>"PREMIUM"===e?a.createElement(g.E.Premium,{className:pe.pU},e):a.createElement(g.E.Regular,{className:"FREE"===e?pe.b0:pe.pU},e)))))));case Z.W7.whatsNewUpdates:case Z.W7.languageSettings:return a.createElement(a.Fragment,null);default:return(0,j.xb)(e)}},e.getLink=function(e,t,i){switch(e){case Z.m1.subscription:return U.some(t.account.subscription);case Z.m1.support:return U.some(t.support.mainPage);case Z.m1.privacyPolicy:return U.some(t.privacyPolicy);case Z.m1.termsOfService:return U.some(t.termsOfService);case Z.m1.reportABug:return U.some(function(e,t){return new de.U(e.api.inProductReportUrl).addParams({clientVersion:t.buildVersion.toString(),platformVersion:t.info.parsedVersion.toString(),application:window.location.origin,browser:ue(t.info.browser),os:me(t.info.os),userType:"business",team:"editor"}).toString()}(t,i));case Z.m1.versionHistory:return U.some(t.urls.versionHistory);case Z.m1.close:case Z.m1.myGrammarly:case Z.m1.documentHeader:case Z.m1.newDocument:case Z.m1.uploadFile:case Z.m1.download:case Z.m1.print:case Z.m1.editHeader:case Z.m1.editorSettings:case Z.m1.accountHeader:case Z.m1.userName:case Z.m1.email:case Z.m1.upgradeToPremium:case Z.m1.language:case Z.m1.logout:case Z.m1.whatsNew:case Z.m1.feedback:case h.H2.undo:case h.H2.redo:case h.H2.cut:case h.H2.copy:case h.H2.paste:case h.H2.selectAll:return U.none;default:return(0,j.xb)(e)}},e.getUploadModel=(0,o.flow)($.Up("nestedItem"),U.chain(U.fromEither),U.chain((e=>{switch(e.type){case Z.W7.uploadFile:return(0,o.pipe)(e.uploadViewModel,U.map((e=>e.uploadModel)));case Z.W7.accountHeaderLabel:case Z.W7.whatsNewUpdates:case Z.W7.languageSettings:return U.none;default:return(0,j.xb)(e)}}))),e.getIcon=function(e){const i=e.name;switch(i){case Z.m1.close:return U.some(a.createElement(S.In.Close,null));case Z.m1.myGrammarly:return U.some(a.createElement(S.In.DocumentSettings.Home,null));case Z.m1.newDocument:return U.some(a.createElement(S.In.DocumentSettings.NewDocument,null));case Z.m1.uploadFile:return U.some(a.createElement(S.In.DocumentSettings.UploadFile,null));case Z.m1.download:return U.some(a.createElement(S.In.ToolbarDownload,null));case Z.m1.print:return U.some(a.createElement(S.In.DocumentSettings.PrintFile,null));case h.H2.undo:return U.some(a.createElement(S.In.DocumentSettings.UndoGrey,null));case h.H2.redo:return U.some(a.createElement(S.In.DocumentSettings.Redo,null));case h.H2.cut:return U.some(a.createElement(S.In.DocumentSettings.Cut,null));case h.H2.copy:return U.some(a.createElement(S.In.Copy,null));case h.H2.paste:return U.some(a.createElement(S.In.DocumentSettings.Paste,null));case Z.m1.editorSettings:return U.some(a.createElement(S.In.Gear,null));case Z.m1.support:return U.some(a.createElement(S.In.QuestionMark,null));case Z.m1.upgradeToPremium:return U.some(a.createElement(S.In.Paid,null));case Z.m1.versionHistory:return U.some(a.createElement(r.I,{icon:l.k,accessibilityLabel:"",size:"large"}));case Z.m1.documentHeader:case Z.m1.editHeader:case Z.m1.accountHeader:case Z.m1.userName:case Z.m1.email:case Z.m1.language:return(0,o.pipe)(e.nestedItem,U.chain(U.fromEither),U.filter(Z.LU.is),U.map((e=>e.dialectSettings.dialectOrDefault.view(t))));case Z.m1.subscription:case Z.m1.logout:case Z.m1.whatsNew:case Z.m1.feedback:case Z.m1.privacyPolicy:case Z.m1.termsOfService:case Z.m1.reportABug:case h.H2.selectAll:return U.none;default:return(0,j.xb)(i)}},e.getItemClassName=function(e){switch(e){case Z.m1.myGrammarly:case Z.m1.editorSettings:return pe.Dq;case Z.m1.documentHeader:case Z.m1.editHeader:case Z.m1.accountHeader:return pe.wx;case Z.m1.userName:return pe.A3;case Z.m1.email:return pe.UY;case Z.m1.versionHistory:return le.versionHistory;case Z.m1.close:case Z.m1.newDocument:case Z.m1.uploadFile:case Z.m1.download:case Z.m1.print:case Z.m1.upgradeToPremium:case Z.m1.language:case Z.m1.subscription:case Z.m1.logout:case Z.m1.support:case Z.m1.whatsNew:case Z.m1.feedback:case Z.m1.privacyPolicy:case Z.m1.termsOfService:case Z.m1.reportABug:case h.H2.undo:case h.H2.redo:case h.H2.cut:case h.H2.copy:case h.H2.paste:case h.H2.selectAll:return pe.rL;default:return(0,j.xb)(e)}},e.getTextClassName=function(e){switch(e){case Z.m1.userName:return U.some(pe.nT);case Z.m1.email:return U.some(pe.Rp);case Z.m1.documentHeader:case Z.m1.editHeader:case Z.m1.accountHeader:return U.some(pe.TK);case Z.m1.close:case Z.m1.myGrammarly:case Z.m1.newDocument:case Z.m1.uploadFile:case Z.m1.download:case Z.m1.print:case Z.m1.editorSettings:case Z.m1.upgradeToPremium:case Z.m1.language:case Z.m1.subscription:case Z.m1.logout:case Z.m1.support:case Z.m1.whatsNew:case Z.m1.feedback:case Z.m1.privacyPolicy:case Z.m1.termsOfService:case Z.m1.reportABug:case Z.m1.versionHistory:case h.H2.undo:case h.H2.redo:case h.H2.cut:case h.H2.copy:case h.H2.paste:case h.H2.selectAll:return U.none;default:return(0,j.xb)(e)}},e.isHeader=function(e){switch(e){case Z.m1.documentHeader:case Z.m1.editHeader:case Z.m1.accountHeader:case Z.m1.userName:case Z.m1.email:return!0;case Z.m1.close:case Z.m1.myGrammarly:case Z.m1.newDocument:case Z.m1.uploadFile:case Z.m1.download:case Z.m1.print:case Z.m1.editorSettings:case Z.m1.upgradeToPremium:case Z.m1.language:case Z.m1.subscription:case Z.m1.logout:case Z.m1.support:case Z.m1.whatsNew:case Z.m1.feedback:case Z.m1.privacyPolicy:case Z.m1.termsOfService:case Z.m1.reportABug:case Z.m1.versionHistory:case h.H2.undo:case h.H2.redo:case h.H2.cut:case h.H2.copy:case h.H2.paste:case h.H2.selectAll:return!1;default:return(0,j.xb)(e)}},e.getClickEventY=function(e){return(0,o.pipe)(U.fromNullable(void 0!==e&&e.target),U.map(i))},e.getElementCenter=i,e.isExpanded=function(e){return e.type===Z.VV.Expanded}}(xe||(xe={}))},8094:(e,t,i)=>{i.d(t,{WG:()=>p,y9:()=>s});var s,n=i(83531),a=i(23988),o=i(60575),r=i(59446),c=i(48581),l=i(36840),d=i(704),u=i(34681),m=i(80029);class p{getFreeTrialEligibility(){var e,t,i,s,n,a;return null!==(a=null!==(n=null===(t=this._eligibilitySpecialOffers)||void 0===t||null===(e=t.free_trial_rollout)||void 0===e?void 0:e.eligibility)&&void 0!==n?n:null===(s=this._eligibilitySpecialOffers)||void 0===s||null===(i=s.pro_free_trial)||void 0===i?void 0:i.eligibility)&&void 0!==a&&a}getFreeTrialEuUkEligibility(){return!(!this._eligibilitySpecialOffers||!this._eligibilitySpecialOffers.free_trial_eu_uk)&&this._eligibilitySpecialOffers.free_trial_eu_uk.eligibility}getFreeTrialForNewUsersEligibility(){return!(!this._eligibilitySpecialOffers||!this._eligibilitySpecialOffers.free_trial_new_users)&&this._eligibilitySpecialOffers.free_trial_new_users.eligibility}constructor(e){(0,a._)(this,"_fingerprints",void 0),(0,a._)(this,"_vitoClient",void 0),(0,a._)(this,"_eligibilitySpecialOffers",void 0),(0,a._)(this,"_initVitoClient",void 0),(0,a._)(this,"requestSpecialOffersEligibility",void 0),this._fingerprints=e;var t=this;this._initVitoClient=(0,n._)((function*(){const e=yield(0,u.r)(t._fingerprints)(),i=new r.Configuration({basePath:(0,m.W)().api.vito,fetchApi:c.pM.request({target:"vito",cache:"default"}),headers:{"X-CSRF-Token":e["X-CSRF-Token"],"X-Container-Id":e["X-Container-Id"],"X-Client-Version":e["X-Client-Version"],"X-Client-Type":e["X-Client-Type"]},credentials:"include"});t._vitoClient=new r.VitoApi(i)}));var i,s=this;this.requestSpecialOffersEligibility=(i=(0,n._)((function*(e){s._vitoClient||(yield s._initVitoClient());try{o.Bx.TimeSeries.rootFemetrics.getMetric(d.b.Metrics.SpecialOfferEligibility).getCounter(d.b.MetricsActions.RequestAttemptsTotal).increment(),s._eligibilitySpecialOffers=yield s._vitoClient.specialOffersGet({names:e}),o.Bx.TimeSeries.rootFemetrics.getMetric(d.b.Metrics.SpecialOfferEligibility).getCounter(d.b.MetricsActions.RequestSuccessTotal).increment()}catch(t){o.Bx.Logging.getLogger("VitoService").error(`Special offer eligibility request failed: ${e}`,t),o.Bx.TimeSeries.rootFemetrics.getMetric(d.b.Metrics.SpecialOfferEligibility).getCounter(d.b.MetricsActions.RequestFailuresTotal).increment()}})),function(e){return i.apply(this,arguments)}),this._initVitoClient()}}!function(e){e.Mock=class{constructor(){(0,a._)(this,"requestSpecialOffersEligibility",(()=>l.Yi)),(0,a._)(this,"getFreeTrialEligibility",(()=>!1)),(0,a._)(this,"getFreeTrialEuUkEligibility",(()=>!1)),(0,a._)(this,"getFreeTrialForNewUsersEligibility",(()=>!1))}}}(s||(s={}))},52680:(e,t,i)=>{i.d(t,{J:()=>r});var s=i(50659),n=i(74056),a=i(93712),o=i(12416);const r=()=>{const e=(0,n.W$)(new a.Qt).base.byokErrorPage;return s.createElement(o.M,{title:e.title,description:e.description()})}}}]);