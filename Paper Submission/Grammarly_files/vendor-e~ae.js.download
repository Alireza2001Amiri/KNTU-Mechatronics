"use strict";(self.webpackChunk_grammarly_denali_app=self.webpackChunk_grammarly_denali_app||[]).push([[741],{31037:(e,t,i)=>{i.r(t),i.d(t,{ActionArg:()=>f,ActionArgDef:()=>v,ActionArgDefRadioButtonGroup:()=>k,ActionArgDefRadioButtonGroupHint:()=>y,ActionArgDefString:()=>b,ActionArgDefStringHint:()=>_,ActionDef:()=>E,ActionDefDisabled:()=>C,ActionDefGeneratesTextType:()=>S,ActionInfo:()=>w,AvailableVoiceProfile:()=>T,AvailableVoiceProfileSection:()=>x,AvailableVoiceProfileSectionTag:()=>I,AvailableVoiceProfileSectionTagState:()=>A,AvailableVoiceProfiles:()=>F,ClientMessage:()=>c,ClientMessageImplementations:()=>Ke,Context:()=>R,DocumentOverview:()=>K,Error:()=>O,ErrorKind:()=>M,GeneratedText:()=>N,GenerationMode:()=>B,Message:()=>P,MessageAction:()=>U,MessageChunk:()=>Q,MessageError:()=>W,MessageGetContext:()=>D,MessageGetHistory:()=>G,MessageGetUserState:()=>H,MessageInterrupt:()=>$,MessageInvalidateContext:()=>L,MessageResult:()=>Y,MessageResultChangesSummary:()=>J,MessageSearchReferences:()=>Z,MessageSearchReferencesResult:()=>q,MessageSetContext:()=>z,MessageSetHistory:()=>se,MessageSetHistoryCard:()=>ne,MessageSetHistoryCardTitle:()=>ee,MessageSetHistoryCardTitleAction:()=>ie,MessageSetHistoryCardTitleUserPrompt:()=>te,MessageSetUserState:()=>X,MessageSetVoice:()=>j,MessageSetVoiceProfile:()=>V,Metadata:()=>re,Notification:()=>ae,NotificationKind:()=>oe,OuterContext:()=>ce,OuterContextItem:()=>le,PreviousText:()=>de,PreviousTextHistory:()=>pe,PreviousTextRegular:()=>ue,PreviousTextWriterExpert:()=>me,ProtocolMessage:()=>d,Reference:()=>he,ReferencePrivacyLevel:()=>ge,ReferencePrivacyLevelPublic:()=>fe,ReferencePrivacyLevelRestricted:()=>ve,Root:()=>g,ServerMessage:()=>u,ServerMessageImplementations:()=>Me,SpecialView:()=>_e,SpecialViewAiUsageAlert:()=>be,StartMessage:()=>p,StartedMessage:()=>m,Style:()=>ye,Text:()=>ke,TextLike:()=>h,TextRange:()=>Se,Toggle:()=>Ce,UrlReference:()=>Ee,Usage:()=>we,UserState:()=>Ie,UserStateSettings:()=>Ae,Voice:()=>xe,VoiceProfileSettings:()=>Re,VoiceProfileSettingsMyVoiceIsEnabledByDefault:()=>Te,VoiceProfileSettingsStatus:()=>Fe,encoderSchemable:()=>Le,extend:()=>De,interpreter:()=>Pe,make:()=>Be});var n=i(1059),s=i(92084),r=i(69998),o=i(18954),a=i(38791),l=i(84647),c=Be((function(e){return Ne(d(e),e.struct({}))(e)})),d=Be((function(e){return e.struct({id:e.number})})),u=Be((function(e){return Ne(d(e),e.struct({}))(e)})),p=Be((function(e){return e.intersect(e.partial({docIdIsTransient:e.boolean}))(e.struct({}))})),m=Be((function(e){return e.struct({cheetahState:Ie(e)})})),h=Be((function(e){return e.struct({plain:e.sensitiveString,delta:e.sensitiveDelta})})),g=Be((function(e){return P(e)})),f=Be((function(e){return e.struct({name:e.string,value:e.sensitiveString})})),v=Be((function(e){var t;return e.sum("valueType")(((t={}).string=b(e),t.radioButtonGroup=k(e),t))})),_=Be((function(e){return e.struct({header:e.string,text:e.readonly(e.array(e.string))})})),b=Be((function(e){return e.intersect(e.partial({hint:_(e)}))(e.struct({valueType:e.literal("string"),label:e.string,name:e.string}))})),y=Be((function(e){return e.struct({header:e.string,text:e.readonly(e.array(e.string))})})),k=Be((function(e){return e.intersect(e.partial({hint:y(e)}))(e.struct({valueType:e.literal("radioButtonGroup"),label:e.string,name:e.string,radioButtonGroupValues:e.readonly(e.array(e.string))}))})),S=Oe(s.nN),C=Be((function(e){return e.intersect(e.partial({onActionNotification:ae(e)}))(e.struct({}))})),E=Be((function(e){return e.intersect(e.partial({generatesTextType:S(e)}))(e.intersect(e.partial({disabled:C(e)}))(e.struct({id:e.string,iconUrl:e.string,group:e.string,label:e.string,searchTags:e.readonly(e.array(e.string)),args:e.readonly(e.array(v(e)))})))})),w=Be((function(e){return e.intersect(e.partial({useReferences:e.readonly(e.array(Ee(e)))}))(e.intersect(e.partial({omitReferenceIds:e.readonly(e.array(e.string))}))(e.struct({contextId:e.string,triggerContextId:e.string,actionId:e.string,args:e.readonly(e.array(f(e)))})))})),A=Oe(s.pz),I=Be((function(e){return e.struct({name:e.string,state:A(e)})})),x=Be((function(e){return e.struct({name:e.string,tags:e.readonly(e.array(I(e)))})})),T=Be((function(e){return e.struct({name:e.string,summary:e.string,selected:e.boolean,sections:e.readonly(e.array(x(e)))})})),F=Be((function(e){return e.readonly(e.array(T(e)))})),R=Be((function(e){return e.intersect(e.partial({voiceProfileSettings:Re(e)}))(e.intersect(e.partial({intent:e.sensitiveString}))(e.intersect(e.partial({documentOverview:K(e)}))(e.intersect(e.partial({specialView:_e(e)}))(e.intersect(e.partial({textScope:Se(e)}))(e.intersect(e.partial({contextNotification:ae(e)}))(e.intersect(e.partial({metadata:re(e)}))(e.struct({id:e.string,voice:xe(e),availableActions:e.readonly(e.array(E(e))),parentAction:w(e),stateBlob:e.string,promptAction:E(e),quickRewriteAction:E(e)}))))))))})),K=Be((function(e){return e.struct({title:e.string,summary:e.string})})),M=Oe(s.Fv),O=Be((function(e){return e.struct({kind:M(e),title:e.string,text:e.string})})),N=Be((function(e){return Ne(h(e),e.struct({plain:e.sensitiveString,interrupted:e.boolean,renderDiff:e.boolean,delta:e.sensitiveDelta}))(e)})),B=Oe(s.ol),P=Be((function(e){var t;return Ne(d(e),e.sum("action")(((t={})["cheetah:getContext"]=D(e),t["cheetah:invalidateContext"]=L(e),t["cheetah:action"]=U(e),t["cheetah:setVoice"]=j(e),t["cheetah:setVoiceProfile"]=V(e),t["cheetah:interrupt"]=$(e),t["cheetah:getUserState"]=H(e),t["cheetah:searchReferences"]=Z(e),t["cheetah:getHistory"]=G(e),t["cheetah:error"]=W(e),t["cheetah:setContext"]=z(e),t["cheetah:searchReferencesResult"]=q(e),t["cheetah:chunk"]=Q(e),t["cheetah:result"]=Y(e),t["cheetah:setUserState"]=X(e),t["cheetah:setHistory"]=se(e),t)))(e)})),D=Be((function(e){return Ne(c(e),e.intersect(e.partial({outerContext:ce(e)}))(e.intersect(e.partial({selectedRange:Se(e)}))(e.intersect(e.partial({stateBlob:e.string}))(e.intersect(e.partial({previousText:de(e)}))(e.intersect(e.partial({includeDisabledActions:e.boolean}))(e.intersect(e.partial({metadata:re(e)}))(e.struct({action:e.literal("cheetah:getContext"),rev:e.number,generationMode:B(e)}))))))))(e)})),L=Be((function(e){return Ne(u(e),e.struct({action:e.literal("cheetah:invalidateContext")}))(e)})),U=Be((function(e){return Ne(c(e),e.intersect(e.partial({useReferences:e.readonly(e.array(Ee(e)))}))(e.intersect(e.partial({omitReferenceIds:e.readonly(e.array(e.string))}))(e.intersect(e.partial({previousText:de(e)}))(e.intersect(e.partial({metadata:re(e)}))(e.struct({action:e.literal("cheetah:action"),rev:e.number,contextId:e.string,triggerContextId:e.string,actionId:e.string,stateBlob:e.string,args:e.readonly(e.array(f(e)))}))))))(e)})),j=Be((function(e){return Ne(c(e),e.struct({action:e.literal("cheetah:setVoice"),voice:xe(e)}))(e)})),V=Be((function(e){return Ne(c(e),e.intersect(e.partial({role:e.string}))(e.intersect(e.partial({isEnabledByDefault:e.boolean}))(e.intersect(e.partial({profiles:F(e)}))(e.struct({action:e.literal("cheetah:setVoiceProfile")})))))(e)})),$=Be((function(e){return Ne(c(e),e.struct({action:e.literal("cheetah:interrupt"),promptId:e.number}))(e)})),H=Be((function(e){return Ne(c(e),e.struct({action:e.literal("cheetah:getUserState")}))(e)})),Z=Be((function(e){return Ne(c(e),e.intersect(e.partial({url:e.string}))(e.struct({action:e.literal("cheetah:searchReferences")})))(e)})),G=Be((function(e){return Ne(c(e),e.struct({action:e.literal("cheetah:getHistory")}))(e)})),W=Be((function(e){return Ne(u(e),e.struct({action:e.literal("cheetah:error"),promptId:e.number,error:O(e)}))(e)})),z=Be((function(e){return Ne(u(e),e.intersect(e.partial({progressMessage:e.string}))(e.struct({action:e.literal("cheetah:setContext"),promptId:e.number,context:R(e),usage:we(e)})))(e)})),q=Be((function(e){return Ne(u(e),e.struct({action:e.literal("cheetah:searchReferencesResult"),promptId:e.number,references:e.readonly(e.array(he(e)))}))(e)})),Q=Be((function(e){return Ne(u(e),e.intersect(e.partial({metadata:re(e)}))(e.struct({action:e.literal("cheetah:chunk"),promptId:e.number,token:e.sensitiveString})))(e)})),J=Be((function(e){return e.struct({title:e.string,description:e.readonly(e.array(e.string))})})),Y=Be((function(e){return Ne(u(e),e.intersect(e.partial({metadata:re(e)}))(e.intersect(e.partial({context:R(e)}))(e.intersect(e.partial({error:O(e)}))(e.intersect(e.partial({text:N(e)}))(e.intersect(e.partial({withVoiceText:N(e)}))(e.intersect(e.partial({showVoiceTextByDefault:e.boolean}))(e.intersect(e.partial({references:e.readonly(e.array(he(e)))}))(e.intersect(e.partial({changesSummary:J(e)}))(e.struct({action:e.literal("cheetah:result"),promptId:e.number,usage:we(e)}))))))))))(e)})),X=Be((function(e){return Ne(u(e),e.struct({action:e.literal("cheetah:setUserState"),state:Ie(e)}))(e)})),ee=Be((function(e){var t;return e.sum("kind")(((t={}).userPrompt=te(e),t.action=ie(e),t))})),te=Be((function(e){return e.struct({kind:e.literal("userPrompt"),text:e.string})})),ie=Be((function(e){return e.struct({kind:e.literal("action"),iconUrl:e.string,label:e.string})})),ne=Be((function(e){return e.intersect(e.partial({showVoiceTextByDefault:e.boolean}))(e.struct({id:e.string,text:ke(e),withVoiceText:ke(e),title:ee(e),references:e.readonly(e.array(he(e)))}))})),se=Be((function(e){return Ne(u(e),e.struct({action:e.literal("cheetah:setHistory"),cards:e.readonly(e.array(ne(e)))}))(e)})),re=Be((function(e){return e.any})),oe=Oe(s.Ij),ae=Be((function(e){return e.intersect(e.partial({title:e.string}))(e.struct({kind:oe(e),text:e.string}))})),le=Be((function(e){return e.intersect(e.partial({title:e.sensitiveString}))(e.intersect(e.partial({people:e.readonly(e.record(e.readonly(e.array(e.sensitiveString))))}))(e.struct({text:e.sensitiveString})))})),ce=Be((function(e){return e.intersect(e.partial({pageIdHash:e.string}))(e.intersect(e.partial({title:e.sensitiveString}))(e.intersect(e.partial({people:e.readonly(e.record(e.readonly(e.array(e.sensitiveString))))}))(e.intersect(e.partial({items:e.readonly(e.array(le(e)))}))(e.struct({})))))})),de=Be((function(e){var t;return e.sum("kind")(((t={}).regular=ue(e),t.history=pe(e),t.writerExpert=me(e),t))})),ue=Be((function(e){return e.struct({kind:e.literal("regular"),text:e.string})})),pe=Be((function(e){return e.struct({kind:e.literal("history"),text:e.string})})),me=Be((function(e){return e.struct({kind:e.literal("writerExpert"),text:e.string,suggestionId:e.string,pname:e.string})})),he=Be((function(e){return e.intersect(e.partial({url:e.string}))(e.struct({id:e.string,privacyLevel:ge(e),title:e.string,iconUrl:e.string}))})),ge=Be((function(e){var t;return e.sum("kind")(((t={}).public=fe(e),t.restricted=ve(e),t))})),fe=Be((function(e){return e.struct({kind:e.literal("public")})})),ve=Be((function(e){return e.struct({kind:e.literal("restricted")})})),_e=Be((function(e){var t;return e.sum("kind")(((t={}).aiUsageAlert=be(e),t))})),be=Be((function(e){return e.struct({kind:e.literal("aiUsageAlert")})})),ye=Be((function(e){return e.struct({button:Ce(e),tones:e.readonly(e.array(Ce(e))),maxTones:e.number})})),ke=Be((function(e){return Ne(h(e),e.struct({}))(e)})),Se=Be((function(e){return e.struct({start:e.number,end:e.number})})),Ce=Be((function(e){return e.struct({iconUrl:e.string,label:e.string,description:e.string})})),Ee=Be((function(e){return e.struct({url:e.string,referenceId:e.string})})),we=Be((function(e){return e.struct({promptsRemaining:e.number,promptsAllocated:e.number,refillDate:e.string})})),Ae=Be((function(e){return e.struct({inlineQuickReplyEnabled:e.boolean,inlineRewriteEnabled:e.boolean})})),Ie=Be((function(e){return e.intersect(e.partial({historyItems:e.number}))(e.struct({settings:Ae(e),usage:we(e)}))})),xe=Be((function(e){return e.intersect(e.partial({styles:e.readonly(e.array(ye(e)))}))(e.intersect(e.partial({selectedRole:e.string}))(e.intersect(e.partial({roles:e.readonly(e.array(e.string))}))(e.struct({selectedStyle:e.string,selectedTones:e.readonly(e.array(e.string)),needSetup:e.boolean}))))})),Te=Be((function(e){return e.struct({state:e.boolean,label:e.string})})),Fe=Oe(s.nn),Re=Be((function(e){return e.intersect(e.partial({status:Fe(e)}))(e.struct({userName:e.string,myVoiceIsEnabledByDefault:Te(e),title:e.string,subTitle:e.string,profiles:F(e)}))})),Ke=Be((function(e){var t;return e.sum("action")(((t={})["cheetah:getContext"]=D(e),t["cheetah:action"]=U(e),t["cheetah:setVoice"]=j(e),t["cheetah:setVoiceProfile"]=V(e),t["cheetah:interrupt"]=$(e),t["cheetah:getUserState"]=H(e),t["cheetah:searchReferences"]=Z(e),t["cheetah:getHistory"]=G(e),t))})),Me=Be((function(e){var t;return e.sum("action")(((t={})["cheetah:invalidateContext"]=L(e),t["cheetah:error"]=W(e),t["cheetah:setContext"]=z(e),t["cheetah:searchReferencesResult"]=q(e),t["cheetah:chunk"]=Q(e),t["cheetah:result"]=Y(e),t["cheetah:setUserState"]=X(e),t["cheetah:setHistory"]=se(e),t))}));function Oe(e){var t=Object.keys(e).map((function(t){return e[t]})),i=t[0],s=t.slice(1);return Be((function(e){return e.literal.apply(e,(0,n.fX)([i],s,!1))}))}function Ne(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Be((function(t){return e.reduce((function(e,i){return t.intersect(i)(e)}))}))}function Be(e){return o.B(e)}var Pe=(0,l.unsafeCoerce)(a.n);function De(e){return function(t){return(0,n.Cl)((0,n.Cl)({},e),t)}}var Le={URI:r.rz,literal:function(){return r.id()},string:r.id(),number:r.id(),boolean:r.id(),nullable:r.me,type:r.NW,struct:r.w3,partial:r.OH,record:r.g1,array:r.YO,tuple:r.PV,intersect:r.y$,sum:r.cz,lazy:function(e,t){return r.RZ(t)},readonly:r.tB}},73144:(e,t,i)=>{i.d(t,{r:()=>n});var n="16.2.0"},92084:(e,t,i)=>{var n,s,r,o,a,l;i.d(t,{Fv:()=>r,Ij:()=>a,nN:()=>n,nn:()=>l,ol:()=>o,pz:()=>s}),function(e){e.Insertable="insertable",e.NonInsertable="non_insertable"}(n||(n={})),function(e){e.Active="active",e.Snoozed="snoozed"}(s||(s={})),function(e){e.Generic="generic",e.Overflow="overflow",e.PromptsLimitExceeded="promptsLimitExceeded",e.SensitiveContent="sensitiveContent",e.ServerOverloaded="serverOverloaded",e.UnsupportedLanguage="unsupportedLanguage"}(r||(r={})),function(e){e.Ideation="ideation",e.PushRewrite="pushRewrite",e.QuickReply="quickReply",e.QuickRewrite="quickRewrite",e.Rewrite="rewrite"}(o||(o={})),function(e){e.Generic="generic",e.Info="info"}(a||(a={})),function(e){e.Initial="initial",e.Seen="seen",e.Updated="updated"}(l||(l={}))},96659:(e,t,i)=>{i.d(t,{t:()=>n});var n,s=i(36840),r=i(86562);!function(e){let t;!function(e){e.mount="mount",e.unmount="unmount",e.actionsMenuMuteClick="actionsMenuMuteClick",e.actionsMenuReportIncorrectClick="actionsMenuReportIncorrectClick",e.actionsMenuReportOffensiveClick="actionsMenuReportOffensiveClick",e.addToDictionaryClick="addToDictionaryClick",e.headerCloseButtonClick="headerCloseButtonClick",e.headerGoBackButtonClick="headerGoBackButtonClick",e.headerVoiceButtonClick="headerVoiceButtonClick",e.setVoiceButtonClick="setVoiceButtonClick",e.voiceProfileCloseButtonClick="voiceProfileCloseButtonClick",e.voiceProfileUseVoiceButtonClick="voiceProfileUseVoiceButtonClick",e.toneToggleClick="toneToggleClick",e.styleToggleClick="styleToggleClick",e.roleTypeaheadSelectionChange="roleTypeaheadSelectionChange",e.dialectDropdownSelectionChange="dialectDropdownSelectionChange",e.promptFieldTextChange="promptFieldTextChange",e.promptFieldFocusChange="promptFieldFocusChange",e.promptFieldAndMenuFocusChange="promptFieldAndMenuFocusChange",e.actionBrickClick="actionBrickClick",e.actionBrickMount="actionBrickMount",e.actionBrickShow="actionBrickShow",e.actionsMount="actionsMount",e.promptSubmitButtonClick="promptSubmitButtonClick",e.generateStopButtonClick="generateStopButtonClick",e.promptFieldKeyPressEscape="promptFieldKeyPressEscape",e.promptFieldKeyPressEnter="promptFieldKeyPressEnter",e.promptFieldKeyPressArrowDown="promptFieldKeyPressArrowDown",e.promptFieldKeyPressArrowUp="promptFieldKeyPressArrowUp",e.promptMenuKeyPressArrowDown="promptMenuKeyPressArrowDown",e.promptMenuKeyPressArrowUp="promptMenuKeyPressArrowUp",e.promptSearchResultsUpdate="promptSearchResultsUpdate",e.resultCardInsertButtonClick="resultCardInsertButtonClick",e.resultCardCopyButtonClick="resultCardCopyButtonClick",e.resultCardCopyToClipboard="resultCardCopyToClipboard",e.resultCardRephraseButtonClick="resultCardRephraseButtonClick",e.resultCardDismissButtonClick="resultCardDismissButtonClick",e.resultCardToggleGenericVoiceButtonClick="resultCardToggleGenericVoiceButtonClick",e.errorCardDismissButtonClick="errorCardDismissButtonClick",e.openFeedbackFormButtonClick="openFeedbackFormButtonClick",e.feedbackFormChange="feedbackFormChange",e.feedbackFormSubmitButtonClick="feedbackFormSubmitButtonClick",e.reportOffensiveResultButtonClick="reportOffensiveResultButtonClick",e.reportOffensiveActionsButtonClick="reportOffensiveActionsButtonClick",e.resultCardHeaderClick="resultCardHeaderClick",e.collapsePromptMenuButtonClick="collapsePromptMenuButtonClick",e.creditsInfoHover="creditsInfoHover",e.creditsInfoClick="creditsInfoClick",e.resultCardHoverChange="resultCardHoverChange",e.resultCardFocusChange="resultCardFocusChange",e.reportMenuVisibilityChange="reportMenuVisibilityChange",e.referencesVisibilityChange="referencesVisibilityChange",e.voiceProfileTabChange="voiceProfileTabChange",e.voiceTagClick="voiceTagClick",e.voiceTagPopoverClose="voiceTagPopoverClose",e.voiceTagPopoverKeepButtonClick="voiceTagPopoverKeepButtonClick",e.voiceTagPopoverRemoveButtonClick="voiceTagPopoverRemoveButtonClick",e.voiceDialectDropdownSelectionChange="voiceDialectDropdownSelectionChange",e.voiceRoleDropdownSelectionChange="voiceRoleDropdownSelectionChange",e.voiceSelectionsSaveButtonClick="voiceSelectionsSaveButtonClick",e.voiceSelectionsCancelButtonClick="voiceSelectionsCancelButtonClick",e.voiceSelectionsEditButtonClick="voiceSelectionsEditButtonClick",e.surveyRatingSelectionChange="surveyRatingSelectionChange",e.surveyOpenAnswerChange="surveyOpenAnswerChange",e.surveySubmitButtonClick="surveySubmitButtonClick",e.surveyKeyPressShiftEnter="surveyKeyPressShiftEnter",e.surveyCancelButtonClick="surveyCancelButtonClick",e.surveyCloseButtonClick="surveyCloseButtonClick",e.regenerateWithoutReferenceButtonClick="regenerateWithoutReferenceButtonClick",e.restoreHistoryButtonClick="restoreHistoryButtonClick",e.userPromptSubmit="userPromptSubmit",e.radioOptionsSubmitButtonClick="radioOptionsSubmitButtonClick",e.radioOptionsCancelButtonClick="radioOptionsCancelButtonClick",e.removeSelectionContextClick="removeSelectionContextClick",e.selectionContextInteraction="selectionContextInteraction",e.settingsButtonClick="settingsButtonClick",e.toneReportLoadedEmptyMount="toneReportLoadedEmptyMount",e.toneReportLoadedNonEmptyMount="toneReportLoadedNonEmptyMount",e.toneReportBackToSuggestionsButtonClick="toneReportBackToSuggestionsButtonClick",e.toneReportToneLikeButtonClick="toneReportToneLikeButtonClick",e.toneReportToneDislikeButtonClick="toneReportToneDislikeButtonClick",e.signInButtonClick="signInButtonClick",e.suggestionAcceptClick="suggestionAcceptClick",e.suggestionDismissClick="suggestionDismissClick"}(t=e.Kind||(e.Kind={})),e.is=function(e){return t=>t.kind===e},e.isResultAction=(0,s.Ub)(e.is(e.Kind.resultCardInsertButtonClick),e.is(e.Kind.resultCardCopyButtonClick),e.is(e.Kind.resultCardRephraseButtonClick),e.is(e.Kind.resultCardDismissButtonClick),e.is(e.Kind.reportOffensiveResultButtonClick),e.is(e.Kind.regenerateWithoutReferenceButtonClick)),e.isToneDetectorAction=(0,s.Ub)(e.is(e.Kind.toneReportLoadedEmptyMount),e.is(e.Kind.toneReportLoadedNonEmptyMount),e.is(e.Kind.toneReportBackToSuggestionsButtonClick),e.is(e.Kind.toneReportToneLikeButtonClick),e.is(e.Kind.toneReportToneDislikeButtonClick)),e.isSurveyAction=(0,s.Ub)(e.is(e.Kind.surveyOpenAnswerChange),e.is(e.Kind.surveySubmitButtonClick),e.is(e.Kind.surveyKeyPressShiftEnter),e.is(e.Kind.surveyCancelButtonClick),e.is(e.Kind.surveyCloseButtonClick),e.is(e.Kind.surveyRatingSelectionChange)),e.isSurveyImplicitDismissAction=(0,s.Ub)(e.is(e.Kind.promptSubmitButtonClick),e.is(e.Kind.actionBrickClick),e.is(e.Kind.resultCardInsertButtonClick),e.is(e.Kind.resultCardRephraseButtonClick),e.is(e.Kind.resultCardDismissButtonClick),e.is(e.Kind.resultCardHeaderClick)),e.isSduiAction=(0,s.Ub)(e.is(e.Kind.actionsMenuReportIncorrectClick),e.is(e.Kind.actionsMenuMuteClick),e.is(e.Kind.actionsMenuReportOffensiveClick),e.is(e.Kind.addToDictionaryClick),e.is(e.Kind.suggestionAcceptClick),e.is(e.Kind.suggestionDismissClick))}(n||(n={})),(0,r.AS)(void 0)},90700:(e,t,i)=>{i.d(t,{Bw:()=>s,El:()=>u,Uv:()=>d});var n,s,r=i(95934),o=i(46059),a=i(38791),l=i(36840),c=i(89547);!function(e){e.Codec=r.tB(r.E$([r.tB(r.NW({action:r.tB(r.Yj)})),r.KC([r.OH({}),r.g1(r.Yj,r.L5)])])),e.is=function(t){return e.Codec.is(t)}}(n||(n={})),function(e){let t,i,n,s,d,u;!function(e){const t=r.tB(r.eu("error")),i=r.tB(r.NW({action:t}));e.is=function(e){return i.is(e)},e.isAction=function(e){return t.is(e)}}(t=e.Error||(e.Error={})),function(e){const t=r.tB(r.eu("finished")),i=r.tB(r.KC([r.tB(r.eu("all_checks_failed")),r.tB(r.eu("all_checks_succeeded")),r.tB(r.eu("nothing_to_check")),r.tB(r.eu("some_checks_failed")),r.tB(r.eu("some_checks_in_progress")),r.tB(r.eu("unknown"))])),n=r.tB(r.KC([r.tB(r.eu("TOO_SMALL")),r.tB(r.eu("SENSITIVE")),r.tB(r.eu("ERROR")),r.tB(r.eu("OK"))])),s=r.OH({Clarity:r.ai,Correctness:r.ai,Engagement:r.ai,"Style guide":r.ai,Tone:r.ai,GeneralScore:r.ai}),o=r.tB(r.E$([r.tB(r.NW({action:t,checksStatus:i,scoresStatus:n,generalScore:r.ai})),r.tB(r.OH({outcomeScores:s}))]));e.is=function(e){return o.is(e)},e.isAction=function(e){return t.is(e)}}(i=e.Finished||(e.Finished={})),function(e){const t=r.tB(r.eu("async_check_finished")),i=r.tB(r.NW({action:t}));e.is=function(e){return i.is(e)},e.isAction=function(e){return t.is(e)},e.isPlagiarism=function(e){return"plagiarism"===e.check},e.isAiDetector=function(e){return"ai_detector"===e.check}}(n=e.AsyncCheckFinished||(e.AsyncCheckFinished={})),function(e){const t=r.tB(r.eu("emotions")),i=r.tB(r.NW({action:r.tB(r.eu("emotions"))}));e.is=function(e){return i.is(e)},e.isAction=function(e){return t.is(e)}}(s=e.TonesResult||(e.TonesResult={})),function(e){const t=r.tB(r.eu("show_survey")),i=r.tB(r.NW({action:t}));e.is=function(e){return i.is(e)},e.isAction=function(e){return t.is(e)}}(d=e.ShowSurvey||(e.ShowSurvey={})),function(e){let t,i;!function(e){const t=r.tB(r.eu("cheetah"));e.Codec=r.tB(r.NW({action:t,id:r.tB(r.ai)})),e.is=function(t){return e.Codec.is(t)},e.isAction=function(e){return t.is(e)}}(t=e.CheetahAck||(e.CheetahAck={})),function(e){e.is=a.n(c.Js.extend(o.Schemable)({any:o.id(),sensitiveString:o.string,sensitiveDelta:o.id()}))(c.Js.ServerMessageImplementations).is}(i=e.CheetahProtocolServerMessage||(e.CheetahProtocolServerMessage={})),e.is=(0,l.Ub)(t.is,i.is)}(u=e.CheetahInboundCAPIMessage||(e.CheetahInboundCAPIMessage={})),e.is=(0,l.Ub)(t.is,d.is,u.is,s.is,i.is,n.is)}(s||(s={}));const d=(0,l.Ub)(s.Finished.is,s.AsyncCheckFinished.is,s.TonesResult.is),u=((0,l.Ub)(s.Finished.isAction,s.AsyncCheckFinished.isAction,s.TonesResult.isAction),s.CheetahInboundCAPIMessage.is)},71652:(e,t,i)=>{i.d(t,{y:()=>n});var n,s=i(65390),r=i(84647),o=i(36840);!function(e){let t,i;function n(e){return e.kind===t.activeLimited||e.kind===t.activeUnlimited}function a(e){return e.kind===t.passive}function l(e){return e.kind===t.unknown}function c(e){return n(e)||l(e)}function d(i){if(void 0===i)return{kind:t.unknown,userSettings:{inlineQuickReplyEnabled:!1,inlineRewriteEnabled:!1}};const n=e.Active.parseRefillDate(i.usage.refillDate);return i.usage.promptsRemaining<0?{kind:t.unknown,userSettings:i.settings}:1e4===i.usage.promptsAllocated&&i.usage.promptsRemaining>0?{kind:t.activeUnlimited,promptsRemaining:i.usage.promptsRemaining,promptsAllocated:i.usage.promptsAllocated,refillDate:n,userSettings:i.settings}:i.usage.promptsRemaining>0?{kind:t.activeLimited,promptsRemaining:i.usage.promptsRemaining,promptsAllocated:i.usage.promptsAllocated,refillDate:n,userSettings:i.settings}:{kind:t.passive,promptsRemaining:i.usage.promptsRemaining,promptsAllocated:i.usage.promptsAllocated,refillDate:n,userSettings:i.settings}}!function(e){e.activeLimited="activeLimited",e.activeUnlimited="activeUnlimited",e.passive="passive",e.unavailable="unavailable",e.disabled="disabled",e.pending="pending",e.unknown="unknown"}(t=e.Kind||(e.Kind={})),function(e){const t=(0,o.Bj)((e=>{const t=Date.parse(e);return isNaN(t)?0:t}));function i(e){const t=e-Date.now();return Math.floor(t/36e5)}e.parseRefillDate=function(e){return t(e)},e.hoursUntilRefillDate=i,e.daysUntilRefillDate=function(e){return Math.floor(i(e)/24)}}(i=e.Active||(e.Active={})),e.isActive=n,e.isActiveUnlimited=function(e){return e.kind===t.activeUnlimited},e.isPassive=a,e.isActiveOrPassive=(0,o.Ub)(n,a),e.isUnknown=l,e.isUsable=c,e.isVisible=function(e){return c(e)||a(e)},e.isDisabled=function(e){return e.kind===t.disabled},e.isUnavailable=function(e){return e.kind===t.pending||e.kind===t.unavailable||e.kind===t.disabled},e.fromUserState=d,e.updateUsage=function(t,i){return d({usage:i,settings:t.kind===e.Kind.disabled||t.kind===e.Kind.unavailable?{inlineQuickReplyEnabled:!1,inlineRewriteEnabled:!1}:t.userSettings})},e.getPromptsAllocated=function(t){return(0,r.pipe)(t,s.fromPredicate(e.isActiveOrPassive),s.map((e=>e.promptsAllocated)))}}(n||(n={}))},81238:(e,t,i)=>{var n;i.d(t,{F:()=>n}),function(e){e.assistantOpenAttempt="assistant_open_attempt",e.preStartServicesReady="assistant_pre_start_services_ready"}(n||(n={}))},79072:(e,t,i)=>{function n(e){return{kind:"error",source:"core",name:"lifecycleStartingFailed",data:e}}function s(e){return{kind:"error",source:"core",name:"lifecycleVisuallyReadyFailed",data:e}}function r(e){return{kind:"error",source:"core",name:"lifecycleInteractionReadyFailed",data:e}}function o(e){return{kind:"error",source:"core",name:"lifecycleReadyToDragFailed",data:e}}function a(e){return{kind:"error",source:"core",name:"lifecycleFocusStateChangedFailed",data:e}}function l(e){return{kind:"error",source:"core",name:"lifecycleCloseFailed",data:e}}function c(e){return{kind:"error",source:"core",name:"unsanitizeTextOnInboundCAPIMessageFailed",data:e}}function d(e){return{kind:"error",source:"core",name:"sanitizeTextOnOutboundCAPIMessageFailed",data:e}}function u(){return{kind:"error",source:"core",name:"getContextFailed",data:null}}function p(){return{kind:"error",source:"core",name:"getHistoryFailed",data:null}}function m(e){return{kind:"error",source:"core",name:"actionFailed",data:e}}function h(e){return{kind:"error",source:"core",name:"waitForContextTimeout",data:e}}function g(){return{kind:"error",source:"core",name:"waitForHistoryTimeout",data:null}}function f(){return{kind:"error",source:"core",name:"waitForResultTimeout",data:null}}function v(e){return{kind:"error",source:"core",name:"waitForAckTimeout",data:e}}function _(e){return{kind:"error",source:"core",name:"setVoiceProfileFailed",data:e}}function b(e){return{kind:"error",source:"core",name:"setNewVoiceProfileFailed",data:e}}function y(e){return{kind:"error",source:"core",name:"capiErrorUnhandled",data:e}}function k(e){return{kind:"error",source:"core",name:"insertResultFailed",data:e}}function S(e){return{kind:"error",source:"core",name:"copyResultFailed",data:e}}function C(e){return{kind:"error",source:"core",name:"regenerateResultFailed",data:e}}function E(e){return{kind:"error",source:"core",name:"stopInProgressResultFailed",data:e}}function w(e){return{kind:"error",source:"core",name:"getTextFailed",data:e}}function A(e){return{kind:"error",source:"core",name:"reportUphookShowFailed",data:e}}function I(e){return{kind:"error",source:"core",name:"reportUphookClickFailed",data:e}}function x(e){return{kind:"error",source:"core",name:"reportUphookDismissedFailed",data:e}}function T(e){return{kind:"error",source:"core",name:"executeUphookFailed",data:e}}i.d(t,{Dq:()=>a,Fb:()=>u,Fh:()=>T,Gt:()=>I,Hw:()=>x,Ie:()=>s,J8:()=>f,JE:()=>E,Jm:()=>r,PH:()=>b,T$:()=>w,_0:()=>S,b3:()=>h,bf:()=>_,cX:()=>o,ch:()=>g,cv:()=>p,dF:()=>C,gR:()=>k,hV:()=>y,mD:()=>n,pF:()=>d,pJ:()=>v,qr:()=>m,sB:()=>l,tZ:()=>c,tg:()=>A})},97782:(e,t,i)=>{i.d(t,{Q:()=>n});var n,s=i(44869),r=i(65390),o=i(38260),a=i(86344),l=i(84647),c=i(28986),d=i(36840),u=i(66202),p=i(67685),m=i(66995);!function(e){let t,i,n,h,g,f,v;function _(e){return"complete"===e.kind}function b(e){return"history"===e.kind}function y(e){return"inProgressOngoing"===e.kind}function k(e){return"inProgressPending"===e.kind}!function(e){e.create=function(e){return`${e}`},e.toPrimitive=function(e){return parseInt(e,10)},e.eq=s.kK}(t=e.Id||(e.Id={})),function(e){e.insert="insert",e.reportOffensive="reportOffensive"}(i=e.Feedback||(e.Feedback={})),function(e){e.insert="insert",e.copy="copy",e.rephrase="rephrase"}(n=e.SupportedAction||(e.SupportedAction={})),e.hasId=function(e){return"id"in e},e.isComplete=_,e.isHistory=b,e.isAIUsageNotification=function(e){return"aiUsageNotification"===e.kind},e.isStandardCompletedResult=(0,d.Ub)(_,b),e.isInProgressOngoing=y,e.isInProgressPending=k,e.isInProgressInterrupted=function(e){return"inProgressInterrupted"===e.kind},e.isInProgress=(0,d.Ub)(y,k),function(e){e.generic="generic",e.user="user"}(h=e.GeneratedTextVoice||(e.GeneratedTextVoice={})),function(t){t.createFromResultMessage=function(t){var i,n;const s=(0,l.pipe)((0,p.y1)(null===(i=t.text)||void 0===i?void 0:i.delta),r.getOrElse((()=>new c.R)));return(0,l.pipe)((0,p.y1)(null===(n=t.withVoiceText)||void 0===n?void 0:n.delta),u.fromOption((()=>s)),u.map((i=>({generic:s,user:i,preferVoice:!0===(null==t?void 0:t.showVoiceTextByDefault)?e.GeneratedTextVoice.user:e.GeneratedTextVoice.generic}))))}}(g=e.ResultDelta||(e.ResultDelta={})),function(t){t.createFromCard=function(t,i){return{kind:"history",id:e.Id.create(t.id),header:"action"===t.title.kind?{label:t.title.label,iconUrl:""!==t.title.iconUrl.trim()?r.some(t.title.iconUrl):r.none,copiablePrompt:r.none}:{label:t.title.text,iconUrl:r.none,copiablePrompt:""!==t.title.text.trim()?r.some(t.title.text):r.none},replacementDelta:g.createFromResultMessage({text:t.text,withVoiceText:t.text.plain===t.withVoiceText.plain?void 0:t.withVoiceText,showVoiceTextByDefault:t.text.plain===t.withVoiceText.plain?void 0:t.showVoiceTextByDefault}),supportedActions:new Set([e.SupportedAction.insert].concat(i?[e.SupportedAction.copy]:[])),references:(0,l.pipe)(t.references,o.Tj(m.O.create),a._S)}}}(f=e.History||(e.History={})),function(e){e.fromInProgressResult=function(e,t){return Object.assign(Object.assign({},e),{kind:"aiUsageNotification",text:t})}}(v=e.AIUsageNotification||(e.AIUsageNotification={}))}(n||(n={}))},28081:(e,t,i)=>{i.d(t,{Y:()=>n});var n,s=i(36840);!function(e){function t(e){return"rewrite"===e}function i(e){return"quickRewrite"===e}e.isIdeation=function(e){return"ideation"===e},e.isRewrite=t,e.isQuickReply=function(e){return"quickReply"===e},e.isQuickRewrite=i,e.isPushRewrite=function(e){return"pushRewrite"===e},e.isTranslate=function(e){return"translate"===e},e.isRewriteOrQuickRewrite=(0,s.Ub)(t,i)}(n||(n={}))},22548:(e,t,i)=>{i.d(t,{_:()=>n});var n,s=i(84647),r=i(86562),o=i(65390),a=i(38886);!function(e){let t,i,n,l,c,d,u,p,m;!function(e){let t;!function(e){e.rephrase="rephrase",e.dismiss="dismiss",e.insert="insert",e.offensive="offensive",e.copy="copy",e.generationCompleted="generationCompleted"}(t=e.UserAction||(e.UserAction={}))}(t=e.Result||(e.Result={})),function(e){let t;!function(e){e.open="open",e.skip="skip",e.openFromBanner="openFromBanner",e.keepVoiceTag="keepTag",e.removeVoiceTag="removeTag",e.toggleToMyVoice="toggleToMyVoice",e.toggleToNeutral="toggleToNeutral"}(t=e.UserAction||(e.UserAction={}))}(i=e.VoiceProfile||(e.VoiceProfile={})),function(e){let t;!function(e){e.openStore="openStore",e.offensive="offensive"}(t=e.UserAction||(e.UserAction={}))}(n=e.Actions||(e.Actions={})),function(e){let t;!function(e){e.search="search"}(t=e.UserAction||(e.UserAction={}))}(l=e.Prompt||(e.Prompt={})),function(e){let t;!function(e){e.hover="hover",e.click="click"}(t=e.UserAction||(e.UserAction={}))}(c=e.UsageInfo||(e.UsageInfo={})),function(e){let t;!function(e){e.view="view"}(t=e.UserAction||(e.UserAction={}))}(d=e.HistoryButton||(e.HistoryButton={})),function(e){let t;!function(e){e.view="view",e.skip="skip",e.next="next"}(t=e.UserAction||(e.UserAction={}))}(u=e.Onboarding||(e.Onboarding={})),function(e){let t;!function(e){e.close="close",e.readyToInteract="readyToInteract"}(t=e.UserAction||(e.UserAction={}))}(p=e.Assistant||(e.Assistant={})),function(e){let t,i;!function(e){e.view="view"}(t=e.UserAction||(e.UserAction={})),function(e){e.dontShowOnDocument="dontShowOnDocument",e.dontShowForever="dontShowForever"}(i=e.AIUsageUserAction||(e.AIUsageUserAction={}))}(m=e.Notification||(e.Notification={})),e.getComponentId=function(e,t,i,l={}){const c=(0,s.pipe)(e.kind,(t=>{switch(t){case"result":return"card";case"voiceProfile":return"voice";case"actions":return e.userAction===n.UserAction.openStore?"group":"card";case"assistant":return"widget";case"onboardingPromptsTooltip":return"onboardingPromptTooltip";case"onboardingReviewTooltip":return"onboardingReviewtextTooltip";case"usageInfo":case"historyButton":case"prompt":case"onboardingPopup":case"BTSonboardingPopup":case"onboardingRewriteTooltip":case"onboardingKnowledgeHubTooltip":case"onboardingReferencesTooltip":case"onboardingHistoryTooltip":case"aiUsageNotification":case"contextNotification":case"actionNotification":return t;default:return(0,r.AS)(t)}}));return(0,s.pipe)(o.fromNullable(i),o.map((e=>`cheetah:history-card:${e}`)),o.getOrElse((()=>`cheetah:${c}${t?`:${t}`:""}`)),(d=l,e=>(0,s.pipe)(Object.entries(d),a.TS(e,((e,[t,i])=>{const n=e.includes("?")?"&":"?";return e+`${n}${t}=${i}`})))));var d},e.getUserAction=function(e){return(0,s.pipe)(e.kind,(t=>{switch(t){case"actions":return e.userAction===n.UserAction.openStore?"All Ideas":e.userAction;case"assistant":return e.userAction===p.UserAction.close?"dismiss":e.userAction;case"result":case"voiceProfile":case"prompt":case"usageInfo":case"historyButton":case"onboardingPopup":case"BTSonboardingPopup":case"onboardingPromptsTooltip":case"onboardingReviewTooltip":case"onboardingRewriteTooltip":case"onboardingKnowledgeHubTooltip":case"onboardingReferencesTooltip":case"onboardingHistoryTooltip":case"aiUsageNotification":case"contextNotification":case"actionNotification":return e.userAction;default:return(0,r.AS)(t)}}))}}(n||(n={}))},59443:(e,t,i)=>{i.d(t,{t:()=>n});const n="CHEETAH"},89547:(e,t,i)=>{i.d(t,{Js:()=>r,WV:()=>o});var n=i(31037),s=i(73144);const r=n,o=s.r},46838:(e,t,i)=>{i.d(t,{V:()=>U});var n=i(46238),s=i(94855),r=i(84647),o=i(31037),a=i(42543),l=i(78339),c=i(31691),d=i(41797),u=i(19147),p=i(23988),m=i(10334),h=i(17171),g=i(66202),f=i(48120),v=i(88105),_=i(91817),b=i(34937),y=i(69998),k=i(22835);function S(e){return{encode:function(t){var i=Object.entries(e).filter((function(e){return(0,_._)(e,1)[0]in t})).map((function(e){var i=(0,_._)(e,2),n=i[0],o=i[1];return(0,r.pipe)(void 0===t[n]?s.pG(void 0):o.encode(t[n]),s.Tj((function(e){return[n,e]})))}));return(0,r.pipe)(s.Pz(i),s.Tj((function(e){return k.PW(e)})))}}}var C=S,E=C;function w(){return{encode:function(e){return s.pG(e)}}}var A=function(e){return null===e?"null":void 0===e?"undefined":(0,b._)(e)},I={URI:"io-ts/EncoderAsync",literal:function(){return w()},string:w(),number:w(),boolean:w(),nullable:function(e){return{encode:function(t){return null===t?s.pG(null):e.encode(t)}}},type:E,struct:C,partial:S,record:function(e){return{encode:function(t){var i=Object.entries(t).map((function(t){var i=(0,_._)(t,2),n=i[0],o=i[1];return(0,r.pipe)(e.encode(o),s.Tj((function(e){return[n,e]})))}));return(0,r.pipe)(s.Pz(i),s.Tj((function(e){return k.PW(e)})))}}},array:function(e){return{encode:function(t){return s.Pz(t.map((function(t){return e.encode(t)})))}}},tuple:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return{encode:function(e){return s.Pz(t.map((function(t,i){return t.encode(e[i])})))}}},intersect:function(e){return function(t){return{encode:function(i){return(0,r.pipe)(t.encode(i),s.cy((function(t){return(0,r.pipe)(e.encode(i),s.Tj((function(e){return function(e,t){if(void 0!==e&&void 0!==t){var i=A(e),n=A(t);if("object"===i||"object"===n)return Object.assign({},e,t)}return t}(t,e)})))})))}}}},sum:y.cz,lazy:function(e,t){return y.RZ(t)},readonly:y.tB},x=i(47318),T=i(39695),F=i(6922),R=i(29573),K=i(32557),M=function(e){(0,R._)(i,e);var t=(0,K._)(i);function i(e,n){var s;return(0,u._)(this,i),s=t.call(this,"DLP Sanitizer: Schema mismatch error. ".concat(e)),(0,p._)((0,T._)(s),"decodeError",void 0),s.decodeError=n,s}return(0,F._)(i,[{key:"toString",value:function(){return"Decode error:\n      Message: ".concat(this.message,"\n      Details: ").concat(this.decodeError)}}]),i}(i(86562).eo),O=function e(t){var i=this;(0,u._)(this,e),(0,p._)(this,"_sanitizationFunctions",void 0),(0,p._)(this,"sanitizeMessage",void 0),(0,p._)(this,"unsanitizeMessage",void 0),(0,p._)(this,"_replaceInDelta",void 0),(0,p._)(this,"_sanitizeDelta",void 0),(0,p._)(this,"_unsanitizeDelta",void 0),(0,p._)(this,"_sensitiveDecoder",void 0),(0,p._)(this,"_sanitizingEncoder",void 0),(0,p._)(this,"_unsanitizingEncoder",void 0),(0,p._)(this,"_getMessageHandler",void 0),this._sanitizationFunctions=t,this.sanitizeMessage=function(e,t){var n=i._getMessageHandler(t);return(0,r.pipe)(n.decode(e),g.fold((function(e){return s.kb(new M("Sanitization failed",f.$2(e)))}),(function(e){return n.sanitizer.encode(e)})))},this.unsanitizeMessage=function(e,t){var n=i._getMessageHandler(t);return(0,r.pipe)(n.decode(e),g.fold((function(e){return s.kb(new M("Unsanitization failed",f.$2(e)))}),(function(e){return n.unsanitizer.encode(e)})))},this._replaceInDelta=function(e,t){return(0,r.pipe)(s.Pz(e.ops.map((function(e){return v.E.isInsertString(e)?(0,r.pipe)(t(e.insert),s.Tj((function(t){return(0,h._)((0,m._)({},e),{insert:t})}))):s.pG(e)}))),s.Tj((function(e){return{ops:e}})))},this._sanitizeDelta=function(e){return i._replaceInDelta(e,i._sanitizationFunctions.sanitizeText)},this._unsanitizeDelta=function(e){return i._replaceInDelta(e,i._sanitizationFunctions.unsanitizeText)},this._sensitiveDecoder=x.b.extend(B)({any:f.id(),sensitiveString:f.Yj,sensitiveDelta:f.id()}),this._sanitizingEncoder=x.b.extend(I)({any:w(),sensitiveString:{encode:this._sanitizationFunctions.sanitizeText},sensitiveDelta:{encode:this._sanitizeDelta}}),this._unsanitizingEncoder=x.b.extend(I)({any:w(),sensitiveString:{encode:this._sanitizationFunctions.unsanitizeText},sensitiveDelta:{encode:this._unsanitizeDelta}}),this._getMessageHandler=function(e){return(0,h._)((0,m._)({},x.b.interpreter(i._sensitiveDecoder)(e)),{sanitizer:x.b.interpreter(i._sanitizingEncoder)(e),unsanitizer:x.b.interpreter(i._unsanitizingEncoder)(e)})}},N=function e(){(0,u._)(this,e),(0,p._)(this,"sanitizeMessage",(function(e,t){return s.pG(e)})),(0,p._)(this,"unsanitizeMessage",(function(e,t){return s.pG(e)}))},B=(0,h._)((0,m._)({},f.Pw),{struct:f.Pw.partial,type:f.Pw.partial}),P=i(90700),D=i(79072),L=i(32133);class U{constructor(e){this._params=e,this._logEvents=new a.B7,this.relevantInboundCAPIMessages=this._getRelevantInboundCAPIMessagesObs(),this.logEvents=this._logEvents.asObservable();const t=e.dlpOptions;this._dlpSanitizer=t?new O({sanitizeText:e=>s.TX((()=>t.sanitizeText(e)),L.$),unsanitizeText:e=>s.TX((()=>t.unsanitizeText(e)),L.$)}):new N}cheetahGetContext(e){return(0,r.pipe)(this._sanitizeOutboundCheetahMessage("cheetah:getContext",e,o.MessageGetContext),s.cy((e=>this._params.sendCAPIMessage({action:"cheetah:getContext",shouldInjectRev:!0,data:e,shouldInjectSessionId:!1}))))}cheetahAction(e){return(0,r.pipe)(this._sanitizeOutboundCheetahMessage("cheetah:action",e,o.MessageAction),s.cy((e=>this._params.sendCAPIMessage({action:"cheetah:action",shouldInjectRev:!0,data:e,shouldInjectSessionId:!1}))))}cheetahGetHistory(){return this._params.sendCAPIMessage({action:"cheetah:getHistory",shouldInjectRev:!1,data:{},shouldInjectSessionId:!1})}cheetahGetUserState(){return this._params.sendCAPIMessage({action:"cheetah:getUserState",data:{},shouldInjectRev:!1,shouldInjectSessionId:!1})}cheetahInterrupt(e){return this._params.sendCAPIMessage({action:"cheetah:interrupt",data:e,shouldInjectRev:!1,shouldInjectSessionId:!1})}cheetahSearchReferences(e){return this._params.sendCAPIMessage({action:"cheetah:searchReferences",data:e,shouldInjectRev:!1,shouldInjectSessionId:!1})}cheetahSetVoice(e){return this._params.sendCAPIMessage({action:"cheetah:setVoice",data:e,shouldInjectRev:!1,shouldInjectSessionId:!1})}cheetahSetVoiceProfile(e){return this._params.sendCAPIMessage({action:"cheetah:setVoiceProfile",data:e,shouldInjectRev:!1,shouldInjectSessionId:!1})}user_action(e){return this._params.sendCAPIMessage({action:"user_action",data:e,shouldInjectRev:!1,shouldInjectSessionId:!0})}set_context(e){return this._params.sendCAPIMessage({action:"set_context",data:e,shouldInjectRev:!0,shouldInjectSessionId:!1})}submit_survey_result(e){return this._params.sendCAPIMessage({action:"submit_survey_result",data:e,shouldInjectRev:!0,shouldInjectSessionId:!1})}feedback(e){return this._params.sendCAPIMessage({action:"feedback",data:e,shouldInjectRev:!1,shouldInjectSessionId:!1})}toggle_checks(e){return this._params.sendCAPIMessage({action:"toggle_checks",data:e,shouldInjectRev:!1,shouldInjectSessionId:!1})}_getRelevantInboundCAPIMessagesObs(){return this._params.inboundCAPIMessages.pipe(l.p(P.Bw.is),c.H((e=>d.H((0,r.pipe)(e,(e=>{switch(e.action){case"cheetah:setContext":return this._dlpSanitizer.unsanitizeMessage(e,o.MessageSetContext);case"cheetah:chunk":return this._dlpSanitizer.unsanitizeMessage(e,o.MessageChunk);case"cheetah:result":return this._dlpSanitizer.unsanitizeMessage(e,o.MessageResult);default:return s.pG(e)}}),s.AU((t=>(this._logEvents.next((0,D.tZ)({capiMessageAction:e.action,reason:(0,L.$)(t).message})),n.of(e))),n.of),(e=>e()))))))}_sanitizeOutboundCheetahMessage(e,t,i){return(0,r.pipe)(this._dlpSanitizer.sanitizeMessage(t,i),s.qE((t=>(this._logEvents.next((0,D.pF)({capiMessageAction:e,reason:(0,L.$)(t).message})),t))))}}},7962:(e,t,i)=>{i.d(t,{V:()=>s,r:()=>r});var n=i(60251);const s={CheetahFetchSkills:new n.iD("cheetah_fetch_skills"),PlagiarismAiDetector:new n.iD("plagiarism_ai_detector_cheetah_web")},r={SmartPlagiarismUphook:new n.aj("smart_plagiarism_uphook",["control","test"]),GrammarlyPro:new n.aj("grammarly_pro_m3_ga_v1",["control","test"]),PremiumFreeTrialEUUK:new n.aj("premium_free_trial_eu_uk",["control","test"]),LongFormPremiumFeed:new n.aj("long_form_premium_feed",["control","test"]),InProductDiscount:new n.aj("in_product_discount_m1",["control","test"])}},35710:(e,t,i)=>{i.d(t,{v:()=>m});var n=i(65390),s=i(84647),r=i(80837),o=i(78339),a=i(15491),l=i(90405),c=i(36094),d=i(80074),u=i(90700),p=i(71652);class m{constructor(e,t){this._capiService=e,this._genAIFeaturesState=t,this._subs=new r.y.Keeper,this._availability=d.s.create({kind:p.y.Kind.pending,userSettings:{inlineQuickReplyEnabled:!1,inlineRewriteEnabled:!1}}),this.availability=this._availability.view(),this._subs.push(this._genAIFeaturesState.subscribe((e=>{this._availability.set(e.enabled?p.y.fromUserState(e.userState):{kind:p.y.Kind.unavailable})}))),this._subs.push((0,s.pipe)(this._capiService.relevantInboundCAPIMessages,o.p(u.Bw.CheetahInboundCAPIMessage.is),a.T((e=>"cheetah:setUserState"===e.action?n.some(e.state):n.none)),l.oE,a.T(p.y.fromUserState)).subscribe(c.H9(this._availability))),this._subs.push((0,s.pipe)(this._capiService.relevantInboundCAPIMessages,o.p(u.Bw.CheetahInboundCAPIMessage.is),a.T((e=>{switch(e.action){case"cheetah:setContext":case"cheetah:result":return n.some(e.usage);default:return n.none}})),l.oE,a.T((e=>p.y.updateUsage(this._availability.get(),e)))).subscribe(c.H9(this._availability)))}dispose(){this._subs.dispose()}}},38315:(e,t,i)=>{i.d(t,{w:()=>o});var n=i(9619),s=i(36094),r=i(80074);class o{constructor(e){this._hostAvailability=e,this._sub=new n.y,this._availability=r.s.create(null),this.availability=this._availability.view(),this._sub=e.subscribe(s.H9(this._availability))}augment(e){this._sub.unsubscribe(),this._sub=e(this._hostAvailability).subscribe(s.H9(this._availability))}dispose(){this._sub.unsubscribe()}}},67685:(e,t,i)=>{i.d(t,{xn:()=>d,y1:()=>c});var n=i(65390),s=i(84647),r=i(95934),o=i(28986),a=i(88105);const l=r.tB(r.NW({ops:r.QZ(r.KC([r.NW({insert:r.tB(r.Yj)}),r.NW({retain:r.tB(r.ai)}),r.NW({delete:r.tB(r.ai)})]))}));function c(e){return(0,s.pipe)(e,n.fromPredicate(l.is),n.map((e=>new o.R([...e.ops]))))}function d(e,t){return e.reduce(((e,t)=>(a.E.isInsertString(t)?(e.text=`${e.text.substring(0,e.index)}${t.insert}${e.text.substring(e.index)}`,e.index+=t.insert.length):a.E.isDelete(t)?e.text=`${e.text.substring(0,e.index)}${e.text.substring(e.index+t.delete)}`:a.E.isRetain(t)?e.index+=t.retain:function(e){var t;return a.E.isInsertEmbed(e)&&!0===(null===(t=e.insert)||void 0===t?void 0:t.linebreak)}(t)&&(e.text=`${e.text.substring(0,e.index)}\n${e.text.substring(e.index)}`,e.index+=1),e)),{text:t,index:0}).text}},32133:(e,t,i)=>{function n(e){return function(e){const t=e;return null!=t&&(void 0!==t.message&&void 0!==t.name||void 0!==t.stack)}(e)?e:{message:String(e),name:"",stack:void 0}}i.d(t,{$:()=>n})},87642:(e,t,i)=>{i.d(t,{s:()=>l,z:()=>c});var n=i(66202),s=i(94855),r=i(84647),o=i(32133),a=function(e,t,i,n){return new(i||(i=Promise))((function(s,r){function o(e){try{l(n.next(e))}catch(e){r(e)}}function a(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))};function l(e,t,i,s,r){return a(this,void 0,void 0,(function*(){try{const o=yield t();n.isLeft(o)?(null==i||i.error("Error executing async task.",{taskName:e,reason:o.left.message}),null==r||r(o.left)):(null==i||i.debug("Successfully executed async task.",{taskName:e,result:o.right}),null==s||s(o.right))}catch(t){null==r||r(t instanceof Error?t:new Error(String(t)));const n=(0,o.$)(t);null==i||i.error("Error executing async task, promise rejected.",{taskName:e,reason:n.message})}}))}const c={URI:s.rz,map:s.WW.map,ap:(e,t)=>(0,r.pipe)(e,s.ap(t))}},37223:(e,t,i)=>{i.d(t,{v:()=>MA});var n,s=i(50659),r=i(80300);!function(e){e.assistantComponentStart="assistant_component_start",e.assistantViewModelsCreated="assistant_view_models_created",e.assistantComponentEnd="assistant_component_end",e.assistantContainerMounted="assistant_container_mounted",e.assistantGetStart="assistant_get_start",e.assistantGetEnd="assistant_get_end"}(n||(n={}));var o=i(65390),a=i(84647),l=i(42543),c=i(9619),d=i(6987),u=i(21216),p=i(36094),m=i(78339),h=i(24946),g=i(86562),f=i(80074),v=i(71652),_=i(64458),b=i(46838);class y{constructor(e){var t;this._deepLinkService=e,this._subs=new c.y,this._handlers=new Map,this._subs.add(null===(t=this._deepLinkService)||void 0===t?void 0:t.deepLinkRequests.subscribe((e=>{var t;return null===(t=this._handlers.get(e))||void 0===t?void 0:t.handler.handleDeepLinkRequest()})))}registerDeepLinkHandler(e,t){var i;const n=t.deepLinkStatusChanges.subscribe((t=>{var i;return null===(i=this._deepLinkService)||void 0===i?void 0:i.notifyStatusChanged(e,t)})),s=()=>{n.unsubscribe(),this._handlers.delete(e)};return null===(i=this._handlers.get(e))||void 0===i||i.dispose(),this._handlers.set(e,{handler:t,dispose:s}),s}dispose(){this._subs.unsubscribe(),this._handlers.clear()}}var k=i(45819),S=i(66202),C=i(38260),E=i(86344),w=i(1617),A=i(94855),I=i(46669),x=i(19711),T=i(66799),F=i(80837),R=i(15491),K=i(71372),M=i(83541),O=i(68594),N=i(90405),B=i(40027),P=i(95168),D=i(54988),L=i(58193),U=i(44869),j=i(36840),V=i(38581),$=i(83288);function H(e,t=3){if(e&&t>0){const i=function(e){const t=(null===(s=null===(n=(i=e).ownerDocument)||void 0===n?void 0:n.defaultView)||void 0===s?void 0:s.getComputedStyle(i))||null;var i,n,s;return t?"auto"===t.overflow||"scroll"===t.overflow||"auto"===t.overflowY||"scroll"===t.overflowY||"auto"===t.overflowX||"scroll"===t.overflowX:null}(e);return i?e:null===i?null:H(null==e?void 0:e.parentElement,t-1)}return null}function Z(e){var t,i;return null===(i=(null===(t=e.activeElement)||void 0===t?void 0:t.shadowRoot)||e)||void 0===i?void 0:i.activeElement}function G(e){return e instanceof HTMLElement}const W=["b","i"];function z(e,t=W){return"string"==typeof e?{dangerouslySetInnerHTML:{__html:(0,V.sanitize)(e,{ALLOWED_TAGS:Array.from(t)})}}:{dangerouslySetInnerHTML:e.pipe(R.T((e=>({__html:(0,V.sanitize)(e,{ALLOWED_TAGS:Array.from(t)})}))))}}var q,Q,J,Y=i(19309);!function(e){let t,i,n;!function(e){e.create=function(e){return e}}(t=e.Id||(e.Id={})),function(e){e.create=function(e,t){return{id:e,kind:"string",value:t}}}(i=e.StringValue||(e.StringValue={})),function(e){e.create=function(e,t){return{id:e,kind:"radio",value:t}}}(n=e.RadioValue||(e.RadioValue={}))}(q||(q={})),function(e){e.match=e=>t=>{const i=t.kind;return"string"===i?e.string(t):"radio"===i?e.radio(t):void(0,g.AS)(i)}}(Q||(Q={})),function(e){function t(e){return"followUpQuestion"===e.kind}function i(e){return"quickAction"===e.kind}let n,s,r,l,c,d;e.isFollowUpQuestionActionValue=t,e.isQuickActionValue=i,e.isListableActionValue=(0,j.Ub)(t,i),e.isUserPromptActionValue=function(e){return"userPrompt"===e.kind},e.isQuickRewriteActionValue=function(e){return"quickRewrite"===e.kind},e.isFollowUpQuestionActionInput=function(e){return"followUpQuestion"===e.kind},e.isQuickActionInput=function(e){return"quickAction"===e.kind},e.isSkillAction=function(e){return"skillAction"===e.kind},e.isToneAction=function(e){return"toneAction"===e.kind},e.isPlagiarismAction=function(e){return"plagiarismAction"===e.kind},e.isWritingExpertAction=function(e){return"writingExpertAction"===e.kind},e.isPerformanceScoreAction=function(e){return"performanceScoreAction"===e.kind},e.isHumanWritingReportAction=function(e){return"humanWritingReportAction"===e.kind},e.createFollowUpQuestionActionInputOrQuickActionInput=function(t,i,n){const r=Array.from(new Set(i.map((e=>e.group)).filter((0,a.not)(s.isPinned)))).findIndex((e=>t.group===e)),l={id:e.Id.create(t.id),contextId:n,icon:S.right(t.iconUrl),group:{id:s.Id.create(t.group),label:t.group,rank:r>-1?1e3*r:Number.MAX_SAFE_INTEGER},label:(0,V.sanitize)(t.label,{ALLOWED_TAGS:W}),badge:o.none,searchLabel:(0,V.sanitize)(t.label,{ALLOWED_TAGS:[]}),searchTags:t.searchTags,generatesTextType:o.fromNullable(t.generatesTextType),disabled:void 0!==t.disabled,notificationOnAttempt:(0,a.pipe)(o.fromNullable(t.disabled),o.chain((({onActionNotification:e})=>o.fromNullable(e))),o.map((({text:e})=>e)))};if(1===t.args.length){const e=t.args[0],i={id:q.Id.create(e.name),label:e.label,hints:(0,a.pipe)(o.fromNullable(e.hint),o.map((e=>({header:e.header,items:e.text}))))};return"string"===e.valueType?o.some(Object.assign(Object.assign({},l),{kind:"followUpQuestion",args:[Object.assign(Object.assign({},i),{kind:"string"})],generatesTextType:o.fromNullable(t.generatesTextType)})):"radioButtonGroup"===e.valueType?(0,a.pipe)(e.radioButtonGroupValues,E.ci,o.map((e=>Object.assign(Object.assign({},l),{kind:"followUpQuestion",args:[Object.assign(Object.assign({},i),{kind:"radio",radioOptions:e})],generatesTextType:o.fromNullable(t.generatesTextType)})))):o.none}return 0===t.args.length?o.some(Object.assign(Object.assign({},l),{kind:"quickAction",args:[]})):o.none},function(e){e.create=function(e){return e},e.eq=U.kK}(n=e.Id||(e.Id={})),function(t){let i;!function(e){e.create=function(e){return e},e.eq=U.kK}(i=t.Id||(t.Id={})),t.isPinned=function(t){return t===e.knownGroup.pinned}}(s=e.Group||(e.Group={})),e.knownGroup={tools:s.Id.create("tools"),apps:s.Id.create("apps"),pinned:s.Id.create("pinned"),moreIdeas:s.Id.create("More ideas")},e.knownGroupRank={[e.knownGroup.tools]:-3e3,[e.knownGroup.pinned]:-1e3},e.knowGroupLabels={[e.knownGroup.tools]:"Tools",[e.knownGroup.apps]:"Apps",[e.knownGroup.pinned]:""},function(e){e.fromTextInput=function(e,t){return Object.assign(Object.assign({},e),{args:[q.StringValue.create(e.args[0].id,t)]})},e.fromRadioInput=function(e,t){return Object.assign(Object.assign({},e),{args:[q.RadioValue.create(e.args[0].id,t)]})}}(r=e.FollowUpQuestionActionValue||(e.FollowUpQuestionActionValue={})),e.createSkillAction=function(t){return{kind:"skillAction",id:n.create(t.id),group:{id:e.knownGroup.apps,label:"App actions",rank:Number.MAX_SAFE_INTEGER},icon:S.right(t.iconUrl),label:(0,V.sanitize)(t.displayName,{ALLOWED_TAGS:W}),badge:o.none,searchLabel:(0,V.sanitize)(t.displayName,{ALLOWED_TAGS:[]}),searchTags:t.tags,generatesTextType:o.none,args:[],skill:t,disabled:!1,notificationOnAttempt:o.none}},e.createToneAction=function(t){const i="Check my tone";return{kind:"toneAction",id:n.create(t.name),group:{id:e.knownGroup.tools,label:"Tools",rank:Number.MAX_SAFE_INTEGER},icon:S.right((s=t.emojiId,Y.C+s+".svg")),label:i,badge:o.none,searchLabel:(0,V.sanitize)(t.name,{ALLOWED_TAGS:[]}),searchTags:[i,t.name],generatesTextType:o.none,args:[],tone:t,disabled:!1,notificationOnAttempt:o.none};var s},e.createPlagiarismAction=function(t={}){const i=t.isPlagiarismSmartUphook?"Plagiarism detected":t.isAiDetectorEnabled?"Check for plagiarism and AI text":"Check for plagiarism",s=t.isPlagiarismSmartUphook?S.left("plagiarismDetected"):t.isAiDetectorEnabled?S.left("plagiarismAndAiDetector"):S.left("plagiarism");return{kind:"plagiarismAction",id:n.create("plagiarism"),group:{id:e.knownGroup.tools,label:"Tools",rank:Number.MAX_SAFE_INTEGER},icon:s,label:i,badge:o.none,searchLabel:"plagiarism",searchTags:["Check for plagiarism"],generatesTextType:o.none,args:[],disabled:!1,notificationOnAttempt:o.none,isUphook:!0===t.isPlagiarismSmartUphook}},e.createWritingExpertAction=function(){const t="Increase the impact of your text";return{kind:"writingExpertAction",id:n.create("writingExpert"),group:{id:e.knownGroup.tools,label:"Tools",rank:Number.MAX_SAFE_INTEGER},icon:S.left("writingExpert"),label:t,badge:o.some("new"),searchLabel:"ideas",searchTags:[t],generatesTextType:o.none,args:[],disabled:!1,notificationOnAttempt:o.none}},function(e){e.ordByGroup=$.contramap((e=>e.group.rank))($.ordNumber)}(l=e.ListableActionInput||(e.ListableActionInput={})),function(e){e.fromInput=function(e,t,i,n){return Object.assign(Object.assign({},e),{arg:q.StringValue.create(e.arg.id,t),useReferences:i,omitReferenceIds:n})}}(c=e.UserPromptActionValue||(e.UserPromptActionValue={})),function(e){e.fromInput=function(e){return Object.assign(Object.assign({},e),{args:[]})}}(d=e.QuickRewriteActionValue||(e.QuickRewriteActionValue={}))}(J||(J={}));var X,ee=i(90700);function te(e){return(0,a.pipe)(o.fromNullable(e.changesSummary),o.filter((({title:e})=>""!==e)),o.chain((({title:e,description:t})=>(0,a.pipe)(E._S(t),o.map((t=>({title:e,description:t})))))))}!function(e){let t,i;!function(e){e.create=function(e){return e}}(t=e.Id||(e.Id={})),e.isPending=function(e){return"pending"===e.kind},e.isReceived=function(e){return"received"===e.kind},function(e){e.empty=function(e){return{id:e,kind:"pending",availableActions:[],specialView:o.none,userPromptAction:o.none,intent:o.none,documentOverview:o.none,selection:o.none,isBoundary:!1,textRevision:o.none}}}(i=e.Pending||(e.Pending={}))}(X||(X={}));var ie,ne=i(92084);function se(e,t){return{name:"assistant_sdui_open_link_called",labels:{source:0!==e.indexOf("advancedIssues")?"advancedIssues":"other",assistantType:t}}}function re(e,t){return{name:"assistant_sdui_upgrade_to_premium_called",labels:{source:0!==e.indexOf("advancedIssues")?"advancedIssues":"other",assistantType:t}}}!function(e){let t;function i(e){switch(e){case"sensitiveResult":return{header:"Assistance is unavailable",text:"Assistance is unavailable for that text or prompt.\nTry something else."};case"overload":return{header:"Couldnt generate text",text:"Were handling a lot of prompts right now and couldnt generate that text.\nPlease try again later."};case"unsupportedLanguage":return{header:"Hmm, dont know that language",text:"Assistance is currently only available for English."};case"critical":case"timeout":case"emptyResult":case"truncatedResult":case"usageExceeded":return{header:"Something went wrong",text:"Were not sure what happened, but we couldnt generate that text.\nPlease try again."};default:return(0,a.absurd)(e)}}!function(e){e.create=function(e){switch(e){case ne.Fv.Generic:return"critical";case ne.Fv.Overflow:return"truncatedResult";case ne.Fv.PromptsLimitExceeded:return"usageExceeded";case ne.Fv.SensitiveContent:return"sensitiveResult";case ne.Fv.ServerOverloaded:return"overload";case ne.Fv.UnsupportedLanguage:return"unsupportedLanguage";default:return(0,a.absurd)(e)}}}(t=e.Reason||(e.Reason={})),e.create=function(e){const n=t.create(e.kind),s=(0,a.pipe)(k.Jq(o.Applicative)({header:(0,a.pipe)(o.fromNullable(e.title),o.filter((e=>""!==e.trim()))),text:(0,a.pipe)(o.fromNullable(e.text),o.filter((e=>""!==e.trim())))}),o.getOrElse((()=>i(n))));return Object.assign({reason:n},s)},e.createCriticalError=function(e){return{reason:"critical",header:"Something went wrong",text:e?"Were not sure what happened.\nPlease try again later.":"Were not sure what happened, but we couldnt generate that text.\nPlease try again."}},e.createEmptyResultError=function(){return Object.assign({reason:"emptyResult"},i("emptyResult"))}}(ie||(ie={}));var oe,ae=i(79072),le=i(97782);!function(e){let t,i,n;!function(e){e.restoreDisabled="restoreDisabled",e.unknown="unknown",e.hasHistory="hasHistory",e.noHistory="noHistory",e.historyRequested="historyRequested",e.historyRestored="historyRestored"}(t=e.HistoryStatus||(e.HistoryStatus={})),function(e){e.unknown="unknown",e.static="static",e.dynamic="dynamic"}(i=e.SelectionContextStatus||(e.SelectionContextStatus={})),e.toStarting=function(e){return"starting"===e.kind?o.some(e):o.none},e.toStarted=function(e){return"started"===e.kind?o.some(e):o.none},e.toContextless=function(e){return"contextless"===e.kind?o.some(e):o.none},e.fold=function(e){return t=>"starting"===t.kind?e.starting(t):"started"===t.kind?e.started(t):"contextless"===t.kind?e.contextless(t):void(0,g.AS)(t)},e.isStartedWithInProgressResult=function(e){return"started"===e.kind&&o.isSome(e.inProgressResult)},e.isStartingWithoutError=function(e){return o.isNone(e.error)&&"starting"===e.kind},function(e){e.initial=e=>({kind:"starting",mode:e,selectedRange:o.none,selectedText:o.none,quickReplyContext:o.none,historyStatus:t.unknown,writingExpertContext:o.none,error:o.none,textRevision:0,selectionContextStatus:i.unknown})}(n=e.Starting||(e.Starting={}))}(oe||(oe={}));var ce=i(28081);function de(e){return ce.Y.isRewriteOrQuickRewrite(e.mode)}function ue(e){return ce.Y.isQuickReply(e.mode)}function pe(e){return ce.Y.isPushRewrite(e.mode)}function me(e){return"signed-in"===e.kind&&e.email.endsWith("@grammarly.com")&&(0,a.pipe)(e.institution,o.fold(a.constFalse,(e=>624392205===e.id)))}function he(e){return"signed-in"===e.kind}function ge(e){return"signed-out"===e.kind}function fe(e){return he(e)&&e.isPremium}var ve,_e=i(28986);!function(e){const t={"Cheetah/_System/Push/SimplifyRewrite":{copiablePrompt:o.none,iconUrl:o.some("https://assets.grammarly.com/cheetah/v1/actions/simplify.svg"),label:"Simplify your text"},"Cheetah/_System/Push/ImproveParagraph":{copiablePrompt:o.none,iconUrl:o.some("https://assets.grammarly.com/cheetah/v1/actions/improve.svg"),label:"Improve your text"}};e.toPreviousText=function(e){return(0,a.pipe)(e,o.fromPredicate((e=>e.alertPname in t)),o.map((e=>({kind:"writerExpert",suggestionId:e.alertId,pname:e.alertPname,text:e.replacementText}))))},e.getInitialResult=function(e){const i=S.left((new _e.R).insert(e.replacementText));return(0,a.pipe)(o.fromNullable(t[e.alertPname]),o.map((t=>({kind:"complete",id:le.Q.Id.create(0),header:t,replacementDelta:i,text:e.replacementText,references:o.none,source:o.none,changesSummary:o.none,timestamp:Date.now(),supportedActions:new Set([le.Q.SupportedAction.insert,le.Q.SupportedAction.copy]),boundaryContextId:o.none}))))}}(ve||(ve={}));var be,ye,ke=i(32133),Se=i(23998),Ce=i(87642),Ee=i(96339);function we(e,t){const i=(0,Se.b)(e).pipe((0,h.s)(1));return void 0!==t?i.pipe((0,Ee.w)(t)).toPromise():i.toPromise()}!function(e){function t(){return(65536*(1+Math.random())|0).toString(16).substring(1)}e.create=function(){return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}}(be||(be={})),function(e){e.create=function(e,t,i,n,s){return"information"===e||"warning"===e?{kind:e,persistent:!!n,customTimeout:s,text:t,id:i||be.create()}:{kind:e,persistent:!!i,customTimeout:"number"==typeof n?n:void 0,id:t||be.create()}}}(ye||(ye={}));var Ae,Ie,xe=i(66995),Te=i(47503);!function(e){let t,i,n,s,r,a;!function(e){let t;!function(e){e.create=function(e){return e},e.eq=U.kK}(t=e.Id||(e.Id={}))}(t=e.Tone||(e.Tone={})),function(e){let t;!function(e){e.create=function(e){return e},e.eq=U.kK}(t=e.Id||(e.Id={}))}(i=e.Style||(e.Style={})),function(e){let t;!function(e){e.create=function(e){return e},e.eq=U.kK}(t=e.Id||(e.Id={}))}(n=e.Role||(e.Role={})),function(e){function t(e){switch(e){case"american":return"American English";case"australian":return"Australian English";case"british":return"British English";case"canadian":return"Canadian English";case"indian":return"Indian English";default:return(0,g.AS)(e)}}function i(e){switch(e){case"american":return"https://assets.grammarly.com/emoji/v1/1f1fa-1f1f8.svg";case"australian":return"https://assets.grammarly.com/emoji/v1/1f1e6-1f1fa.svg";case"british":return"https://assets.grammarly.com/emoji/v1/1f1ec-1f1e7.svg";case"canadian":return"https://assets.grammarly.com/emoji/v1/1f1e8-1f1e6.svg";case"indian":return"https://assets.grammarly.com/emoji/v1/1f1ee-1f1f3.svg";default:return(0,g.AS)(e)}}let n;!function(e){e.create=function(e){return e},e.eq=U.kK}(n=e.Id||(e.Id={})),e.american={id:n.create("american"),label:t("american"),iconUrl:i("american")},e.australian={id:n.create("australian"),label:t("australian"),iconUrl:i("australian")},e.british={id:n.create("british"),label:t("british"),iconUrl:i("british")},e.canadian={id:n.create("canadian"),label:t("canadian"),iconUrl:i("canadian")},e.indian={id:n.create("indian"),label:t("indian"),iconUrl:i("indian")},e.all=function(){return[e.american,e.australian,e.british,e.canadian,e.indian]}}(s=e.Dialect||(e.Dialect={})),function(e){e.eq=U.OW({selectedStyle:i.Id.eq,selectedTonesPerStyle:Te.nZ(i.Id.eq,w.nZ(t.Id.eq)),selectedRole:o.getEq(n.Id.eq),selectedDialect:s.Id.eq})}(r=e.Selections||(e.Selections={})),e.toLegacyVoiceProfile=function(e){return"legacyVoiceProfile"===e.kind?o.some(e):o.none},function(e){const t=U.OW({name:U.kK,state:U.kK}),i=U.OW({name:U.kK,tags:C.nZ(t)}),r=U.OW({name:U.kK,summary:U.kK,selected:U.zF,sections:C.nZ(i)}),a=C.nZ(r);e.eqByRoleDialectProfileAndIsEnabledByDefault=U.OW({profiles:a,selectedRole:o.getEq(n.Id.eq),selectedDialect:s.Id.eq,isEnabledByDefault:U.zF})}(a=e.NewSelections||(e.NewSelections={})),e.toNewVoiceProfile=function(e){return"newVoiceProfile"===e.kind?o.some(e):o.none}}(Ae||(Ae={})),function(e){e.createId=({tagName:e,sectionName:t,profileName:i})=>`${t}-${e}-${i}`}(Ie||(Ie={}));var Fe,Re=i(7962),Ke=i(62470),Me=i(15668);!function(e){let t,i;e.fromOuterContext=function(e){var i,n,s,r;const l=e=>(0,a.pipe)(o.fromNullable(null==e?void 0:e.from),o.chain(C.d5),o.fold((()=>t.empty),t.fromNameAndEmailString)),c=e=>(0,a.pipe)(o.fromNullable(null==e?void 0:e.to),o.chain(E._S),o.map(E.Tj(t.fromNameAndEmailString)),o.getOrElseW((()=>[]))),d=(0,a.pipe)(o.fromNullable(e.items),o.chain(C.d5),o.getOrElseW((()=>{})));return{previousMessageInfo:{author:l(null==d?void 0:d.people),directRecipients:c(null==d?void 0:d.people),text:null!==(i=null==d?void 0:d.text)&&void 0!==i?i:""},title:null!==(n=e.title)&&void 0!==n?n:"",author:l(e.people),directRecipients:c(e.people),indirectRecipients:(0,a.pipe)(o.fromNullable(null===(s=e.people)||void 0===s?void 0:s.cc),o.chain(E._S),o.map(E.Tj(t.fromNameAndEmailString)),o.getOrElseW((()=>[]))),undisclosedRecipients:(0,a.pipe)(o.fromNullable(null===(r=e.people)||void 0===r?void 0:r.bcc),o.chain(E._S),o.map(E.Tj(t.fromNameAndEmailString)),o.getOrElseW((()=>[])))}},e.toOuterContext=function(t){return{title:t.title,people:{from:[e.Person.extractNameAndEmailString(t.author)],to:t.directRecipients.map(e.Person.extractNameAndEmailString),cc:t.indirectRecipients.map(e.Person.extractNameAndEmailString),bcc:t.undisclosedRecipients.map(e.Person.extractNameAndEmailString)},items:[{text:t.previousMessageInfo.text,people:{from:[e.Person.extractNameAndEmailString(t.previousMessageInfo.author)],to:t.previousMessageInfo.directRecipients.map(e.Person.extractNameAndEmailString)}}]}},e.empty={previousMessageInfo:{author:{name:"",email:""},directRecipients:[],text:""},title:"",author:{name:"",email:""},directRecipients:[],indirectRecipients:[],undisclosedRecipients:[]},function(e){e.empty={name:"",email:""},e.fromNameAndEmailString=function(t){return(0,a.pipe)(o.fromNullable(t.match(/^([^<]*)<(.*)>$/)),o.map((e=>{var t,i,n,s;return{name:null!==(i=null===(t=e[1])||void 0===t?void 0:t.trim())&&void 0!==i?i:"",email:null!==(s=null===(n=e[2])||void 0===n?void 0:n.trim())&&void 0!==s?s:""}})),o.getOrElse((()=>e.empty)))},e.extractNameAndEmailString=function(e){const t=""!==e.email?`<${e.email}>`:"";return[e.name,t].filter((e=>""!==e)).join(" ")}}(t=e.Person||(e.Person={})),function(e){e.empty={author:{name:"",email:""},directRecipients:[],text:""}}(i=e.PreviousMessageInfo||(e.PreviousMessageInfo={}))}(Fe||(Fe={}));var Oe=i(67685);const Ne=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function Be(e,t,i,n,s){let r,o,a,l,c,d,u,p,m,h,g,f,v;for(;s>=64;){for(r=t[0],o=t[1],a=t[2],l=t[3],c=t[4],d=t[5],u=t[6],p=t[7],h=0;h<16;h++)g=n+4*h,e[h]=(255&i[g])<<24|(255&i[g+1])<<16|(255&i[g+2])<<8|255&i[g+3];for(h=16;h<64;h++)m=e[h-2],f=(m>>>17|m<<15)^(m>>>19|m<<13)^m>>>10,m=e[h-15],v=(m>>>7|m<<25)^(m>>>18|m<<14)^m>>>3,e[h]=(f+e[h-7]|0)+(v+e[h-16]|0);for(h=0;h<64;h++)f=(((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))+(c&d^~c&u)|0)+(p+(Ne[h]+e[h]|0)|0)|0,v=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&o^r&a^o&a)|0,p=u,u=d,d=c,c=l+f|0,l=a,a=o,o=r,r=f+v|0;t[0]+=r,t[1]+=o,t[2]+=a,t[3]+=l,t[4]+=c,t[5]+=d,t[6]+=u,t[7]+=p,n+=64,s-=64}return n}class Pe{constructor(){this.digestLength=32,this.blockSize=64,this.state=new Int32Array(8),this.temp=new Int32Array(64),this.buffer=new Uint8Array(128),this.bufferLength=0,this.bytesHashed=0,this.finished=!1,this.reset()}reset(){return this.state[0]=1779033703,this.state[1]=3144134277,this.state[2]=1013904242,this.state[3]=2773480762,this.state[4]=1359893119,this.state[5]=2600822924,this.state[6]=528734635,this.state[7]=1541459225,this.bufferLength=0,this.bytesHashed=0,this.finished=!1,this}clean(){for(let e=0;e<this.buffer.length;e++)this.buffer[e]=0;for(let e=0;e<this.temp.length;e++)this.temp[e]=0;this.reset()}update(e,t=e.length){if(this.finished)throw new Error("SHA256: can't update because hash was finished.");let i=0;if(this.bytesHashed+=t,this.bufferLength>0){for(;this.bufferLength<64&&t>0;)this.buffer[this.bufferLength++]=e[i++],t--;64===this.bufferLength&&(Be(this.temp,this.state,this.buffer,0,64),this.bufferLength=0)}for(t>=64&&(i=Be(this.temp,this.state,e,i,t),t%=64);t>0;)this.buffer[this.bufferLength++]=e[i++],t--;return this}finish(e){if(!this.finished){const e=this.bytesHashed,t=this.bufferLength,i=e/536870912|0,n=e<<3,s=e%64<56?64:128;this.buffer[t]=128;for(let e=t+1;e<s-8;e++)this.buffer[e]=0;this.buffer[s-8]=i>>>24&255,this.buffer[s-7]=i>>>16&255,this.buffer[s-6]=i>>>8&255,this.buffer[s-5]=i>>>0&255,this.buffer[s-4]=n>>>24&255,this.buffer[s-3]=n>>>16&255,this.buffer[s-2]=n>>>8&255,this.buffer[s-1]=n>>>0&255,Be(this.temp,this.state,this.buffer,0,s),this.finished=!0}for(let t=0;t<8;t++)e[4*t+0]=this.state[t]>>>24&255,e[4*t+1]=this.state[t]>>>16&255,e[4*t+2]=this.state[t]>>>8&255,e[4*t+3]=this.state[t]>>>0&255;return this}digest(){const e=new Uint8Array(this.digestLength);return this.finish(e),e}_saveState(e){for(let t=0;t<this.state.length;t++)e[t]=this.state[t]}_restoreState(e,t){for(let t=0;t<this.state.length;t++)this.state[t]=e[t];this.bytesHashed=t,this.finished=!1,this.bufferLength=0}}new Uint8Array(32);function De(e,t){switch(e.historyStatus){case oe.HistoryStatus.restoreDisabled:return e.historyStatus;case oe.HistoryStatus.unknown:case oe.HistoryStatus.noHistory:case oe.HistoryStatus.hasHistory:return void 0!==t?t>0?oe.HistoryStatus.hasHistory:oe.HistoryStatus.noHistory:oe.HistoryStatus.unknown;case oe.HistoryStatus.historyRequested:case oe.HistoryStatus.historyRestored:return"started"===e.kind&&void 0!==e.results.find(le.Q.isHistory)?oe.HistoryStatus.historyRestored:oe.HistoryStatus.restoreDisabled;default:(0,g.AS)(e.historyStatus)}}function Le(e,t=!1){return(0,a.pipe)(e.replacementDelta,S.fold(a.identity,(({preferVoice:e,generic:i,user:n})=>t?e===le.Q.GeneratedTextVoice.generic?i:n:i)),(e=>(0,Oe.xn)(e,"")))}function Ue(e){return A.oF((()=>"started"===e.kind?S.right(e):S.left(new Error("Session not started"))))}function je(e,t,i,n){var s;const r=(0,a.pipe)(oe.toStarted(i),o.fold((()=>[]),(e=>e.voiceProfile.roles)));return{kind:"newVoiceProfile",userName:e.userName,title:e.title,subTitle:e.subTitle,profiles:e.profiles,isEnabledByDefault:e.myVoiceIsEnabledByDefault.state,isEnabledByDefaultLabel:e.myVoiceIsEnabledByDefault.label,dialects:Ae.Dialect.all(),roles:(0,a.pipe)(null!==(s=t.roles)&&void 0!==s?s:[],C.Tj((e=>({id:Ae.Role.Id.create(e),label:e}))),(e=>e.length>0?e:r)),selectedDialect:(0,a.pipe)(oe.toStarted(i),o.fold((()=>Ae.Dialect.Id.create(n)),(e=>e.voiceProfile.selectedDialect))),selectedRole:(0,a.pipe)(o.fromNullable(t.selectedRole),o.map((e=>e.trim())),o.filter((e=>""!==e)),o.map(Ae.Role.Id.create)),needsSetup:!1}}function Ve(e,t,i){var n,s;const r=(0,a.pipe)(oe.toStarted(t),o.map((e=>e.voiceProfile)),o.chain(Ae.toLegacyVoiceProfile),o.fold((()=>[]),(e=>e.styles))),l=(0,a.pipe)(oe.toStarted(t),o.fold((()=>[]),(e=>e.voiceProfile.roles))),c=(0,a.pipe)(null!==(n=e.styles)&&void 0!==n?n:[],C.Tj((e=>({id:Ae.Style.Id.create(e.button.label),label:e.button.label,iconUrl:e.button.iconUrl,tones:e.tones.map((e=>({id:Ae.Tone.Id.create(e.label),label:e.label,iconUrl:e.iconUrl,description:e.description}))),maxTones:e.maxTones,description:e.button.description}))),(e=>e.length>0?e:r)),d=Ae.Style.Id.create(e.selectedStyle),u=c.find((e=>Ae.Style.Id.eq.equals(e.id,d)));return{kind:"legacyVoiceProfile",styles:c,roles:(0,a.pipe)(null!==(s=e.roles)&&void 0!==s?s:[],C.Tj((e=>({id:Ae.Role.Id.create(e),label:e}))),(e=>e.length>0?e:l)),selectedStyle:d,selectedTonesPerStyle:(new Map).set(d,new Set(e.selectedTones.filter((e=>null==u?void 0:u.tones.map((e=>e.id.toString())).includes(e))))),selectedRole:(0,a.pipe)(o.fromNullable(e.selectedRole),o.map((e=>e.trim())),o.filter((e=>""!==e)),o.map(Ae.Role.Id.create)),dialects:Ae.Dialect.all(),selectedDialect:(0,a.pipe)(oe.toStarted(t),o.fold((()=>Ae.Dialect.Id.create(i)),(e=>e.voiceProfile.selectedDialect))),needsSetup:e.needSetup}}function $e(e,t,i){return[...(0,a.pipe)(t,C.Tj((i=>J.createFollowUpQuestionActionInputOrQuickActionInput(i,t,e))),C.oE),...i.map((e=>J.createSkillAction(e)))]}function He(e,t){const i=(0,a.pipe)(e.args,C.d5,o.map((t=>({id:J.Id.create(e.id),kind:"userPrompt",arg:{id:q.Id.create(t.name),kind:"string",label:t.label,hints:(0,a.pipe)(o.fromNullable(t.hint),o.map((e=>({header:e.header,items:e.text}))))},generatesTextType:o.some(ne.nN.Insertable),useReferences:o.none,omitReferenceIds:o.none,disabled:void 0!==e.disabled,notificationOnAttempt:(0,a.pipe)(o.fromNullable(e.disabled),o.chain((({onActionNotification:e})=>o.fromNullable(e))),o.map((({text:e})=>e)))}))));return o.isNone(i)&&t.warn("Failed to extract user prompt action, received empty action args.",{actionId:e.id}),i}function Ze(e){return{kind:"quickRewrite",id:J.Id.create(e.id),label:(0,V.sanitize)(e.label,{ALLOWED_TAGS:W}),icon:S.right(e.iconUrl),generatesTextType:o.fromNullable(e.generatesTextType),disabled:void 0!==e.disabled,notificationOnAttempt:(0,a.pipe)(o.fromNullable(e.disabled),o.chain((({onActionNotification:e})=>o.fromNullable(e))),o.map((({text:e})=>e)))}}function Ge(e){return(0,a.pipe)(o.fromNullable(e),o.map((e=>(0,V.sanitize)(e,{ALLOWED_TAGS:[...W,"person"]}))),o.map((e=>e.trim())),o.filter((e=>e.length>0)))}function We(e){return{kind:le.Q.isComplete(e)?"regular":le.Q.isHistory(e)?"history":(0,g.AS)(e),text:Le(e)}}function ze(e){return(0,a.pipe)(o.fromNullable(e.references),o.map((t=>t.map((t=>{var i;return Object.assign(Object.assign({},t),{id:xe.O.Id.create(t.id),url:o.fromNullable(t.url),contextText:(0,a.pipe)(o.fromNullable(null===(i=e.metadata)||void 0===i?void 0:i.knowledge_engine_references),o.chainNullableK((e=>{const i=Array.isArray(e)?e.find((e=>e.id===t.id)):void 0,n=null==i?void 0:i.contextText;return"string"==typeof n?n:void 0})))})})))))}const qe=o.fromNullable;function Qe(e){switch(e){case"ideation":return ne.ol.Ideation;case"rewrite":case"translate":return ne.ol.Rewrite;case"quickRewrite":return ne.ol.QuickRewrite;case"quickReply":return ne.ol.QuickReply;case"pushRewrite":return ne.ol.PushRewrite;default:return(0,g.AS)(e)}}function Je(e){return(0,a.pipe)(e.quickReplyContext,o.map(Fe.toOuterContext))}function Ye(e){var t;return(0,a.pipe)(null!==(t=function(e){var t;return null===(t=e.match(/^https:\/\/docs.google.com\/[a-zA-Z0-9-_]+\/d\/([a-zA-Z0-9-_]+)/))||void 0===t?void 0:t[1]}(e))&&void 0!==t?t:function(e){var t;const i=null!==(t=e.match(/^https:\/\/([a-zA-Z0-9-_]+).atlassian.net\/wiki\/spaces\/[a-zA-Z0-9-_]+\/pages\/([0-9]+)/))&&void 0!==t?t:[];return i[1]&&i[2]?`${i[1]}:${i[2]}`:void 0}(e),o.fromNullable,o.map(Xe))}function Xe(e){const t=(new TextEncoder).encode(e);return Ke.hp.from(function(e){const t=(new Pe).update(e),i=t.digest();return t.clean(),i}(t)).toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function et(e,t,i,n,s){var r,l,c,d,u,p;return c=this,d=void 0,p=function*(){if((null==s?void 0:s.contextUpdatesServer)&&!X.isPending(e)&&i.textRevision===o.toUndefined(e.textRevision)){const s=(0,a.pipe)(o.isNone(i.selectedRange)?(0,a.pipe)(o.fromNullable(null===(r=t.context)||void 0===r?void 0:r.textScope),o.filter((e=>e.start!==e.end))):(0,a.pipe)(k.Jq(o.option)({currentSelectionRange:i.selectedRange,backendSelectionRange:o.fromNullable(null===(l=t.context)||void 0===l?void 0:l.textScope)}),o.filter((({currentSelectionRange:e,backendSelectionRange:t})=>e.start!==t.start||e.end!==t.end)),o.map((({backendSelectionRange:e})=>e))),o.toUndefined);if(s){if(s.start===s.end)return S.right(o.none);{const t=yield n(s)();return S.right((0,a.pipe)(o.fromEither(t),o.map((e=>({text:e,range:s}))),o.alt((()=>e.selection))))}}return S.left(void 0)}return S.left(void 0)},new((u=void 0)||(u=Promise))((function(e,t){function i(e){try{s(p.next(e))}catch(e){t(e)}}function n(e){try{s(p.throw(e))}catch(e){t(e)}}function s(t){var s;t.done?e(t.value):(s=t.value,s instanceof u?s:new u((function(e){e(s)}))).then(i,n)}s((p=p.apply(c,d||[])).next())}))}var tt=function(e,t,i,n){return new(i||(i=Promise))((function(s,r){function o(e){try{l(n.next(e))}catch(e){r(e)}}function a(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))};class it{constructor(e){var t,i,n,s;if(this._params=e,this._subs=new F.y.Keeper,this._logger=this._params.logService.getLogger(it.name),this._session=f.s.create(oe.Starting.initial(this._params.genAIStartSessionOptions.mode)),this._resultById=new Map,this._contextIdByResultId=new Map,this._contextById=new Map,this._historyResultIdByGetContextMessageId=new Map,this._contextMessageIdsTriggeredBySelectionChanges=new Set,this._stateBlobByContextId=new Map,this._initialReceivedContext=null,this._upstreamDialect=f.s.create(Ae.Dialect.Id.create("american")),this._cheetahAckIds=new Set,this._searchReferencesUrlsById=new Map,this._cheetahAckHandlers=new Array,this._resultTimeout=void 0,this._contextTimeout=void 0,this._historyTimeout=void 0,this._cheetahAckTimeout=void 0,this._historyAckHandler=void 0,this._skills=[],this._capiCheckingStatus=f.s.create("unknown"),this._resultTimeoutMs=null!==(t=this._params.resultTimeoutMs)&&void 0!==t?t:2e4,this._contextTimeoutMs=null!==(i=this._params.contextTimeoutMs)&&void 0!==i?i:2e4,this._historyTimeoutMs=null!==(n=this._params.historyTimeoutMs)&&void 0!==n?n:2e4,this._cheetahAckTimeoutMs=null!==(s=this._params.cheetahAckTimeoutMs)&&void 0!==s?s:2e4,this._notificationHandler=null,this.session=this._session.view(),this._handleCAPIMessage=e=>{switch(e.action){case"error":return this._handleError(e);case"cheetah":return this._handleCheetahAck(e);case"cheetah:setContext":return void this._handleCheetahSetContext(e);case"cheetah:chunk":return this._handleCheetahChunk(e);case"cheetah:result":return void this._handleCheetahResult(e);case"cheetah:error":return this._handleCheetahError(e);case"cheetah:setUserState":return this._handleCheetahSetUserState(e);case"cheetah:searchReferencesResult":return this._handleCheetahSearchReferencesResult(e);case"cheetah:invalidateContext":return void this._getContext();case"cheetah:setHistory":return this._handleCheetahSetHistory(e);case"show_survey":case"emotions":case"finished":case"async_check_finished":return;default:return(0,g.AS)(e)}},this._subs.push(this._params.capiService.relevantInboundCAPIMessages.pipe(m.p(ee.Bw.Finished.is),R.T((e=>e.checksStatus))).subscribe(p.H9(this._capiCheckingStatus))),de(this._params.genAIStartSessionOptions)){const e=this._params.textEditorService.selectedRange.get();(0,a.pipe)(e,o.fold((()=>this._init()),(e=>(0,Ce.s)("getText",this._params.textEditorService.getText(e),this._logger,(t=>this._init({selectedRange:e,selectedText:t})),(t=>{this._params.logService.logEvent((0,ae.T$)({textRange:e,reason:(0,ke.$)(t).message})),this._init()})))))}else this._init()}registerNotificationHandler(e){this._notificationHandler=e}_pushNotification(e){var t;null===(t=this._notificationHandler)||void 0===t||t.call(this,e)}_init(e){var t;this._session.set({kind:"starting",mode:this._params.genAIStartSessionOptions.mode,selectedRange:o.fromNullable(null==e?void 0:e.selectedRange),selectedText:(0,a.pipe)(o.fromNullable(null==e?void 0:e.selectedText),o.filter((e=>e.length>0))),quickReplyContext:o.fromNullable(ue(this._params.genAIStartSessionOptions)?this._params.genAIStartSessionOptions.quickReplyContext:void 0),writingExpertContext:o.fromNullable(pe(this._params.genAIStartSessionOptions)?this._params.genAIStartSessionOptions.writingExpertContext:void 0),historyStatus:oe.HistoryStatus.unknown,error:o.none,textRevision:0,selectionContextStatus:this._params.selectionContextAvailability&&(null===(t=this._params.selectionContextAvailability.get())||void 0===t?void 0:t.contextUpdatesClient)?oe.SelectionContextStatus.dynamic:oe.SelectionContextStatus.static}),this._setupSessionModeUpdater(),this._subs.push(this._params.capiService.relevantInboundCAPIMessages.subscribe((e=>this._handleCAPIMessage(e)))),this._subs.push(this._params.userService.user.pipe(m.p(he),R.T((({dialect:e})=>e)),R.T(Ae.Dialect.Id.create)).subscribe(p.H9(this._upstreamDialect))),this._subs.push(this._upstreamDialect.subscribe((e=>this._handleUpstreamDialectChange(e)))),this._subs.push(this._session.pipe((0,I.F)(((e,t)=>e.kind===t.kind)),(0,x.$)((e=>"started"===e.kind))).subscribe((()=>{this._params.userActionTrackingService.trackReadyToInteract(),this._params.metricService.report({name:"assistant_gen_ai_initial_context_ready",labels:void 0},{startMarks:["assistant_lifecycle_starting"]})}))),this._params.selectionContextAvailability&&this._setUpSelectionAvailabilityChangeHandlers(this._params.selectionContextAvailability),this._setupGenAIAvailabilityHandler(),this._subs.push(this._session.subscribe((e=>this._logger.debug("Session updated.",e))))}_setupGenAIAvailabilityHandler(){this._subs.push(this._params.genAIAvailability.pipe(R.T(v.y.isUnavailable),I.F()).subscribe((e=>{this._logger.debug("Gen-AI availability updated.",{genAIIsUnavailable:e}),e?(this._session.modify((e=>Object.assign(Object.assign({},e),{kind:"contextless",nonContextualActions:[]}))),this._getSkills()):"started"!==this._session.get().kind&&(this._session.modify((e=>Object.assign(Object.assign({},e),{kind:"starting"}))),this._startSessionWhenAppropriate())})))}_startSessionWhenAppropriate(){var e;this._params.selectionContextAvailability&&null===this._params.selectionContextAvailability.get()?K.O4([this._params.selectionContextAvailability.pipe(m.p((e=>null!==e))),M.timer(null!==(e=this._params.selectionContextAvailabilityWaitTimeoutMs)&&void 0!==e?e:2e3)]).pipe(h.s(1)).subscribe((()=>this._startSession())):this._startSession()}_startSession(e){(0,Ce.s)("flush",this._params.textEditorService.flush(),this._logger,(()=>{var t,i;const n=de(this._params.genAIStartSessionOptions)?this._params.textEditorService.selectedRange.get():o.fromNullable(void 0),s=function(e){const t=(0,a.pipe)(e,o.fromPredicate((e=>function(e){return ce.Y.isIdeation(e.mode)}(e)&&!!e.documentUrl)),o.map((e=>e.documentUrl)),o.chain(o.fromNullable),o.chain(Ye),o.map((e=>({pageIdHash:e})))),i=(0,a.pipe)(e,o.fromPredicate(ue),o.map((e=>Fe.toOuterContext(e.quickReplyContext))));return o.getMonoid((0,Me.getFirstSemigroup)()).concat(t,i)}(this._params.genAIStartSessionOptions),r=o.fromNullable(pe(this._params.genAIStartSessionOptions)?this._params.genAIStartSessionOptions.writingExpertContext:void 0),l={generationMode:Qe(this._params.genAIStartSessionOptions.mode),selectedRange:o.toUndefined(n),outerContext:o.toUndefined(s),stateBlob:e,metadata:this._params.genAIStartSessionOptions.metadata,previousText:(0,a.pipe)(r,o.chain(ve.toPreviousText),o.toUndefined),includeDisabledActions:this._params.selectionContextAvailability&&(null===(t=this._params.selectionContextAvailability.get())||void 0===t?void 0:t.contextUpdatesServer)&&(null===(i=this._params.selectionContextAvailability.get())||void 0===i?void 0:i.contextUpdatesClient)};this._getSkills(),this._getContext(l)}))}_getSkills(){if(this._params.skillService){const e={skills:0===this._skills.length?this._params.skillService.getSkills():A.pG(this._skills),shouldShowSkills:(0,a.pipe)(this._params.experimentService?this._params.experimentService.isGateEnabled(Re.V.CheetahFetchSkills):A.pG(!1),A.qE((e=>new Error(e))))};(0,Ce.s)("getSkills",k.Jq(Ce.z)(e),this._logger,(({skills:e,shouldShowSkills:t})=>{t&&(this._skills=e,this._session.modify(oe.fold({starting:a.identity,contextless:e=>Object.assign(Object.assign({},e),{nonContextualActions:this._skills.map((e=>J.createSkillAction(e)))}),started:e=>e.activeContext.availableActions.some((e=>"skillAction"===e.kind))?e:Object.assign(Object.assign({},e),{activeContext:Object.assign(Object.assign({},e.activeContext),{availableActions:e.activeContext.availableActions.concat(this._skills.map((e=>J.createSkillAction(e))))}),activeBoundaryContext:Object.assign(Object.assign({},e.activeBoundaryContext),{availableActions:e.activeBoundaryContext.availableActions.concat(this._skills.map((e=>J.createSkillAction(e))))})})})))}),(e=>{this._params.logService.logEvent(function(e){return{kind:"error",source:"skill",name:"getSkillsFailed",data:e}}({reason:(0,ke.$)(e).message}))}))}}_setUpSelectionAvailabilityChangeHandlers(e){const t=e.pipe(R.T((e=>!!(null==e?void 0:e.contextUpdatesClient))));this._subs.push(t.pipe(d.n((e=>e?this._params.textEditorService.selectedRange.pipe(O.i(1),N.oE,B.Z(500),P.M((e=>this._handleSelectedRangeUpdate(e)))):D.w))).subscribe()),this._subs.push(t.pipe(d.n((e=>e?(0,Se.b)(this._params.textEditorService.textUpdated).pipe(P.M((()=>this._handleTextUpdated()))):D.w))).subscribe()),this._subs.push(t.pipe(P.M((e=>{this._session.modify((t=>Object.assign(Object.assign({},t),{selectionContextStatus:e?oe.SelectionContextStatus.dynamic:oe.SelectionContextStatus.static})))}))).subscribe())}_handleSelectedRangeUpdate(e){this._logger.debug("Handling selected range update.",{selectedRange:e}),(0,Ce.s)("getText",this._params.textEditorService.getText(e),this._logger,(t=>{t.trim().length?(this._session.modify(oe.fold({starting:a.identity,contextless:a.identity,started:i=>Object.assign(Object.assign({},i),{mode:"rewrite",activeContext:Object.assign(Object.assign({},i.activeContext),{kind:"pending",isBoundary:!0,textRevision:o.some(i.textRevision),selection:o.some({text:t,range:e})}),activeBoundaryContext:Object.assign(Object.assign({},i.activeBoundaryContext),{kind:"pending",isBoundary:!0,textRevision:o.some(i.textRevision),selection:o.some({text:t,range:e})}),selectedRange:o.some(e),selectedText:(0,a.pipe)(o.some(t),o.filter((e=>e.length>0)))})})),this._getContext(void 0,void 0,!0)):this._session.modify((e=>Object.assign(Object.assign({},e),{selectedRange:o.none,selectedText:o.none})))}))}_handleTextUpdated(){this._logger.debug("Handling text update."),this._session.modify(oe.fold({starting:a.identity,contextless:a.identity,started:e=>Object.assign(Object.assign({},e),{textRevision:e.textRevision+1})}))}_setupSessionModeUpdater(){"quickReply"===this._params.genAIStartSessionOptions.mode&&this._params.textEditorService.trimmedTextLength&&this._subs.push((0,Se.b)(this._params.textEditorService.trimmedTextLength).pipe(m.p((e=>e>0)),h.s(1)).subscribe((()=>{this._session.modify((e=>Object.assign(Object.assign({},e),{mode:"quickReply"===e.mode?"ideation":e.mode})))})))}submitAction(e,t){this._logger.debug("Submitting action.",{actionValue:e,selectedVoice:t}),this._submitAction(e,void 0,void 0,void 0,void 0,t)}setVoiceProfile(e){return this._logger.debug("Setting voice profile (legacy).",{voiceProfileSelections:e}),(0,a.pipe)(Ue(this._session.get()),A.Tj((t=>(this._session.set(Object.assign(Object.assign({},t),{voiceProfile:Object.assign(Object.assign({},t.voiceProfile),e),activeContext:Object.assign(Object.assign({},t.activeContext),{kind:"pending"})})),t))),A.cy((t=>(0,a.pipe)(this._params.capiService.cheetahSetVoice({voice:{selectedStyle:e.selectedStyle,selectedTones:Array.from(e.selectedTonesPerStyle.get(e.selectedStyle)||[]),selectedRole:(0,a.pipe)(e.selectedRole,o.toUndefined),needSetup:!1}}),A.wu((e=>new Error(`CAPIService.cheetahSetVoice error: ${e.message}`)),(()=>!Ae.Dialect.Id.eq.equals(t.voiceProfile.selectedDialect,e.selectedDialect))),A.cy((t=>t?k.CO(A.ys)((0,a.pipe)(this._params.capiService.set_context({documentContext:{dialect:e.selectedDialect}}),A.qE((e=>new Error(`CAPIService.setContext error: ${e.message}`)))),(0,a.pipe)(this._params.userService.setDialect(e.selectedDialect),A.qE((e=>new Error(`UserService.setDialect error: ${e.message}`))))):A.of(null))),A.wu((e=>(this._params.logService.logEvent((0,ae.bf)({reason:(0,ke.$)(e).message})),e)),a.constVoid)))))}setNewVoiceProfile(e){var{selectedDialect:t}=e,i=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(i[n[s]]=e[n[s]])}return i}(e,["selectedDialect"]);return this._logger.debug("Setting voice profile (new).",{dialect:t,voiceProfile:i}),(0,a.pipe)(Ue(this._session.get()),A.Tj((e=>(this._session.set(Object.assign(Object.assign({},e),{activeContext:Object.assign(Object.assign({},e.activeContext),{kind:"pending"})})),e))),A.cy((e=>(0,a.pipe)(this._params.capiService.cheetahSetVoiceProfile({role:(0,a.pipe)(i.selectedRole,o.toUndefined),isEnabledByDefault:i.isEnabledByDefault,profiles:i.profiles}),A.wu((e=>new Error(`CAPIService.cheetahSetVoiceProfile error: ${e.message}`)),(()=>!Ae.Dialect.Id.eq.equals(e.voiceProfile.selectedDialect,t))),A.cy((e=>e?k.CO(A.ys)((0,a.pipe)(this._params.capiService.set_context({documentContext:{dialect:t}}),A.qE((e=>new Error(`CAPIService.setContext error: ${e.message}`)))),(0,a.pipe)(this._params.userService.setDialect(t),A.qE((e=>new Error(`UserService.setDialect error: ${e.message}`))))):A.of(null))),A.wu((e=>(this._params.logService.logEvent((0,ae.PH)({reason:(0,ke.$)(e).message})),e)),a.constVoid)))))}stopInProgressResult(){return this._logger.debug("Stopping in-progress result."),(0,a.pipe)(this._session.get(),A.aN(oe.isStartedWithInProgressResult,(()=>new Error("Session has no in-progress result."))),A.cy((e=>(this._clearResultRelatedTimeouts(),this._session.modify((t=>Object.assign(Object.assign({},t),{activeContext:(0,a.pipe)(e.results.length>0?this._extractLatestResultContext(e):this._extractInitialContext(),o.getOrElse((()=>e.activeContext))),inProgressResult:le.Q.isInProgressPending(e.inProgressResult.value)?o.some(Object.assign(Object.assign({},e.inProgressResult.value),{kind:"inProgressInterrupted"})):le.Q.isInProgressInterrupted(e.inProgressResult.value)?e.inProgressResult:le.Q.isInProgressOngoing(e.inProgressResult.value)?o.none:(0,g.AS)(e.inProgressResult.value)}))),(0,a.pipe)(e.inProgressResult.value,o.fromPredicate(le.Q.isInProgressOngoing),o.fold((()=>A.of(-1)),(e=>this._params.capiService.cheetahInterrupt({promptId:le.Q.Id.toPrimitive(e.id)}))))))),A.wu((e=>(this._params.logService.logEvent((0,ae.JE)({reason:(0,ke.$)(e).message})),e)),a.constVoid))}regenerateResult(e,t,i){this._logger.debug("Regenerating result.",{resultId:e,options:t,selectedVoice:i}),(0,a.pipe)(oe.toStarted(this._session.get()),L.jw((()=>{this._params.logService.logEvent((0,ae.dF)({resultId:e,reason:"session-not-started"}))})),o.chain((t=>(0,a.pipe)(o.fromNullable(this._resultById.get(e)),o.filter(le.Q.isComplete),o.filter((e=>e.supportedActions.has(le.Q.SupportedAction.rephrase))),o.map((e=>({session:t,result:e}))),L.jw((()=>{this._params.logService.logEvent((0,ae.dF)({resultId:e,reason:"not-found"}))}))))),o.chain((({session:t,result:i})=>(0,a.pipe)(k.Jq(o.option)({resultSource:i.source,boundaryContextId:i.boundaryContextId}),o.map((({resultSource:e,boundaryContextId:n})=>({resultSource:e,boundaryContextId:n,resultText:Le(i),session:t}))),L.jw((()=>{this._params.logService.logEvent((0,ae.dF)({resultId:e,reason:"no-source-action"}))}))))),o.map((({resultSource:n,boundaryContextId:s,resultText:r})=>{const l=n.actionValue,c=o.getMonoid(E.CA()).concat,d=(0,a.pipe)(l,o.fromPredicate(J.isUserPromptActionValue),o.fold((0,a.constant)(l),(e=>Object.assign(Object.assign({},e),{omitReferenceIds:c(e.omitReferenceIds,t.omitReferenceIds)})))),u=this._contextIdByResultId.get(e);void 0===u&&this._params.logService.logEvent({kind:"warn",source:"core",name:"regenerateResultContextNotFound",data:null}),this._submitAction(d,n.contextId,u,s,{kind:"regular",text:r},i),this._params.userActionTrackingService.trackResultRephrase(u)})))}searchReferences(e){const t=this._session.get();"started"===t.kind?t.detectedReferences.has(e)||(this._session.set(Object.assign(Object.assign({},t),{detectedReferences:new Map(t.detectedReferences).set(e,o.none)})),this._setupCheetahAckHandler("searchReferences",(t=>{this._searchReferencesUrlsById.set(t,e)})),(0,Ce.s)("cheetahSearchReferences",this._params.capiService.cheetahSearchReferences({url:e}),this._logger)):this._logger.warn("Failed to search references, session not started.",{referencesUrl:e})}dismissResult(e){this._logger.debug("Dismissing result.",{resultId:e});const t=this._session.get();let i=null;if("started"===t.kind)if(this._resultById.delete(e)){const n=t.results.findIndex((t=>t.id===e));i=t.results[n];let s=t.activeContext,r=t.activeBoundaryContext,l=null;if(0===n&&t.results.length>1){this._logger.debug("Dismissing latest result, will try to restore context from previous result.",{session:t,resultId:e});const i=o.toUndefined(this._extractPreviousResultContext(t)),n=(0,a.pipe)(this._extractPreviousResultBoundaryContext(t),o.alt((()=>o.fromNullable(this._initialReceivedContext))),o.toUndefined),c=o.toUndefined(this._extractLatestResultBoundaryContext(t));i?n!==c?(this._logger.debug("Dismissing result, previous result was for different boundary context, will keep currently active boundary context.",{session:t,resultId:e}),s=t.activeBoundaryContext):(this._logger.debug("Dismissing result, found context for previous result, will restore its context.",{session:t,resultId:e,previousResultContext:i}),s=i,n&&(r=n)):t.results[1]&&le.Q.isHistory(t.results[1])&&(0,a.pipe)(o.fromNullable(this._contextIdByResultId.get(t.results[1].id)),o.chain((e=>o.fromNullable(this._contextById.get(e)))),o.isNone)?l=t.results[1].id:this._logger.warn("Failed to find context for previous result after dismissing result.",{resultId:e})}else 1===t.results.length&&(s=t.activeBoundaryContext);this._session.set(Object.assign(Object.assign({},t),{activeContext:Object.assign(Object.assign({},s),{kind:null!==l?"pending":s.kind,availableActions:l?[]:s.availableActions}),activeBoundaryContext:r,results:t.results.filter((t=>!le.Q.Id.eq.equals(t.id,e)))}));const c=this._contextIdByResultId.get(e);this._params.userActionTrackingService.trackResultDismiss(c,le.Q.isHistory(i)?e:void 0),"aiUsageNotification"===i.kind&&this._params.userActionTrackingService.trackAINotificationDismiss("document"),l&&this._getContext(void 0,l)}else this._logger.warn("Failed to dismiss result, result does not exist.",{resultId:e});else this._logger.warn("Failed to dismiss result, session not started.",{resultId:e})}dismissError(){this._logger.debug("Dismissing error."),this._session.lens("error").set(o.none)}restoreHistory(){this._getHistory()}trackResultInsert(e,t=!1){this._logger.debug("Tracking result insert.",{resultId:e,isUserVoice:t});const i=this._resultById.get(e);if(i){const n=this._contextIdByResultId.get(e);this._params.userActionTrackingService.trackResultInsert(n,le.Q.isHistory(i)?i.id:void 0,t)}else this._logger.warn("Failed to track result insert, result does not exist.",{resultId:e})}trackResultCopy(e,t=!1){this._logger.debug("Tracking result copy.",{resultId:e,isUserVoice:t});const i=this._resultById.get(e);if(i){const n=this._contextIdByResultId.get(e);this._params.userActionTrackingService.trackResultCopy(n,le.Q.isHistory(i)?i.id:void 0,t)}else this._logger.warn("Failed to track result copy, result does not exist.",{resultId:e})}_trackResultGenerationCompleted(e){this._logger.debug("Tracking result generation-complete.",{resultId:e});const t=this._resultById.get(e);if(t){const i=this._contextIdByResultId.get(e);this._params.userActionTrackingService.trackResultGenerationCompleted(i,le.Q.isHistory(t)?t.id:void 0)}else this._logger.warn("Failed to track result generation-complete, result does not exist.",{resultId:e})}trackResultOffensive(e){this._logger.debug("Tracking result as offensive.",{resultId:e});const t=this._resultById.get(e);if(t){const i=this._contextIdByResultId.get(e);this._params.userActionTrackingService.trackResultOffensive(i,le.Q.isHistory(t)?t.id:void 0)}else this._logger.warn("Failed to track result as offensive, result does not exist.",{resultId:e})}trackActionsOffensive(){this._logger.debug("Tracking actions as offensive.");const e=this._session.get();"started"===e.kind?this._params.userActionTrackingService.trackActionsOffensive(e.activeContext.id):this._logger.warn("Failed to track actions as offensive, session not started.")}getContextById(e){return o.fromNullable(this._contextById.get(e))}dismissActiveBoundaryContext(e){this._logger.debug("Dismissing active boundary context.",{restorePreviousBoundaryContext:e});const t=(0,a.pipe)(oe.toStarted(this._session.get()),o.map((e=>e.activeContext.id!==e.activeBoundaryContext.id)),o.getOrElse(a.constFalse));if(e&&t)return void this._logger.warn("Failed to dismiss active boundary context, cannot simultaneously dismiss boundary context with results and restore previous one.");const i=t||!e,n=o.toNullable((0,a.pipe)(this._session.get(),oe.toStarted,o.chain((e=>this._extractLatestResultContext(e))))),s=o.toNullable((0,a.pipe)(this._session.get(),oe.toStarted,o.chain((e=>this._extractLatestResultBoundaryContext(e))),o.alt((()=>this._extractInitialContext()))));this._session.modify(oe.fold({starting:a.identity,contextless:a.identity,started:e=>i?Object.assign(Object.assign({},e),{mode:"ideation",activeContext:Object.assign(Object.assign({},e.activeContext),{kind:"pending",isBoundary:!0,textRevision:o.some(e.textRevision),selection:o.none}),activeBoundaryContext:Object.assign(Object.assign({},e.activeBoundaryContext),{kind:"pending",isBoundary:!0,textRevision:o.some(e.textRevision),selection:o.none}),selectedRange:o.none,selectedText:o.none}):n&&s?Object.assign(Object.assign({},e),{mode:e.results.length?e.mode:"ideation",activeContext:n,activeBoundaryContext:s}):Object.assign(Object.assign({},e),{kind:"starting",activeContext:Object.assign(Object.assign({},e.activeContext),{selection:o.none,kind:"pending"}),activeBoundaryContext:void 0,selectedRange:o.none,selectedText:o.none})})),n&&s&&!i||this._getContext(void 0,void 0,i)}dispose(){this._subs.dispose()}_getContext(e,t,i=!1){var n,s;return tt(this,void 0,void 0,(function*(){if(this._logger.debug("Getting context.",{data:e,fetchContextForHistoryCardId:t}),"contextless"===this._session.get().kind)return void this._logger.debug("Getting context for a contextless session, skipping.");try{yield we(this._capiCheckingStatus.pipe(m.p((e=>"unknown"!==e&&"some_checks_in_progress"!==e))),1e4)}catch(e){this._params.logService.logEvent({kind:"warn",source:"core",name:"waitForStableCAPICheckingStatusTimeout",data:null})}this._setupCheetahAckHandler("getContext",(e=>{this._setupContextTimeout("getContext"),void 0!==t&&this._historyResultIdByGetContextMessageId.set(e,t),i&&this._contextMessageIdsTriggeredBySelectionChanges.add(e)}));const r=this._session.get();(0,Ce.s)("cheetahGetContext",this._params.capiService.cheetahGetContext(null!=e?e:{generationMode:Qe(i?"rewrite":r.mode),selectedRange:o.toUndefined(r.selectedRange),outerContext:o.toUndefined(Je(r)),stateBlob:(0,a.pipe)(oe.toStarted(r),o.map((e=>e.activeContext)),o.fold(a.constUndefined,(e=>this._stateBlobByContextId.get(e.id)))),previousText:!i&&"started"===r.kind&&r.results.length>0&&le.Q.isStandardCompletedResult(r.results[0])?We(r.results[0]):void 0,includeDisabledActions:this._params.selectionContextAvailability&&(null===(n=this._params.selectionContextAvailability.get())||void 0===n?void 0:n.contextUpdatesServer)&&(null===(s=this._params.selectionContextAvailability.get())||void 0===s?void 0:s.contextUpdatesClient)}),this._logger,(()=>{this._params.logService.logEvent({kind:"info",source:"core",name:"getContextSuccessful",data:null})}),(()=>{const e=ie.createCriticalError((0,a.pipe)(oe.toStarting(this._session.get()),o.isSome));this._session.modify(oe.fold({starting:t=>Object.assign(Object.assign({},t),{error:o.some(e),kind:"contextless",nonContextualActions:this._skills.map((e=>J.createSkillAction(e)))}),contextless:t=>Object.assign(Object.assign({},t),{error:o.some(e)}),started:t=>Object.assign(Object.assign({},t),{error:o.some(e),inProgressResult:o.none})})),this._params.logService.logEvent((0,ae.Fb)())}))}))}_handleCheetahSetContext(e){var t,i;return tt(this,void 0,void 0,(function*(){this._logger.debug("Handling `cheetah:setContext`.",{message:e}),this._clearContextTimeout();const n=this._session.get(),s=(0,a.pipe)(o.fromNullable(null===(t=e.context)||void 0===t?void 0:t.voiceProfileSettings),o.fold((()=>Ve(e.context.voice,n,this._upstreamDialect.get())),(t=>je(t,e.context.voice,n,this._upstreamDialect.get())))),r={id:X.Id.create(e.context.id),availableActions:$e(X.Id.create(e.context.id),e.context.availableActions,this._skills),userPromptAction:He(e.context.promptAction,this._logger),quickRewriteAction:Ze(e.context.quickRewriteAction),intent:Ge(e.context.intent),documentOverview:qe(e.context.documentOverview),specialView:o.fromNullable(e.context.specialView),selection:this._historyResultIdByGetContextMessageId.has(e.promptId)?o.none:(0,a.pipe)(k.Jq(o.option)({text:n.selectedText,range:n.selectedRange})),textRevision:o.some(n.textRevision)},l=0===this._contextById.size;let c=e.progressMessage?Object.assign(Object.assign({},r),{kind:"pending",isBoundary:!1}):Object.assign(Object.assign({},r),{kind:"received",isBoundary:l||this._contextMessageIdsTriggeredBySelectionChanges.has(e.promptId)});if(this._shouldSkipContextUpdate(e))return void this._logger.debug("Skipping `cheetah:setContext` for missing history card.");const d=yield et(c,e,this._session.get(),(e=>this._params.textEditorService.getText(e)),null===(i=this._params.selectionContextAvailability)||void 0===i?void 0:i.get());c=(0,a.pipe)(o.fromEither(d),o.fold((()=>c),(t=>Object.assign(Object.assign({},c),{isBoundary:!0,selection:t,availableActions:$e(X.Id.create(e.context.id),e.context.availableActions,this._skills)})))),0===this._contextById.size&&X.isReceived(c)&&(this._initialReceivedContext=c),this._contextById.set(c.id,c),this._stateBlobByContextId.set(c.id,e.context.stateBlob),this._bindContextToHistoryCardIfNeeded(e,c.id);const u=(0,a.pipe)(n.writingExpertContext,o.chain((e=>ve.getInitialResult(e))),L.Mi((e=>{this._resultById.set(e.id,e),this._contextIdByResultId.set(e.id,c.id)})),o.fold((()=>[]),(e=>[e])));if(this._session.set(Object.assign(Object.assign({},n),{kind:"started",voiceProfile:s,activeContext:c,activeBoundaryContext:c.isBoundary?c:"started"===n.kind?n.activeBoundaryContext:c,inProgressResult:"started"===n.kind?(0,a.pipe)(n.inProgressResult,o.map((e=>Object.assign(Object.assign({},e),{boundaryContextId:c.isBoundary?o.some(c.id):e.boundaryContextId})))):o.none,results:"started"===n.kind?n.results:u,detectedReferences:"started"===n.kind?n.detectedReferences:new Map,selectedRange:(0,a.pipe)(d,S.fold((()=>n.selectedRange),(e=>(0,a.pipe)(e,o.map((({range:e})=>e)))))),selectedText:(0,a.pipe)(d,S.fold((()=>n.selectedText),(e=>(0,a.pipe)(e,o.map((({text:e})=>e))))))})),(0,a.pipe)(o.fromNullable(e.context.contextNotification),L.Mi((({text:t})=>{this._pushNotification(ye.create("information",t,`contextNotification:${e.id}`,!0)),this._params.userActionTrackingService.trackContexNotification("context")}))),l&&ce.Y.isQuickRewrite(n.mode)){const t=J.QuickRewriteActionValue.fromInput(Ze(e.context.quickRewriteAction));this._logger.debug("Handling initial `cheetah:setContext` for quick rewrite session, submitting quick rewrite action.",{session:n,message:e,quickRewriteAction:t}),this._submitAction(t)}}))}_shouldSkipContextUpdate(e){return(0,a.pipe)(o.fromNullable(this._historyResultIdByGetContextMessageId.get(e.promptId)),o.fold(a.constFalse,(e=>(0,a.pipe)(oe.toStarted(this._session.get()),o.map((e=>e.results)),o.fold(a.constTrue,(t=>!t.some((t=>t.id===e))))))))}_bindContextToHistoryCardIfNeeded(e,t){(0,a.pipe)(o.fromNullable(this._historyResultIdByGetContextMessageId.get(e.promptId)),o.filter((e=>(0,a.pipe)(o.fromNullable(this._contextIdByResultId.get(e)),o.fold(a.constTrue,(e=>void 0===this._contextById.get(e)))))),L.Mi((e=>this._contextIdByResultId.set(e,t))))}_handleCheetahSetUserState(e){this._logger.debug("Handling `cheetah:setUserState`.",{message:e}),this._session.modify((t=>Object.assign(Object.assign({},t),{historyStatus:De(t,e.state.historyItems)})))}_getHistory(){this._logger.debug("Getting history."),void 0===this._historyAckHandler?(this._historyAckHandler=()=>{this._historyAckHandler=void 0,this._setupHistoryTimeout()},this._setupCheetahAckHandler("getHistory",this._historyAckHandler),this._session.lens("historyStatus").set(oe.HistoryStatus.historyRequested),(0,Ce.s)("cheetahGetHistory",this._params.capiService.cheetahGetHistory(),this._logger,(()=>{this._params.logService.logEvent({kind:"info",source:"core",name:"getHistorySuccessful",data:null})}),(()=>{this._params.logService.logEvent((0,ae.cv)())}))):this._logger.warn("Failed to get history, `cheetah:getHistory` request hasn't been ack'ed yet.")}_handleCheetahSetHistory(e){void 0!==this._historyAckHandler&&(this._removeCheetahAckHandler(this._historyAckHandler),this._historyAckHandler=void 0),this._clearHistoryTimeout();const t=this._session.get();"started"===t.kind?(0,a.pipe)(e.cards,C.Tj((e=>le.Q.History.createFromCard(e,void 0!==this._params.textEditorService.copyText))),C.BE,E._S,o.fold((()=>this._session.lens("historyStatus").set(oe.HistoryStatus.noHistory)),(e=>{e.forEach((e=>this._resultById.set(e.id,e))),this._session.set(Object.assign(Object.assign({},t),{activeContext:Object.assign(Object.assign({},t.activeContext),{kind:"pending",textRevision:o.none,availableActions:[],selection:o.none}),historyStatus:oe.HistoryStatus.historyRestored,results:[...t.results,...e],selectedRange:o.none,selectedText:o.none})),this._getContext(void 0,e[0].id)}))):this._logger.warn("Failed to handle `cheetah:setHistory`, session not started.")}_handleCheetahChunk(e){this._logger.debug("Handling `cheetah:chunk`.",{message:e});const t=this._session.get();if("started"!==t.kind)return void this._logger.warn("Failed to handle `cheetah:chunk`, session not started.");const i=le.Q.Id.create(e.promptId);(0,a.pipe)(t.inProgressResult,o.filter(le.Q.isInProgressOngoing),o.filter((e=>le.Q.Id.eq.equals(e.id,i))),o.fold((()=>{const e=(0,a.pipe)(t.inProgressResult,o.filter(le.Q.isInProgressOngoing),o.map((e=>e.id)),o.toNullable);this._params.logService.logEvent(function(e){return{kind:"warn",source:"core",name:"unexpectedChunkReceived",data:e}}({expectedInProgressResultId:e,receivedInProgressResultId:i}))}),(i=>{this._clearResultRelatedTimeouts(),this._session.set(Object.assign(Object.assign({},t),{inProgressResult:o.some(Object.assign(Object.assign({},i),{text:i.text+e.token}))})),this._setupResultTimeout()})))}_handleCheetahResult(e){return tt(this,void 0,void 0,(function*(){this._logger.debug("Handling `cheetah:result`.",{message:e});const t=this._session.get();if("started"!==t.kind)return this._logger.warn("Failed to handle `cheetah:result`, session not started.");const i=le.Q.Id.create(e.promptId);try{yield(0,a.pipe)(t.inProgressResult,o.filter(le.Q.isInProgressOngoing),o.filter((e=>le.Q.Id.eq.equals(e.id,i))),o.fold((()=>{const e=(0,a.pipe)(t.inProgressResult,o.filter(le.Q.isInProgressOngoing),o.map((e=>e.id)),o.toNullable);return this._params.logService.logEvent(function(e){return{kind:"warn",source:"core",name:"unexpectedResultReceived",data:e}}({expectedInProgressResultId:e,receivedInProgressResultId:i})),Promise.resolve(void 0)}),(n=>tt(this,void 0,void 0,(function*(){var s,r,l,c;if(this._clearResultRelatedTimeouts(),e.error||!e.text||""===e.text.plain){const n=e.error?ie.create(e.error):ie.createEmptyResultError();this._logger.warn("Received `cheetah:result` with error.",{resultId:i,errorReason:n.reason}),this._session.set(Object.assign(Object.assign({},t),{inProgressResult:o.none,error:o.some(n)}))}else if(e.text.interrupted)this._logger.debug("Received `cheetah:result` with interrupted text, skipping.",{session:t,message:e});else{let i,d,u,p;i="aiUsageAlert"===(null===(r=null===(s=e.context)||void 0===s?void 0:s.specialView)||void 0===r?void 0:r.kind)?le.Q.AIUsageNotification.fromInProgressResult(n,e.text.plain):Object.assign(Object.assign({},n),{text:e.text.plain,kind:"complete",timestamp:Date.now(),replacementDelta:le.Q.ResultDelta.createFromResultMessage(e),supportedActions:(0,a.pipe)((c=n.source,(0,a.pipe)(c,o.map((e=>e.actionValue.generatesTextType)),o.filter(L.gR(ne.nN.Insertable)),o.fold((()=>w.Ie),(()=>w.tP(new Set([le.Q.SupportedAction.rephrase,le.Q.SupportedAction.insert])))))),w.Yr(U.kK)(le.Q.SupportedAction.copy)),references:ze(e),changesSummary:te(e)}),this._logger.debug("Received complete `cheetah:result`, saving complete result into history.",{session:t,message:e,result:i});let m=S.left(void 0);if(e.context){const s=e.context;u=s.voiceProfileSettings?je(s.voiceProfileSettings,s.voice,t,this._upstreamDialect.get()):Ve(s.voice,t,this._upstreamDialect.get()),d={kind:"received",id:X.Id.create(s.id),availableActions:$e(X.Id.create(e.context.id),s.availableActions,this._skills),userPromptAction:He(s.promptAction,this._logger),intent:Ge(s.intent),documentOverview:qe(s.documentOverview),specialView:o.fromNullable(s.specialView),selection:this._historyResultIdByGetContextMessageId.has(e.promptId)?o.none:(0,a.pipe)(n.boundaryContextId,o.chain((e=>(0,a.pipe)(o.fromNullable(this._contextById.get(e)),o.chain((({selection:e})=>e)))))),isBoundary:!1,textRevision:(0,a.pipe)((0,a.pipe)(n.boundaryContextId,o.chain((e=>o.fromNullable(this._contextById.get(e)))),o.chain((({textRevision:e})=>e))))},m=yield et(d,e,this._session.get(),(e=>this._params.textEditorService.getText(e)),null===(l=this._params.selectionContextAvailability)||void 0===l?void 0:l.get()),d=(0,a.pipe)(o.fromEither(m),o.fold((()=>d),(e=>Object.assign(Object.assign({},d),{isBoundary:!0,selection:e,availableActions:$e(X.Id.create(s.id),s.availableActions,this._skills)})))),d.isBoundary&&(i=Object.assign(Object.assign({},i),{boundaryContextId:o.some(d.id)})),p=s.stateBlob,this._logger.debug("Received `cheetah:result` with context, will update voice profile and context accordingly.",{session:t,message:e,voiceProfile:u,context:d})}else this._logger.warn("Received `cheetah:result` without context.",{resultId:i.id}),u=t.voiceProfile,d=t.activeContext,p=this._stateBlobByContextId.get(t.activeContext.id);this._contextById.set(d.id,d),void 0!==p&&this._stateBlobByContextId.set(d.id,p),this._resultById.set(i.id,i),this._contextIdByResultId.set(i.id,d.id),this._session.set(Object.assign(Object.assign({},t),{voiceProfile:u,activeContext:d,inProgressResult:o.none,results:[i,...t.results],selectedRange:(0,a.pipe)(m,S.fold((()=>t.selectedRange),(e=>(0,a.pipe)(e,o.map((({range:e})=>e)))))),selectedText:(0,a.pipe)(m,S.fold((()=>t.selectedText),(e=>(0,a.pipe)(e,o.map((({text:e})=>e))))))})),this._trackResultGenerationCompleted(i.id)}})))))}catch(e){const t=(0,ke.$)(e);return this._logger.warn("Failed to handle `cheetah:result`.",{resultId:i,reason:t.message})}}))}_handleCheetahSearchReferencesResult(e){const t=this._session.get();if("started"===t.kind){const i=this._searchReferencesUrlsById.get(e.promptId);if(i){const n=e.references[0];n&&this._session.set(Object.assign(Object.assign({},t),{detectedReferences:new Map(t.detectedReferences).set(i,o.some(xe.O.create(n)))}))}else this._logger.warn("Failed to handle `cheetah:searchReferencesResult`, no corresponding `cheetah:searchReferences` request.")}else this._logger.warn("Failed to handle `cheetah:searchReferencesResult`, session not started.")}_handleCheetahError(e){this._logger.debug("Handling `cheetah:error`.",{message:e}),this._clearAllTimeouts();const t=ie.create(e.error);this._logger.warn("Received `cheetah:error`.",{errorKind:e.error.kind}),this._session.modify((e=>Object.assign(Object.assign({},e),{inProgressResult:o.none,error:o.some(t)})))}_handleUpstreamDialectChange(e){this._logger.debug("Handling upstream dialect change.",{upstreamDialect:e});const t=this._session.get();if("started"===t.kind){const i=Ae.Dialect.Id.create(e);this._logger.debug("Dialect changed on upstream services, updating selected dialect on voice profile.",{session:t,selectedDialect:i}),this._session.set(Object.assign(Object.assign({},t),{voiceProfile:Object.assign(Object.assign({},t.voiceProfile),{selectedDialect:i})}))}}_handleCheetahAck(e){this._logger.debug("Handling `cheetah:ack`.",{message:e}),this._clearCheetahAckTimeout(),this._cheetahAckIds.add(e.id);const t=this._cheetahAckHandlers.length>0?this._cheetahAckHandlers[0]:void 0;t&&(this._logger.debug("Extracting `cheetah:ack` handler from queue and executing it.",{message:e,cheetahAckHandlers:this._cheetahAckHandlers}),this._cheetahAckHandlers=this._cheetahAckHandlers.slice(1),t(e.id))}_handleError(e){if(this._cheetahAckIds.has(e.id))if(this._clearAllTimeouts(),e.error===T.O4.SESSION_NOT_INITIALIZED){const t=(0,a.pipe)(oe.toStarted(this._session.get()),o.map((e=>this._stateBlobByContextId.get(e.activeContext.id))),o.toUndefined);this._session.modify((e=>Object.assign(Object.assign({},e),{inProgressResult:o.none}))),this._startSession(t),this._params.logService.logEvent(function(e){return{kind:"warn",source:"core",name:"capiErrorHandled",data:e}}({capiError:e}))}else{const t=ie.createCriticalError((0,a.pipe)(oe.toStarting(this._session.get()),o.isSome));this._session.modify((e=>Object.assign(Object.assign({},e),{inProgressResult:o.none,error:o.some(t)}))),this._params.logService.logEvent((0,ae.hV)({capiError:e}))}else this._params.logService.logEvent((0,ae.hV)({capiError:e}))}_submitAction(e,t,i,n,s,r){var l,c;this._logger.debug("Submitting action.",{actionValue:e,contextId:t,triggerContextId:i,boundaryContextId:n,previousText:s,selectedVoice:r});const d=this._session.get();if("started"===d.kind){const u=null!==(l=null!=t?t:null==e?void 0:e.contextId)&&void 0!==l?l:d.activeContext.id,p=null!=i?i:u,m=null!=n?n:d.activeBoundaryContext.id,h=(null!=s?s:void 0!==(null==e?void 0:e.contextId))?void 0:d.results.length>0&&le.Q.isStandardCompletedResult(d.results[0])?We(d.results[0]):void 0,f=this._stateBlobByContextId.get(u);if(void 0===f)return void this._logger.warn("Failed to submit action, cannot find state blob for context ID.",{contextId:u,triggerContextId:i});const v="aiUsageNotification"===(null===(c=d.results[0])||void 0===c?void 0:c.kind)?d.results.slice(1):d.results;this._session.set(Object.assign(Object.assign({},d),{results:v,historyStatus:oe.HistoryStatus.restoreDisabled,activeContext:Object.assign(Object.assign({},d.activeContext),{kind:"pending"}),inProgressResult:o.isSome(e.generatesTextType)?o.some({kind:"inProgressPending",header:{label:J.isUserPromptActionValue(e)?e.arg.value:e.label,iconUrl:J.isUserPromptActionValue(e)||""===e.icon.right.trim()?o.none:o.some(e.icon.right),copiablePrompt:J.isUserPromptActionValue(e)&&""!==e.arg.value.trim()?o.some(e.arg.value):o.none},text:"",source:o.some({contextId:u,actionValue:e}),boundaryContextId:o.some(m)}):o.none,error:o.none})),this._setupCheetahAckHandler("action",(e=>{(0,a.pipe)(oe.toStarted(this._session.get()),o.chain((e=>e.inProgressResult)),o.filter((0,j.Ub)(le.Q.isInProgressPending,le.Q.isInProgressInterrupted)),o.fold((()=>(this._logger.debug("Received `cheetah:ack` related to in-progress-pending result but we don't have an in-progress-pending result, skipping.",{ackId:e}),A.of(void 0))),(t=>{if(le.Q.isInProgressInterrupted(t))return this._logger.debug("Received `cheetah:ack` related to in-progress-interrupted result, sending `cheetah:interrupt`.",{ackId:e}),this._session.modify((e=>Object.assign(Object.assign({},e),{inProgressResult:o.none}))),this._params.capiService.cheetahInterrupt({promptId:e});if(le.Q.isInProgressPending(t)){this._setupContextTimeout("action"),this._setupResultTimeout();const i=Object.assign(Object.assign({},t),{kind:"inProgressOngoing",id:le.Q.Id.create(e)});return this._logger.debug("Received `cheetah:ack` related to in-progress-pending result, transitioning result to in-progress-ongoing.",{ackId:e,inProgressResult:i}),this._resultById.set(i.id,i),this._session.modify((e=>Object.assign(Object.assign({},e),{inProgressResult:o.some(i)}))),A.of(void 0)}(0,g.AS)(t)})))()}));const _=Object.assign({contextId:u,triggerContextId:p,actionId:e.id,args:J.isUserPromptActionValue(e)?[{name:e.arg.id,value:e.arg.value}]:(0,a.pipe)(E._S(e.args),o.fold((()=>[]),(e=>e.map((e=>({name:e.id,value:e.value})))))),stateBlob:f,previousText:h},r?{metadata:{selectedVoice:r}}:null),b=(0,a.pipe)(e,o.fromPredicate(J.isUserPromptActionValue),o.fold((0,a.constant)(_),(e=>Object.assign(Object.assign({},_),{useReferences:o.toUndefined(e.useReferences),omitReferenceIds:o.toUndefined(e.omitReferenceIds)}))));this._logger.debug("Sending `cheetah:action` to CAPI.",{data:b}),(0,Ce.s)("cheetahAction",this._params.capiService.cheetahAction(b),this._logger,(()=>{this._params.logService.logEvent(function(e){return{kind:"info",source:"core",name:"actionSuccessful",data:e}}({actionId:e.id}))}),(()=>{this._params.logService.logEvent((0,ae.qr)({actionId:e.id}))}))}else this._logger.warn("Failed to submit action, session not started.",{actionId:e.id})}_extractLatestResultContext(e){return this._extractContextFromResult(e,0)}_extractLatestResultBoundaryContext(e){return this._extractBoundaryContextFromResult(e,0)}_extractPreviousResultContext(e){return this._extractContextFromResult(e,1)}_extractPreviousResultBoundaryContext(e){return this._extractBoundaryContextFromResult(e,1)}_extractContextFromResult(e,t){const i=(0,a.pipe)(o.fromNullable(e.results[t]),o.map((e=>e.id)),o.chain((e=>o.fromNullable(this._contextIdByResultId.get(e)))),o.chain((e=>o.fromNullable(this._contextById.get(e)))));return o.isNone(i)&&this._logger.warn("Failed to extract context from result.",{resultIndex:t}),i}_extractBoundaryContextFromResult(e,t){return(0,a.pipe)(o.fromNullable(e.results[t]),o.filter(le.Q.isComplete),o.chain((({boundaryContextId:e})=>e)),o.chain((e=>o.fromNullable(this._contextById.get(e)))),L.jw((()=>{this._logger.warn("Failed to extract boundary context from result.",{resultIndex:t})})))}_extractInitialContext(){return null!==this._initialReceivedContext?o.some(this._initialReceivedContext):(this._logger.warn("Failed to extract initial context."),o.none)}_setupResultTimeout(){this._clearResultTimeout(),this._resultTimeout=M.timer(this._resultTimeoutMs).subscribe((()=>{this._session.modify((e=>Object.assign(Object.assign({},e),{inProgressResult:o.none,error:o.some(ie.createCriticalError((0,a.pipe)(oe.toStarting(this._session.get()),o.isSome)))}))),this._params.logService.logEvent((0,ae.J8)())}))}_setupContextTimeout(e){this._logger.debug("Setting up context timeout.",{sourceCommand:e}),this._clearContextTimeout(),this._contextTimeout=M.timer(this._contextTimeoutMs).subscribe((()=>{const t=ie.createCriticalError((0,a.pipe)(oe.toStarting(this._session.get()),o.isSome));this._session.modify((e=>Object.assign(Object.assign({},e),{inProgressResult:o.none,error:o.some(t)}))),this._params.logService.logEvent((0,ae.b3)({sourceCommand:e}))}))}_setupHistoryTimeout(){this._clearHistoryTimeout(),this._historyTimeout=M.timer(this._historyTimeoutMs).subscribe((()=>{const e=ie.createCriticalError((0,a.pipe)(oe.toStarting(this._session.get()),o.isSome));this._session.modify((t=>Object.assign(Object.assign({},t),{inProgressResult:o.none,error:o.some(e)}))),this._params.logService.logEvent((0,ae.ch)())}))}_setupCheetahAckTimeout(e){this._logger.debug("Setting up `cheetah:ack` timeout.",{sourceCommand:e}),this._clearCheetahAckTimeout(),this._cheetahAckTimeout=M.timer(this._cheetahAckTimeoutMs).subscribe((()=>{const t=ie.createCriticalError((0,a.pipe)(oe.toStarting(this._session.get()),o.isSome));this._session.modify((e=>Object.assign(Object.assign({},e),{inProgressResult:o.none,error:o.some(t)}))),this._params.logService.logEvent((0,ae.pJ)({sourceCommand:e}))}))}_clearResultTimeout(){var e;null===(e=this._resultTimeout)||void 0===e||e.unsubscribe(),this._resultTimeout=void 0}_clearContextTimeout(){var e;null===(e=this._contextTimeout)||void 0===e||e.unsubscribe(),this._contextTimeout=void 0}_clearHistoryTimeout(){var e;null===(e=this._historyTimeout)||void 0===e||e.unsubscribe(),this._historyTimeout=void 0}_clearCheetahAckTimeout(){var e;null===(e=this._cheetahAckTimeout)||void 0===e||e.unsubscribe(),this._cheetahAckTimeout=void 0}_clearResultRelatedTimeouts(){this._clearContextTimeout(),this._clearResultTimeout(),this._clearCheetahAckTimeout()}_clearAllTimeouts(){this._clearResultTimeout(),this._clearContextTimeout(),this._clearHistoryTimeout(),this._clearCheetahAckTimeout()}_setupCheetahAckHandler(e,t){this._setupCheetahAckTimeout(e),this._cheetahAckHandlers.push(t)}_removeCheetahAckHandler(e){this._cheetahAckHandlers=this._cheetahAckHandlers.filter((t=>t!==e)),0===this._cheetahAckHandlers.length&&this._clearCheetahAckTimeout()}}var nt=i(89547);const st={version:"126.0.1"};class rt{constructor(e){var t,i;this._params=e,this._commonProperties={version:st.version,cheetahClientProtocolVersion:nt.WV,clientType:this._params.hostInfo.clientType,clientVersion:this._params.hostInfo.clientVersion,environment:this._params.hostInfo.environment,experience:this._params.experience,userId:null!==(i=this._params.user,t=he(i)?i.id:void 0)&&void 0!==t?t:""}}logEvent(e){return this._log(e.kind,e.source,e.name,e.data)}getLogger(e){return{debug:(t,...i)=>this._debug(e,t,...i),info:(t,i)=>this._info(e,t,i),warn:(t,i)=>this._warn(e,t,i),error:(t,i)=>this._error(e,t,i)}}_debug(e,t,...i){["dev","test"].includes(this._params.hostInfo.environment)&&console.debug(`[${e}]`,t,...i)}_info(e,t,i){return["dev","test"].includes(this._params.hostInfo.environment)&&console.info(`[${e}]`,t,i),this._log("info",e,t,i)}_warn(e,t,i){return["dev","test"].includes(this._params.hostInfo.environment)&&console.warn(`[${e}]`,t,i),this._log("warn",e,t,i)}_error(e,t,i){return["dev","test"].includes(this._params.hostInfo.environment)&&console.error(`[${e}]`,t,i),this._log("error",e,t,i)}_log(e,t,i,n){const s="info"===e||"prod"!==this._params.hostInfo.environment?"infrequent":"continuous",r="prod"!==this._params.hostInfo.environment?30:90;return function(e){return t=this,i=void 0,s=function*(){if("error"===e.logLevel||"warn"===e.logLevel?console[e.logLevel](e.message,e):console.debug("Sending log.",e.message,e),!["prod","preprod","qa","dev","unknown"].includes(e.environment))return console.debug(`Won't send log for host environment "${e.environment}".`,e);let t=!1;if(e.data)try{JSON.stringify(e.data)}catch(i){console.warn("Failed to JSON.stringify data.",{data:e.data},i),t=!0}try{const i=yield fetch(`https://f-log-assistant.grammarly.io/log?datatier=${e.dataTier}&retention=${e.retentionDays}`,{method:"POST",body:JSON.stringify(Object.assign(Object.assign({logLevel:e.logLevel,source:e.source,message:e.message},e.data?t?{data:"JSON.stringify failure"}:{data:e.data}:{}),e.commonProperties))});if(!i.ok){const e=yield i.text();throw Error(e)}}catch(t){console.warn("Failed to send log.",e,t)}},new((n=void 0)||(n=Promise))((function(e,r){function o(e){try{l(s.next(e))}catch(e){r(e)}}function a(e){try{l(s.throw(e))}catch(e){r(e)}}function l(t){var i;t.done?e(t.value):(i=t.value,i instanceof n?i:new n((function(e){e(i)}))).then(o,a)}l((s=s.apply(t,i||[])).next())}));var t,i,n,s}({environment:this._params.hostInfo.environment,dataTier:s,retentionDays:r,logLevel:e,source:t,message:i,commonProperties:this._commonProperties,data:n})}}var ot=function(e,t,i,n){return new(i||(i=Promise))((function(s,r){function o(e){try{l(n.next(e))}catch(e){r(e)}}function a(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))};class at{constructor(e){this._params=e,this._logger=this._params.logService.getLogger(at.name),this._commonLabels={version:st.version,cheetahClientProtocolVersion:nt.WV,clientType:this._params.lifecycleService.hostInfo.clientType,clientVersion:this._params.lifecycleService.hostInfo.clientVersion,environment:this._params.lifecycleService.hostInfo.environment,experience:this._params.experience},this._markedMetricNames=new Set}report(e,{startMarks:t,durationBetweenMarks:i}={}){return ot(this,void 0,void 0,(function*(){if(!["prod","preprod","qa","dev"].includes(this._params.lifecycleService.hostInfo.environment))return this._logger.debug(`Won't report metric for host environment "${this._params.lifecycleService.hostInfo.environment}".`,{metric:e,startMarks:t,durationBetweenMarks:i});performance.mark(e.name),this._markedMetricNames.add(e.name);const n=Object.entries(Object.assign(Object.assign({},this._commonLabels),e.labels)).map((([e,t])=>({key:e,value:t}))),s=this._getDurationMetrics(null!=t?t:[],e.name,n),r=this._getDurationBetweenMetrics(null!=i?i:[],e.name,n);try{const t="sendBeacon"in navigator?this._beacon:window.fetch,i=yield t(`${at.FEMETRICS_ENDPOINT}/batch/import`,{method:"POST",body:JSON.stringify([{name:`${e.name}_total`,type:"counter",value:1,labels:n},...s,...r])});if(!i.ok){const e=yield i.text();throw Error(e)}}catch(t){this._params.logService.logEvent(function(e){return{kind:"warn",source:"core",name:"reportMetricFailed",data:e}}({reason:(0,ke.$)(t).message,metric:e}))}}))}_beacon(e,t){return ot(this,void 0,void 0,(function*(){return navigator.sendBeacon(e,t.body),Promise.resolve(new Response(JSON.stringify({})))}))}_getDurationBetweenMetrics(e,t,i){return e.map(((e,n,s)=>{var r;const o=null!==(r=s[n+1])&&void 0!==r?r:t;try{return{name:`${e}_to_${o}_duration_ms`,type:"histogram",value:this._measureDurationBetweenMarks(e,o),labels:i}}catch(t){const i=(0,ke.$)(t);return this._logger.warn(`Failed to measure '${e}' to '${o}'.`,{reason:i.message}),null}})).filter(Boolean)}_measureDurationBetweenMarks(e,t){const i=performance.measure(`${e}_to_${t}`,e,t);this._markedMetricNames.add(`${e}_to_${t}`);let n=null==i?void 0:i.duration;if(!n){const i=performance.getEntriesByName(`${e}_to_${t}`).at(-1);if(!i)throw Error("performance.measure had no return value and measure could not be found among entries.");n=i.duration}return n}_getDurationMetrics(e,t,i){return e.map((e=>{try{const n=this._measureDurationBetweenMarks(e,t);return{name:`${t}_duration_ms`,type:"histogram",value:n,labels:i.concat([{key:"startMark",value:e}])}}catch(i){const n=(0,ke.$)(i);return void this._logger.warn(`Failed to measure '${e}' to '${t}'.`,{reason:n.message})}})).filter(Boolean)}dispose(){this._markedMetricNames.forEach((e=>{performance.clearMarks(e),performance.clearMeasures(e)}))}}at.FEMETRICS_ENDPOINT="https://assistant.femetrics.grammarly.io";const lt=at;var ct=i(62822);class dt{constructor(){this._notifications=new l.B7,this._notificationDismissed=D.w}notify(e){return this._notifications.next(e),this._notificationDismissed.pipe(m.p((t=>t===e.id)),ct.u("dismissed"),h.s(1))}getNotifications(e){return this._notificationDismissed=e,this._notifications}}var ut=i(89769);function pt(e){return e.split(/\s+/).map((e=>e.trim())).filter((e=>""!==e))}var mt=i(22548);class ht{constructor(e){this._params=e,this._logger=this._params.logService.getLogger(ht.name)}trackResultInsert(e,t,i=!1){this._logger.debug("Tracking result insert.",{contextId:e,historyResultId:t,withVoiceProfile:i}),e||this._logger.warn("Tracking result insert without context ID."),this._trackUxInteraction({kind:"result",userAction:mt._.Result.UserAction.insert},e,t,{withVoiceProfile:i})}trackResultCopy(e,t,i=!1){this._logger.debug("Tracking result copy.",{contextId:e,historyResultId:t,withVoiceProfile:i}),e||this._logger.warn("Tracking result copy without context ID."),this._trackUxInteraction({kind:"result",userAction:mt._.Result.UserAction.copy},e,t,{withVoiceProfile:i})}trackResultOffensive(e,t){this._logger.debug("Tracking result as offensive.",{contextId:e,historyResultId:t}),e||this._logger.warn("Tracking result as offensive without context ID."),this._trackUxInteraction({kind:"result",userAction:mt._.Result.UserAction.offensive},e,t)}trackResultDismiss(e,t){this._logger.debug("Tracking result dismiss.",{contextId:e,historyResultId:t}),e||this._logger.warn("Tracking result dismiss without context ID."),this._trackUxInteraction({kind:"result",userAction:mt._.Result.UserAction.dismiss},e,t)}trackResultRephrase(e){this._logger.debug("Tracking result rephrase.",{contextId:e}),e||this._logger.warn("Tracking result rephrase without context ID."),this._trackUxInteraction({kind:"result",userAction:mt._.Result.UserAction.rephrase},e)}trackResultGenerationCompleted(e,t){this._logger.debug("Tracking result generation-complete.",{contextId:e,historyResultId:t}),e||this._logger.warn("Tracking result generation-complete without context ID."),this._trackUxInteraction({kind:"result",userAction:mt._.Result.UserAction.generationCompleted},e,t)}trackVoiceProfileOpen(e){this._logger.debug("Tracking voice profile open.",{source:e}),this._trackUxInteraction({kind:"voiceProfile",userAction:"toolbar"===e?mt._.VoiceProfile.UserAction.open:mt._.VoiceProfile.UserAction.openFromBanner})}trackVoiceProfileSkip(){this._logger.debug("Tracking voice profile skip."),this._trackUxInteraction({kind:"voiceProfile",userAction:mt._.VoiceProfile.UserAction.skip})}trackActionsOpenStore(){this._logger.debug("Tracking actions open store."),this._trackUxInteraction({kind:"actions",userAction:mt._.Actions.UserAction.openStore})}trackActionsOffensive(e){this._logger.debug("Tracking actions as offensive.",{contextId:e}),e||this._logger.warn("Tracking actions as offensive context ID."),this._trackUxInteraction({kind:"actions",userAction:mt._.Actions.UserAction.offensive},e)}trackPromptSearch(){this._logger.debug("Tracking prompt search."),this._trackUxInteraction({kind:"prompt",userAction:mt._.Prompt.UserAction.search})}trackUsageInfoClick(){this._logger.debug("Tracking usage info click."),this._trackUxInteraction({kind:"usageInfo",userAction:mt._.UsageInfo.UserAction.click})}trackUsageInfoHover(){this._logger.debug("Tracking usage info hover."),this._trackUxInteraction({kind:"usageInfo",userAction:mt._.UsageInfo.UserAction.hover})}trackHistoryButtonView(){this._logger.debug("Tracking history button view."),this._trackUxInteraction({kind:"historyButton",userAction:mt._.HistoryButton.UserAction.view})}trackAssistantClose(){this._logger.debug("Tracking assistant close."),this._trackUxInteraction({kind:"assistant",userAction:mt._.Assistant.UserAction.close})}trackVoiceProfileRemoveTag(){this._logger.debug("Tracking voice profile remove tag."),this._trackUxInteraction({kind:"voiceProfile",userAction:mt._.VoiceProfile.UserAction.removeVoiceTag})}trackVoiceProfileKeepTag(){this._logger.debug("Tracking voice profile keep tag."),this._trackUxInteraction({kind:"voiceProfile",userAction:mt._.VoiceProfile.UserAction.keepVoiceTag})}trackAINotificationDismiss(e){this._logger.debug("Tracking AI notification dismiss.",{scope:e}),this._trackUxInteraction({kind:"aiUsageNotification",userAction:"document"===e?mt._.Notification.AIUsageUserAction.dontShowOnDocument:mt._.Notification.AIUsageUserAction.dontShowForever})}trackReadyToInteract(){this._logger.debug("Tracking ready to interact."),this._trackUxInteraction({kind:"assistant",userAction:mt._.Assistant.UserAction.readyToInteract})}trackMyVoiceCardToggle(e){this._logger.debug("Tracking my voice card toggle.",{isMyVoiceEnabled:e}),this._trackUxInteraction({kind:"voiceProfile",userAction:e?mt._.VoiceProfile.UserAction.toggleToMyVoice:mt._.VoiceProfile.UserAction.toggleToNeutral})}trackContexNotification(e){this._logger.debug("Tracking context notification.",{source:e}),this._trackUxInteraction({kind:"context"===e?"contextNotification":"actionNotification",userAction:mt._.Notification.UserAction.view})}_trackUxInteraction(e,t,i,n={}){const s=mt._.getComponentId(e,t,i,n),r=mt._.getUserAction(e),o=this._params.genAIAvailability.get();v.y.isUnavailable(o)?this._logger.debug(`Gen-AI ${o.kind}, skipping backend user_action tracking.`,{componentId:s,userAction:r,uxInteraction:e,contextId:t}):(this._logger.debug("Sending `user_action` to CAPI.",{componentId:s,userAction:r,uxInteraction:e,contextId:t}),(0,Ce.s)("sendUserAction",this._params.capiService.user_action({componentId:s,userAction:r}),this._logger))}}var gt=i(38908),ft=i(96659);const vt=(0,j.Ub)(ft.t.is(ft.t.Kind.headerVoiceButtonClick),ft.t.is(ft.t.Kind.openFeedbackFormButtonClick),ft.t.is(ft.t.Kind.promptSearchResultsUpdate),ft.t.is(ft.t.Kind.removeSelectionContextClick),ft.t.is(ft.t.Kind.reportOffensiveResultButtonClick),ft.t.is(ft.t.Kind.resultCardDismissButtonClick),ft.t.is(ft.t.Kind.setVoiceButtonClick)),_t=(0,j.Ub)(ft.t.is(ft.t.Kind.actionsMenuReportIncorrectClick),ft.t.is(ft.t.Kind.actionsMenuMuteClick),ft.t.is(ft.t.Kind.actionsMenuReportOffensiveClick),ft.t.is(ft.t.Kind.addToDictionaryClick),ft.t.is(ft.t.Kind.suggestionAcceptClick),ft.t.is(ft.t.Kind.suggestionDismissClick)),bt=(e,t)=>e?`There ${gt.td(e,"is","are")} ${e} matching ${gt.td(e,"result","results")} for query ${t}`:`No matching results, press enter to execute your custom prompt ${t}`;class yt{constructor(e){this._params=e,this._subs=new c.y,this._logger=this._params.logService.getLogger(yt.name),this.state=f.s.create({messageId:0,messageText:""}),this._subs.add(this.state.subscribe((e=>this._logger.debug("A11y view model message updated.",e)))),this._subs.add(this._params.assistantUIActions.pipe(m.p((0,j.Ub)(vt,_t))).subscribe((e=>this._handleUIAction(e))))}createNotification(e){this._subs.add(M.timer(300).subscribe((()=>this.state.set({messageId:this.state.lens("messageId").get()+1,messageText:e}))))}_handleUIAction(e){var t,i;switch(e.kind){case ft.t.Kind.removeSelectionContextClick:{const e=null===(t=o.toNullable(this._params.genAISessionService.get()))||void 0===t?void 0:t.session.get();return void("started"===(null==e?void 0:e.kind)&&o.isNone(e.activeBoundaryContext.selection)&&this.createNotification("Removed selected context"))}case ft.t.Kind.headerVoiceButtonClick:case ft.t.Kind.setVoiceButtonClick:{const{kind:e}=this._params.routingViewModel.activeView.get();return void("voiceProfile"!==e&&"legacyVoiceProfile"!==e||this.createNotification("Now viewing my voice profile"))}case ft.t.Kind.reportOffensiveResultButtonClick:return void this.createNotification("Thanks for the feedback");case ft.t.Kind.resultCardDismissButtonClick:{const{result:{id:t}}=e,n=null===(i=o.toNullable(this._params.genAISessionService.get()))||void 0===i?void 0:i.session.get();return void("started"!==(null==n?void 0:n.kind)||n.results.find((e=>e.id===t))||this.createNotification("Dismissed response output"))}case ft.t.Kind.openFeedbackFormButtonClick:{const{kind:e}=this._params.routingViewModel.activeView.get();return void("feedbackForm"===e&&this.createNotification("Now viewing the feedback form"))}case ft.t.Kind.promptSearchResultsUpdate:return void this.createNotification(bt(e.resultsCount,e.query));case ft.t.Kind.actionsMenuMuteClick:return void this.createNotification("Turning off these types of suggestions");case ft.t.Kind.actionsMenuReportIncorrectClick:return void this.createNotification("Reporting as incorrect suggestion");case ft.t.Kind.actionsMenuReportOffensiveClick:return void this.createNotification("Reporting as offensive suggestion");case ft.t.Kind.addToDictionaryClick:return void this.createNotification("Adding term to the dictionary");case ft.t.Kind.suggestionAcceptClick:return void this.createNotification("Accepting suggestion");case ft.t.Kind.suggestionDismissClick:return void this.createNotification("Dismissing suggestion");default:return(0,g.AS)(e)}}dispose(){this._subs.unsubscribe()}}class kt{constructor(e){this._params=e,this._sub=new c.y,this._logger=this._params.logService.getLogger(kt.name),this._domain=f.s.create(o.none),this._state=f.s.create({}),this.stagingFeedbackFormData=this._state.view(),this.domain=this._domain.view(),this._sub.add(this._params.feedbackService.domain.subscribe((e=>this._domain.set(o.fromNullable(e))))),this._sub.add(this._params.assistantUIActions.subscribe((e=>this._handleUIAction(e))))}dispose(){this._sub.unsubscribe()}_handleUIAction(e){switch(e.kind){case ft.t.Kind.openFeedbackFormButtonClick:return this._openFeedbackForm(e.source);case ft.t.Kind.feedbackFormChange:return this._updateFeedbackForm(e.feedbackData);case ft.t.Kind.feedbackFormSubmitButtonClick:return this._submitFeedbackForm(e.feedbackData);default:return}}_openFeedbackForm(e){this._params.routingViewModel.push({kind:"feedbackForm"}),this._state.set({source:e})}_updateFeedbackForm(e){this._state.modify((t=>Object.assign(Object.assign({},t),e)))}_submitFeedbackForm(e){this._params.routingViewModel.pop(),this._state.set({}),(0,Ce.s)("submitFeedback",this._params.feedbackService.submitFeedback(e),this._logger,void 0,(e=>{this._params.logService.logEvent(function(e){return{source:"feedback",kind:"error",name:"submitFeedbackFailed",data:e}}({reason:(0,ke.$)(e).message}))}))}}class St{constructor(e,t,i,n=3e3,s=300,r=1){this._notificationService=e,this._assistantUIActions=t,this._activeView=i,this._notificationsDurationMs=n,this._mouseOutHoldBackDurationMs=s,this._maxNotificationsCountAtOnce=r,this._state=f.s.create([]),this._notificationsSubs=new Map,this._subs=new c.y,this._hovered=f.s.create(!1),this._dismissed=new l.B7,this.state=this._state.view(),this._subs.add(this._showFeedbackSubmittedToast().subscribe()),this._subs.add(this._clearNotificationsOnViewChange().subscribe()),this._subs.add(this._removeVoiceTagNotification().subscribe()),this._subs.add(this._showServiceNotifications().subscribe())}dismiss(e){var t;null===(t=this._notificationsSubs.get(e))||void 0===t||t.unsubscribe(),this._notificationsSubs.delete(e),this._state.modify(C.pb((t=>t.id!==e))),this._hovered.set(!1),this._dismissed.next(e)}hover(e){this._hovered.set(e)}clearAll(){this._notificationsSubs.forEach((e=>e.unsubscribe())),this._notificationsSubs.clear(),this._state.set([])}dispose(){this._subs.unsubscribe(),this.clearAll()}_showNotification(e){e.persistent||this._notificationsSubs.set(e.id,M.timer(e.customTimeout||this._notificationsDurationMs).pipe(d.n((()=>this._hovered.get()?this._hovered.pipe(B.Z(10),m.p((e=>!e)),h.s(1),d.n((()=>M.timer(this._mouseOutHoldBackDurationMs)))):u.of(null)))).subscribe((()=>this.dismiss(e.id)))),this._state.modify((0,a.flow)(C.qu(e),C.$M(this._maxNotificationsCountAtOnce)))}_showFeedbackSubmittedToast(){return this._assistantUIActions.pipe(m.p((0,j.Ub)(ft.t.is(ft.t.Kind.feedbackFormSubmitButtonClick),ft.t.is(ft.t.Kind.reportOffensiveResultButtonClick),ft.t.is(ft.t.Kind.reportOffensiveActionsButtonClick),ft.t.is(ft.t.Kind.toneReportToneLikeButtonClick),ft.t.is(ft.t.Kind.toneReportToneDislikeButtonClick))),P.M((()=>this._showNotification(ye.create("feedbackSubmitted")))))}_removeVoiceTagNotification(){return this._assistantUIActions.pipe(m.p(ft.t.is(ft.t.Kind.voiceTagPopoverRemoveButtonClick)),P.M((()=>this._showNotification(ye.create("voiceTagRemoved")))))}_showServiceNotifications(){return this._notificationService.getNotifications(this._dismissed).pipe(P.M((e=>this._showNotification(e))))}_clearNotificationsOnViewChange(){return this._activeView.view("kind").pipe(I.F(),P.M((()=>this.clearAll())))}}var Ct=i(38427),Et=i(18182);function wt(e){switch(e){case Et.e.historyButtonActive:return o.some("historyButton");case Et.e.initialActionsList:return o.some("homeGenAIActionsList");case Et.e.referencesList:return o.some("genAIResultReferences");case Et.e.promptInputAndMenuContainer:return o.some("promptInput");case Et.e.followUpActionsList:return o.some("genAIResultFollowUpActionsList");case Et.e.appActionsList:return o.some("homeAppActionsList");case Et.e.actionsMoreButton:return o.some("actionsMoreButton");case Et.e.creditsInfoButton:case Et.e.intentCard:case Et.e.historyButton:case Et.e.promptInput:case Et.e.promptMenuContent:case Et.e.skill:return o.none;default:(0,g.AS)(e)}}class At{constructor(e){this._params=e,this._subs=new c.y,this._references=f.s.create(new Map),this._onboardingStep=f.s.create(o.none),this.onboardingStep=this._onboardingStep.view(),(0,a.pipe)(this._params.onboardingService,o.map((e=>{this._subs.add(this._params.assistantUIActions.pipe(m.p(ft.t.is(ft.t.Kind.mount))).subscribe((({name:t,element:i})=>(0,a.pipe)(wt(t),o.map((t=>{this._references.modify((e=>new Map(e).set(t,i))),e.notify({kind:"onboardingTargetMount",target:t})})))))),this._subs.add(this._params.assistantUIActions.pipe(m.p(ft.t.is(ft.t.Kind.unmount))).subscribe((({name:t})=>(0,a.pipe)(wt(t),o.map((t=>{this._references.modify((e=>{const i=new Map(e);return i.delete(t),i})),e.notify({kind:"onboardingTargetUnmount",target:t})})))))),this._subs.add(Ct.zV([this._references,(0,Se.b)(e.onboardingStepRequest).pipe(R.T(o.fromNullable))]).pipe(R.T((([e,t])=>(0,a.pipe)(t,o.chain((t=>(0,a.pipe)(o.fromNullable(e.get(t.target)),o.map((e=>Object.assign(Object.assign({},t),{reference:e})))))))))).subscribe(p.H9(this._onboardingStep)))})))}notify(e){switch(e.kind){case"onboardingStepUnmount":(0,a.pipe)(this._params.onboardingService,o.map((t=>t.notify({kind:"onboardingStepUnmount",stepId:e.stepId,reason:e.reason}))));break;case"onboardingStepMount":(0,a.pipe)(this._params.onboardingService,o.map((t=>t.notify({kind:"onboardingStepMount",stepId:e.stepId}))));break;default:(0,g.AS)(e)}}dispose(){this._subs.unsubscribe()}}function It(e){return"home"===e.kind||"thread"===e.kind}const xt={legacyVoiceProfile:!0,voiceProfile:!0,feedbackForm:!0,skill:!0,toneReport:!0,settings:!0,plagiarism:!0,writingExpert:!0,performanceScore:!0};function Tt(e){return!0===xt[e.kind]}var Ft;!function(e){e.eq=U.ee(((e,t)=>e.kind===t.kind))}(Ft||(Ft={}));var Rt,Kt,Mt,Ot=i(21662);!function(e){e.Slight="Slight",e.Moderate="Moderate",e.Strong="Strong",e.VeryStrong="Very strong"}(Rt||(Rt={})),function(e){e.On="on",e.Off="off"}(Kt||(Kt={})),function(e){e.positive="positive",e.negative="negative"}(Mt||(Mt={}));const Nt=$.contramap((e=>e.confidence))($.getDualOrd($.ordNumber)),Bt=$.contramap((e=>e===Kt.Off||e!==Kt.On&&(0,g.AS)(e)))($.ordBoolean),Pt=$.contramap((({brandToneInfo:e,confidence:t})=>[(0,a.pipe)(e,o.map((({status:e})=>e))),t]))($.getTupleOrd($.getDualOrd(o.getOrd(Bt)),$.getDualOrd($.ordNumber)));var Dt;!function(e){e.isLoadedEmpty=e=>"loadedEmpty"===e.kind,e.isLoadedNonEmpty=e=>"loadedNonEmpty"===e.kind,e.isLoaded=(0,j.Ub)(e.isLoadedEmpty,e.isLoadedNonEmpty)}(Dt||(Dt={}));class Lt{constructor(e){var t;this._params=e,this._subscriptions=new c.y,this._toneAlertsSummary=f.s.create(o.none),this._loadingTimedOut=f.s.create(!1),this.state=f.s.combine(this._params.toneDetectorServiceInternal.state,this._toneAlertsSummary,this._params.userService.user.view((e=>(0,a.pipe)(o.fromPredicate(he)(e),o.map((({institution:e,isPremium:t})=>({institutionName:(0,a.pipe)(e,o.map((e=>e.name))),isUphookEligible:!t}))),o.getOrElse((()=>({institutionName:o.none,isUphookEligible:!1})))))),this._loadingTimedOut,((e,t,{institutionName:i,isUphookEligible:n},s)=>s?{kind:"loadedEmpty",brandToneInfo:o.none,loadingTimedOut:!0}:(0,a.pipe)(e,o.fold((()=>({kind:"loading"})),(({tones:e,hidden:s,brandTonesEnabled:r,institutionLogo:l})=>(0,a.pipe)(E._S(e),o.filter((e=>!s)),o.fold((()=>({kind:"loadedEmpty",brandToneInfo:r?o.some({institutionName:i,institutionLogo:l}):o.none,loadingTimedOut:!1})),(e=>({kind:"loadedNonEmpty",tones:e,brandToneInfo:r?o.some({institutionName:i,institutionLogo:l}):o.none,uphookInfo:n?t:o.none}))))))))),this._subscriptions.add(this._params.assistantUIActions.pipe(m.p((0,j.Ub)(ft.t.isToneDetectorAction,ft.t.is(ft.t.Kind.actionBrickClick))),Ot.E(this.state)).subscribe((([e,t])=>this._handleUIAction(e,t)))),this._subscriptions.add(this._params.routingViewModel.activeView.view("kind").pipe(I.F(),m.p((e=>"toneReport"===e))).subscribe((()=>this._refreshToneAlertsSummary()))),this._subscriptions.add(this.state.pipe(x.$(Dt.isLoadedNonEmpty)).subscribe((()=>this._refreshToneAlertsSummary())));const i=M.timer(null!==(t=this._params.loadingTimeoutMs)&&void 0!==t?t:1e4).subscribe((()=>this._loadingTimedOut.set(!0)));this._subscriptions.add(i),this._subscriptions.add(this.state.pipe(x.$(Dt.isLoaded)).subscribe((()=>i.unsubscribe())))}dispose(){this._subscriptions.unsubscribe()}_refreshToneAlertsSummary(){we(this._params.toneDetectorServiceInternal.getToneAlertsSummary()).then(p.H9(this._toneAlertsSummary))}_handleUIAction(e,t){switch(e.kind){case ft.t.Kind.toneReportToneLikeButtonClick:this._params.toneDetectorServiceInternal.submitToneFeedback(e.toneName,Mt.positive);break;case ft.t.Kind.toneReportToneDislikeButtonClick:this._params.toneDetectorServiceInternal.submitToneFeedback(e.toneName,Mt.negative);break;case ft.t.Kind.actionBrickClick:{const t=e.action;"regularAction"===t.kind&&J.isToneAction(t.action)&&this._params.routingViewModel.push({kind:"toneReport"});break}case ft.t.Kind.toneReportLoadedEmptyMount:Dt.isLoadedEmpty(t)&&this._params.lifecycleViewModel.onInteractionReady({kind:"tone-detector",success:!t.loadingTimedOut});break;case ft.t.Kind.toneReportLoadedNonEmptyMount:Dt.isLoadedNonEmpty(t)&&(this._params.lifecycleViewModel.onInteractionReady({kind:"tone-detector",success:!0}),this._params.trackingService.toneReportShown({tones:t.tones,brandTonesEnabled:o.isSome(t.brandToneInfo)}));break;case ft.t.Kind.toneReportBackToSuggestionsButtonClick:"toneReport"===this._params.routingViewModel.activeView.get().kind&&this._params.routingViewModel.pop();break;default:(0,g.AS)(e)}}}class Ut{constructor(e){this._params=e,this._contextualActions=f.s.combine(this._params.genAISession,this._params.activeView.view(o.fromPredicate(It)),this._params.genAIAvailability,((e,t,i)=>(0,a.pipe)(k.Jq(o.option)({session:(0,a.pipe)(e,o.chain(oe.toStarted)),view:(0,a.pipe)(t,o.map((e=>e.kind)))}),o.map((({session:e,view:t})=>"home"===t?e.activeBoundaryContext:"thread"===t?e.activeContext:(0,g.AS)(t))),o.map((t=>({loading:!(0,a.pipe)(e,o.exists((e=>o.isSome(e.error))))&&"pending"===t.kind,actions:v.y.isUnavailable(i)||o.exists((({kind:e})=>"aiUsageAlert"===e))(t.specialView)?[]:t.availableActions.filter((0,a.not)(J.isSkillAction)),context:t})))))),this._toneAction=(0,a.pipe)(this._params.toneDetectorViewModel,o.fold((()=>f.s.create(o.none)),(e=>e.state.view((0,a.flow)(o.fromPredicate(Dt.isLoadedNonEmpty),o.map((({tones:e})=>(0,a.pipe)(e,E.d5,J.createToneAction)))))))),this._performanceScoreAction=(0,a.pipe)(this._params.performanceScoreViewModel,o.fold((()=>f.s.create(o.none)),(e=>e.performanceScoreAction))),this._plagiarismAction=f.s.combine((0,a.pipe)(this._params.plagiarismViewModel,o.fold((()=>f.s.create(o.none)),(e=>e.plagiarismAction))),this._params.textEditorState.view("textLength"),((e,t)=>(0,a.pipe)(k.Jq(o.option)({action:e,textLength:t}),o.filter((({textLength:e})=>e>0)),o.map((({action:e})=>e))))),this._writingExpertAction=f.s.combine((0,a.pipe)(this._params.writingExpertViewModel,o.fold((()=>f.s.create(o.none)),(e=>e.writingExpertAction))),this._params.textEditorState.view("wordCount"),((e,t)=>(0,a.pipe)(k.Jq(o.option)({action:e,wordCount:t}),o.filter((({wordCount:e})=>e>50)),o.map((({action:e})=>e))))),this._humanWritingReportAction=(0,a.pipe)(this._params.humanWritingReportViewModel,o.fold((()=>f.s.create(o.none)),(e=>e.humanWritingReportAction))),this._skillActions=this._params.genAISession.view((e=>(0,a.pipe)(e,o.chain(oe.toStarted),o.map((e=>e.activeContext)),o.map((e=>e.availableActions)),o.alt((()=>(0,a.pipe)(e,o.chain(oe.toContextless),o.map((({nonContextualActions:e})=>e))))),o.fold((()=>[]),C.pb(J.isSkillAction))))),this.state=f.s.combine(this._contextualActions,this._toneAction,this._plagiarismAction,this._skillActions,this._writingExpertAction,this._performanceScoreAction,this._humanWritingReportAction,((e,t,i,n,s,r,o)=>({contextualActions:e,toneAction:t,plagiarismAction:i,skillActions:n,writingExpertAction:s,performanceScoreAction:r,humanWritingReportAction:o})))}}var jt=i(19772),Vt=i(34078),$t=i(58347),Ht=i(65621),Zt=i(65141),Gt=i(3346);function Wt(e){var t;if(e instanceof HTMLIFrameElement){const i=null===(t=e.contentWindow)||void 0===t?void 0:t.document;if(i){const e=i.body.querySelector("textarea:not([disabled]), input:not([disabled])");e&&"focus"in e&&"function"==typeof e.focus&&e.focus()}}else e.focus()}function zt(e){return(t,i)=>(t instanceof HTMLIFrameElement?t.contentDocument&&t.contentDocument.body?Zt.R(t.contentDocument.body,i):D.w:Zt.R(t,i)).pipe(Gt.W((n=>{const s=(0,ke.$)(n);return e.error("Failed to attach event listener during focus trap.",{htmlElementTagName:null!==t?t.tagName:null,eventName:i,reason:s.message}),D.w})))}var qt=i(94713),Qt=i(11864),Jt=i(53651),Yt=i(13970);const Xt=(0,Yt.w)("color",(({title:e,titleId:t,desc:i,descId:n,...r})=>s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16","aria-hidden":"true",stroke:"transparent","aria-labelledby":t,"aria-describedby":n,...r},i?s.createElement("desc",{id:n},i):null,e?s.createElement("title",{id:t},e):null,s.createElement("path",{stroke:"#646B81",strokeLinecap:"round",strokeLinejoin:"round",d:"M5.5 4.4h5m-5 2.4h5m-5 2.4h5m-5 2.4H8M4.25 14h7.5c.69 0 1.25-.56 1.25-1.25v-9.5C13 2.56 12.44 2 11.75 2h-7.5C3.56 2 3 2.56 3 3.25v9.5c0 .69.56 1.25 1.25 1.25"}))));var ei=i(54242),ti=i(77167),ii=i(80152),ni=i(38107),si=i(24497),ri=i(87574),oi=i(27235),ai=i(83392),li=i(27917);const ci=e=>s.createElement(li.hh,Object.assign({width:"24",height:"24",viewBox:"0 0 24 24",fill:"none"},e),s.createElement("rect",{x:"4.5",y:"4.5",width:"6",height:"6",rx:"1.5",stroke:ii.Q.Text.Base.Subdued}),s.createElement("rect",{x:"4.5",y:"13.5",width:"6",height:"6",rx:"1.5",stroke:ii.Q.Text.Base.Subdued}),s.createElement("rect",{x:"13.5",y:"4.5",width:"6",height:"6",rx:"1.5",stroke:ii.Q.Text.Base.Subdued}),s.createElement("path",{d:"M14.5513 15.8162L12.9269 16.3577C12.7902 16.4033 12.7902 16.5967 12.9269 16.6423L14.5513 17.1838C15.1485 17.3828 15.6172 17.8515 15.8162 18.4487L16.3577 20.0731C16.4033 20.2098 16.5967 20.2098 16.6423 20.0731L17.1838 18.4487C17.3828 17.8515 17.8515 17.3828 18.4487 17.1838L20.0731 16.6423C20.2098 16.5967 20.2098 16.4033 20.0731 16.3577L18.4487 15.8162C17.8515 15.6172 17.3828 15.1485 17.1838 14.5513L16.6423 12.9269C16.5967 12.7902 16.4033 12.7902 16.3577 12.9269L15.8162 14.5513C15.6172 15.1485 15.1485 15.6172 14.5513 15.8162Z",fill:ii.Q.Text.Base.Subdued,stroke:ii.Q.Text.Base.Subdued})),di=e=>s.createElement(li.hh,Object.assign({width:"22",height:"22",viewBox:"0 0 28 28"},e,{fill:"none"}),s.createElement("rect",{x:"0.5",y:"0.5",width:"27",height:"27",rx:"13.5",stroke:"#C6CBDE"}),s.createElement("path",{d:"M18.6118 19.9487C19.8543 18.9904 20.7655 17.6671 21.2173 16.1645C21.6692 14.6619 21.639 13.0554 21.1311 11.5708C20.6231 10.0863 19.6629 8.79805 18.3853 7.88717C17.1076 6.9763 15.5768 6.4885 14.0077 6.49228C12.4386 6.49607 10.9101 6.99126 9.63688 7.9083C8.36366 8.82533 7.40967 10.1182 6.90889 11.6052C6.40811 13.0922 6.3857 14.6988 6.84481 16.1992C7.30392 17.6996 8.22148 19.0185 9.46862 19.9707",stroke:"#6D758D",strokeLinecap:"round",strokeLinejoin:"round"}),s.createElement("path",{d:"M14.0001 14L18.3723 12.1908",stroke:"#6D758D",strokeLinecap:"round"}),s.createElement("circle",{cx:"14",cy:"14",r:"1.5",fill:"#F9FAFF",stroke:"#6D758D",strokeLinejoin:"round"})),ui=e=>s.createElement(li.hh,Object.assign({width:"22",height:"22",viewBox:"0 0 28 28"},e,{fill:"none"}),s.createElement("rect",{x:"0.5",y:"0.5",width:"27",height:"27",rx:"13.5",stroke:"#E7E9F5"}),s.createElement("rect",{x:"8",y:"13",width:"12",height:"2",rx:"1",fill:"#C6CBDE"})),pi=e=>s.createElement(li.hh,Object.assign({width:"22",height:"22",viewBox:"0 0 28 28"},e,{fill:"none"}),s.createElement("rect",{x:"0.5",y:"0.5",width:"27",height:"27",rx:"13.5",stroke:"#E7E9F5"}),s.createElement("path",{d:"M9.5 15.5L12.5 18.5L20 11",stroke:"#6D758D",strokeLinecap:"round"})),mi=e=>s.createElement(li.hh,Object.assign({width:"24",height:"25",viewBox:"0 0 24 25",stroke:"none"},e),s.createElement("rect",{x:"1",y:"3.5",width:"16",height:"19.9967",fill:si.NeutralGray30}),s.createElement("g",{filter:"url(#PlagiarismAndAiDetectorIcon_filter0_i_3829_930)"},s.createElement("rect",{x:"3",y:"1.5",width:"16",height:"19.9967",fill:si.NeutralGray0})),s.createElement("path",{d:"M15.4513 16.4568C17.0815 16.1106 17.9697 15.2258 18.392 13.8714C16.6202 13.8714 15.184 12.4899 15.184 10.7857C15.184 9.08151 16.6202 7.7 18.392 7.7C20.1637 7.7 21.6 8.99398 21.6 10.7857C21.6 12.5774 21.2435 17.1064 15.4513 18.5V16.4568Z",fill:si.Green60}),s.createElement("path",{d:"M7.46727 16.4568C9.09752 16.1106 9.98569 15.2258 10.4079 13.8714C8.63622 13.8714 7.19995 12.4899 7.19995 10.7857C7.19995 9.08151 8.63622 7.7 10.4079 7.7C12.1797 7.7 13.6159 8.99398 13.6159 10.7857C13.6159 12.5774 13.2595 17.1064 7.46727 18.5V16.4568Z",fill:si.Green60}),s.createElement("defs",null,s.createElement("filter",{id:"PlagiarismAndAiDetectorIcon_filter0_i_3829_930",x:"1",y:"1.5",width:"18",height:"21.9967",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},s.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),s.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),s.createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),s.createElement("feOffset",{dx:"-2",dy:"2"}),s.createElement("feGaussianBlur",{stdDeviation:"2"}),s.createElement("feComposite",{in2:"hardAlpha",operator:"arithmetic",k2:"-1",k3:"1"}),s.createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.760784 0 0 0 0 0.776471 0 0 0 0 0.831373 0 0 0 0.4 0"}),s.createElement("feBlend",{mode:"normal",in2:"shape",result:"effect1_innerShadow_3829_930"})))),hi=e=>s.createElement(li.hh,Object.assign({width:"16",height:"13",viewBox:"0 0 16 13"},e),s.createElement("g",{id:"Vector"},s.createElement("path",{d:"M9.42855 10.1756C11.1709 9.79665 12.1201 8.82771 12.5714 7.34465C10.6779 7.34465 9.14286 5.83188 9.14286 3.96578C9.14286 2.09969 10.6779 0.586914 12.5714 0.586914C14.465 0.586914 16 2.00384 16 3.96578C16 5.92773 15.619 10.8871 9.42855 12.413V10.1756Z",fill:"#7A3500",stroke:"none"}),s.createElement("path",{d:"M0.285697 10.1756C2.02804 9.79665 2.97729 8.82771 3.42857 7.34465C1.53502 7.34465 0 5.83188 0 3.96578C0 2.09969 1.53502 0.586914 3.42857 0.586914C5.32212 0.586914 6.85714 2.00384 6.85714 3.96578C6.85714 5.92773 6.47619 10.8871 0.285697 12.413V10.1756Z",fill:"#7A3500",stroke:"none"}))),gi=e=>s.createElement(li.hh,Object.assign({width:"16",height:"16",viewBox:"0 0 16 16"},e),s.createElement("path",{d:"M10.3009 10.6376C11.3878 10.4069 11.9799 9.817 12.2614 8.91408C11.0802 8.91408 10.1227 7.99306 10.1227 6.85694C10.1227 5.72082 11.0802 4.7998 12.2614 4.7998C13.4425 4.7998 14.4 5.66246 14.4 6.85694C14.4 8.05142 14.1624 11.0708 10.3009 11.9998V10.6376Z",fill:"#027E6F",stroke:"none"}),s.createElement("path",{d:"M4.97826 10.6376C6.06509 10.4069 6.65721 9.817 6.93871 8.91408C5.75756 8.91408 4.80005 7.99306 4.80005 6.85694C4.80005 5.72082 5.75756 4.7998 6.93871 4.7998C8.11986 4.7998 9.07737 5.66246 9.07737 6.85694C9.07737 8.05142 8.83974 11.0708 4.97826 11.9998V10.6376Z",fill:"#027E6F",stroke:"none"})),fi=e=>s.createElement(li.hh,Object.assign({width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"none"},e),s.createElement("g",{clipPath:"url(#a)"},s.createElement("path",{fill:"#FFC444",d:"M5.654 7.744a3.623 3.623 0 0 0-2.398-2.398.362.362 0 0 1 0-.692 3.623 3.623 0 0 0 2.398-2.398.362.362 0 0 1 .692 0 3.623 3.623 0 0 0 2.398 2.398.362.362 0 0 1 0 .692 3.623 3.623 0 0 0-2.398 2.398.362.362 0 0 1-.692 0"}),s.createElement("path",{fill:"#027E6F",d:"M6.207 13.111a.5.5 0 0 1-.353-.853l8.98-8.982c.36-.358.962-.017.84.475l-1.63 6.517a.5.5 0 0 0 .485.62h2.597a.5.5 0 0 1 .354.854l-8.981 8.982c-.359.358-.962.017-.839-.475l1.63-6.517a.5.5 0 0 0-.486-.62z"})),s.createElement("defs",null,s.createElement("clipPath",{id:"a"},s.createElement("path",{fill:"#fff",d:"M0 0h24v24H0z"}))));const vi=e=>{var{children:t}=e,i=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(i[n[s]]=e[n[s]])}return i}(e,["children"]);return s.createElement("div",Object.assign({},i,{className:Qt.Ks.joinClasses([_i,i.className])}),t)},_i=Qt.Ks.style({display:"inline-flex",justifyContent:"center",alignItems:"center",transform:"scale(calc(var(--rem)/16))"});var bi=i(4920),yi=i(94445);const ki="action-row-btn",Si=`.${ki}`,Ci=s.forwardRef((function({icon:e,label:t,ariaLabel:i,badge:n,style:r,mount:o,onClick:l,isUphook:c},d){return s.createElement(oi.$,{variant:"tertiary",onClick:l,name:"actionBrick",size:"large",style:[Ri,c?Ki:void 0,r],className:ki,mount:o,role:"option","aria-label":i||t},(0,a.pipe)(e,S.fold((e=>"more"===e?s.createElement(ci,{"aria-hidden":!0}):"plagiarism"===e?s.createElement(gi,{"aria-hidden":!0}):"plagiarismDetected"===e?s.createElement(hi,{"aria-hidden":!0}):"plagiarismAndAiDetector"===e?s.createElement(mi,{"aria-hidden":!0}):"writingExpert"===e?s.createElement(fi,{"aria-hidden":!0}):"performanceScoreEmpty"===e?s.createElement(ui,{"aria-hidden":!0}):"performanceScoreSome"===e?s.createElement(di,{"aria-hidden":!0}):"performanceScoreSuccess"===e?s.createElement(pi,{"aria-hidden":!0}):"humanWritingReport"===e?s.createElement(vi,null,s.createElement(Jt.I,{icon:Xt,accessibilityLabel:""})):(0,g.AS)(e)),(e=>s.createElement("img",{src:e,style:{width:Qt.Ks.rem(Ei),height:Qt.Ks.rem(Ei)},"aria-hidden":!0})))),s.createElement("div",{className:Oi},s.createElement(ri.F.div,Object.assign({mount:d},z(t),{className:Mi,"aria-hidden":!0})),"new"===n&&s.createElement("span",{"aria-hidden":!0},s.createElement(ei.v,{variant:"success",label:"New!","aria-hidden":!0}))))})),Ei=1.25,wi=ti.Jj,Ai=ti.Jj,Ii=ti.CN,xi=wi+Ei+Ii,Ti=Ai,Fi=(0,ai.Ek)(`inset 0 0 0 2px ${yi.A.BorderBrandDefault}`),Ri={default:{fontSize:Qt.Ks.rem(.875),lineHeight:Qt.Ks.rem(1.3125),minHeight:Qt.Ks.rem(2.5),gap:Qt.Ks.rem(Ii),padding:`${Qt.Ks.rem(ti.v$)} ${Qt.Ks.rem(Ai)} ${Qt.Ks.rem(ti.v$)} ${Qt.Ks.rem(wi)}`,justifyContent:"flex-start",alignItems:"flex-start",color:ii.Q.Text.Base.Default,boxShadow:"none",borderRadius:0,$nest:Fi,width:"100%"},hovered:{color:ii.Q.Text.Base.Default,boxShadow:"none",$nest:Fi},active:{color:ii.Q.Text.Base.Default,boxShadow:"none",$nest:Fi},icon:(0,bi.QD)(Ei)},Ki={default:{backgroundColor:ii.Q.Background.Premium.Default,color:ii.Q.Text.Premium.Default,borderRadius:Qt.Ks.rem(ni.KY),minHeight:"auto",width:"fit-content",padding:`${Qt.Ks.rem(ti.or)} ${Qt.Ks.rem(ti.v$)}`,gap:Qt.Ks.rem(ti.v$),fontWeight:700,margin:Qt.Ks.rem(ti.v$)},active:{backgroundColor:si.Gold40,color:ii.Q.Text.Premium.Default},hovered:{backgroundColor:si.Gold40,color:ii.Q.Text.Premium.Default}},Mi=Qt.Ks.style({whiteSpace:"initial",textAlign:"left",lineHeight:Qt.Ks.rem(1.3125)}),Oi=Qt.Ks.style({display:"flex",alignItems:"start",justifyContent:"space-between",width:"100%",gap:Qt.Ks.rem(qt.v$)});var Ni;!function(e){function t(e){return"actionStore"===e.kind}function i(e){return"searchResults"===e.kind}e.isActionStore=t,e.isSearchResults=i,e.isEmptySearchResults=function(e){return"emptySearchResults"===e.kind},e.isNonEmptyState=function(e){return t(e)||i(e)}}(Ni||(Ni={}));class Bi{constructor(e,t,i,n,s,r,h,v,_,b,y,k){this._userActionTrackingService=_,this._focusPromptField=y,this._logger=k,this._subs=new c.y,this._state=f.s.create(o.none),this._userTyped=new l.B7,this._promptOrMenuFocused=new l.B7,this._promptMenuActions=new l.B7,this._promptMenuContainer=f.s.create(o.none),this._promptMenuContentContainer=o.none,this._cachedActionBricks=o.none,this.state=this._state.view(),this._subs.add(e.subscribe((e=>this._handleUIAction(e)))),this._subs.add(this._userTyped.pipe(Vt.s((e=>e.trim().length>0?M.timer(150):u.of(null))),R.T((e=>e.trim())),P.M((e=>{""===e&&this._promptMenuActions.next({kind:"close"})})),m.p((e=>""!==e)),m.p((()=>!b())),Ot.E(this._state.view(o.fold((()=>a.constTrue),(e=>e.filterPredicate)))),P.M((([e,t])=>this._promptMenuActions.next({kind:"showSearchResults",search:e,filterPredicate:t})))).subscribe()),this._subs.add(function(e,t,i,n,s,r,l,c,p){const m=n;return Ct.zV([e.pipe(d.n((e=>"showSearchResults"===e.kind||"showActionStore"===e.kind?f.s.combine(t,m,s,i,r,l,c,((t,i,n,s,r,l,c)=>{const d=(0,a.pipe)(t,o.fold((()=>[]),(e=>e.actions))),u=(0,a.pipe)((0,a.pipe)([r,i,n,l,c],C.oE).concat(s).concat(d.filter((0,a.not)(J.isSkillAction))),C.pb(e.filterPredicate),E._S);return(0,a.pipe)("showSearchResults"===e.kind?(0,a.pipe)(u,o.filter((()=>""!==e.search.trim()&&!(0,a.pipe)(t,o.exists((e=>e.loading))))),o.chain((t=>function(e,t){return(0,a.pipe)(e,C.x1((e=>(0,a.pipe)(function(e,t,i){const n=pt(e),s=[...pt(t),...(0,a.pipe)(i,C.cy((e=>pt(e))))],r=n.map((()=>null));let l=0;for(const e of s){if(l>=n.length)break;e.toLowerCase().includes(n[l].toLowerCase())&&(r[l]=0,++l)}return r.includes(null)?o.none:o.some(r.map((e=>null!=e?e:0)).reduce(((e,t)=>e+t),0))}(t,e.searchLabel,e.searchTags),o.map((t=>({data:e,matchScore:t})))))),C.di($.contramap((({matchScore:e})=>e))($.ordNumber)),C.Tj((({data:e})=>e)),E._S)}(t,e.search)))):"showActionStore"===e.kind?(0,a.pipe)(u,o.filter((()=>!(0,a.pipe)(t,o.exists((e=>e.loading)))))):(0,g.AS)(e),o.map((t=>"showSearchResults"===e.kind?{kind:"searchResults",actions:t,filterPredicate:e.filterPredicate,query:e.search,promptMenuContainer:o.none}:"showActionStore"===e.kind?{kind:"actionStore",actions:t,filterPredicate:e.filterPredicate,promptMenuContainer:o.none}:(0,g.AS)(e))),o.alt((()=>"showSearchResults"===e.kind?o.some({kind:"emptySearchResults",query:e.search,filterPredicate:e.filterPredicate,promptMenuContainer:o.none}):o.none)))})):"close"===e.kind?u.of(o.none):(0,g.AS)(e))),ut.Z(o.none)),p]).pipe(R.T((([e,t])=>(0,a.pipe)(e,o.map((e=>Object.assign(Object.assign({},e),{promptMenuContainer:t})))))))}(this._promptMenuActions,t,i,n,s,r,h,v,this._promptMenuContainer).subscribe(p.H9(this._state))),this._subs.add(this._promptOrMenuFocused.pipe($t.B(100),m.p((e=>!e))).subscribe((()=>this._promptMenuActions.next({kind:"close"})))),this._subs.add(this.state.pipe(Ht.J(),m.p((([e,t])=>o.isNone(e)&&o.isSome(t))),R.T((([e,t])=>t)),N.oE).subscribe((e=>{"actionStore"===e.kind?this._userActionTrackingService.trackActionsOpenStore():"searchResults"===e.kind&&this._userActionTrackingService.trackPromptSearch()}))),this._subs.add(this._promptMenuActions.pipe(m.p((e=>"close"===e.kind))).subscribe((()=>this._invalidateActionBricks()))),this._subs.add(Ct.zV([this._state,e.pipe(m.p((e=>e.kind===ft.t.Kind.mount&&e.name===Et.e.promptInputAndMenuContainer)))]).pipe(d.n((([e,{element:t}])=>(0,a.pipe)(e,o.fold((()=>D.w),(e=>jt.R.FocusTrap.dynamicFocusTrap(jt.R.FocusTrap.InitialFocus.none,Wt,zt(this._logger))(u.of(o.some(t))))))))).subscribe())}dispose(){this._subs.unsubscribe()}_handleUIAction(e){switch(e.kind){case ft.t.Kind.mount:return void(e.name===Et.e.promptMenuContent?this._promptMenuContentContainer=o.some(e.element):e.name===Et.e.promptInputAndMenuContainer&&this._promptMenuContainer.set(o.some(e.element)));case ft.t.Kind.unmount:return void(e.name===Et.e.promptInputAndMenuContainer&&this._promptMenuContainer.set(o.none));case ft.t.Kind.promptMenuKeyPressArrowDown:return this._onPromptMenuKeyPressArrowDown();case ft.t.Kind.promptMenuKeyPressArrowUp:return this._onPromptMenuKeyPressArrowUp();case ft.t.Kind.promptFieldKeyPressArrowUp:return this._focusLastBrick();case ft.t.Kind.promptFieldKeyPressArrowDown:return this._focusFirstBrick();case ft.t.Kind.promptFieldTextChange:return this._invalidateActionBricks(),this._userTyped.next(e.text);case ft.t.Kind.promptFieldKeyPressEscape:return e.menuOpened?this._promptMenuActions.next({kind:"close"}):void 0;case ft.t.Kind.collapsePromptMenuButtonClick:case ft.t.Kind.promptSubmitButtonClick:return this._promptMenuActions.next({kind:"close"});case ft.t.Kind.promptFieldKeyPressEnter:return void(e.text.trim().length>0&&this._promptMenuActions.next({kind:"close"}));case ft.t.Kind.actionBrickClick:return"allResults"===e.action.kind?this._promptMenuActions.next({kind:"showActionStore",filterPredicate:e.action.filterPredicate}):this._promptMenuActions.next({kind:"close"});case ft.t.Kind.promptFieldAndMenuFocusChange:return this._promptOrMenuFocused.next(e.focused);default:return}}_invalidateActionBricks(){this._cachedActionBricks=o.none}_getActionBricks(){return(0,a.pipe)(this._cachedActionBricks,o.getOrElse((()=>{const e=(0,a.pipe)(this._promptMenuContentContainer,o.fold((()=>[]),(e=>C.ci(Array.from(e.querySelectorAll(Si)).filter(G)))));return this._cachedActionBricks=o.some(e),e})))}_onPromptMenuKeyPressArrowDown(){var e;const t=this._getActionBricks(),i=Z((null===(e=o.toNullable(this._promptMenuContentContainer))||void 0===e?void 0:e.ownerDocument)||document);return(0,a.pipe)(o.fromNullable(t.findIndex((e=>e===i))),L.Mi((e=>{var i;e+1>=t.length?this._focusPromptField():null===(i=t[e+1])||void 0===i||i.focus()})))}_onPromptMenuKeyPressArrowUp(){var e;const t=this._getActionBricks(),i=Z((null===(e=o.toNullable(this._promptMenuContentContainer))||void 0===e?void 0:e.ownerDocument)||document);return(0,a.pipe)(o.fromNullable(t.findIndex((e=>e===i))),L.Mi((e=>{var i;e-1<0?this._focusPromptField():null===(i=t[e-1])||void 0===i||i.focus()})))}_focusFirstBrick(){var e;null===(e=this._getActionBricks()[0])||void 0===e||e.focus()}_focusLastBrick(){var e;const t=this._getActionBricks();null===(e=t[t.length-1])||void 0===e||e.focus()}}var Pi=i(10540),Di=i(48209),Li=i(60269),Ui=i(41797);class ji{constructor(e){var t,i;this._params=e,this._subs=new c.y,this._action=f.s.create(o.none),this.humanWritingReportAction=this._action.view(),void 0!==this._params.humanWritingReportService&&(this._subs.add(this._params.assistantUIActions.pipe(m.p((0,j.M4)(ft.t.is(ft.t.Kind.actionBrickClick),(e=>"regularAction"===e.action.kind&&J.isHumanWritingReportAction(e.action.action))))).subscribe((()=>{var e,t;return null===(t=null===(e=this._params.humanWritingReportService)||void 0===e?void 0:e.notifyGenerateReportActionClick)||void 0===t?void 0:t.call(e)}))),this._subs.add(Ui.H(null!==(i=null===(t=this._params.humanWritingReportService)||void 0===t?void 0:t.showGenerateReportActions)&&void 0!==i?i:u.of(!1)).pipe(R.T((0,j.Sw)(o.some(function(){const e="Generate a report";return{kind:"humanWritingReportAction",id:J.Id.create("humanWritingReport"),group:{id:J.knownGroup.tools,label:"Tools",rank:Number.MAX_SAFE_INTEGER},icon:S.left("humanWritingReport"),label:e,badge:o.none,searchLabel:"humanWritingReport",searchTags:[e],generatesTextType:o.none,args:[],disabled:!1,notificationOnAttempt:o.none}}()),o.none))).subscribe(p.H9(this._action))))}dispose(){this._subs.unsubscribe()}}class Vi{constructor(e){this._params=e,this._subs=new c.y,this._viewActive=f.s.create(!1),this.deepLinkStatusChanges=f.s.combine(this._viewActive,this._params.performanceScoreViewAvailable,((e,t)=>({active:e,available:t}))),this._subs.add(this._params.routingViewModel.activeView.view("kind").subscribe((e=>this._viewActive.set("performanceScore"===e)))),this._subs.add(this._performanceViewActiveScoreNone().subscribe((()=>this._params.routingViewModel.pop()))),this._subs.add(this._performanceActionBrickClick().subscribe((()=>this._handleOpenPerformanceScoreViewRequest())))}handleDeepLinkRequest(){this._handleOpenPerformanceScoreViewRequest()}dispose(){this._subs.unsubscribe()}_handleOpenPerformanceScoreViewRequest(){"performanceScore"!==this._params.routingViewModel.activeView.get().kind&&this._params.performanceScoreViewAvailable.get()&&this._params.routingViewModel.push({kind:"performanceScore"})}_performanceActionBrickClick(){return this._params.assistantUIActions.pipe(m.p((0,j.M4)(ft.t.is(ft.t.Kind.actionBrickClick),(e=>"regularAction"===e.action.kind&&J.isPerformanceScoreAction(e.action.action)))))}_performanceViewActiveScoreNone(){return this._params.routingViewModel.activeView.view("kind").pipe(m.p((e=>"performanceScore"===e)),d.n((()=>this._params.performanceScoreViewAvailable.pipe(m.p((e=>!e)),h.s(1)))))}}var $i,Hi=i(2855);function Zi(e){return"number"==typeof e&&e>=0&&e<=1?o.some(e):o.none}!function(e){e.lensAllSuggestionFeedShortForm="lens-all-suggestions-feed-short-form",e.lensAllSuggestionFeed="lens-all-suggestions-feed",e.lensCorrectnessFeed="lens-correctness-feed",e.lensClarityFeed="lens-clarity-feed",e.lensDeliveryFeed="lens-delivery-feed",e.lensEngagementFeed="lens-engagement-feed",e.lensStyleGuideFeed="lens-style-guide-feed",e.lensPremiumFeed="lens-premium-feed",e.plagiarismFeed="plagiarism-feed",e.writingExpertFeed="writing-expert-feed"}($i||($i={}));const Gi={[$i.lensAllSuggestionFeed]:"All suggestions",[$i.lensAllSuggestionFeedShortForm]:"All suggestions",[$i.lensCorrectnessFeed]:"Correctness",[$i.lensClarityFeed]:"Clarity",[$i.lensDeliveryFeed]:"Delivery",[$i.lensEngagementFeed]:"Engagement",[$i.lensStyleGuideFeed]:"Style guide",[$i.lensPremiumFeed]:"Premium",[$i.plagiarismFeed]:"Plagiarism",[$i.writingExpertFeed]:"Writing Expert"};function Wi(e){return Object.values($i).includes(e)?o.some(e):o.none}const zi={shortForm:$i.lensAllSuggestionFeedShortForm,longForm:$i.lensAllSuggestionFeed};function qi(e){return!function(e){return"sensitive"===e.status||"error"===e.status}(e)}function Qi(e){return t=>{switch(t.status){case"loading":return e.loading();case"tooSmall":return e.tooSmall();case"ok":return e.ok(t);default:(0,g.AS)(t)}}}function Ji(e){const t=(0,a.pipe)(e,(e=>{switch(e.status){case"ok":return`See overall score (${e.generalScore}/100)`;case"loading":case"tooSmall":return"See overall score";default:(0,g.AS)(e)}})),i=(0,a.pipe)(e,(e=>{switch(e.status){case"ok":return function(e){return"ok"===e.status&&100===e.generalScore}(e)?"performanceScoreSuccess":"performanceScoreSome";case"loading":case"tooSmall":return"performanceScoreEmpty";default:(0,g.AS)(e)}}));return{kind:"performanceScoreAction",id:J.Id.create("performanceScore"),group:{id:J.knownGroup.tools,label:"Tools",rank:Number.MAX_SAFE_INTEGER},icon:S.left(i),label:t,badge:o.none,searchLabel:"performanceScore",searchTags:[t],generatesTextType:o.none,args:[],disabled:!1,notificationOnAttempt:o.none}}class Yi{constructor(e){this._params=e,this._logger=this._params.logService.getLogger("PerformanceScoreViewModelImpl"),this._subs=new c.y,this._performanceScore=f.s.create(o.some({status:"loading"})),this._featureOptions=f.s.create(o.none),this.performanceScore=f.s.combine(this._performanceScore,this._featureOptions,((e,t)=>(0,a.pipe)(e,o.filter((()=>o.isSome(t))),o.filter(qi)))),this.performanceScoreAction=f.s.combine(this.performanceScore,this._featureOptions,((e,t)=>(0,a.pipe)(e,o.filter((()=>(0,a.pipe)(t,o.exists((e=>e.showEntryPoint))))),o.map(Ji)))),this._params.featureOptions&&(this._subs.add((0,Se.b)(this._params.featureOptions).pipe(R.T(o.fromNullable)).subscribe(p.H9(this._featureOptions))),this._subs.add(Ct.zV([this._params.lastFinishedMessage,this._params.feeds,this._featureOptions]).pipe(m.p((([e,t,i])=>o.isSome(i))),R.T((([e,t])=>function(e,t){return"OK"===e.scoresStatus?(0,a.pipe)("number"==typeof(i=e.generalScore)&&i>=0&&i<=100?o.some(Math.round(i)):o.none,o.map((i=>({status:"ok",generalScore:i,outcomeScores:Xi(e.outcomeScores,t)})))):o.some({status:"TOO_SMALL"===e.scoresStatus?"tooSmall":"SENSITIVE"===e.scoresStatus?"sensitive":"ERROR"===e.scoresStatus?"error":(0,g.AS)(e.scoresStatus)});var i}(e,t)))).subscribe(p.H9(this._performanceScore))),this._subs.add(this.performanceScore.subscribe((e=>this._logger.debug("Performance score",e)))))}onPerformanceScoreReportMount(e){this._params.tracking.performanceScoreReportShown("ok"===e.status&&100===e.generalScore?"success":e.status)}dispose(){this._subs.unsubscribe()}}function Xi(e,t){var i,n,s,r,l,c,d,u,p,m;return{clarity:{score:(0,a.pipe)(Zi(null==e?void 0:e.Clarity),o.getOrElse((()=>0))),alerts:null!==(n=null===(i=t.get(Hi.W.Item.Id.from($i.lensClarityFeed)))||void 0===i?void 0:i.alertCount)&&void 0!==n?n:0},correctness:{score:(0,a.pipe)(Zi(null==e?void 0:e.Correctness),o.getOrElse((()=>0))),alerts:null!==(r=null===(s=t.get(Hi.W.Item.Id.from($i.lensCorrectnessFeed)))||void 0===s?void 0:s.alertCount)&&void 0!==r?r:0},engagement:{score:(0,a.pipe)(Zi(null==e?void 0:e.Engagement),o.getOrElse((()=>0))),alerts:null!==(c=null===(l=t.get(Hi.W.Item.Id.from($i.lensEngagementFeed)))||void 0===l?void 0:l.alertCount)&&void 0!==c?c:0},styleGuide:{score:(0,a.pipe)(Zi(null==e?void 0:e["Style guide"]),o.getOrElse((()=>0))),alerts:null!==(u=null===(d=t.get(Hi.W.Item.Id.from($i.lensStyleGuideFeed)))||void 0===d?void 0:d.alertCount)&&void 0!==u?u:0},delivery:{score:(0,a.pipe)(Zi(null==e?void 0:e.Tone),o.getOrElse((()=>0))),alerts:null!==(m=null===(p=t.get(Hi.W.Item.Id.from($i.lensDeliveryFeed)))||void 0===p?void 0:p.alertCount)&&void 0!==m?m:0}}}class en{constructor(e){this._params=e,this.deepLinkStatusChanges=f.s.combine(this._params.plagiarismAvailable,this._params.activeView,((e,t)=>({available:e,active:"plagiarism"===t})))}handleDeepLinkRequest(){"plagiarism"!==this._params.activeView.get()&&this._params.plagiarismAvailable.get()&&this._params.handlePlagiarismDeepLinkRequest()}}var tn=i(46238),nn=i(2338);function sn(e){return{kind:"error",source:"revision",name:"applyAlertsFailed",data:e}}function rn(e){return{kind:"error",source:"revision",name:"removeAlertsFailed",data:e}}function on(e){return{kind:"error",source:"revision",name:"sduiUserActionFailed",data:e}}function an(e){return{kind:"error",source:"revision",name:"sduiCardCopyTextFailed",data:e}}function ln(e){return{kind:"error",source:"revision",name:"sduiCardOpenLinkFailed",data:e}}class cn{constructor(e){this._params=e,this._logger=this._params.logService.getLogger(cn.name),this._subs=new c.y,this._plagiarismChecksEnabled=f.s.create(!1),this._aiDetectorEnabled=f.s.create((0,a.pipe)(this._params.aiDetectorEnabled,o.fold((()=>this._params.experimentService?o.none:o.some(!1)),(e=>o.some(e))))),this.plagiarismChecksEnabled=this._plagiarismChecksEnabled.view(),this.aiDetectorEnabled=this._aiDetectorEnabled.view(),o.isNone(this.aiDetectorEnabled.get())&&e.experimentService&&(0,Ce.s)("isAiDetectorGateEnabled",(0,a.pipe)(e.experimentService.isGateEnabled(Re.V.PlagiarismAiDetector),A.qE((e=>new Error(e)))),this._logger,(e=>this._aiDetectorEnabled.set(o.some(e))),(e=>this._aiDetectorEnabled.set(o.some(!1))))}enablePlagiarismChecks(){this._subs.add(this.aiDetectorEnabled.pipe(N.oE,h.s(1),R.T((e=>(0,a.pipe)(e?{plagiarism:!0,ai_detector:!0}:{plagiarism:!0},(e=>this._params.capiService.toggle_checks({checks:e})),tn.map((e=>{if(S.isLeft(e))throw new Error(e.left.message);return e.right})),(e=>Ui.H(e()))))),nn.K()).pipe(h.s(1)).subscribe((e=>this._plagiarismChecksEnabled.set(!0)),(e=>function(e){return{kind:"error",source:"revision",name:"enablePlagiarismCheckFailed",data:e}}({reason:(0,ke.$)(e).message}))))}disablePlagiarismChecks(){this._subs.add(this.aiDetectorEnabled.pipe(N.oE,h.s(1),R.T((e=>(0,a.pipe)(e?{plagiarism:!1,ai_detector:!1}:{plagiarism:!1},(e=>this._params.capiService.toggle_checks({checks:e})),tn.map((e=>{if(S.isLeft(e))throw new Error(e.left.message);return e.right})),(e=>Ui.H(e()))))),nn.K()).pipe(h.s(1)).subscribe((e=>this._plagiarismChecksEnabled.set(!1)),(e=>function(e){return{kind:"error",source:"revision",name:"disablePlagiarismCheckFailed",data:e}}({reason:(0,ke.$)(e).message}))))}dispose(){this._subs.unsubscribe()}}var dn=i(91283);function un(e){const t=new c.y,i=e.feedManager.feeds.view((t=>o.fromNullable(t.get(e.feedId)))).view(o.map((e=>e.feed)));return t.add(e.entryPointClicked.pipe(P.M((()=>e.routingViewModel.push(e.view))),d.n((()=>e.canExecuteEntryPointAction().pipe(h.s(1)))),N.oE).subscribe((t=>{e.feedActionService.processActions(t.content.actions,t.id,t.alertIds,t.content.id)}))),t.add(e.feedManager.feed.pipe(R.T((e=>{var t;return null===(t=o.toNullable(e))||void 0===t?void 0:t.id})),Ht.J(),m.p((([t,i])=>t===e.feedId&&i!==e.feedId&&e.routingViewModel.activeView.get().kind===e.view.kind))).subscribe((()=>e.routingViewModel.pop()))),t.add(e.routingViewModel.has(e.view).pipe(Ht.J(),m.p((([e,t])=>e&&!t)),d.n((()=>e.feedManager.feed.pipe(h.s(1),R.T((e=>{var t;return null===(t=o.toNullable(e))||void 0===t?void 0:t.id}))))),m.p((t=>t===e.feedId))).subscribe((()=>(0,a.pipe)(i.get(),o.map((t=>e.feedActionService.processActions([{type:"popAssistantFeed"},e.sduiDisableCheckAction],t.id,t.alertIds,t.content.id))))))),t.add({unsubscribe:()=>{e.routingViewModel.has(e.view).get()&&(0,a.pipe)(i.get(),o.map((t=>e.feedActionService.processActions([e.sduiDisableCheckAction],t.id,t.alertIds,t.content.id))))}}),t}var pn=i(59042);function mn(e,t){return e.pipe(R.T(pn.b.filter(t,t,t)),m.p((e=>!pn.b.isEmpty(e))),R.T(pn.b.reduce(o.none,((e,t)=>o.none),((e,t,i)=>o.some(i)),((e,t)=>o.some(t)))),M.skipBy(o.getEq(Hi.W.Item.eq)))}var hn=i(61586);function gn(e){return new hn.c((t=>{const i=new c.y,n=new l.B7;let s=o.none;return i.add(e.asyncCheckFinishedMessage.subscribe((t=>{s=o.some(e.extractScore(t)),n.next(t)}))),i.add(e.asyncChecksEnabled.pipe(I.F(),d.n((t=>t?Li.h(e.textUpdated.pipe(R.T((()=>o.some({checking:!0,lastScore:s})))),n.pipe(R.T((t=>e.extractScore(t))),R.T((e=>o.some({checking:!1,lastScore:o.some(e)}))))).pipe(ut.Z(o.some({checking:!0,lastScore:s}))):u.of(o.none))),M.skipBy(o.getEq(U.OW({checking:U.zF,lastScore:o.getEq(e.scoreEq)})))).subscribe(t)),()=>i.unsubscribe()}))}function fn(e){return"gButton:plagiarism"===e.content.type}class vn{constructor(e){this._params=e,this._subs=new c.y,this._sourceCount=f.s.create(o.none),this._hasPlagiarismUphookSuggestions=f.s.create(!1),this._citationDropdown=f.s.create(o.none),this._plagiarismEntryPoint=f.s.create(o.none),this._plagiarismFeed=this._params.feedManager.feeds.view((e=>o.fromNullable(e.get(Hi.W.Item.Id.from($i.plagiarismFeed))))).view(o.map((e=>e.feed))),this._plagiarismCheckingState=f.s.create(o.none),this._aiDetectorCheckingState=f.s.create(o.none),this._logger=this._params.logService.getLogger(vn.name),this._smartUphookTreatment=f.s.create(null),this.smartUphookEnabled=f.s.combine(this._params.userViewModel.isPremium,this._params.userViewModel.isPlagiarismDisabled,this._smartUphookTreatment,((e,t,i)=>!e&&!t&&"test"===i)),this.state=this._params.isPlagiarismEnabled?f.s.combine(this._plagiarismCheckingState,this._aiDetectorCheckingState,this._sourceCount,this._citationDropdown,this._params.userViewModel.isPlagiarismDisabled,this._params.aiDetectorEnabled,((e,t,i,n,s,r)=>o.toNullable(r)?(0,a.pipe)(k.Jq(o.option)({plagiarismCheckingState:e,aiDetectorCheckingState:t}),o.map((({plagiarismCheckingState:{checking:e,lastScore:t},aiDetectorCheckingState:{checking:s,lastScore:r}})=>({checking:s||e,originality:t,sourceCount:i,citationDropdown:n,aiDetectorScore:r}))),o.filter((()=>!s)),(e=>({kind:"plagiarismAndAiDetector",state:e}))):(0,a.pipe)(e,o.map((({checking:e,lastScore:t})=>({checking:e,originality:t,sourceCount:i,citationDropdown:n}))),o.filter((()=>!s)),(e=>({kind:"plagiarismOnly",state:e}))))):this._params.aiDetectorEnabled.view((e=>({kind:o.toNullable(e)?"plagiarismAndAiDetector":"plagiarismOnly",state:o.none}))),this._showPlagiarismDetectedAction=f.s.combine(this.smartUphookEnabled,this._hasPlagiarismUphookSuggestions,this.state,((e,t,i)=>(0,a.pipe)(i.state,o.exists((i=>{const n=(0,a.pipe)(i.originality,o.getOrElse((()=>1)));return e&&t&&n<=.95}))))),this.plagiarismAction=this._params.isPlagiarismEnabled?f.s.combine(this._plagiarismEntryPoint,this._showPlagiarismDetectedAction,this._params.userViewModel.isPlagiarismDisabled,this._params.aiDetectorEnabled,((e,t,i,n)=>(0,a.pipe)(e,o.map((()=>J.createPlagiarismAction({isPlagiarismSmartUphook:t,isAiDetectorEnabled:!0===o.toNullable(n)}))),o.filter((()=>!i))))):f.s.create(o.none),this._subs.add(mn(this._params.sduiItemsCollectionDiff,fn).subscribe((e=>this._plagiarismEntryPoint.set(e)))),this._subs.add(un({feedManager:this._params.feedManager,feedActionService:this._params.feedActionService,routingViewModel:this._params.routingViewModel,entryPointClicked:Li.h(this._params.assistantUIActions.pipe(m.p((0,j.M4)(ft.t.is(ft.t.Kind.actionBrickClick),(e=>"regularAction"===e.action.kind&&J.isPlagiarismAction(e.action.action))))),this._params.plagiarismDeepLinkRequest).pipe(P.M((()=>this._logSmartUphookTreatment()))),canExecuteEntryPointAction:()=>this._params.userViewModel.isPremium.get()||this.smartUphookEnabled.get()?this._plagiarismEntryPoint.pipe(m.p(o.isSome),h.s(1)):u.of(o.none),feedId:Hi.W.Item.Id.from($i.plagiarismFeed),sduiDisableCheckAction:{type:"disablePlagiarismCheck"},view:{kind:"plagiarism"}})),this._subs.add(gn({extractScore:e=>e.outcomeScores.Originality,asyncChecksEnabled:Ct.zV([this._params.plagiarismChecksEnabled,this.smartUphookEnabled]).pipe(R.T((([e,t])=>e||t))),asyncCheckFinishedMessage:this._params.lastAsyncCheckFinishedMessage.pipe(m.p(ee.Bw.AsyncCheckFinished.isPlagiarism)),textUpdated:this._params.textUpdated,scoreEq:U.US}).subscribe((e=>this._plagiarismCheckingState.set(e)))),this._subs.add(gn({extractScore:e=>e.outcomeScores.ai_detector_score,asyncChecksEnabled:Ct.zV([this._params.plagiarismChecksEnabled,this._params.aiDetectorEnabled]).pipe(R.T((([e,t])=>e&&!0===o.toNullable(t)))),asyncCheckFinishedMessage:this._params.lastAsyncCheckFinishedMessage.pipe(m.p(ee.Bw.AsyncCheckFinished.isAiDetector)),textUpdated:this._params.textUpdated,scoreEq:U.US}).subscribe((e=>this._aiDetectorCheckingState.set(e)))),this._subs.add(this._plagiarismFeed.view(o.chain((e=>{var t,i;for(const n of dn.cK.traverse(e.content))if("tooltip"===n.type){const e=null===(i=null===(t=/from (?<sources>\d+) sources on the web/.exec(n.text))||void 0===t?void 0:t.groups)||void 0===i?void 0:i.sources;if(void 0!==e)return(0,a.pipe)(o.fromNullable(Number.parseInt(e,10)),o.filter((e=>Number.isSafeInteger(e))))}return o.none}))).subscribe((e=>this._sourceCount.set(e)))),this._subs.add(this._plagiarismFeed.view(o.chain((e=>{var t;for(const i of dn.cK.traverse(e.content))if("selectableDropDownMenu"===i.type&&"citation-style"===(null===(t=i.name)||void 0===t?void 0:t.value))return o.some(i);return o.none}))).subscribe((e=>this._citationDropdown.set(e)))),this._subs.add(this.smartUphookEnabled.pipe(m.p(a.identity),d.n((()=>this._params.suggestionCountViewModel.getFeedSuggestionCount($i.plagiarismFeed)))).subscribe((e=>{this._hasPlagiarismUphookSuggestions.set(e>0)}))),(0,Ce.s)("peekSmartPlagiarismUphookTreatment",(0,a.pipe)(this._params.experimentService&&!this._params.userViewModel.isPremium.get()?this._params.experimentService.peekTreatment(Re.r.SmartPlagiarismUphook):A.pG(null),A.qE((e=>new Error(e)))),this._logger,(e=>this._smartUphookTreatment.set(e)))}seeAllSuggestions(){this._params.routingViewModel.popUntil((e=>"home"===e.kind))}onCitationDropdownSelect(e,t){(0,a.pipe)(this._plagiarismFeed.get(),o.map((i=>{this._params.feedActionService.processActions(e,i.id,i.alertIds,t),this._params.trackingService.plagiarismCitationsStyleChanged(t)})))}onCitationDropdownOpen(e){this._params.trackingService.plagiarismCitationsStyleDropdownOpened(e)}_logSmartUphookTreatment(){const e=this._smartUphookTreatment.get();null!==e&&this._logTreatment(Re.r.SmartPlagiarismUphook,e)}_logTreatment(e,t){(0,Ce.s)("logExperimentTreatment",(0,a.pipe)(this._params.experimentService?this._params.experimentService.logTreatment(e,t):A.kb("No experiment service"),A.qE((e=>new Error(e)))),this._logger)}dispose(){this._subs.unsubscribe()}}var _n=i(28600);class bn{constructor(e){this._params=e,this._disposed=new l.B7,this._writingExpertChecksEnabled=f.s.create(!1),this.writingExpertChecksEnabled=this._writingExpertChecksEnabled.view()}enableWritingExpertChecks(){Ui.H(this._params.capiService.toggle_checks({checks:{writing_expert_check:!0}})()).pipe(h.s(1),_n.Q(this._disposed)).subscribe((()=>this._writingExpertChecksEnabled.set(!0)),(e=>function(e){return{kind:"error",source:"revision",name:"enableWritingExpertCheckFailed",data:e}}({reason:(0,ke.$)(e).message})))}disableWritingExpertChecks(){Ui.H(this._params.capiService.toggle_checks({checks:{writing_expert_check:!1}})()).pipe(h.s(1),_n.Q(this._disposed)).subscribe((()=>this._writingExpertChecksEnabled.set(!1)),(e=>function(e){return{kind:"error",source:"revision",name:"disableWritingExpertCheckFailed",data:e}}({reason:(0,ke.$)(e).message})))}dispose(){this._disposed.next(void 0),this._disposed.complete()}}var yn=i(6320),kn=i(30386);const Sn=()=>yn.KH();function Cn(e){return(0,a.pipe)(Sn().unwrap(e),(({items:e})=>e.size))}function En(e){return(0,a.pipe)(Sn().unwrap(e),(({items:t})=>(0,a.pipe)(function(e){return(0,a.pipe)(Sn().unwrap(e),(({order:e})=>Kn(e)))}(e),C.Tj((e=>o.fromNullable(t.get(e)))),C.oE)))}function wn(e){return(0,a.pipe)(Sn().unwrap(e),(({items:e,order:t})=>(0,a.pipe)(t.focus,o.chain((t=>o.fromNullable(e.get(t)))))))}function An(e){return(0,a.pipe)(Sn().unwrap(e),(({order:e})=>(0,a.pipe)(e.focus,o.map((()=>e.lefts.length)))))}function In(e){return(0,a.flow)(Sn().unwrap,(({items:t,order:i})=>({items:t,order:(0,a.pipe)(i.focus,o.fold((()=>Fn(i.lefts.concat(i.rights),o.some(e))),(t=>function(t,i){const n=(i.lefts.length,e);return Fn(Kn(i),o.some(n))}(0,Rn(i.lefts,o.some(t),i.rights)))),o.getOrElse((()=>i)))})),Sn().wrap)}function xn(e){return(0,a.pipe)(Sn().unwrap(e).order.lefts.length,(t=>(0,a.pipe)(e,In(t+1))))}function Tn(e){return(0,a.pipe)(Sn().unwrap(e).order.lefts.length,(t=>(0,a.pipe)(e,In(t-1))))}function Fn(e,t){return C.Im(e)||(0,a.pipe)(t,o.exists((t=>C.kI(t,e))))?o.none:o.some((0,a.pipe)(t,o.fold((()=>({lefts:e,focus:o.none,rights:[]})),(t=>({lefts:(0,a.pipe)(e.slice(),C.$M(t)),focus:o.fromNullable(e[t]),rights:(0,a.pipe)(e.slice(),C.Zg(t+1))})))))}function Rn(e,t,i){return{lefts:e,focus:t,rights:i}}function Kn(e){return e.lefts.concat(C.oE([e.focus])).concat(e.rights)}function Mn(e){const t=e.lefts.length,i=e.rights.length;return Fn(e.lefts.concat(e.rights),o.some(i>0?t:t-1))}function On(e){return Fn(e.lefts.concat(e.rights),o.none)}var Nn=i(82541);function Bn(e){return"globalPart"===e.content.type&&("known"===e.content.name.kind||"unknown"===e.content.name.kind)&&e.content.name.value===Nn.A7.GlobalPartWritingExpertState}function Pn(e){var t,i;if("column"===e.content.content.type){if("error-content"===(null===(t=e.content.content.name)||void 0===t?void 0:t.value))return o.some({kind:"error-content",sduiItem:e});if("success-content"===(null===(i=e.content.content.name)||void 0===i?void 0:i.value))return o.some({kind:"success-content",sduiItem:e})}return o.none}const Dn={id:Hi.W.Item.Id.from("writing-expert-part-EMPTY"),alertIds:[],content:{id:Hi.W.Item.Id.from("writing-expert-part"),type:"globalPart",name:{kind:"known",value:Nn.A7.GlobalPartWritingExpertState},content:{id:Hi.W.Item.Id.from("writing-expert-part-EMPTY-COLUMN"),type:"column",name:{kind:"unknown",value:"success-content"},children:[{type:"block",id:"6",parts:[{type:"text",selectable:!1,id:"5",meta:{},text:"Something went wrong. Please, try again later.",textColor:"CoreNeutral90",format:[]}],name:{kind:"unknown",value:"alignment-block"},spacing:{top:"0",right:"0",bottom:"0.5",left:"0"},horizontalAlign:"center",verticalAlign:"middle"}]}}};var Ln,Un;function jn(e){return"gButton:writingExpert"===e.content.type}!function(e){let t;!function(e){e.empty="empty",e.error="error",e.nonEmpty="nonEmpty",e.loadingEvaluationAndSuggestions="loadingEvaluationAndSuggestions",e.nonEmptyLoadingEvaluation="nonEmptyLoadingEvaluation",e.evaluationFinishedLoadingSuggestions="evaluationFinishedLoadingSuggestions"}(t=e.Kind||(e.Kind={})),e.isIdle=function(e){return e===t.empty||e===t.error||e===t.nonEmpty},e.isError=function(e){return e.kind===t.error},e.isEmpty=function(e){return e.kind===t.empty},e.isNonEmpty=function(e){return e.kind===t.nonEmpty},e.isLoadingEvaluationAndSuggestions=function(e){return e.kind===t.loadingEvaluationAndSuggestions},e.isEvaluationFinishedLoadingSuggestions=function(e){return e.kind===t.evaluationFinishedLoadingSuggestions},e.isNonEmptyLoadingEvaluation=function(e){return e.kind===t.nonEmptyLoadingEvaluation}}(Ln||(Ln={})),function(e){e.isIdle=e=>"idle"===e.kind,e.isZero=e=>"zero"===e.kind,e.isLoadingEvaluation=e=>"loadingEvaluation"===e.kind,e.isLoadingSuggestions=e=>"loadingSuggestions"===e.kind}(Un||(Un={}));const Vn=Hi.W.Item.Id.from($i.writingExpertFeed);class $n{constructor(e){this._params=e,this._subs=new c.y,this._writingExpertEntryPoint=f.s.create(o.none),this._checkingState=f.s.create(o.none),this._globalPartState=f.s.create(o.none),this._writingExpertFeed=this._params.feedManager.feeds.view((e=>o.fromNullable(e.get(Vn)))),this._feedManagerFeed=this._params.feedManager.feed.view(o.filter((e=>e.id===Vn))),this.writingExpertAction=this._params.isWritingExpertEnabled?f.s.combine(this._writingExpertEntryPoint,this._params.userViewModel.isPremium,((e,t)=>(0,a.pipe)(e,o.filter((()=>t)),o.map((()=>J.createWritingExpertAction()))))):f.s.create(o.none),this._evaluationState=f.s.create({kind:"zero"}),this._state=f.s.create({kind:Ln.Kind.loadingEvaluationAndSuggestions}),this.state=this._state.view(),this._logger=this._params.logService.getLogger("WritingExpertViewModelImpl"),this._params.isWritingExpertEnabled&&(this._subs.add(mn(this._params.sduiItemsCollectionDiff,jn).subscribe((e=>this._writingExpertEntryPoint.set(e)))),this._subs.add(mn(this._params.sduiItemsCollectionDiff,Bn).subscribe((e=>(0,a.pipe)(e,o.chain(Pn),o.fold((()=>{this._logger.debug("globalPartState not changed, failed to extract",e)}),(e=>{this._globalPartState.set(o.some(e)),this._logger.debug("globalPartState changed",e)})))))),this._subs.add(un({feedManager:this._params.feedManager,feedActionService:this._params.feedActionService,routingViewModel:this._params.routingViewModel,entryPointClicked:this._params.assistantUIActions.pipe(m.p((0,j.M4)(ft.t.is(ft.t.Kind.actionBrickClick),(e=>"regularAction"===e.action.kind&&J.isWritingExpertAction(e.action.action))))),canExecuteEntryPointAction:()=>this._writingExpertEntryPoint.pipe(m.p(o.isSome),h.s(1)),feedId:Hi.W.Item.Id.from($i.writingExpertFeed),sduiDisableCheckAction:{type:"disableWritingExpertCheck"},view:{kind:"writingExpert"}})),this._subs.add(gn({extractScore:()=>null,asyncChecksEnabled:this._params.writingExpertChecksEnabled,asyncCheckFinishedMessage:this._params.lastAsyncCheckFinishedMessage.pipe(m.p((e=>"writing_expert_check"===e.check))),textUpdated:D.w,scoreEq:U.w_}).subscribe((e=>this._checkingState.set(e)))),this._subs.add(f.s.combine(this._checkingState,this._writingExpertFeed,((e,t)=>{const i=(0,a.pipe)(t,o.map((e=>e.feed)));return this._logger.debug("evaluationState recalculation....",e,i),(0,a.pipe)(e,o.map((e=>{const t=function(e){return(0,a.pipe)(e,o.chain((e=>o.fromNullable(e.content.footer))),o.chain((e=>{let t;for(const i of dn.cK.traverse(e))if("text"===i.type&&i.text.length>0){if(t)return o.some({title:t,subTitle:i.text});t=i.text}return t?o.some({title:t,subTitle:""}):o.none})))}(i);this._logger.debug("trying to extract evaluation result",t);const n=this._evaluationState.get();return!0===e.checking?o.isSome(t)&&Un.isLoadingEvaluation(n)?{kind:"loadingSuggestions",evaluationResult:L.$v(t)}:{kind:"loadingEvaluation"}:o.isSome(t)?{kind:"idle",evaluationResult:L.$v(t)}:{kind:"zero"}})),o.getOrElse((()=>({kind:"zero"}))))})).subscribe((e=>{this._evaluationState.set(e),this._logger.debug("evaluationState changed",e)}))),this._subs.add(this._params.routingViewModel.activeView.view("kind").pipe(I.F(),Ht.J(),P.M((([e,t])=>{"home"===e&&"writingExpert"===t&&this.submitWritingExpertFeedback(T.Mq.FEED_OPENED),"writingExpert"===e&&this.submitWritingExpertFeedback(T.Mq.FEED_CLOSED)}))).subscribe()),this._subs.add(Ct.zV([this._feedManagerFeed,this._evaluationState,this._globalPartState]).pipe(R.T((([e,t,i])=>(this._logger.debug("state recalculation....",e,t,i),function(e,t,i){return(0,a.pipe)(e,o.fold((()=>({kind:Ln.Kind.loadingEvaluationAndSuggestions})),(e=>(0,a.pipe)(i,o.filter((({kind:e})=>"error-content"===e)),o.isSome)&&(Un.isIdle(t)||Un.isZero(t))?{kind:Ln.Kind.error,sduiItem:(0,a.pipe)(i,o.map((({sduiItem:e})=>e)),L.$v)}:Cn(e.collection)>0?Un.isIdle(t)||Un.isLoadingSuggestions(t)?{kind:Ln.Kind.nonEmpty,evaluationResult:t.evaluationResult}:{kind:Ln.Kind.nonEmptyLoadingEvaluation}:Un.isIdle(t)||Un.isZero(t)?(0,a.pipe)(i,o.map((({kind:e,sduiItem:t})=>{switch(e){case"error-content":return{kind:Ln.Kind.error,sduiItem:t};case"success-content":return{kind:Ln.Kind.empty,sduiItem:t};default:return(0,g.AS)(e)}})),o.getOrElse((()=>({kind:Ln.Kind.loadingEvaluationAndSuggestions})))):Un.isLoadingEvaluation(t)?{kind:Ln.Kind.loadingEvaluationAndSuggestions}:{kind:Ln.Kind.evaluationFinishedLoadingSuggestions,evaluationResult:t.evaluationResult})))}(e,t,i)))),Gt.W((e=>(this._logger.error("Exception in state recalculation",e),u.of({kind:Ln.Kind.error,sduiItem:Dn}))))).subscribe((e=>{this._logger.debug("state changed",e),this._state.set(e)}),(e=>{this._logger.error("Exception in state recalculation, subscription ended",e)}),(()=>{this._logger.debug("state recalculation subscription completed")}))))}submitWritingExpertFeedback(e){(0,Ce.s)("submitWritingExpertFeedback",this._params.capiService.feedback({type:T.Sm.WritingExpert,weStage:e}))}seeAllSuggestions(){this._params.routingViewModel.popUntil((e=>"home"===e.kind))}tryAgain(){this.submitWritingExpertFeedback(T.Mq.TRY_AGAIN)}dispose(){this._subs.unsubscribe()}}var Hn=i(35749),Zn=i(35413),Gn=i(71195);class Wn{constructor(e){this._params=e,this._logger=this._params.logService.getLogger(Wn.name),this._subs=new c.y,this._alertIds=new Set,this._changes=new l.B7,this.changes=Hn.x(Zn.v((()=>u.of(Array.from(this._alertIds).map(Gn.BG)))),this._changes).pipe(m.p(C.J_)),this._subs.add((0,Se.b)(this._params.alertCollectionChanges).subscribe({next:e=>this._processChanges(e),complete:()=>this._changes.complete()}))}hasAlert(e){return this._alertIds.has(e)}_processChanges(e){for(const t of e)(0,Gn.L1)(t)?this._alertIds.add(t.alertId):(0,Gn.x9)(t)?this._alertIds.delete(t.alertId):(0,g.AS)(t);e.length>0&&this._logger.debug("Alert collection change.",new Set(this._alertIds)),this._changes.next(e)}dispose(){this._subs.unsubscribe(),this._changes.complete()}}var zn=i(41139),qn=i(82549),Qn=i(71814);class Jn{constructor(e){this._params=e,this._logger=this._params.logService.getLogger(Jn.name),this._subs=new c.y;const t=this._params.sduiActions.pipe((0,a.flow)(M.shareReplay({bufferSize:1,refCount:!0}),(e=>e.pipe(zn.r(e.pipe($t.B(0))))))),i=t.pipe(m.p((e=>e.some((e=>"notify"===e.type&&e.userAction===Nn.nm.Click))&&e.some((e=>"nextCard"===e.type||"prevCard"===e.type)))),ct.u(!0)),n=t.pipe(m.p((e=>e.some((e=>"positionedClick"===e.type&&"collapsedCard"===e.source)))),ct.u(!0)),s=t.pipe(m.p((e=>e.some((e=>"notify"===e.type&&e.userAction===Nn.nm.Click))&&e.some((e=>"removeRoot"===e.type)))),ct.u(!0));this._subs.add(Li.h(i,n,s).pipe(Pi.QE(qn.E),Ot.E(this._params.activeFeed),R.T((([e,t])=>(0,a.pipe)(t,o.chain((e=>wn(e.collection))),o.chain((e=>C.d5(e.alertIds)))))),N.oE,d.n((e=>(this._logger.info(`Scrolling alert ${e} into view`),(0,Se.b)(this._params.alertService.scrollAlertIntoView({alertId:e})).pipe(h.s(1),Qn.w(),Gt.W((t=>u.of(function(e){return{kind:"error",source:"revision",name:"scrollAlertIntoViewFailed",data:e}}({scrollAlertIntoViewInfo:{alertId:e},reason:(0,ke.$)(t).message}))))))))).subscribe((e=>{this._params.logService.logEvent(e)})))}dispose(){this._subs.unsubscribe()}}var Yn=i(92051),Xn=i(30396);function es(e){var t;try{return"strongAlertRef"===e.type&&"known"===(null===(t=e.name)||void 0===t?void 0:t.kind)&&e.name.value===Nn.A7.StrongAlertRefUpgradeHook||"longFormCard"===e.type&&e.behaviors.some((e=>{var t;return"behavior:strongAlertRef"===e.type&&"known"===(null===(t=e.name)||void 0===t?void 0:t.kind)&&e.name.value===Nn.A7.StrongAlertRefUpgradeHook}))}catch(e){return!1}}class ts{constructor(e){var t,i,n,s;this._params=e,this._subs=new c.y,this._logger=this._params.logService.getLogger(ts.name),this._feedMounted=f.s.create(!1),this._subs.add((0,a.pipe)((t=this._feedMounted,i=this._params.focusedItem,n=this._params.activeFeedChanges,s=this._params.resetEmphasizedAlerts,Li.h(t.pipe(I.F(),R.T((e=>({kind:"activeFeedMounted",mounted:e})))),i.pipe(R.T(o.map((e=>e.id))),M.skipBy(o.getEq(Hi.W.Item.Id.eq)),R.T((e=>({kind:"focusedItem",itemId:o.toNullable(e)})))),s.pipe(R.T((e=>({kind:"resetEmphasizedAlerts",alerts:e})))),n.pipe(R.T((e=>Object.assign({kind:"activeFeedChanges"},e))))).pipe(Xn.S(((e,t)=>{var i,n,s,r,l,c;let d=e.upgradeHookItemId,u=!1;if("resetEmphasizedAlerts"===t.kind)e.visibilityState.forEach(((i,n)=>{"emphasized"!==i||t.alerts.has(n)||(e.visibilityState.set(n,"visible"),e.alertsToUpdate.add(n))})),t.alerts.forEach((t=>{const i=Hi.W.AlertId.from(t);e.visibilityState.set(i,"emphasized"),e.alertsToUpdate.add(i)}));else if("focusedItem"===t.kind)if(null===t.itemId){const t=null!==d&&d===e.focusedItemId,s=null!==e.focusedItemId&&null!==(n=null===(i=e.items.get(e.focusedItemId))||void 0===i?void 0:i.alertIds)&&void 0!==n?n:[];s.length>0&&s.forEach((i=>{e.visibilityState.set(i,t?"hidden":"visible"),e.alertsToUpdate.add(i)}))}else{const i=new Set(null!==e.focusedItemId&&null!==(r=null===(s=e.items.get(e.focusedItemId))||void 0===s?void 0:s.alertIds)&&void 0!==r?r:[]),n=new Set(null!==(c=null===(l=e.items.get(t.itemId))||void 0===l?void 0:l.alertIds)&&void 0!==c?c:[]),o=w.iv(Hi.W.AlertId.eq)(i)(n);w.iv(Hi.W.AlertId.eq)(n)(i).forEach((t=>{const i=e.alertsToItems.get(t),n=null!==d&&i&&1===i.size&&i.has(d);e.visibilityState.set(t,n?"hidden":"visible"),e.alertsToUpdate.add(t)})),o.forEach((t=>{e.visibilityState.set(t,"emphasized"),e.alertsToUpdate.add(t)}))}else if("activeFeedChanges"===t.kind){if(t.feedChanged){for(const t of e.visibilityState.values())if("hidden"!==t){u=!0;break}e.items.clear(),e.alertsToItems.clear(),e.alertsToUpdate.clear(),e.visibilityState.clear()}(0,a.pipe)(t.itemsChanges,pn.b.forEach(((t,i)=>e.items.delete(i)),((t,i,n)=>{e.items.set(n,i),d=es(i.content)?n:d}),((t,i)=>{e.items.set(i,t),d=es(t.content)?i:d}))),(0,a.pipe)(t.alertsToItemsChanges,pn.b.forEach(((t,i)=>{e.visibilityState.set(i,"hidden"),e.alertsToUpdate.add(i),e.alertsToItems.delete(i)}),((t,i,n)=>{const s=null!==e.upgradeHookItemId&&t.has(e.upgradeHookItemId)&&1===t.size,r=null!==d&&i.has(d)&&1===i.size,o=null!==e.focusedItemId&&t.has(e.focusedItemId),a=null!==e.focusedItemId&&i.has(e.focusedItemId);!o&&a?(e.visibilityState.set(n,"emphasized"),e.alertsToUpdate.add(n)):o&&!a?(e.visibilityState.set(n,null!==d&&1===i.size&&i.has(d)?"hidden":"visible"),e.alertsToUpdate.add(n)):!s&&r?(e.visibilityState.set(n,"hidden"),e.alertsToUpdate.add(n)):s&&!r&&(e.visibilityState.set(n,"visible"),e.alertsToUpdate.add(n)),e.alertsToItems.set(n,i)}),((t,i)=>{const n=null!==e.focusedItemId&&t.has(e.focusedItemId),s=null!==d&&1===t.size&&t.has(d);n?(e.visibilityState.set(i,"emphasized"),e.alertsToUpdate.add(i)):s||(e.visibilityState.set(i,"visible"),e.alertsToUpdate.add(i)),e.alertsToItems.set(i,t)})))}else if("activeFeedMounted"===t.kind){const i=(0,a.pipe)(Array.from(e.visibilityState.entries()),C.pb((([e,t])=>"hidden"!==t))),n=t.mounted&&i.length>0?(0,a.pipe)(i,C.Tj((([e,t])=>({alertId:e,visibility:t}))),(e=>o.some({changes:e,isReset:!0}))):!t.mounted&&i.length>0?o.some({changes:[],isReset:!0}):o.none;return Object.assign(Object.assign({},e),{feedMounted:t.mounted,alertsToUpdate:new Set,output:n})}const p=e.feedMounted&&(e.alertsToUpdate.size>0||"activeFeedChanges"===t.kind&&t.feedChanged&&u)?(0,a.pipe)(Array.from(e.alertsToUpdate),C.Tj((t=>(0,a.pipe)(o.fromNullable(e.visibilityState.get(t)),o.map((e=>({alertId:t,visibility:e})))))),C.oE,(e=>o.some({changes:e,isReset:"activeFeedChanges"===t.kind&&t.feedChanged}))):o.none;return Object.assign(Object.assign({},e),{upgradeHookItemId:d,focusedItemId:"focusedItem"===t.kind?t.itemId:e.focusedItemId,output:p,alertsToUpdate:o.isSome(p)?new Set:e.alertsToUpdate})}),{visibilityState:new Map,alertsToUpdate:new Set,alertsToItems:new Map,items:new Map,feedMounted:!1,upgradeHookItemId:null,focusedItemId:null,output:o.none}),R.T((e=>e.output)),N.oE)),P.M((e=>this._logger.debug("Received alert visibility changes.",e))),Yn.ZZ((({changes:e,isReset:t})=>t?(0,Se.b)(this._params.alertService.setAlertsVisibility(e)).pipe(h.s(1),Qn.w(),Gt.W((t=>u.of(function(e){return{kind:"error",source:"revision",name:"setAlertsVisibilityFailed",data:e}}({alertsVisibilityInfo:e,reason:(0,ke.$)(t).message}))))):(0,Se.b)(this._params.alertService.updateAlertsVisibility(e)).pipe(h.s(1),Qn.w(),Gt.W((t=>u.of(function(e){return{kind:"error",source:"revision",name:"updateAlertsVisibilityFailed",data:e}}({alertsVisibilityInfo:e,reason:(0,ke.$)(t).message})))))))).subscribe((e=>{this._params.logService.logEvent(e)})))}notifyFeedMount(){this._feedMounted.set(!0)}notifyFeedUnmount(){this._feedMounted.set(!1)}dispose(){this._subs.unsubscribe()}}var is=i(68745),ns=i(68101),ss=i(60246);function rs(e,t){return(0,a.pipe)(e,C.TS([],((e,i)=>i.alertIds.some((e=>t.has(e)))?[...e,i]:e)),C.di($.getDualOrd($.fromCompare(((e,i)=>{const n=e.alertIds.filter((e=>t.has(e))).length,s=i.alertIds.filter((e=>t.has(e))).length;if(n!==s)return n-s>0?1:-1;{const t=i.alertIds.length-e.alertIds.length;return t>0?1:t<0?-1:0}})))),C.d5,o.map((e=>e.id)))}class os{constructor(e){this._params=e,this._subs=new c.y,this._logger=this._params.logService.getLogger(os.name),this._activeFeed=new is.t(o.none),this._sduiCheckingFinishedOnce=this._sduiFullTextCheckingCompletedOnceProxy(),this.focusCard=this._getSelectAlertByIdRequest().pipe(d.n((e=>e?this._getFocusCardRequest(e).pipe(P.M((t=>this._logger.debug(`Focus request for card ${t} with alertId ${e}`))),R.T((e=>({kind:"focusCard",cardId:e})))):this._getFocusFirstCardRequest().pipe(P.M((()=>this._logger.debug("Focus request for first card."))),R.T((()=>({kind:"focusFirstCard"}))))))),this._subs.add(this._params.activeFeed.subscribe(this._activeFeed))}dispose(){this._subs.unsubscribe()}_getFocusCardRequest(e){return this._activeFeed.pipe(R.T((t=>(0,a.pipe)(t,o.chain((t=>rs(En(t.collection),new Set([e]))))))),N.oE,h.s(1))}_getFocusFirstCardRequest(){const e=this._activeFeed.pipe(N.oE,R.T((e=>this._params.isShortFormFeed(e)&&0===Cn(e.collection))),I.F(),m.p(a.identity)),t=this._activeFeed.pipe(M.skipBy(o.getEq(U.mJ((e=>e.id))(Hi.W.Item.Id.eq))),N.oE);return Li.h(t,e).pipe(Ot.E(this._activeFeed),d.n((([e,t])=>{var i;return K.O4(this._sduiCheckingFinishedOnce.pipe(m.p(a.identity),h.s(1)),M.timer((null===(i=o.toNullable(t))||void 0===i?void 0:i.id)===$i.lensAllSuggestionFeedShortForm?2e3:Number.MAX_SAFE_INTEGER)).pipe(d.n((()=>this._activeFeed.pipe(m.p(o.exists((e=>Cn(e.collection)>0))),ns.v((0,a.flow)(o.chain((e=>wn(e.collection))),o.isNone))))))})))}_sduiFullTextCheckingCompletedOnceProxy(){const e=new is.t(!1),t=new ss.m(1);return this._subs.add(this._params.sduiChangesSettled.subscribe(t)),this._subs.add(this._params.checkingFinishedOnce.pipe(h.s(1),d.n((()=>K.O4(M.timer(500).pipe(ct.u(!0)),t))),m.p(a.identity)).subscribe(e)),e}_getSelectAlertByIdRequest(){const e=new is.t(null);return this._subs.add((0,Se.b)(this._params.selectedAlertId).pipe(d.n((e=>e?Li.h(this._activeFeed.pipe(m.p((t=>(0,a.pipe)(t,o.chain((e=>wn(e.collection))),o.exists((t=>t.alertIds.includes(Hi.W.AlertId.from(e))))))),ct.u(null)),this._params.alertCollection.changes.pipe(m.p((t=>!!t.find((t=>(0,Gn.x9)(t)&&t.alertId===e)))),ct.u(null))).pipe(ut.Z(e)):u.of(null)))).subscribe(e)),e.pipe(ut.Z(null),I.F())}}class as{constructor(e){var t,i;this._subs=new c.y,this._autofocusNextLongFormCardOnApplyOrDismiss=f.s.create(!0),this._autofocusNextLongFormCardOnAlertRefEmpty=f.s.create(!1),this.autofocusNextLongFormCardOnApplyOrDismiss=this._autofocusNextLongFormCardOnApplyOrDismiss.view(),this.autofocusNextLongFormCardOnAlertRefEmpty=this._autofocusNextLongFormCardOnAlertRefEmpty.view(),this._subs.add(null===(t=e.autofocusNextLongFormCardOnAlertRefEmpty)||void 0===t?void 0:t.subscribe(p.H9(this._autofocusNextLongFormCardOnAlertRefEmpty))),this._subs.add(null===(i=e.autofocusNextLongFormCardOnApplyOrDismiss)||void 0===i?void 0:i.subscribe(p.H9(this._autofocusNextLongFormCardOnApplyOrDismiss)))}dispose(){this._subs.unsubscribe()}}var ls=i(91242);function cs(e){return{kind:"warn",source:"revision",name:"sduiUserActionFailed",data:e}}const ds=/^.*(@(Short|Long)).*$/;function us(e,t){const i=e.match(ds);return null!==i?e.replace(i[1],"shortForm"===t?"@Short":"@Long"):e}var ps=function(e,t,i,n){return new(i||(i=Promise))((function(s,r){function o(e){try{l(n.next(e))}catch(e){r(e)}}function a(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))};class ms{constructor(e){this._params=e,this._subs=new c.y,this._logger=this._params.logService.getLogger(ms.name),this._processedActionStatus=new l.B7,this._disposed=!1,this.processedActionStatus=this._processedActionStatus.asObservable(),this._sduiFeedManagerLifecycleOnActiveFeedEmpty(),this._sduiFeedManagerLifecycleOnActiveFeedRemoved(),this._sduiFeedManagerLifecycleOnAlertsRefEmpty()}_sduiFeedManagerLifecycleOnAlertsRefEmpty(){this._subs.add(this._params.sduiManagerProxy.onAlertsRefEmpty.subscribe((e=>(0,a.pipe)(this._params.feedManager.feed.get(),o.chain((e=>wn(e.collection))),o.filter((t=>t.id===e.sduiRootId)),L.Mi((()=>{const t=this._params.autofocusSettingsService.autofocusNextLongFormCardOnAlertRefEmpty.get(),i=e.emptyStrongAlertRef.onEmpty.filter((e=>"nextCard"!==e.type&&"prevCard"!==e.type||t));this._logger.debug("Handling alerts ref empty.",{actions:e.emptyStrongAlertRef.onEmpty,patchedActions:i,itemId:e.sduiId,autofocusNextCardOnAlertRefEmptyEnabled:t}),i.length>0&&this._processActions(i,e.sduiId,e.emptyStrongAlertRef.alertIds,e.sduiId)}))))))}_sduiFeedManagerLifecycleOnActiveFeedEmpty(){this._subs.add(this._params.feedManager.onActiveFeedEmpty.subscribe((e=>{var t;"assistantFeed"===e.content.type?this._processActions(null!==(t=e.content.onEmpty)&&void 0!==t?t:[],e.id,[],e.id):this._params.logService.logEvent({kind:"warn",source:"revision",name:"sduiFeedOnEmptyDSLActionsSkipped",data:null})})))}_sduiFeedManagerLifecycleOnActiveFeedRemoved(){this._subs.add(this._params.feedManager.onActiveFeedRemove.subscribe((e=>{"assistantFeed"===e.content.type?this._processActions(e.content.onRemove,e.id,e.alertIds,e.content.id):this._params.logService.logEvent({kind:"warn",source:"revision",name:"sduiFeedOnRemoveDSLActionsSkipped",data:null})})))}_switchViewWithinFocusedItem(e){(0,a.pipe)(this._params.feedManager.feed.get(),o.chain((e=>wn(e.collection))),o.filter((t=>e.sduiRootId!==t.id)),L.Mi((t=>this._params.sduiManagerProxy.pushSwitchView(Object.assign(Object.assign({},e),{sduiRootId:t.id})))))}_switchViewWithinCurrentFeed(e){(0,a.pipe)(this._params.feedManager.feed.get(),o.filter((({id:t})=>e.sduiRootId!==t)),L.Mi((({id:t})=>this._params.sduiManagerProxy.pushSwitchView(Object.assign(Object.assign({},e),{sduiRootId:t})))))}_onAssistantClose(){(0,a.pipe)(this._params.feedManager.feed.get(),o.chain((e=>{var t;return o.fromNullable(null===(t=this._params.feedManager.feeds.get().get(e.id))||void 0===t?void 0:t.feed)})),L.Mi((e=>{var t,i,n;(null!==(i=null===(t=e.content.onAssistantClose)||void 0===t?void 0:t.length)&&void 0!==i?i:0)>0&&this._processActions(null!==(n=e.content.onAssistantClose)&&void 0!==n?n:[],e.id,e.alertIds,e.content.id)})))}_executeAsyncCommand(e,t){return ps(this,void 0,void 0,(function*(){try{return yield we(e()),!0}catch(e){return t(e),!1}}))}_processActions(e,t,i,n){return ps(this,void 0,void 0,(function*(){const s=function(e){return e.some((e=>"notify"===e.type&&e.userAction===Nn.nm.Click))&&e.some((e=>"removeRoot"===e.type))?e.filter((e=>"nextCard"!==e.type&&"prevCard"!==e.type)):e}(e);this._logger.debug("Processing SDUI actions.",{actions:s,dslActions:e,itemId:t,alertIdsInScope:i,sourceId:n});for(const e of s){this._logger.debug("Processing SDUI action.",{action:e}),this._processedActionStatus.next({action:e,status:"pending",itemId:t});const r=yield(0,a.pipe)(e,(e=>ps(this,void 0,void 0,(function*(){var r;switch(e.type){case"notify":{const t=null!==(r=e.sourceId)&&void 0!==r?r:n,i=us(t,this._params.feedForm.get());return t!==i&&this._logger.debug("Patched user action component ID.",{componentId:t,patchedComponentId:i}),(0,a.pipe)(yield this._params.capiService.user_action({userAction:e.userAction,componentId:i})(),S.fold((i=>(this._params.logService.logEvent(this._disposed&&ls.Xb.isNotConnectedError(i)?cs({componentId:t,userAction:e.userAction,reason:(0,ke.$)(i).message}):on({componentId:t,userAction:e.userAction,reason:(0,ke.$)(i).message})),!1)),(()=>!0)))}case"applyAlerts":{const t=i.map((t=>({alertId:t,alternativeIndex:e.alternativeIndex,feedForm:this._params.feedForm.get()})));return this._executeAsyncCommand((()=>this._params.alertService.applyAlerts(t)),(e=>{this._params.logService.logEvent(sn({applyAlertsInfo:t,reason:(0,ke.$)(e).message}))}))}case"removeAlerts":{const e=s.some((e=>"applyAlerts"===e.type)),t=i.map((t=>({alertId:t,removalReason:e?"alertApplied":"other"})));return this._executeAsyncCommand((()=>this._params.alertService.removeAlerts(t)),(e=>{this._params.logService.logEvent(rn({removeAlertsInfo:t,reason:(0,ke.$)(e).message}))}))}case"removeRoot":return this._params.sduiManagerProxy.pushRemovedRoot([t,"removeRoot"]),!0;case"pushAssistantFeed":return this._params.feedManager.pushFeed(e.feedId,e.cardId),!0;case"popAssistantFeed":return this._params.feedManager.popFeed(e.fallbackFeed),!0;case"positionedClick":case"focusAssistantCard":return this._params.feedManager.focusCard("focusAssistantCard"===e.type?Hi.W.Item.Id.from(e.cardId):t),!0;case"prevCard":return this._params.feedManager.focusPrev(),!0;case"nextCard":return this._params.feedManager.focusNext(),!0;case"switchView":{const i={where:e.where,selected:e.selected,sduiRootId:t};return this._params.sduiManagerProxy.pushSwitchView(i),this._switchViewWithinFocusedItem(i),this._switchViewWithinCurrentFeed(i),!0}case"highlightAlert":return this._params.setEmphasizedAlerts([i[0]]),!0;case"openLink":return this._params.metricService.report(se(n,this._params.feedForm.get())),this._executeAsyncCommand((()=>this._params.lifecycleService.openUrl(e.url)),(e=>{this._params.logService.logEvent(ln({reason:(0,ke.$)(e).message}))}));case"upgradeToPremium":return this._params.metricService.report(re(n,this._params.feedForm.get())),this._executeAsyncCommand((()=>this._params.uphookService.executeUphook({name:"advancedIssues",slot:"shortForm"===this._params.feedForm.get()?"singleCardAssistant":"longFormAssistant",variant:"premium"})),(e=>{this._params.logService.logEvent((0,ae.Fh)({uphook:"advancedIssues",reason:(0,ke.$)(e).message}))}));case"copyToClipboard":return this._executeAsyncCommand((()=>this._params.textEditorService.copyText(e.text)),(e=>{this._params.logService.logEvent(an({reason:(0,ke.$)(e).message}))}));case"enablePlagiarismCheck":return this._params.plagiarismService.enablePlagiarismChecks(),!0;case"disablePlagiarismCheck":return this._params.plagiarismService.disablePlagiarismChecks(),!0;case"enableWritingExpertCheck":return this._params.writingExpertService.enableWritingExpertChecks(),!0;case"disableWritingExpertCheck":return this._params.writingExpertService.disableWritingExpertChecks(),!0;case"hoverStateChanged":case"transition":return!0;case"selectAlternative":case"hideHighlights":case"showHighlights":case"nativeOpenAssistant":case"openCreateSnippetModal":case"newRevision":case"interactPopover":case"closePopover":case"closeCard":case"openGrammarlyGo":case"openToneDetector":case"stopApplyingAlerts":case"openSettings":case"openFeedback":case"openPerformanceScore":case"nativeOpenUserSatisfactionFeedback":case"openLearnMore":return this._logger.warn("Processing unsupported SDUI action, this is a no-op.",{actionType:e.type}),!1;default:(0,g.AS)(e)}}))));this._processedActionStatus.next({action:e,status:r?"successful":"failed",itemId:t})}}))}processActions(e,t,i,n){return this._processActions(e,t,null!=i?i:[],null!=n?n:t)}dispose(){this._disposed=!0,this._onAssistantClose(),this._subs.unsubscribe()}}var hs=i(49490),gs=i(36916),fs=i(31691);function vs(e){return t=>{const i=_s(t.content);return!o.isNone(i)&&e.reduce(((e,t)=>!1===e?e:(0,a.pipe)(i,o.chain((e=>o.fromNullable(e[t.property]))),o.fold((()=>t.condition===Nn.TV.NotEqualTo),(e=>t.condition===Nn.TV.EqualTo?e===t.value:e!==t.value)))),!0)}}function _s(e){try{for(const t of dn.cK.traverse(e)){if("longFormCard"===t.type)return o.some(t.feedProperties);if("assistantCard"===t.type&&t.properties)return o.some(t.properties)}return o.none}catch(e){return o.none}}const bs=C.nZ(U.OW({property:U.kK,condition:U.kK,value:U.US})),ys=C.nZ(U.OW({orderBy:U.kK,direction:U.kK}));function ks(e){return e.pipe(Xn.S((({feedsState:e,items:t,alertsToItems:i},n)=>{(0,a.pipe)(n,pn.b.forEach((i=>{if(Ss(i))e.delete(i.id);else{t.delete(i.id);for(const t of e.values())t.removeItem(i)}}),((i,n)=>{if(Ss(n)){let i=e.get(n.id);i?i.updateFeed(n,t):(i=new Cs(n.id,n,t),e.set(n.id,i))}else{t.set(n.id,n);for(const t of e.values())t.updateItem(i,n)}}),(i=>{if(Ss(i))e.set(i.id,new Cs(i.id,i,t));else{t.set(i.id,i);for(const t of e.values())t.addItem(i)}})));const s=new Map(Array.from(e.entries()).map((([e,t])=>[e,{id:e,feed:t.feed,itemCount:t.itemCount,alertCount:t.alertCount,items:t.items,itemsChanges:t.getItemsChangesAndReset(),alertsToItems:t.alertsToItems,alertsToItemsChanges:t.getAlertsToItemsChangesAndReset()}])));return{feedsState:e,items:t,alertsToItems:i,output:s}}),{feedsState:new Map,items:new Map,alertsToItems:new Map,output:new Map})).pipe(R.T((({output:e})=>e)))}function Ss(e){return"assistantFeed"===e.content.type}class Cs{constructor(e,t,i){this.id=e,this.feed=t,this._filter=vs(this.feed.content.filtering),this._items=new Map,this._alertsToItems=new Map,this._itemsDiff=new Map,this._alertsToItemsDiff=new Map;for(const e of i.values())this.addItem(e)}updateFeed(e,t){const i=!bs.equals(this.feed.content.filtering,e.content.filtering);this.feed=e,i&&(this._filter=vs(e.content.filtering),this._items.forEach((e=>this.removeItem(e))),t.forEach((e=>this.addItem(e))))}addItem(e){this._filter(e)&&!this._items.has(e.id)&&(this._itemsDiff.set(e.id,gs.pG(e)),this._items.set(e.id,e),this._addAlertsForItem(e))}updateItem(e,t){const i=this._items.delete(e.id),n=this._filter(t);(i||n)&&this._itemsDiff.set(t.id,n&&i?gs.WP(e,t):n?gs.pG(t):gs.kb(e)),i&&this._removeAlertsForItem(e),n&&(this._items.set(t.id,t),this._addAlertsForItem(t))}removeItem(e){this._items.delete(e.id)&&(this._itemsDiff.set(e.id,gs.kb(e)),this._removeAlertsForItem(e))}_removeAlertsForItem(e){for(const t of e.alertIds){const i=this._alertsToItems.get(t);if(!i)return;i.delete(e.id)&&(0===i.size?(this._alertsToItems.delete(t),this._alertsToItemsDiff.set(t,gs.kb([e.id]))):this._alertsToItemsDiff.set(t,gs.WP([...i].concat(e.id),[...i])))}}_addAlertsForItem(e){var t;for(const i of e.alertIds){const n=null!==(t=this._alertsToItems.get(i))&&void 0!==t?t:new Set;if(!n.has(e.id)){const t=[...n];this._alertsToItems.set(i,n.add(e.id)),this._alertsToItemsDiff.set(i,0===t.length?gs.pG([e.id]):gs.WP(t,[...n]))}}}getItemsChangesAndReset(){const e=pn.b.fromMutation((e=>this._itemsDiff.forEach(((t,i)=>e.set(i,t)))));return this._itemsDiff.clear(),e}getAlertsToItemsChangesAndReset(){const e=pn.b.fromMutation((e=>this._alertsToItemsDiff.forEach(((t,i)=>e.set(i,(0,a.pipe)(t,gs.wu((e=>new Set(e)),(e=>new Set(e)))))))));return this._alertsToItemsDiff.clear(),e}get items(){return this._items}get alertsToItems(){return this._alertsToItems}get itemCount(){return this._items.size}get alertCount(){return this._alertsToItems.size}}var Es=i(53397),ws=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(i[n[s]]=e[n[s]])}return i};const As={show:e=>`[${e.id} - ${Cn(e.collection)} items - focus at ${o.getShow(hs.N4).show((0,a.pipe)(wn(e.collection),o.map((e=>e.id))))}]`};class Is{constructor(e){this._params=e,this._subs=new c.y,this._logger=this._params.logService.getLogger(Is.name),this._focusCommandsQueue=[],this._evalFocusCommand=new ss.m(1),this._feedStack=new is.t([]),this._feed=f.s.create(o.none),this._feedsState=new is.t(new Map),this._feeds=f.s.create(new Map),this._sduiItemsCollectionDiff=new l.B7,this._sduiFeedChanges=this._sduiFeedAddedAndRemovedObs(),this._activeFeedChanges=new l.B7,this.onActiveFeedRemove=new l.B7,this.onActiveFeedEmpty=new l.B7,this.feed=this._feed.view(),this.activeFeedChanges=this._activeFeedChanges.asObservable(),this.feeds=this._feeds.view(),this._subs.add(this._sduiItemsCollectionDiff.pipe(ks).subscribe((e=>{this._feedsState.next(e),this._feeds.set(new Map(Array.from(e.entries()).map((e=>{var[t,i]=e,{itemsChanges:n,items:s,alertsToItems:r,alertsToItemsChanges:o}=i;return[t,ws(i,["itemsChanges","items","alertsToItems","alertsToItemsChanges"])]}))))}))),this._subs.add(this._getActiveFeedChanges().subscribe(this._activeFeedChanges)),this._subs.add(this._emitOnFeedRemove()),this._subs.add(this._updateActiveFeed()),this._subs.add(this._invalidateFeedsFromStack()),this._subs.add(this.feed.subscribe((e=>this._logger.debug("Feed state changed.",o.getShow(As).show(e))))),this._subs.add(this.feeds.subscribe((e=>this._logger.debug("Feeds changed.",Array.from(e.keys()))))),this._subs.add(this._params.sduiItemsCollectionDiff.subscribe(this._sduiItemsCollectionDiff))}pushFeed(e,t,i){const n=this._feedStack.getValue(),s=this._feedsState.getValue(),r=(0,a.pipe)(o.fromNullable(t),o.filter((t=>{var i,n;return!!(null===(n=null===(i=s.get(Hi.W.Item.Id.from(e)))||void 0===i?void 0:i.items)||void 0===n?void 0:n.get(Hi.W.Item.Id.from(t)))})),o.alt((()=>{var t,n,r;return i?rs(Array.from(null!==(r=null===(n=null===(t=s.get(Hi.W.Item.Id.from(e)))||void 0===t?void 0:t.items)||void 0===n?void 0:n.values())&&void 0!==r?r:[]),i):o.none}))),l=(0,a.pipe)(this._feed.get(),o.chain((e=>wn(e.collection))),o.map((e=>e.id))),c=(0,a.pipe)(n,C.HV,o.map((({feedId:e,valid:t})=>({feedId:e,itemIdToFocus:l,valid:t}))));this._logger.debug("Pushing feed.",{feedId:e,itemIdToFocus:r}),this._feedStack.next((0,kn.lN)(n).concat(C.oE([c])).concat({feedId:Hi.W.Item.Id.from(e),itemIdToFocus:r,valid:!0}))}replaceFeed(e,t,i){const n=this._feedsState.getValue(),s=(0,a.pipe)(o.fromNullable(t),o.filter((t=>{var i,s;return!!(null===(s=null===(i=n.get(Hi.W.Item.Id.from(e)))||void 0===i?void 0:i.items)||void 0===s?void 0:s.get(Hi.W.Item.Id.from(t)))})),o.alt((()=>{var t,s,r;return i?rs(Array.from(null!==(r=null===(s=null===(t=n.get(Hi.W.Item.Id.from(e)))||void 0===t?void 0:t.items)||void 0===s?void 0:s.values())&&void 0!==r?r:[]),i):o.none})));this._logger.debug("Replacing feed.",{feedId:e,itemIdToFocus:s}),this._feedStack.next(C.Kv((0,kn.lN)(this._feedStack.getValue()),{feedId:Hi.W.Item.Id.from(e),itemIdToFocus:s,valid:!0}))}popFeed(e){const t=this._feedStack.getValue();this._logger.debug("Popping feed.",{fallbackFeed:e}),t.filter((e=>e.valid)).length>1?this._feedStack.next(function(e){const t=[...e];for(let e=t.length-1;e>=0&&!t[e].valid;--e)t.pop();return t}((0,kn.lN)(t))):(0,a.pipe)(o.fromNullable(e),o.fold((()=>{this._logger.warn("Popped feed with less than 2 valid feeds in the feed stack and no fallback feed, this is a no-op.")}),(e=>{this.pushFeed(Hi.W.Item.Id.from(e.feedId),e.cardId),this._logger.debug(`Popped feed with less than 2 valid feeds in the feed stack. Switching to fallback feed. ${JSON.stringify(e)}`)})))}focusFirst(){this._logger.debug("Focusing first card on feed."),this._focusCommandsQueue.push({kind:"focusFirst"}),this._evalFocusCommand.next()}focusCard(e){this._logger.debug("Focusing card on feed.",{itemId:e}),this._focusCommandsQueue.push({kind:"focusCard",itemId:e}),this._evalFocusCommand.next()}focusNext(){this._logger.debug("Focusing next card on feed."),this._focusCommandsQueue.push({kind:"focusNext"}),this._evalFocusCommand.next()}focusPrev(){this._logger.debug("Focusing previous card on feed."),this._focusCommandsQueue.push({kind:"focusPrev"}),this._evalFocusCommand.next()}dispose(){this._subs.unsubscribe()}_updateActiveFeed(){return this._getActiveFeedMeta().pipe(d.n(o.fold((()=>u.of(o.none)),(({ordering:e,feedId:t,itemIdToFocus:i})=>{const n=this._getFeedItemsAndChanges(t).pipe(R.T((e=>({kind:"sduiChange",diff:e})))),s=(0,a.pipe)(i,o.fold((()=>D.w),(e=>u.of({kind:"focusCard",itemId:e})))),r=(c=e,l=(0,Es.fold)($.getMonoid())(c.map((e=>(0,a.pipe)($.ordNumber,$.contramap((0,a.flow)(_s,o.chain((t=>o.fromNullable(t[e.orderBy]))),o.fold((()=>Number.MAX_VALUE),(t=>e.direction===Nn.ne.Asc?t:-1*t)))))))),$.contramap((e=>e.content))(l));var l,c;return Li.h(n,s,this._evalFocusCommand.pipe(ut.Z(null),d.n((()=>Ui.H(this._focusCommandsQueue.splice(0)))))).pipe(Xn.S(((e,i)=>(0,a.pipe)(e,"sduiChange"===i.kind?function(e,t,i=a.constTrue){return(0,a.flow)(Sn().unwrap,(n=>(0,a.pipe)(e,pn.b.reduce({items:new Map(n.items),added:new Set,updated:new Set,removed:new Set},((e,t,i)=>(e.removed.add(i),e)),((e,t,i,n)=>(e.items.set(n,i),e.updated.add(n),e)),((e,t,i)=>(e.items.set(i,t),e.added.add(i),e))),(({items:e,added:s,updated:r,removed:l})=>{const c=(0,a.pipe)(n.order.focus,o.exists((e=>l.has(e)))),d=Kn(n.order).filter((e=>!r.has(e))),u=(0,kn.zj)(d,[...r,...s],function(e,t){return $.fromCompare(((i,n)=>{const s=e.get(i),r=e.get(n);return void 0!==s&&void 0!==r?t.compare(s,r):0}))}(e,t)),p=(0,a.pipe)(u,C.pb((e=>!l.has(e)||(0,a.pipe)(n.order.focus,o.exists((t=>t===e))))));l.forEach((t=>e.delete(t)));const m=(0,a.pipe)(n.order.focus,o.fold((()=>Rn((0,a.pipe)(p,C.pb((e=>!l.has(e)))),o.none,[])),(t=>(0,a.pipe)(Fn(p,o.some(p.indexOf(t))),c?o.chain(i(e)?Mn:On):a.identity,o.getOrElse((()=>Rn((0,a.pipe)(p,C.pb((e=>!l.has(e)))),o.none,[])))))));return{items:e,order:m}}))),Sn().wrap)}(i.diff,r,(e=>1===e.size&&es(Array.from(e.values())[0].content)||this._params.autofocusNextCard(t))):a.identity,"focusNext"===i.kind?xn:a.identity,"focusPrev"===i.kind?Tn:a.identity,"focusCard"===i.kind?In(En(e).findIndex((e=>e.id===i.itemId))):a.identity,"focusFirst"===i.kind?In((0,a.pipe)(En(e),(e=>1===e.length?0:e.findIndex((e=>!es(e.content)))))):a.identity)),Sn().wrap({items:new Map,order:Rn([],o.none,[])})),R.T((e=>o.some({id:t,collection:e}))))}))),P.M((e=>this._emitOnActiveFeedEmptyIfNewFeedIsEmpty(e,this._feed.get())))).subscribe(p.H9(this._feed))}_getFeedItemsAndChanges(e){return Hn.x(u.of((0,a.pipe)(this._feedsState.getValue(),Te.$I(Hi.W.Item.Id.eq)(e),o.map((e=>e.items)),o.map((e=>pn.b.fromMutation((t=>e.forEach(((e,i)=>t.set(i,gs.pG(e)))))))))),this._feedsState.pipe(O.i(1),R.T((0,a.flow)(Te.$I(Hi.W.Item.Id.eq)(e),o.map((e=>e.itemsChanges)))))).pipe(N.oE)}_getActiveFeedChanges(){return this._feed.pipe(R.T(o.map((e=>e.id))),ut.Z(o.none),M.skipBy(o.getEq(Hi.W.Item.Id.eq)),R.T((e=>o.toNullable(k.Jq(o.option)({feedId:e,feedItems:(0,a.pipe)(e,o.chain((e=>{var t;return o.fromNullable(null===(t=this._feedsState.getValue().get(e))||void 0===t?void 0:t.items)}))),feedAlerts:(0,a.pipe)(e,o.chain((e=>{var t;return o.fromNullable(null===(t=this._feedsState.getValue().get(e))||void 0===t?void 0:t.alertsToItems)})))})))),Ht.J(),d.n((([e,t])=>null===t?null===e?D.w:u.of({feedChanged:!0,itemsChanges:pn.b.empty(),alertsToItemsChanges:pn.b.empty()}):Hn.x(u.of({feedChanged:!0,itemsChanges:pn.b.fromMutation((e=>{for(const i of t.feedItems.values())e.set(i.id,gs.pG(i))})),alertsToItemsChanges:pn.b.fromMutation((e=>{for(const[i,n]of t.feedAlerts.entries())e.set(i,gs.pG(n))}))}),this._feedsState.pipe(O.i(1),R.T((0,a.flow)(Te.$I(Hi.W.Item.Id.eq)(t.feedId),o.map((e=>({feedChanged:!1,itemsChanges:e.itemsChanges,alertsToItemsChanges:e.alertsToItemsChanges})))))).pipe(N.oE)))),m.p((e=>e.feedChanged||!pn.b.isEmpty(e.itemsChanges)||!pn.b.isEmpty(e.alertsToItemsChanges))))}_getActiveFeedMeta(){return this._feedStack.pipe(R.T((0,kn.i5)((e=>e.valid))),d.n(o.fold((()=>u.of(o.none)),(e=>this._feedsState.pipe(R.T(Te.$I(Hi.W.Item.Id.eq)(e.feedId)),R.T(o.map((({feed:t})=>({ordering:t.content.ordering,feedId:t.id,itemIdToFocus:e.itemIdToFocus})))))))),M.skipBy(o.getEq(xs)))}_sduiFeedAddedAndRemovedObs(){const e=U.mJ((e=>e.id))(Hi.W.Item.Id.eq),t=this._feedsState.pipe(R.T((0,a.flow)((e=>Array.from(e.values())),C.Tj((e=>e.feed)),w.ci(e))),ut.Z(new Set),Ht.J()),i=w.iv(e),n=t.pipe(R.T((([e,t])=>i(t)(e))),fs.H((e=>Ui.H(e))),M.shareReplay({bufferSize:1,refCount:!0}));return{added:t.pipe(R.T((([e,t])=>i(e)(t))),fs.H((e=>Ui.H(e))),M.shareReplay({bufferSize:1,refCount:!0})),removed:n}}_invalidateFeedsFromStack(){const e=this._sduiFeedChanges.removed.subscribe((e=>{const t=this._feedStack.getValue();if(t.find((t=>t.feedId===e.id))){const i=t.map((t=>t.feedId===e.id?Object.assign(Object.assign({},t),{valid:!1}):t));this._feedStack.next(i)}})),t=this._sduiFeedChanges.added.subscribe((e=>{const t=this._feedStack.getValue();if(t.find((t=>t.feedId===e.id))){const i=t.map((t=>t.feedId===e.id?Object.assign(Object.assign({},t),{valid:!0}):t));this._feedStack.next(i)}}));return()=>{e.unsubscribe(),t.unsubscribe()}}_emitOnFeedRemove(){return this._sduiFeedChanges.removed.pipe(Ot.E(this._feedStack.pipe(R.T(C.HV))),m.p((([e,t])=>{var i;return(null===(i=o.toNullable(t))||void 0===i?void 0:i.feedId)===e.id})),R.T((([e,t])=>e))).subscribe(this.onActiveFeedRemove)}_emitOnActiveFeedEmptyIfNewFeedIsEmpty(e,t){(0,a.pipe)(k.Jq(o.option)({currentFeed:t,newFeed:e}),o.filter((({currentFeed:e,newFeed:t})=>e.id===t.id&&Cn(e.collection)>0&&0===Cn(t.collection))),o.chain((({currentFeed:e})=>o.fromNullable(this._feeds.get().get(e.id)))),o.map((({feed:e})=>this.onActiveFeedEmpty.next(e))))}}const xs=U.OW({feedId:Hi.W.Item.Id.eq,itemIdToFocus:o.getEq(Hi.W.Item.Id.eq),ordering:ys});class Ts extends Is{constructor(e){super(e),this._initialForm=null,this.allSuggestionsFeedId=this.feeds.view((e=>{var t,i;return(0,a.pipe)(o.fromNullable(null===(i=null===(t=e.get(Hi.W.Item.Id.from("longForm"===this._initialForm?$i.lensAllSuggestionFeed:$i.lensAllSuggestionFeedShortForm)))||void 0===t?void 0:t.feed)||void 0===i?void 0:i.id))})),this._initialForm=e.initialForm}pushFeed(e,t,i){super.pushFeed(Hi.W.Item.Id.from(e),t,i)}replaceFeed(e,t,i){super.replaceFeed(Hi.W.Item.Id.from(e),t,i)}popFeed(e){super.popFeed(null!=e?e:(0,a.pipe)(this.allSuggestionsFeedId.get(),o.map((e=>({feedId:e}))),o.toUndefined))}}class Fs{constructor(e){this._params=e,this._subs=new c.y,this._deepLinkStatus=f.s.create({available:!1,active:!1}),this.deepLinkStatusChanges=this._deepLinkStatus.view(),this._subs.add(this._focusPremiumSuggestionsUphook()),this._subs.add(this._trackPremiumSuggestionsUphookAvailability()),this._subs.add(this._deepLinkStatus.view("active").subscribe((e=>{var t,i;null===(i=(t=this._params.uphookService).notifyPremiumSuggestionsUphookFocusChanged)||void 0===i||i.call(t,e)}))),this._subs.add(this._params.routingViewModel.activeView.view((e=>"home"!==e.kind)).subscribe((()=>this._deepLinkStatus.lens("active").set(!1))))}onFocusedSDUIItemMount(e){this._deepLinkStatus.lens("active").set(es(e.content))}handleDeepLinkRequest(){this._params.routingViewModel.has({kind:"home"})&&(this._params.routingViewModel.popUntil((e=>"home"===e.kind)),(0,a.pipe)(this._params.feedManager.feeds.get(),o.fromPredicate((e=>e.has(Hi.W.Item.Id.from($i.lensPremiumFeed)))),o.fold((()=>(0,a.pipe)(this._params.feedManager.feed.get(),o.chain((({collection:e})=>this._findUphookItem(e))),o.map((e=>this._params.feedManager.focusCard(e.id))))),(()=>(this._params.feedManager.pushFeed($i.lensPremiumFeed),o.none)))))}_focusPremiumSuggestionsUphook(){var e;return(null!==(e=this._params.uphookService.requestFocusPremiumSuggestionsUphook)&&void 0!==e?e:D.w).subscribe((()=>this.handleDeepLinkRequest()))}_trackPremiumSuggestionsUphookAvailability(){const e=this._params.feedManager.feed.pipe(B.Z(100),R.T(o.exists((e=>o.isSome(this._findUphookItem(e.collection)))))),t=this._params.feedManager.feeds.pipe(R.T((e=>e.has(Hi.W.Item.Id.from($i.lensPremiumFeed)))));return Ct.zV([e,t]).pipe(R.T((([e,t])=>e||t)),P.M((e=>{var t,i;null===(i=(t=this._params.uphookService).notifyPremiumSuggestionsUphookAvailabilityChanged)||void 0===i||i.call(t,e),this._deepLinkStatus.lens("available").set(e)}))).subscribe()}_findUphookItem(e){return(0,a.pipe)(En(e),"shortForm"===this._params.feedFormViewModel.state.get().feedForm?C.Uk((e=>es(e.content))):C.i8((e=>es(e.content))))}dispose(){this._subs.unsubscribe()}}var Rs=i(12884),Ks=i(28066),Ms=i(77413),Os=i(60336),Ns=i(27180);class Bs{constructor(e){this._params=e,this._subs=new c.y,this._logger=this._params.logService.getLogger(Bs.name),this._sduiEvents=new l.B7,this._localSDUIBuffer=[],this._localSDUIBufferChanged=new l.B7,this._flush=new l.B7,this._sduiManagerFactory=()=>new Ms.Z(this._sduiEvents.asObservable(),o.fromPredicate((e=>this._params.alertCollection.hasAlert(e))),void 0,Li.h(Rs.Y(100).pipe(ut.Z(0)),this._flush.pipe(ct.u(0)))),this._sduiManager=f.s.create(this._sduiManagerFactory()),this._state=f.s.create(this._sduiManager.get().state.get()),this._sduiReset=new l.B7,this._sduiItemCollectionChanges=new l.B7,this._sduiChangesSettled=new is.t(!1),this.sduiReset=this._sduiReset.asObservable(),this.state=this._state.view(),this.onAlertsRefEmpty=(0,a.pipe)(this._sduiManager.view((e=>e.onAlertsRefEmpty)),Ks.w()),this.sduiChangesSettled=this._sduiChangesSettled.pipe(I.F()),this._sduiProcessingSub=null,this._subs.add(this._processAlertChanges()),this._subs.add(this._processInboundSDUIMessages(this._sduiItemCollectionChanges)),this._subs.add(this._computeSDUIChangesSettled().subscribe(this._sduiChangesSettled)),this._subs.add(this._sduiManager.pipe(d.n((e=>e.state))).subscribe(p.H9(this._state))),this._subs.add(this._sduiEvents.pipe(zn.r(this._sduiEvents.pipe($t.B(0)))).subscribe((e=>{const t=e.filter((e=>e.kind===Os.Q.SduiEventKind.Add)),i=e.filter((e=>e.kind===Os.Q.SduiEventKind.Update)),n=e.filter((e=>e.kind===Os.Q.SduiEventKind.Remove));(t.length>0||i.length>0||n.length>0)&&this._logger.debug(`Received SDUI events - insertions: [${t.map((e=>e.sduiRootId)).join(",")}] - updates: [${i.map((e=>e.sduiRootId)).join(",")}] - removals: [${n.map((e=>e.sduiRootId)).join(",")}]`)}))),this._subs.add((0,Se.b)(this._params.sduiItemCollectionChanges).subscribe(this._sduiItemCollectionChanges))}pushRemovedRoot(e){this._sduiManager.get().pushRemovedRoot(e),this._sduiManager.get().flush()}pushRemovedAlerts([e,t]){this._sduiManager.get().pushRemovedAlerts([e,t])}pushSwitchView(e){this._sduiManager.get().pushSwitchView(e)}dispose(){this._cancelSDUIBufferProcessing(),this._subs.unsubscribe(),this._sduiManager.get().dispose()}_computeSDUIChangesSettled(){const e=this._sduiManager.pipe(d.n((e=>e.unresolvedItemsQueueSize)),R.T((e=>0===e))),t=this._localSDUIBufferChanged.pipe(R.T((()=>0===this._localSDUIBuffer.length))),i=Ct.zV([e,t]).pipe(R.T((([e,t])=>e&&t)),I.F()),n=this._sduiItemCollectionChanges.pipe(R.T((e=>0===e.pendingChangesCount)),ut.Z(!0),I.F());return Ct.zV([i,n]).pipe(d.n((([e,t])=>e?t?u.of(!0):M.timer(500).pipe(ct.u(!0)):M.timer(500).pipe(ct.u(!0),ut.Z(!1)))),I.F())}_parseSDUIMessage(e,t,i=!1){return i?(0,a.pipe)(dn.cK.dslRootParser(e),S.mapLeft((e=>(this._params.logService.logEvent(function(e){return{kind:"error",source:"revision",name:"sduiDSLParseFailed",data:e}}({sduiRootId:t,reason:(0,ke.$)(e).message})),e))),o.fromEither):o.some(e)}_processInboundSDUIMessages(e){var t;return e.pipe(R.T((e=>e.changes)),nn.K(),m.p(Ps),R.T((e=>(0,Ns.Cv)(e)?(0,a.pipe)(this._parseSDUIMessage(e.sdui,e.sduiRootId),o.map((t=>({kind:Os.Q.SduiEventKind.Add,sdui:t,sduiRootId:Os.Q.RawSduiItem.Id.create(e.sduiRootId),rev:0})))):(0,Ns.av)(e)?(0,a.pipe)(this._parseSDUIMessage(e.sdui,e.sduiRootId),o.map((t=>({kind:Os.Q.SduiEventKind.Update,sdui:t,sduiRootId:Os.Q.RawSduiItem.Id.create(e.sduiRootId),rev:0})))):(0,Ns.Jd)(e)?o.some({kind:Os.Q.SduiEventKind.Remove,sduiRootId:Os.Q.RawSduiItem.Id.create(e.sduiRootId),rev:0}):(0,Ns.pp)(e)?(this._cancelSDUIBufferProcessing(),this._localSDUIBuffer=[],this._localSDUIBufferChanged.next(),this._sduiManager.modify((e=>(e.dispose(),this._sduiManagerFactory()))),this._sduiReset.next(void 0),o.none):void(0,g.AS)(e))),N.oE,null!==(t=this._params.sduiEventTransformer)&&void 0!==t?t:a.identity).subscribe((e=>{this._localSDUIBuffer.push(e),this._localSDUIBufferChanged.next(),this._startSDUIBufferProcessing()}))}_cancelSDUIBufferProcessing(){null!==this._sduiProcessingSub&&(this._sduiProcessingSub.unsubscribe(),this._sduiProcessingSub=null)}_startSDUIBufferProcessing(){null===this._sduiProcessingSub&&(this._sduiProcessingSub=this._enqueueSDUIProcessing())}_enqueueSDUIProcessing(){return M.timer(0).pipe(P.M((()=>{this._processBatchFromSDUIBuffer(),this._localSDUIBuffer.length>0?(this._cancelSDUIBufferProcessing(),this._startSDUIBufferProcessing()):this._sduiProcessingSub=null}))).subscribe()}_processBatchFromSDUIBuffer(){this._localSDUIBuffer.length>0&&(this._localSDUIBuffer.splice(0,100).forEach((e=>this._sduiEvents.next(e))),this._sduiManager.get().notifyAlertsChanged(),this._flush.next(),this._localSDUIBufferChanged.next())}_processAlertChanges(){return this._params.alertCollection.changes.subscribe((e=>{const t=e.reduce(((e,t)=>{var i;return(0,Gn.x9)(t)&&"textChange"===t.reason&&e.set("textChange",(null!==(i=e.get("textChange"))&&void 0!==i?i:[]).concat(Hi.W.AlertId.from(t.alertId))),e}),new Map);e.length>0&&(this._sduiManager.get().notifyAlertsChanged(),t.size>0&&this._logger.debug("Optimistically removing alerts.",t),t.forEach(((e,t)=>this.pushRemovedAlerts([e,t]))))}))}}function Ps(e){return"sduiItemAdd"!==e.kind&&"sduiItemUpdate"!==e.kind||!function(e,t=new Set(["inlineCard"])){return!(null==e||"object"!=typeof e||!("type"in e)||"string"!=typeof e.type||!t.has(e.type))}(e.sdui)}var Ds=i(73231);function Ls(e){return e.pipe(ut.Z(Ds.k.empty),Ht.J(),R.T((([e,t])=>Ds.k.diff(e,t))))}const Us="long-form-suggestion-card",js="long-form-lens",Vs="feed-order",$s="short-form-feed-order",Hs=(0,a.flow)(Xn.S(((e,t)=>{var i;const n=[],s=new Map(e.updatedLongFormFeeds),r=new Set(e.longFormFeedFilteringValues),l=e=>{const t=(i=s.values(),r=e,(0,a.pipe)(Array.from(i),C.x1((e=>(0,a.pipe)("assistantFeed"===e.sdui.type?o.some(e.sdui):o.none,o.map((e=>function(e,t){return Object.assign(Object.assign({},e),{filtering:[...e.filtering,{property:js,value:t,condition:Nn.TV.NotEqualTo}]})}(e,r))),o.map((t=>Object.assign(Object.assign({},e),{kind:Os.Q.SduiEventKind.Update,sdui:t}))))))));var i,r;t.forEach((e=>s.set(e.sduiRootId,e))),n.push(...t)};if(t.kind===Os.Q.SduiEventKind.Add||t.kind===Os.Q.SduiEventKind.Update)if(es(t.sdui))"longFormCard"===t.sdui.type?n.push(Object.assign(Object.assign({},t),{sdui:Gs(t.sdui)})):"strongAlertRef"===t.sdui.type&&"longFormCard"===t.sdui.child.type&&n.push(Object.assign(Object.assign({},t),{sdui:Object.assign(Object.assign({},t.sdui),{child:Gs(t.sdui.child)})}));else if("longFormCard"===t.sdui.type||"strongAlertRef"===t.sdui.type&&"longFormCard"===t.sdui.child.type){const e=null!==(i=("longFormCard"===t.sdui.type?t.sdui.feedProperties:"strongAlertRef"===t.sdui.type&&"longFormCard"===t.sdui.child.type?t.sdui.child.feedProperties:{})[js])&&void 0!==i?i:void 0;void 0===e||r.has(e)||l(e),"longFormCard"===t.sdui.type?n.push(Object.assign(Object.assign({},t),{sdui:Ws(t.sdui)})):"strongAlertRef"===t.sdui.type&&"longFormCard"===t.sdui.child.type&&n.push(Object.assign(Object.assign({},t),{sdui:Object.assign(Object.assign({},t.sdui),{child:Ws(t.sdui.child)})}))}else if("assistantFeed"===t.sdui.type&&t.sdui.id===String($i.lensAllSuggestionFeed)){const e=Os.Q.RawSduiItem.Id.create($i.lensAllSuggestionFeedShortForm);n.push(t,Object.assign(Object.assign({},t),{sduiRootId:e,sdui:zs(e,t.sdui)}))}else"assistantFeed"===t.sdui.type&&(0,a.pipe)(function(e,t){var i;const n=e.filtering.find(Zs);if(n){const s=Array.from(t).filter((e=>e!==n.value));return o.some({sdui:Object.assign(Object.assign({},e),{filtering:[...e.filtering.filter((e=>!Zs(e))),...s.map((e=>({property:js,value:e,condition:Nn.TV.NotEqualTo})))]}),filteringValue:null!==(i=null==n?void 0:n.value)&&void 0!==i?i:null})}return o.none}(t.sdui,e.longFormFeedFilteringValues),o.map((({sdui:e,filteringValue:i})=>{const o=!r.has(i);r.add(i),o&&l(i),s.set(t.sduiRootId,Object.assign(Object.assign({},t),{sdui:e})),n.push(Object.assign(Object.assign({},t),{sdui:e}))})));else t.sduiRootId===String($i.lensAllSuggestionFeed)?n.push(t,Object.assign(Object.assign({},t),{sduiRootId:Os.Q.RawSduiItem.Id.create($i.lensAllSuggestionFeedShortForm)})):t.kind===Os.Q.SduiEventKind.Remove?s.delete(t.sduiRootId):(0,g.AS)(t);return{events:n.length>0?n:[t],longFormFeedFilteringValues:r,updatedLongFormFeeds:s}}),{events:[],longFormFeedFilteringValues:new Set(C.y1(0,6)),updatedLongFormFeeds:new Map}),fs.H((({events:e})=>Ui.H(e))));function Zs(e){return e.property===js&&e.condition===Nn.TV.EqualTo}const Gs=e=>Object.assign(Object.assign({},e),{feedProperties:Object.assign(Object.assign({},e.feedProperties),{[Us]:1,[Vs]:Number.MIN_SAFE_INTEGER,[$s]:Number.MAX_SAFE_INTEGER})}),Ws=e=>Object.assign(Object.assign({},e),{feedProperties:Object.assign(Object.assign({},e.feedProperties),{[$s]:e.feedProperties[Vs]})});function zs(e,t){return Object.assign(Object.assign({},t),{id:e,ordering:[{orderBy:$s,direction:Nn.ne.Asc},...t.ordering.filter((e=>e.orderBy!==Vs))]})}class qs{constructor(e){this._subs=new c.y,this._state=f.s.create({firstCheckingFinished:!1,sduiEventsSettledOnce:!1}),this._firstCheckingFinishedAndSduiEventsSettledTimedOut=f.s.create(!1),this.firstCheckingFinishedAndSduiEventsSettled=this._state.view((e=>e.firstCheckingFinished&&e.sduiEventsSettledOnce)),this.firstCheckingFinishedAndSduiEventsSettledTimedOut=this._firstCheckingFinishedAndSduiEventsSettledTimedOut.view(),this._subs.add(e.sduiChangesSettled.pipe(m.p(a.identity)).subscribe((()=>this._state.lens("sduiEventsSettledOnce").set(!0)))),this._subs.add(e.lastFinishedMessage.subscribe((()=>this._state.lens("firstCheckingFinished").set(!0))));const t=M.timer(1e4).subscribe((()=>this._firstCheckingFinishedAndSduiEventsSettledTimedOut.set(!0)));this._subs.add(t),this._subs.add(this.firstCheckingFinishedAndSduiEventsSettled.pipe(m.p(a.identity)).subscribe((()=>t.unsubscribe())))}dispose(){this._subs.unsubscribe()}}const Qs={[$i.lensAllSuggestionFeed]:"all-suggestions",[$i.lensAllSuggestionFeedShortForm]:"all-suggestions",[$i.lensCorrectnessFeed]:"correctness",[$i.lensClarityFeed]:"clarity",[$i.lensDeliveryFeed]:"delivery",[$i.lensEngagementFeed]:"engagement",[$i.lensStyleGuideFeed]:"style-guide",[$i.lensPremiumFeed]:"premium",[$i.plagiarismFeed]:"plagiarism",[$i.writingExpertFeed]:"writing-expert"};function Js(e){return(0,a.pipe)(Wi(e.id),o.map((e=>Qs[e])))}class Ys{constructor(e){this._params=e,this._feedForm=f.s.create(this._params.supportedForms[0]),this.requestedSupportedForms=this._params.supportedForms,this.state=f.s.combine(this._feedForm,this._params.feedManager.feeds,((e,t)=>({feedForm:e,supportedForms:(0,a.pipe)(new Set(this._params.supportedForms),w.pb((e=>t.has(Hi.W.Item.Id.from(zi[e])))))})))}onToggleFeedForm(e){this._feedForm.set(e);const t=this._params.feedManager.feed.get();this._params.tracking.feedFormChanged(e,(0,a.pipe)(t,o.chain(Js),o.toNullable),(0,a.pipe)(t,o.map((e=>Cn(e.collection))),o.toNullable));const i=(0,a.pipe)(t,o.chain((e=>wn(e.collection))));this._params.feedManager.replaceFeed("longForm"===e?$i.lensAllSuggestionFeed:$i.lensAllSuggestionFeedShortForm,(0,a.pipe)(i,o.fold((()=>{}),(e=>e.id))),(0,a.pipe)(i,o.chain((e=>dn.cK.getAlertIds(e.content))),o.fold((()=>{}),(e=>new Set(e)))))}}var Xs=i(82094);function er(e){return(0,a.pipe)(e,o.chain((e=>(0,a.pipe)(e.content.content,Xs.$I("text"),o.map(Number),o.filter((e=>!Number.isNaN(e)))))))}function tr(e){return"globalPart"===e.content.type&&"premium-suggestions-counter"===e.content.id}function ir(e){return"premiumFeedLens"===e.kind}const nr=[$i.lensAllSuggestionFeed,$i.lensCorrectnessFeed,$i.lensClarityFeed,$i.lensEngagementFeed,$i.lensDeliveryFeed,$i.lensStyleGuideFeed,$i.lensPremiumFeed];function sr(e){return{[$i.lensAllSuggestionFeed]:e($i.lensAllSuggestionFeed),[$i.lensClarityFeed]:e($i.lensClarityFeed),[$i.lensCorrectnessFeed]:e($i.lensCorrectnessFeed),[$i.lensEngagementFeed]:e($i.lensEngagementFeed),[$i.lensDeliveryFeed]:e($i.lensDeliveryFeed),[$i.lensStyleGuideFeed]:e($i.lensStyleGuideFeed),[$i.lensPremiumFeed]:e($i.lensPremiumFeed)}}class rr{constructor(e){this._params=e,this._subs=new c.y,this._outcomeScores=f.s.create(sr((()=>1))),this._styleGuideEnabled=f.s.create(!1),this._availableFeeds=f.s.create(new Map),this.premiumCounter=f.s.create(0),this._grammarlyProTreatment=f.s.create(null),this._logger=this._params.logService.getLogger(vn.name),this.lenses=f.s.combine(this._outcomeScores,this._availableFeeds,this._styleGuideEnabled,this.premiumCounter,this._grammarlyProTreatment,((e,t,i,n,s)=>(0,a.pipe)(nr,C.pb((e=>t.has(Hi.W.Item.Id.from(e)))),C.pb((e=>!!i||e!==$i.lensStyleGuideFeed)),C.Tj((t=>{var i;return t===$i.lensPremiumFeed?{kind:"premiumFeedLens",lensId:t,label:"test"===s?"Pro":Gi[t],suggestionCount:n}:{kind:"regularFeedLens",lensId:t,label:Gi[t],percent:null!==(i=e[t])&&void 0!==i?i:1}})),(e=>new Map(e.map((e=>[e.lensId,e]))))))),this._subs.add(this._params.availableFeeds.subscribe(p.H9(this._availableFeeds))),this._subs.add(this._params.userInstitutionInfo.pipe(R.T(o.exists((e=>!0===e.styleGuideEnabled)))).subscribe(p.H9(this._styleGuideEnabled))),this._subs.add(Ct.zV([this._params.lastFinishedMessage,this._availableFeeds]).subscribe((([{outcomeScores:e},t])=>{const i=function(e,t){return i=>{var n,s;const r=null===(n=e.get(Hi.W.Item.Id.from(i)))||void 0===n?void 0:n.alertCount,a=function(e,t){switch(t){case $i.lensAllSuggestionFeed:case $i.lensAllSuggestionFeedShortForm:return null==e?void 0:e.GeneralScore;case $i.lensClarityFeed:return null==e?void 0:e.Clarity;case $i.lensCorrectnessFeed:return null==e?void 0:e.Correctness;case $i.lensDeliveryFeed:return null==e?void 0:e.Tone;case $i.lensEngagementFeed:return null==e?void 0:e.Engagement;case $i.lensStyleGuideFeed:return null==e?void 0:e["Style guide"];case $i.lensPremiumFeed:case $i.plagiarismFeed:case $i.writingExpertFeed:return;default:(0,g.AS)(t)}}(t,i);return 0===r?1:null!==(l=a,s=o.toNullable(Zi(l)))&&void 0!==s?s:0;var l}}(t,e);this._outcomeScores.set(sr(i))}))),this._subs.add(mn(this._params.sduiItemsCollectionDiff,tr).subscribe((0,a.flow)(er,o.fold((()=>this.premiumCounter.set(0)),(e=>this.premiumCounter.set(e)))))),(0,Ce.s)("peekGrammarlyProTreatment",(0,a.pipe)(this._params.experimentService?this._params.experimentService.peekTreatment(Re.r.GrammarlyPro):A.pG(null),A.qE((e=>new Error(e)))),this._logger,(e=>this._grammarlyProTreatment.set(e)))}onToggleLens(e){const t=(0,a.pipe)(this._params.feedManager.feed.get(),o.map((e=>e.id)),o.exists((t=>t===e)));this._params.tracking.feedLensButtonClicked(Qs[e]);const i=(0,a.pipe)(this._params.feedManager.feed.get(),o.chain((e=>wn(e.collection))),o.fold((()=>{}),(e=>e.id)));t?this._params.feedManager.replaceFeed($i.lensAllSuggestionFeed,i):this._params.feedManager.replaceFeed(e,i)}dispose(){this._subs.unsubscribe()}}var or;function ar(e){return"assistantCard"===e.content.type?o.some(e.content):"strongAlertRef"===e.content.type&&"assistantCard"===e.content.child.type?o.some(e.content.child):"strongAlertRef"===e.content.type&&"longFormCard"===e.content.child.type&&"assistantCard"===e.content.child.fullContent.type?o.some(e.content.child.fullContent):"longFormCard"===e.content.type&&"assistantCard"===e.content.fullContent.type?o.some(e.content.fullContent):o.none}!function(e){const t=[];e.notifyFeedUnmount=function(){t.forEach((e=>e()))},e.registerFeedUnmountHandler=function(e){return t.push(e),e},e.unregisterFeedUnmountHandler=function(e){const i=t.findIndex((t=>t===e));i>=0&&t.splice(i,1)}}(or||(or={}));class lr{constructor(e){this._params=e,this._subs=new c.y,this._focusedItem=f.s.create(o.none),this._feedReset=f.s.create(!1),this._feedItemRendered=new l.B7,this._isWaitingForAlertsToBeApplied=f.s.create(!1),this._longFormPremiumFeedTreatment=f.s.create(null),this._logger=this._params.logService.getLogger(lr.name),this.isAllSuggestionsFeedEnabled=f.s.create(this._params.isAllSuggestionsFeedEnabled),this.feed=this._params.feedManager.feed.view(),this.feedReset=this._feedReset.view(),this.isWaitingForAlertsToBeApplied=this._isWaitingForAlertsToBeApplied.view(),this.isPremiumFeedEnabled=f.s.combine(this._params.userViewModel.isPremium,this._longFormPremiumFeedTreatment,((e,t)=>!e&&"test"===t)),this._subs.add(this._params.sduiReset.pipe(d.n((()=>M.timer(5e3).pipe(ct.u(!1),ut.Z(!0))))).subscribe(p.H9(this._feedReset))),this._subs.add(this._trackFeedShows().subscribe()),this._subs.add(this._params.feedActionService.processedActionStatus.pipe(m.p((({action:e})=>"applyAlerts"===e.type)),Xn.S(((e,{status:t,itemId:i})=>(0,a.pipe)(e,"pending"===t?w.Yr(Hi.W.Item.Id.eq)(i):w.TF(Hi.W.Item.Id.eq)(i))),new Set),R.T((e=>e.size>0))).subscribe(p.H9(this._isWaitingForAlertsToBeApplied))),(0,Ce.s)("peekLongFormPremiumFeedTreatment",(0,a.pipe)(this._params.experimentService?this._params.experimentService.peekTreatment(Re.r.LongFormPremiumFeed):A.pG(null),A.qE((e=>new Error(e)))),this._logger,(e=>this._longFormPremiumFeedTreatment.set(e)))}_interactionReady(e){const t=this._params.feedFormViewModel.state.view("feedForm").get(),i=(0,a.pipe)(this.feed.get(),o.chain(Js),o.getOrElseW((()=>"unknown")));this._params.lifecycleViewModel.onInteractionReady({kind:"revision",feedForm:t,feedName:i,success:e})}processActions(e,t,i,n){this._params.feedActionService.processActions(e,t.id,i.alertRefs,n)}_onFocusedItemMount(e){(0,a.pipe)(this._focusedItem.get(),o.filter((t=>t.id!==e.id)),o.chain((e=>(0,a.pipe)(ar(e),o.map((t=>({actions:t.onBlur,item:e,sourceId:t.id})))))),o.map((({actions:e,item:t,sourceId:i})=>this._params.feedActionService.processActions(e,t.id,void 0,i)))),(0,a.pipe)(ar(e),o.map((t=>({actions:t.onFocus,item:e,sourceId:t.id}))),o.map((({actions:e,item:t,sourceId:i})=>this._params.feedActionService.processActions(e,t.id,void 0,i)))),this._params.onFocusedSDUIItemMount(e),this._focusedItem.set(o.some(e)),"shortForm"===this._params.feedFormViewModel.state.view("feedForm").get()&&this._interactionReady(!0)}onItemMount(e,t){e&&this._onFocusedItemMount(t),"longForm"===this._params.feedFormViewModel.state.view("feedForm").get()&&this._interactionReady(!0),this._feedItemRendered.next()}onFeedMount(){const e=or.registerFeedUnmountHandler((()=>{or.unregisterFeedUnmountHandler(e),this._params.alertVisibilityManager.notifyFeedUnmount(),(0,a.pipe)(this._focusedItem.get(),o.chain((e=>(0,a.pipe)(ar(e),o.map((t=>({actions:t.onBlur,item:e,sourceId:t.id})))))),o.map((({actions:e,item:t,sourceId:i})=>this._params.feedActionService.processActions(e,t.id,void 0,i))))}));this._params.alertVisibilityManager.notifyFeedMount(),this._logPremiumFeedTreatment()}onSuccessStateMount(){(0,a.pipe)(this.feed.get(),o.chain(Js),o.map((e=>this._params.tracking.feedSuccessStateShown(e,"applied")))),this._interactionReady(!0),this._feedItemRendered.next()}onEmptyStateMount(e){(0,a.pipe)(this.feed.get(),o.chain(Js),o.map((e=>this._params.tracking.feedSuccessStateShown(e,"nothingToCheck")))),this._interactionReady(!e),e||this._feedItemRendered.next()}dispose(){this._subs.unsubscribe()}_trackFeedShows(){return this.feed.pipe(R.T(o.chain(Js)),M.skipBy(o.getEq(U.kK)),N.oE,d.n((e=>this._feedItemRendered.pipe(h.s(1),ct.u(e))))).pipe(P.M((e=>this._params.tracking.feedLensShown(e))))}_logPremiumFeedTreatment(){const e=this._longFormPremiumFeedTreatment.get();null!==e&&(0,Ce.s)("logPremiumFeedTreatment",(0,a.pipe)(this._params.experimentService?this._params.experimentService.logTreatment(Re.r.LongFormPremiumFeed,e):A.kb("No experiment service"),A.qE((e=>new Error(e)))),this._logger)}}class cr{constructor(e){this._params=e,this._subs=new c.y,this._showPartialPageModeNotification=this._params.showPartialPageModeNotification,this._pageRange=f.s.create(o.none),this._partialPageModeNotificationShown=!1,this.pageRange=this._pageRange.view(),this._subs.add(this._params.partialPageRange.pipe(R.T(o.some)).subscribe(p.H9(this._pageRange)))}partialPageRangeHeaderMount(){const e=(0,a.pipe)(this._pageRange.get(),o.filter((()=>this._showPartialPageModeNotification&&!this._partialPageModeNotificationShown)),o.fold((()=>D.w),(e=>this._params.notificationService.notify(ye.create("warning",`Grammarly shows suggestions for ${e.endPage-e.startPage+1} document pages at a time. Scroll into the page you want to review to see suggestions for that section.`,"partialPageMode",!0)))));this._subs.add(e.subscribe((()=>{this._params.tracking.partialPageModeNotificationDismissed(),this._partialPageModeNotificationShown=!0})))}dispose(){this._subs.unsubscribe()}}class dr{constructor(e){this._params=e,this._subs=new c.y,this._state=f.s.create({allSuggestionsCount:0,activeFeedSuggestionCount:0,allSuggestionsEmpty:!0,someSuggestionsAddressed:!1}),this.state=this._state.view();const t=f.s.combine(this._params.isAllSuggestionsFeedEnabled,this._params.feedManagerProxy.allSuggestionsFeedId,((e,t)=>e?t:o.none));this._subs.add(t.pipe(d.n(o.fold((()=>u.of(0)),(e=>this._params.feedManagerProxy.feeds.view((t=>{var i,n;return null!==(n=null===(i=t.get(e))||void 0===i?void 0:i.itemCount)&&void 0!==n?n:0})))))).subscribe(p.H9(this._state.lens("allSuggestionsCount")))),this._subs.add(f.s.combine(this._params.isAllSuggestionsFeedEnabled,this._params.feedManagerProxy.allSuggestionsFeedId,this._params.feedManagerProxy.feed,((e,t,i)=>(0,a.pipe)(i,o.filter((i=>!(i.id===o.toNullable(t)&&!e)))))).view(o.fold((()=>0),(e=>Cn(e.collection)))).subscribe(p.H9(this._state.lens("activeFeedSuggestionCount")))),this._subs.add(t.pipe(d.n(o.fold((()=>u.of(!0)),(e=>this._params.feedManagerProxy.feeds.view((t=>{var i,n;return 0===(null!==(n=null===(i=t.get(e))||void 0===i?void 0:i.itemCount)&&void 0!==n?n:0)}))))),I.F()).subscribe((e=>{this._state.lens("allSuggestionsEmpty").set(e),e||this._state.lens("someSuggestionsAddressed").set(!1)})))}onSuggestionAddressed(){this._state.lens("someSuggestionsAddressed").set(!0)}getFeedSuggestionCount(e){return this._params.feedManagerProxy.feeds.view((t=>(0,a.pipe)(o.fromNullable(t.get(Hi.W.Item.Id.from(e))),o.fold((()=>0),(e=>e.itemCount)))))}dispose(){this._subs.unsubscribe()}}function ur(e){var t,i,n,s;const r=new c.y,u=e.logService.getLogger(ur.name),p=new l.B7,f=null!==(t=e.sduiService.supportedForms)&&void 0!==t?t:["shortForm","longForm"],v=new l.B7,_=new l.B7,b=new Wn({alertCollectionChanges:_,logService:e.logService}),y=new Bs({sduiItemCollectionChanges:v,alertCollection:b,sduiEventTransformer:Hs,logService:e.logService}),k=new l.B7;r.add(y.state.pipe(Ls).subscribe(k));const S=new cn({capiService:e.capiService,logService:e.logService,aiDetectorEnabled:void 0===e.isAiDetectorEnabled?o.none:o.some(e.isAiDetectorEnabled),experimentService:e.experimentService}),C=new bn({capiService:e.capiService}),E=new as({autofocusNextLongFormCardOnAlertRefEmpty:e.sduiService.autofocusNextLongFormCardOnAlertRefEmpty,autofocusNextLongFormCardOnApplyOrDismiss:e.sduiService.autofocusNextLongFormCardOnApplyOrDismiss}),w=new Ts({sduiItemsCollectionDiff:k,initialForm:f[0],autofocusNextCard:e=>e===$i.lensAllSuggestionFeedShortForm||E.autofocusNextLongFormCardOnApplyOrDismiss.get(),logService:e.logService}),A=new os({activeFeed:w.feed,checkingFinishedOnce:e.capiService.relevantInboundCAPIMessages.pipe(m.p(ee.Bw.Finished.is)),sduiChangesSettled:y.sduiChangesSettled,selectedAlertId:e.alertService.selectedAlertId,alertCollection:b,isShortFormFeed:e=>e.id===$i.lensAllSuggestionFeedShortForm,logService:e.logService});r.add(A.focusCard.pipe(Pi.QE(Di.$)).subscribe((e=>{switch(e.kind){case"focusFirstCard":return w.focusFirst();case"focusCard":return w.focusCard(e.cardId);default:(0,g.AS)(e)}})));const I=new Ys({supportedForms:f,feedManager:w,tracking:e.trackingService}),x=new ms({feedManager:w,sduiManagerProxy:y,capiService:e.capiService,alertService:e.alertService,plagiarismService:S,writingExpertService:C,textEditorService:e.textEditorService,lifecycleService:e.lifecycleService,uphookService:e.uphookService,autofocusSettingsService:E,feedForm:I.state.view("feedForm"),logService:e.logService,metricService:e.metricService,setEmphasizedAlerts:e=>p.next(new Set(e))}),T=null!==(i=e.defaultFeed)&&void 0!==i?i:w.allSuggestionsFeedId.pipe(N.oE,h.s(1));r.add(T.subscribe((e=>{u.debug("Pushing default feed.",{feedId:e}),w.pushFeed(e)})));const F=new ts({focusedItem:w.feed.pipe(R.T(o.chain((e=>wn(e.collection))))),activeFeedChanges:w.activeFeedChanges,resetEmphasizedAlerts:p,alertService:e.alertService,logService:e.logService}),K=new Jn({activeFeed:w.feed,alertService:e.alertService,sduiActions:x.processedActionStatus.pipe(R.T((e=>e.action))),logService:e.logService}),M=new Fs({feedManager:w,routingViewModel:e.routingViewModel,uphookService:e.uphookService,feedFormViewModel:I}),O=e.deepLinkManager.registerDeepLinkHandler("premiumSuggestionsUphook",M),B=new rr({feedManager:w,sduiItemsCollectionDiff:k,availableFeeds:w.feeds,lastFinishedMessage:e.capiService.relevantInboundCAPIMessages.pipe(m.p(ee.Bw.Finished.is)),userInstitutionInfo:e.userViewModel.institutionInfo,tracking:e.trackingService,experimentService:e.experimentService,logService:e.logService}),L=new lr({isAllSuggestionsFeedEnabled:e.isAllSuggestionsFeedEnabled,feedManager:w,feedActionService:x,alertVisibilityManager:F,onFocusedSDUIItemMount:e=>M.onFocusedSDUIItemMount(e),feedFormViewModel:I,sduiReset:y.sduiReset,tracking:e.trackingService,lifecycleViewModel:e.lifecycleViewModel,experimentService:e.experimentService,logService:e.logService,userViewModel:e.userViewModel}),U=new qs({lastFinishedMessage:e.capiService.relevantInboundCAPIMessages.pipe(m.p(ee.Bw.Finished.is)),sduiChangesSettled:y.sduiChangesSettled}),j=new cr({showPartialPageModeNotification:null!==(s=null===(n=e.partialPageModeSettings)||void 0===n?void 0:n.showPartialPageModeNotification)&&void 0!==s&&s,partialPageRange:(0,a.pipe)(o.fromNullable(e.textEditorService.partialPageRange),o.fold((()=>D.w),Se.b)),tracking:e.trackingService,notificationService:e.notificationService}),V=new dr({isAllSuggestionsFeedEnabled:L.isAllSuggestionsFeedEnabled,feedManagerProxy:w}),$=(0,Se.b)(e.textEditorService.textUpdated),H=e.capiService.relevantInboundCAPIMessages.pipe(m.p(ee.Bw.AsyncCheckFinished.is)),Z=new l.B7,G=new vn({uphookService:e.uphookService,feedManager:w,sduiItemsCollectionDiff:k,feedActionService:x,routingViewModel:e.routingViewModel,userViewModel:e.userViewModel,assistantUIActions:e.assistantUIActions,textUpdated:$,lastAsyncCheckFinishedMessage:H,isPlagiarismEnabled:e.isPlagiarismEnabled,plagiarismChecksEnabled:S.plagiarismChecksEnabled,aiDetectorEnabled:S.aiDetectorEnabled,trackingService:e.trackingService,logService:e.logService,plagiarismDeepLinkRequest:Z,experimentService:e.experimentService,lifecycleService:e.lifecycleService,suggestionCountViewModel:V}),W=new en({activeView:e.routingViewModel.activeView.view("kind"),plagiarismAvailable:G.plagiarismAction.view(o.isSome),handlePlagiarismDeepLinkRequest:()=>Z.next()}),z=e.deepLinkManager.registerDeepLinkHandler("plagiarismView",W),q=new $n({feedManager:w,feedActionService:x,sduiItemsCollectionDiff:k,routingViewModel:e.routingViewModel,userViewModel:e.userViewModel,assistantUIActions:e.assistantUIActions,lastAsyncCheckFinishedMessage:H,isWritingExpertEnabled:e.isWritingExpertEnabled,writingExpertChecksEnabled:C.writingExpertChecksEnabled,capiService:e.capiService,logService:e.logService}),Q=new ji({assistantUIActions:e.assistantUIActions,humanWritingReportService:e.humanWritingReportService}),J=new Yi({featureOptions:e.performanceScoreOptions,lastFinishedMessage:e.capiService.relevantInboundCAPIMessages.pipe(m.p(ee.Bw.Finished.is)),feeds:w.feeds,tracking:e.trackingService,logService:e.logService}),Y=new Vi({performanceScoreViewAvailable:J.performanceScore.view(o.isSome),routingViewModel:e.routingViewModel,assistantUIActions:e.assistantUIActions}),X=e.deepLinkManager.registerDeepLinkHandler("performanceScoreView",Y),te=new l.B7;return r.add(te.pipe(h.s(1),d.n((()=>Li.h((0,Se.b)(e.alertService.alertCollectionChanges).pipe(P.M((e=>_.next(e)))),(0,Se.b)(e.sduiService.sduiItemCollectionChanges).pipe(P.M((e=>v.next(e)))))))).subscribe()),{start:()=>te.next(),viewModels:{feed:L,feedLens:B,feedForm:I,checkingState:U,suggestionCount:V,plagiarism:G,writingExpert:q,performanceScore:J,humanWritingReport:Q,shortFormFeedMode:e.shortFormFeedMode,pageRange:j},dispose:()=>{r.unsubscribe(),Q.dispose(),b.dispose(),E.dispose(),A.dispose(),X(),O(),z(),Y.dispose(),M.dispose(),J.dispose(),V.dispose(),G.dispose(),q.dispose(),S.dispose(),B.dispose(),U.dispose(),F.dispose(),K.dispose(),x.dispose(),w.dispose(),y.dispose(),j.dispose()}}}class pr{constructor(e){this._params=e,this._subs=new c.y,this._subs.add(this._params.assistantUIActions.subscribe((e=>{if(e.kind===ft.t.Kind.settingsButtonClick)return"withView"===this._params.options.kind?this._params.routingViewModel.push({kind:"settings"}):this._params.options.onClick(e.buttonRect)})))}getView(){return"withView"===this._params.options.kind?o.some(this._params.options.getView()):o.none}dispose(){this._subs.unsubscribe()}}const mr=new(i(60251).aj)("ext_translation_discoverability",["control","test"]);class hr{constructor(e){this._params=e,this._subs=new c.y,this._logger=this._params.logService.getLogger(hr.name),this._state=f.s.create(o.none),this.state=this._state.view(),this.translationDiscoverabilityTreatmentEnabled=f.s.create(!1),this._params.skillService&&this._subs.add(this._params.skillService.skillRequests.subscribe((e=>{e.close?(this._onSkillClosed(),this._state.set(o.none)):e.size&&this._state.modify(o.map((t=>Object.assign(Object.assign({},t),{size:e.size}))))}))),(0,Ce.s)("peekTranslationDiscoverabilityTreatment",(0,a.pipe)(this._params.experimentService?this._params.experimentService.peekTreatment(mr):A.pG(null),A.qE((e=>new Error(e)))),this._logger,(e=>{this.translationDiscoverabilityTreatmentEnabled.set("test"===e)})),this._subs.add(this._params.assistantUIActions.subscribe((e=>this._handleUIAction(e))))}dispose(){this._subs.unsubscribe()}_handleUIAction(e){switch(e.kind){case ft.t.Kind.actionBrickClick:if("regularAction"===e.action.kind&&J.isSkillAction(e.action.action)){const t=e.action.action.skill;this.openSkill(t)}break;case ft.t.Kind.mount:e.name===Et.e.skill&&(0,Ce.s)("initSkill",(0,a.pipe)((0,a.pipe)(this._state.get(),A.sV((()=>new Error("Cannot init Skill. No Skill state available.")))),A.cy((t=>this._params.skillService?(0,a.pipe)(this._params.skillService.initSkill(t.skill,e.element),A.Tj((e=>Object.assign(Object.assign({},t),{size:e})))):A.kb(new Error("Cannot init Skill. No `SkillService` available."))))),this._logger,(e=>this._state.set(o.some(Object.assign(Object.assign({},e),{status:"ready"})))),(e=>{this._state.modify(o.map((e=>Object.assign(Object.assign({},e),{status:"error"})))),this._params.logService.logEvent(function(e){return{kind:"error",source:"skill",name:"initSkillFailed",data:e}}({skillId:(0,a.pipe)(this._state.get(),o.map((e=>e.skill.id)),o.toNullable),reason:(0,ke.$)(e).message}))}));break;case ft.t.Kind.unmount:if(e.name===Et.e.skill&&!this._params.routingViewModel.has({kind:"skill"}).get()){const e=this._state.get();(0,Ce.s)("terminateSkill",(0,a.pipe)(e,A.sV((()=>new Error("Cannot terminate Skill. No Skill state available."))),A.cy((e=>this._params.skillService?(0,a.pipe)(this._params.skillService.terminateSkill(e.skill),A.Tj((()=>e))):A.kb(new Error("Cannot terminate Skill. No `SkillService` available."))))),this._logger,(()=>this._state.set(o.none)),(t=>{this._params.logService.logEvent(function(e){return{kind:"error",source:"skill",name:"terminateSkillFailed",data:e}}({skillId:(0,a.pipe)(this._state.get(),o.map((e=>e.skill.id)),o.toNullable),reason:(0,ke.$)(t).message})),this._state.get()===e&&this._state.set(o.none)}))}}}_onSkillOpened(){this._params.routingViewModel.push({kind:"skill"})}_onSkillClosed(){"skill"===this._params.routingViewModel.activeView.get().kind&&this._params.routingViewModel.pop()}openSkill(e){"skill"!==this._params.routingViewModel.activeView.get().kind&&(this._onSkillOpened(),this._state.set(o.some({skill:e,status:"loading",size:{width:416,height:245}})))}}var gr=i(38886);class fr{constructor(e){this._params=e,this._subscriptions=new F.y.Keeper,this._logger=this._params.logService.getLogger(fr.name),this._state=f.s.create(o.none),this.state=this._state.view(),this.getToneAlertsSummary=()=>this._params.externalService.getToneAlertsSummary(),this._subscriptions.push(this._params.capiService.relevantInboundCAPIMessages.pipe(m.p(ee.Bw.TonesResult.is)).subscribe((e=>this._handleTonesResultMessage(e))))}submitToneFeedback(e,t){const i=t===Mt.positive?T.Zq.EMOTION_LIKE:t===Mt.negative?T.Zq.EMOTION_DISLIKE:(0,g.AS)(t);(0,Ce.s)("submitToneFeedback",this._params.capiService.feedback({emotion:e,type:i,subtype:T.U3.Inline}),this._logger)}_handleTonesResultMessage(e){const t=!0===e.brandTonesEnabled;this._state.set(o.some({tones:(0,a.pipe)(e.emotions,(0,gr.Tj)((({name:e,emojiId:t,confidence:i,brandToneLabel:n,brandToneDescription:s})=>({name:e,emojiId:t,confidence:i,brandToneInfo:void 0!==n?o.some({status:_r(n),description:o.fromNullable(s)}):o.none}))),vr,C.di(t?Pt:Nt)),hidden:!0===e.hidden,brandTonesEnabled:t,institutionLogo:o.fromNullable(e.institutionLogo)}))}dispose(){this._subscriptions.dispose()}}function vr(e){const t=e.reduce(((e,t)=>e+t.confidence),0);return e.map((e=>{let i;return i=e.confidence<.25?Rt.Slight:e.confidence<.5?Rt.Moderate:e.confidence/t>.5?Rt.VeryStrong:Rt.Strong,Object.assign(Object.assign({},e),{prevalence:i})}))}function _r(e){switch(e){case"on":return Kt.On;case"off":return Kt.Off;default:return(0,g.AS)(e)}}class br{constructor(e){this._params=e,this._subs=new c.y,this._logger=this._params.logService.getLogger(br.name),this._grammarlyProTreatment=f.s.create(null),this._freeTrialEUUKTreatment=f.s.create(null),this._inProductDiscountTreatment=f.s.create(null),this.isEligibleForFreeTrial=f.s.create(!1),this.isGrammarlyPro=f.s.combine(this._params.userViewModel.isPremium,this._grammarlyProTreatment,((e,t)=>!e&&"test"===t)),this.isInProductDiscounts=f.s.combine(this._params.userViewModel.isPremium,this._inProductDiscountTreatment,((e,t)=>!e&&"test"===t)),(0,Ce.s)("peekGrammarlyProTreatment",(0,a.pipe)(this._params.experimentService&&!this._params.userViewModel.isPremium.get()?this._params.experimentService.peekTreatment(Re.r.GrammarlyPro):A.pG(null),A.qE((e=>new Error(e)))),this._logger,(e=>this._grammarlyProTreatment.set(e))),(0,Ce.s)("peekFreeTrialEUUKTreatment",(0,a.pipe)(this._params.experimentService&&!this._params.userViewModel.isPremium.get()?this._params.experimentService.peekTreatment(Re.r.PremiumFreeTrialEUUK):A.pG(null),A.qE((e=>new Error(e)))),this._logger,(e=>this._freeTrialEUUKTreatment.set(e))),(0,Ce.s)("peekInProductDiscountsTreatment",(0,a.pipe)(this._params.experimentService&&!this._params.userViewModel.isPremium.get()?this._params.experimentService.peekTreatment(Re.r.InProductDiscount):A.pG(null),A.qE((e=>new Error(e)))),this._logger,(e=>this._inProductDiscountTreatment.set(e))),void 0!==this._params.uphookService.isEligibleForFreeTrial&&this._subs.add((0,Se.b)(this._params.uphookService.isEligibleForFreeTrial).subscribe((e=>{this.isEligibleForFreeTrial.set(e)})))}onUphookShow(e,t){this._logInProductDiscountsTreatmentIfApplicable(),this._logGrammarlyProTreatmentIfApplicable(),this._logFreeTrialEUUKTreatmentIfApplicable(),we(this._params.uphookService.trackUphookShown({name:e,slot:t,variant:this._getUphookVariant()})).catch((t=>{this._params.logService.logEvent((0,ae.tg)({uphook:e,reason:(0,ke.$)(t).message}))}))}onUphookClick(e,t){we(this._params.uphookService.trackUphookClicked({name:e,slot:t,variant:this._getUphookVariant()})).catch((t=>{this._params.logService.logEvent((0,ae.Gt)({uphook:e,reason:(0,ke.$)(t).message}))})),we(this._params.uphookService.executeUphook({name:e,slot:t,variant:this._getUphookVariant()})).catch((t=>{this._params.logService.logEvent((0,ae.Fh)({uphook:e,reason:(0,ke.$)(t).message}))}))}onUphookDismiss(e,t){we(this._params.uphookService.trackUphookDismissed({name:e,slot:t,variant:this._getUphookVariant()})).catch((t=>{this._params.logService.logEvent((0,ae.Hw)({uphook:e,reason:(0,ke.$)(t).message}))}))}_logGrammarlyProTreatmentIfApplicable(){const e=this._grammarlyProTreatment.get();null!==e&&this._logTreatment(Re.r.GrammarlyPro,e)}_logFreeTrialEUUKTreatmentIfApplicable(){const e=this._freeTrialEUUKTreatment.get();null!==e&&this._logTreatment(Re.r.PremiumFreeTrialEUUK,e)}_logInProductDiscountsTreatmentIfApplicable(){const e=this._inProductDiscountTreatment.get();null!==e&&this._logTreatment(Re.r.InProductDiscount,e)}_logTreatment(e,t){(0,Ce.s)("logExperimentTreatment",(0,a.pipe)(this._params.experimentService?this._params.experimentService.logTreatment(e,t):A.kb("No experiment service"),A.qE((e=>new Error(e)))),this._logger)}_getUphookVariant(){return this.isInProductDiscounts.get()?this.isGrammarlyPro.get()?"discountPro":"discountPremium":this.isEligibleForFreeTrial.get()?"premiumTrial":this.isGrammarlyPro.get()?"pro":"premium"}dispose(){this._subs.unsubscribe()}}var yr,kr,Sr=i(62228);function Cr(e){return{source:"userSurvey",kind:"error",name:"submitSurveyFailed",data:e}}!function(e){let t;!function(e){let t;!function(e){e.Rating="rating",e.Feedback="feedback",e.Completed="completed",e.Closed="closed"}(t=e.Type||(e.Type={})),e.isOpen=e=>e!==t.Closed,e.toCAPIStage=e=>{switch(e){case t.Rating:return Sr.QB.Survey.Data.OpenAnswerScoreSurvey.scoreStage;case t.Feedback:case t.Closed:case t.Completed:return Sr.QB.Survey.Data.OpenAnswerScoreSurvey.submitStage;default:(0,g.AS)(e)}}}(t=e.Stage||(e.Stage={}))}(yr||(yr={}));class Er{constructor(e){this._params=e,this._subs=new F.y.Keeper,this._logger=this._params.logService.getLogger(Er.name),this._activeSurvey=f.s.create(o.none),this.activeSurvey=this._activeSurvey.view(),this._init()}dispose(){this._subs.dispose()}submitSurveyResult(e){(0,Ce.s)("submitSurveyResult",this._params.capiService.submit_survey_result({placement:e.placement,score:e.rating,stage:yr.Stage.toCAPIStage(e.stage),open_answer:o.getOrElse((()=>""))(e.openAnswer),detailed_placement:e.detailedPlacement,type:e.type}),this._logger,void 0,(()=>{this._params.logService.logEvent(Cr({surveyType:e.type,surveyPlacement:e.placement,surveyDetailedPlacement:e.detailedPlacement}))}))}dismissSurvey(e){(0,Ce.s)("submitSurveyResult",this._params.capiService.submit_survey_result({placement:e.placement,score:"declined",stage:yr.Stage.toCAPIStage(e.stage),detailed_placement:e.detailedPlacement,type:e.type}),this._logger,void 0,(()=>{this._params.logService.logEvent(Cr({surveyType:e.type,surveyPlacement:e.placement,surveyDetailedPlacement:e.detailedPlacement}))}))}_init(){this._subs.push(this._params.capiService.relevantInboundCAPIMessages.pipe(m.p(ee.Bw.ShowSurvey.is)).subscribe((e=>this._handleShowSurvey(e))))}_handleShowSurvey(e){(0,a.pipe)(e.survey,o.fromPredicate((e=>e.placement===Sr.QB.Survey.Data.BaseSurvey.Placement.ggo)),o.chain((e=>"open_answer_score"===e.type?o.some(e):o.none)),o.chain((e=>{var t;return"string"==typeof e.detailed_placement&&2===(null===(t=e.detailed_placement)||void 0===t?void 0:t.split(":").length)?o.some({survey:e,detailedPlacement:e.detailed_placement}):o.none})),o.chain((({survey:e,detailedPlacement:t})=>{const[i,n]=t.split(":"),s=Math.abs(Number.parseInt(n,10));return Number.isNaN(s)?o.none:o.some({survey:e,detailedPlacement:t,sessionId:i,resultId:le.Q.Id.create(s)})})),o.fold((()=>{this._params.logService.logEvent(function(e){return{source:"userSurvey",kind:"warn",name:"unexpectedSurveyFormatReceived",data:e}}({surveyType:e.survey.type,surveyPlacement:e.survey.placement,surveyDetailedPlacement:e.survey.detailed_placement}))}),(({survey:e,detailedPlacement:t,resultId:i})=>{this._activeSurvey.modify((()=>o.some({placement:e.placement,title:e.title,detailedPlacement:t,type:Sr.QB.Survey.Data.OpenAnswerScoreSurvey.type,resultId:i,maxScore:e.max_score,boxText:o.fromNullable(e.box_text),ratingLabels:e.score_labels,acknowledgmentTitle:o.fromNullable(e.acknowledgment_title),acknowledgment:o.fromNullable(e.acknowledgment),skipOpenAnswerFrom:e.skip_open_answer_from,openAnswer:o.fromNullable({placeholder:e.open_answer.placeholder,maxLen:e.open_answer.max_len,minLen:o.fromNullable(e.open_answer.min_len)})})))})))}}!function(e){e.empty={activeSurvey:o.none,stage:yr.Stage.Type.Rating,transitionStage:yr.Stage.Type.Rating,rating:o.none,errors:o.none,openAnswer:o.none}}(kr||(kr={}));class wr{constructor(e){this._params=e,this._state=f.s.create(kr.empty),this._subs=new c.y,this._stageTimeoutClear=void 0,this.state=this._state.view(),this._updateStageAfterTransition(),this._subscribeToActiveSurvey(),this._subs.add(this._params.assistantUIActions.subscribe((e=>{(0,j.Ub)(ft.t.isSurveyAction,ft.t.isSurveyImplicitDismissAction)(e)&&this._handleUIAction(e)})))}get _activeSurvey(){return this.state.get().activeSurvey}_subscribeToActiveSurvey(){this._subs.add(this._params.userSurveyService.activeSurvey.subscribe((e=>{(0,a.pipe)(e,o.map((e=>{(0,a.pipe)(this._activeSurvey,o.fold((()=>this._updateActiveSurvey(e)),(t=>{t.detailedPlacement!==e.detailedPlacement&&this._updateActiveSurvey(e)})))})))})))}_updateActiveSurvey(e){this._state.set(Object.assign(Object.assign({},kr.empty),{activeSurvey:o.some(e)}))}_handleUIAction(e){switch(e.kind){case ft.t.Kind.surveySubmitButtonClick:case ft.t.Kind.surveyKeyPressShiftEnter:this._onSurveyCompleted();break;case ft.t.Kind.surveyCancelButtonClick:case ft.t.Kind.surveyCloseButtonClick:this._onDismissExplicitly();break;case ft.t.Kind.surveyOpenAnswerChange:this._onOpenAnswerChange(e.openAnswer);break;case ft.t.Kind.surveyRatingSelectionChange:this._onRatingSelectionChange(e.rating);break;case ft.t.Kind.promptSubmitButtonClick:case ft.t.Kind.actionBrickClick:case ft.t.Kind.resultCardInsertButtonClick:case ft.t.Kind.resultCardRephraseButtonClick:case ft.t.Kind.resultCardHeaderClick:case ft.t.Kind.resultCardDismissButtonClick:this._onDismissImplicitly();break;default:(0,g.AS)(e)}}_onRatingSelectionChange(e){(0,a.pipe)(this._activeSurvey,o.map((e=>e.skipOpenAnswerFrom)),o.map((t=>{e<t?this._state.modify((t=>Object.assign(Object.assign({},t),{rating:o.some(e),transitionStage:yr.Stage.Type.Feedback}))):this._state.modify((t=>Object.assign(Object.assign({},t),{rating:o.some(e),transitionStage:yr.Stage.Type.Completed}))),this._reportCompleting()})))}_onOpenAnswerChange(e){(0,a.pipe)(this._activeSurvey,o.chain((({openAnswer:e})=>e)),o.map((({maxLen:t})=>{e.length<=t&&this._state.modify((t=>Object.assign(Object.assign({},t),{openAnswer:o.some(e),errors:o.none})))})))}_onSurveyCompleted(){(0,a.pipe)(this._activeSurvey,o.chain((({openAnswer:e})=>e)),o.chain((({minLen:e})=>e)),o.fold((()=>this._complete()),(e=>{(0,a.pipe)(this._state.get().openAnswer,o.fold((()=>this._setOpenAnswerError("This field is required.")),(t=>{t.length<e?this._setOpenAnswerError(e>0?`Please enter at least ${e} characters.`:"This field is required."):this._complete()})))})))}_complete(){this._reportCompleting(),this._state.lens("transitionStage").set(yr.Stage.Type.Completed)}_reportCompleting(){(0,a.pipe)(this._activeSurvey,o.chain((e=>(0,a.pipe)(this._state.get().rating,o.map((t=>({survey:e,rating:t})))))),o.map((({survey:e,rating:t})=>this._params.userSurveyService.submitSurveyResult({rating:t,openAnswer:this._state.get().openAnswer,placement:e.placement,detailedPlacement:e.detailedPlacement,stage:this.state.get().stage,type:e.type}))))}_setOpenAnswerError(e){this._state.lens("errors").set(o.some({openAnswerError:o.some(e)}))}_onDismissExplicitly(){(0,a.pipe)(this._activeSurvey,o.map((e=>{const t=this.state.get().stage;t===yr.Stage.Type.Rating&&this._params.userSurveyService.dismissSurvey({placement:e.placement,detailedPlacement:e.detailedPlacement,type:e.type,stage:t})}))),this._state.lens("transitionStage").set(yr.Stage.Type.Closed)}_onDismissImplicitly(){this._state.lens("transitionStage").set(yr.Stage.Type.Closed)}_updateStageAfterTransition(){this._subs.add(this._state.subscribe((e=>{this._clearStageTimeout(),this._stageTimeoutClear=setTimeout((()=>{this._state.lens("stage").set(e.transitionStage)}),Ar[e.transitionStage])})))}_clearStageTimeout(){void 0!==this._stageTimeoutClear&&(clearTimeout(this._stageTimeoutClear),this._stageTimeoutClear=void 0)}dispose(){this._subs.unsubscribe(),this._clearStageTimeout()}}const Ar={[yr.Stage.Type.Rating]:0,[yr.Stage.Type.Feedback]:300,[yr.Stage.Type.Completed]:0,[yr.Stage.Type.Closed]:0};var Ir;!function(e){e.set=function(e,t){return i=>Object.assign(Object.assign({},i),{[e]:t})}}(Ir||(Ir={}));class xr{constructor(e){this._params=e,this._subs=new c.y,this._logger=this._params.logService.getLogger(xr.name),this._state=f.s.create({stagingNewVoiceProfile:o.none,stagingVoiceProfile:o.none}),this.state=this._state.view(),this._subs.add(this._params.assistantUIActions.subscribe((e=>this._handleUIAction(e))))}dispose(){this._subs.unsubscribe()}_handleUIAction(e){switch(e.kind){case ft.t.Kind.headerGoBackButtonClick:return this._handleGoBack(e.goBackFrom);case ft.t.Kind.headerVoiceButtonClick:return this._openVoiceProfile("toolbar");case ft.t.Kind.setVoiceButtonClick:return this._openVoiceProfile("banner");case ft.t.Kind.voiceProfileCloseButtonClick:return this._closeVoiceProfile();case ft.t.Kind.voiceProfileUseVoiceButtonClick:return this._applyVoiceProfile();case ft.t.Kind.toneToggleClick:return this._toggleTone(e.id,e.selected);case ft.t.Kind.styleToggleClick:return this._selectStyle(e.id);case ft.t.Kind.roleTypeaheadSelectionChange:return this._selectRole((0,a.pipe)(e.role,o.map((e=>e.id))));case ft.t.Kind.dialectDropdownSelectionChange:return this._selectDialect(e.dialect.id);case ft.t.Kind.voiceProfileTabChange:return this._switchNewVoiceProfileTab(e.profileName);case ft.t.Kind.voiceTagPopoverRemoveButtonClick:return this._removeVoiceTag(e);case ft.t.Kind.voiceTagPopoverClose:return this._closeVoiceTagPopover();case ft.t.Kind.voiceTagPopoverKeepButtonClick:return this._keepVoiceTagPopover();case ft.t.Kind.voiceTagClick:return this._toggleVoiceTag(e);case ft.t.Kind.voiceDialectDropdownSelectionChange:return this._selectNewVoiceDialect(e.dialect.id);case ft.t.Kind.voiceRoleDropdownSelectionChange:return this._selectNewVoiceRole(e.role.id);case ft.t.Kind.voiceSelectionsSaveButtonClick:return this._saveNewVoiceSelections();case ft.t.Kind.voiceSelectionsCancelButtonClick:return this._cancelNewVoiceSelectionChanges();case ft.t.Kind.voiceSelectionsEditButtonClick:return this._editNewVoiceSelections();case ft.t.Kind.promptFieldKeyPressEscape:case ft.t.Kind.headerCloseButtonClick:return this._trySaveNewProfileIfChanged();default:return}}_handleGoBack(e){"voiceProfile"!==e.kind&&"legacyVoiceProfile"!==e.kind||(0,a.pipe)(this._params.genAISessionService.get(),o.chain((e=>oe.toStarted(e.session.get()))),o.map((e=>{"newVoiceProfile"===e.voiceProfile.kind?(this._trySaveNewProfileIfChanged(),this._state.lens("stagingNewVoiceProfile").set(o.none)):"legacyVoiceProfile"===e.voiceProfile.kind&&this._state.lens("stagingVoiceProfile").set(o.none)})))}_createVoiceProfile(e){var t;return"newVoiceProfile"===e.kind?Ir.set("stagingNewVoiceProfile",o.some({selectedRole:e.selectedRole,selectedDialect:e.selectedDialect,isEnabledByDefault:e.isEnabledByDefault,profiles:e.profiles,activeTagId:o.none,activeProfileName:o.fromNullable(null===(t=e.profiles.find((e=>e.selected)))||void 0===t?void 0:t.name),stagingSelections:o.none})):Ir.set("stagingVoiceProfile",o.some({selectedStyle:e.selectedStyle,selectedTonesPerStyle:e.selectedTonesPerStyle,selectedRole:e.selectedRole,selectedDialect:e.selectedDialect,needsSetup:e.needsSetup}))}_openVoiceProfile(e){(0,a.pipe)(this._params.genAISessionService.get(),o.chain((e=>oe.toStarted(e.session.get()))),o.map((t=>{this._params.userActionTrackingService.trackVoiceProfileOpen(e),this._params.routingViewModel.push({kind:"newVoiceProfile"===t.voiceProfile.kind?"voiceProfile":"legacyVoiceProfile"}),this._state.modify(this._createVoiceProfile(t.voiceProfile))})))}_closeVoiceProfile(){this._params.userActionTrackingService.trackVoiceProfileSkip(),this._params.routingViewModel.pop(),this._state.lens("stagingVoiceProfile").set(o.none)}_applyVoiceProfile(){const e=this._state.get().stagingVoiceProfile;this._params.routingViewModel.pop(),this._state.lens("stagingVoiceProfile").set(o.none),(0,a.pipe)(e,o.map((e=>{const t=o.toNullable(this._params.genAISessionService.get());t&&(0,Ce.s)("setVoiceProfile",t.setVoiceProfile(e),this._logger)})))}_toggleTone(e,t){this._state.lens("stagingVoiceProfile").modify(o.map((i=>{return Object.assign(Object.assign({},i),{selectedTonesPerStyle:(0,a.pipe)(i.selectedTonesPerStyle,t?(n=Ae.Style.Id.eq,(e,t)=>i=>(0,a.pipe)(i,Te.qt(n)(e,(0,a.flow)(o.some,t)),o.getOrElse((()=>(0,a.pipe)(i,Te.PT(n)(e,t(o.none)))))))(i.selectedStyle,o.fold((()=>new Set([e])),w.Yr(Ae.Tone.Id.eq)(e))):(0,a.flow)(Te.qt(Ae.Style.Id.eq)(i.selectedStyle,w.TF(Ae.Tone.Id.eq)(e)),o.getOrElse((()=>i.selectedTonesPerStyle))))});var n})))}_selectStyle(e){this._state.lens("stagingVoiceProfile").modify(o.map((t=>Object.assign(Object.assign({},t),{selectedStyle:e}))))}_selectRole(e){this._state.lens("stagingVoiceProfile").modify(o.map((t=>Object.assign(Object.assign({},t),{selectedRole:e}))))}_selectDialect(e){this._state.lens("stagingVoiceProfile").modify(o.map((t=>Object.assign(Object.assign({},t),{selectedDialect:e}))))}_editNewVoiceSelections(){this._updateNewProfileStateIfAny((e=>Object.assign(Object.assign({},e),{stagingSelections:o.some({selectedDialect:e.selectedDialect,selectedRole:e.selectedRole})})))}_cancelNewVoiceSelectionChanges(){this._updateNewProfileStateIfAny((e=>Object.assign(Object.assign({},e),{stagingSelections:o.none})))}_saveNewVoiceSelections(){this._updateNewProfileStateIfAny((e=>Object.assign(Object.assign({},e),{selectedDialect:(0,a.pipe)(e.stagingSelections,o.fold((()=>e.selectedDialect),(e=>e.selectedDialect))),selectedRole:(0,a.pipe)(e.stagingSelections,o.fold((()=>e.selectedRole),(e=>e.selectedRole))),stagingSelections:o.none})))}_selectNewVoiceRole(e){this._updateNewProfileStateIfAny((t=>Object.assign(Object.assign({},t),{stagingSelections:(0,a.pipe)(t.stagingSelections,o.map((t=>Object.assign(Object.assign({},t),{selectedRole:o.some(e)}))))})))}_selectNewVoiceDialect(e){this._updateNewProfileStateIfAny((t=>Object.assign(Object.assign({},t),{stagingSelections:(0,a.pipe)(t.stagingSelections,o.map((t=>Object.assign(Object.assign({},t),{selectedDialect:e}))))})))}_updateNewProfileStateIfAny(e){this._state.lens("stagingNewVoiceProfile").modify(o.map(e))}_keepVoiceTagPopover(){this._params.userActionTrackingService.trackVoiceProfileKeepTag(),this._closeVoiceTagPopover()}_closeVoiceTagPopover(){this._updateNewProfileStateIfAny((e=>Object.assign(Object.assign({},e),{activeTagId:o.none})))}_toggleVoiceTag({tagName:e,sectionName:t,profileName:i}){this._updateNewProfileStateIfAny((n=>Object.assign(Object.assign({},n),{activeTagId:o.toNullable(n.activeTagId)===Ie.createId({tagName:e,sectionName:t,profileName:i})?o.none:o.some(Ie.createId({tagName:e,sectionName:t,profileName:i}))})))}_removeVoiceTag({tagName:e,profileName:t,sectionName:i}){this._params.userActionTrackingService.trackVoiceProfileRemoveTag(),this._updateNewProfileStateIfAny((n=>Object.assign(Object.assign({},n),{profiles:(0,a.pipe)(n.profiles,C.Tj((n=>n.name===t?Object.assign(Object.assign({},n),{sections:n.sections.map((t=>t.name===i?Object.assign(Object.assign({},t),{tags:t.tags.filter((t=>t.name!==e))}):t))}):n)))})))}_switchNewVoiceProfileTab(e){this._updateNewProfileStateIfAny((t=>Object.assign(Object.assign({},t),{activeProfileName:o.some(e)})))}_trySaveNewProfileIfChanged(){(0,a.pipe)(k.Jq(o.option)({editedVoiceProfile:this._state.view("stagingNewVoiceProfile").get(),sessionVoiceProfile:(0,a.pipe)(this._params.genAISessionService.get(),o.chain((e=>oe.toStarted(e.session.get()))),o.map((e=>e.voiceProfile)),o.chain(Ae.toNewVoiceProfile))}),o.filter((({editedVoiceProfile:e,sessionVoiceProfile:t})=>!Ae.NewSelections.eqByRoleDialectProfileAndIsEnabledByDefault.equals(e,t))),o.map((({editedVoiceProfile:e})=>{const t=o.toNullable(this._params.genAISessionService.get());t&&(0,Ce.s)("setNewVoiceProfile",t.setNewVoiceProfile({selectedDialect:e.selectedDialect,selectedRole:e.selectedRole,isEnabledByDefault:e.isEnabledByDefault,profiles:e.profiles}),this._logger)})))}}var Tr,Fr=i(43308);!function(e){e.eq=S.getEq(U.kK,le.Q.Id.eq),e.card=function(e){return S.right(e)},e.uiItem=function(e){return S.left(e)},e.toCard=function(e){return o.fromEither(e)},e.toUIItem=function(e){return(0,a.pipe)(e,S.fold(o.some,(()=>o.none)))}}(Tr||(Tr={}));var Rr,Kr;!function(e){let t;!function(e){e.make=function(e){return{kind:"regularAction",action:e}}}(t=e.RegularAction||(e.RegularAction={}))}(Rr||(Rr={})),function(e){e.create=function(){return{textBox:"",selectedAction:o.none,promptAutofocusToken:0,cardsState:{hoveredCard:o.none,focusedCard:o.none},reportMenuVisible:o.none,referencesVisibility:new Map,detectedReferences:o.none,overrideCardVoice:new Map}}}(Kr||(Kr={}));class Mr{constructor(e){this._params=e,this._subs=new c.y,this._logger=this._params.logService.getLogger(Mr.name),this._state=f.s.create(Kr.create()),this._reportMenuVisibleDebounced=f.s.create(o.none),this._disposed=new l.B7,this._genAISession=f.s.create(o.none),this._genAIPromptsFulfilled=f.s.create(0),this._paramsStateDeps=f.s.combine(this._params.userService.user,this._params.genAIAvailability,this._genAISession,this._params.routingViewModel.activeView,((e,t,i,n)=>({user:e,genAIAvailability:t,genAISession:i,activeView:n}))),this.state=f.s.combine(this._state,this._paramsStateDeps,this._reportMenuVisibleDebounced,this._params.textIsEmpty,((e,t,i,n)=>{var{cardsState:s,reportMenuVisible:r,textBox:l}=e,c=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(i[n[s]]=e[n[s]])}return i}(e,["cardsState","reportMenuVisible","textBox"]),d=t.user,u=t.genAIAvailability,p=t.genAISession;return Object.assign(Object.assign({},c),{textBox:l,user:d,userCanSignIn:!he(d)&&!!this._params.userService.signIn,genAIAvailability:u,genAISession:p,userPromptAction:(0,a.pipe)(p,o.chain(oe.toStarted),o.chain((e=>e.activeContext.userPromptAction)),o.map((e=>Object.assign(Object.assign({},e),{arg:Object.assign(Object.assign({},e.arg),{kind:"string",label:(0,a.pipe)(n,o.fold((()=>""),(0,j.Sw)("Try Write an ode to the em dash","Tell us to...")))})})))),activeCards:new Set((0,a.pipe)([s.hoveredCard,(0,a.pipe)(s.focusedCard,o.alt((()=>(0,a.pipe)(i,o.chain(Tr.toCard)))))],C.oE)),canScroll:o.isNone(r)})})),this._subs.add(this.state.subscribe((e=>this._logger.debug("Assistant view model state updated.",e)))),this._subs.add(this._params.genAISessionService.pipe(d.n(o.fold((()=>u.of(o.none)),(e=>e.session.view(o.some))))).subscribe(p.H9(this._genAISession))),this._params.hasRevision||this._subs.add(this._showErrorOnSessionStart().subscribe()),this._subs.add(this._updateGenAIPromptsFulfilled().subscribe(p.H9(this._genAIPromptsFulfilled))),this._subs.add(Li.h(this._state.view("reportMenuVisible").pipe(N.oE,R.T(o.some)),this._state.view("reportMenuVisible").pipe(M.skipBy(o.getEq(Tr.eq)),$t.B(250),m.p(o.isNone))).subscribe(p.H9(this._reportMenuVisibleDebounced))),this._subs.add(this._params.routingViewModel.activeView.subscribe((()=>this._state.modify((0,a.flow)(Ir.set("reportMenuVisible",o.none),Ir.set("cardsState",{hoveredCard:o.none,focusedCard:o.none})))))),this._subs.add(this._params.assistantUIActions.subscribe((e=>{this._handleUIAction(e)}))),this._subs.add(this._params.userService.user.subscribe((e=>this._handleUserUpdate(e))))}focusPromptField(){this._state.lens("promptAutofocusToken").modify((e=>e+1))}getContextById(e){var t,i;return null!==(i=null===(t=o.toNullable(this._params.genAISessionService.get()))||void 0===t?void 0:t.getContextById(e))&&void 0!==i?i:o.none}dispose(){this._disposed.next(null),this._disposed.complete(),this._subs.unsubscribe()}_showErrorOnSessionStart(){return Li.h(this._genAISession.view((0,a.flow)(o.chain(oe.toStarting),o.chain((e=>e.error)),o.map((()=>this._params.routingViewModel.replace({kind:"error"}))))))}_updateGenAIPromptsFulfilled(){return Li.h(this._genAISession.view((0,a.flow)(o.chain(oe.toStarted),o.map((e=>e.results.length)))).pipe(N.oE,Xn.S(((e,t)=>({lastResultsCount:t,promptsFulfilled:e.promptsFulfilled+(t>e.lastResultsCount?1:0)})),{lastResultsCount:0,promptsFulfilled:0}),Fr.E("promptsFulfilled")))}_handleUIAction(e){var t,i,n;switch(e.kind){case ft.t.Kind.headerCloseButtonClick:return void this._onClose(e);case ft.t.Kind.headerGoBackButtonClick:case ft.t.Kind.radioOptionsCancelButtonClick:return this._goBack();case ft.t.Kind.promptFieldTextChange:return this._updateTextBox(e.text);case ft.t.Kind.actionBrickClick:return this._trackActionClick(e),this._executeAction(e.action);case ft.t.Kind.actionBrickMount:return this._trackActionMount(e);case ft.t.Kind.actionBrickShow:return this._trackActionShow(e);case ft.t.Kind.promptSubmitButtonClick:return this._go(o.none);case ft.t.Kind.userPromptSubmit:return this._go(o.some(e.prompt));case ft.t.Kind.radioOptionsSubmitButtonClick:return this._submitSelectedAction({selectedRadioOption:e.selectedOption});case ft.t.Kind.generateStopButtonClick:return this._stop();case ft.t.Kind.resultCardInsertButtonClick:return this._insert(e.result,e.selectedVoice);case ft.t.Kind.resultCardCopyButtonClick:return this._copy(e.result,e.selectedVoice);case ft.t.Kind.resultCardCopyToClipboard:return null===(t=o.toNullable(this._params.genAISessionService.get()))||void 0===t?void 0:t.trackResultCopy(e.result.id,e.selectedVoice===le.Q.GeneratedTextVoice.user);case ft.t.Kind.resultCardRephraseButtonClick:return this._rephrase(e.result,e.selectedVoice);case ft.t.Kind.resultCardDismissButtonClick:return this._dismissResult(e.result);case ft.t.Kind.errorCardDismissButtonClick:return this._dismissError();case ft.t.Kind.reportOffensiveResultButtonClick:return this._reportOffensiveResult(e.result);case ft.t.Kind.reportOffensiveActionsButtonClick:return this._reportOffensiveActions();case ft.t.Kind.resultCardHeaderClick:return this._clickResultHeader(e.prompt);case ft.t.Kind.creditsInfoHover:return this._params.userActionTrackingService.trackUsageInfoHover();case ft.t.Kind.creditsInfoClick:return this._onCreditsInfoClick();case ft.t.Kind.resultCardHoverChange:return this._onCardHover(e.resultId,e.hovered);case ft.t.Kind.resultCardFocusChange:return this._onCardFocus(e.resultId,e.focused);case ft.t.Kind.resultCardToggleGenericVoiceButtonClick:return this._onToggleGenericVoice(e.resultId,e.voice);case ft.t.Kind.reportMenuVisibilityChange:return this._onCardReportMenuVisibilityChange(e.trigger,e.visible);case ft.t.Kind.referencesVisibilityChange:return this._onCardReferencesVisibilityChange(e.resultId,e.visible);case ft.t.Kind.regenerateWithoutReferenceButtonClick:return this._regenerateWithoutReference(e.result,e.referenceId,e.selectedVoice);case ft.t.Kind.mount:return this._handleMount(e);case ft.t.Kind.promptFieldKeyPressEscape:return this._onPromptFieldKeyPressEscape(e);case ft.t.Kind.promptFieldKeyPressEnter:return this._checkForGenAIUnavailableError(),"ready"!==e.fieldReadyState||v.y.isUnavailable(this.state.view("genAIAvailability").get())?void 0:e.text.trim().length>0?this._go(o.none):this._tryInsertLatestResult();case ft.t.Kind.restoreHistoryButtonClick:return this._handleHistoryButtonClick();case ft.t.Kind.removeSelectionContextClick:return this._onRemoveSelectionContextClick();case ft.t.Kind.selectionContextInteraction:return this._onSelectionContextInteraction(e);case ft.t.Kind.signInButtonClick:return null===(n=(i=this._params.userService).signIn)||void 0===n?void 0:n.call(i);case ft.t.Kind.actionsMount:return void(0,a.pipe)(this._genAISession.get(),o.map((e=>e.error)),o.map((e=>{const t=o.isNone(e);this._logger.debug("Actions mounted for the first time, notifying gen-ai interaction ready.",{success:t}),this._params.lifecycleViewModel.onInteractionReady({kind:"gen-ai",success:t})})));default:return}}_handleHistoryButtonClick(){(0,a.pipe)(this._genAISession.get(),o.chain(oe.toStarted),o.map((e=>o.isSome(e.inProgressResult)||e.results.length>0)),o.map((e=>{var t;e?this._params.routingViewModel.push({kind:"thread"}):(null===(t=o.toNullable(this._params.genAISessionService.get()))||void 0===t||t.restoreHistory(),this._subs.add(this._genAISession.view(o.chain(oe.toStarted)).pipe(N.oE,m.p((e=>void 0!==e.results.find(le.Q.isHistory))),h.s(1)).subscribe((()=>this._params.routingViewModel.push({kind:"thread"})))))})))}_handleMount(e){e.name===Et.e.creditsInfoButton?he(this._params.userService.user.get())?this._params.uphookViewModel.onUphookShow("grammarlyGoPrompts","grammarlyGo"):this._logger.warn("grammarlyGoPrompts uphook shown to logged out user; this should not happen."):e.name===Et.e.historyButtonActive&&this._params.userActionTrackingService.trackHistoryButtonView()}_handleUserUpdate(e){ge(e)?this._params.routingViewModel.replace({kind:"signedOut"}):he(e)&&"signedOut"===this._params.routingViewModel.activeView.get().kind&&this._params.routingViewModel.push({kind:"home"})}_onCardHover(e,t){this._state.lens("cardsState").lens("hoveredCard").modify(t?()=>o.some(e):o.filter((t=>t!==e)))}_onCardFocus(e,t){this._state.lens("cardsState").lens("focusedCard").modify(t?()=>o.some(e):o.filter((t=>t!==e)))}_onCardReportMenuVisibilityChange(e,t){this._state.modify((i=>Object.assign(Object.assign({},i),{reportMenuVisible:t?o.some(e):(0,a.pipe)(i.reportMenuVisible,o.filter((t=>!Tr.eq.equals(t,e)))),cardsState:Object.assign(Object.assign({},i.cardsState),{hoveredCard:(0,a.pipe)(Tr.toCard(e),o.fold((()=>i.cardsState.hoveredCard),(e=>t?i.cardsState.hoveredCard:(0,a.pipe)(i.cardsState.hoveredCard,o.filter((t=>t!==e))))))})})))}_onCardReferencesVisibilityChange(e,t){this._state.lens("referencesVisibility").modify((i=>new Map(i).set(e,t)))}_onToggleGenericVoice(e,t){this._state.lens("overrideCardVoice").modify((i=>{var n;const s=new Map(i),r=(null!==(n=i.get(e))&&void 0!==n?n:t)===le.Q.GeneratedTextVoice.generic?le.Q.GeneratedTextVoice.user:le.Q.GeneratedTextVoice.generic;return s.set(e,r),this._params.userActionTrackingService.trackMyVoiceCardToggle(r===le.Q.GeneratedTextVoice.user),s}))}_onRemoveSelectionContextClick(){var e;return this._params.tracking.selectionContextRemoveButtonClicked(),null===(e=o.toNullable(this._params.genAISessionService.get()))||void 0===e?void 0:e.dismissActiveBoundaryContext("thread"===this._params.routingViewModel.activeView.get().kind)}_onSelectionContextInteraction(e){switch(e.visibility){case"attention":this._params.tracking.selectionContextClicked();break;case"visible":this._params.tracking.selectionContextHovered();break;case"hidden":break;default:(0,g.AS)(e.visibility)}return this._params.textEditorService.setContextHighlight(e.range,e.visibility)}_onClose(e){ft.t.is(ft.t.Kind.headerCloseButtonClick)(e)&&this._params.userActionTrackingService.trackAssistantClose(),this._params.lifecycleViewModel.onClose()}_goBack(){"followUpPrompt"===this._params.routingViewModel.activeView.get().kind&&this._state.modify((e=>Object.assign(Object.assign({},e),{selectedAction:o.none,textBox:""}))),this._params.routingViewModel.pop()}_updateTextBox(e){this._state.lens("textBox").set(e),this._searchReferences(e)}_executeAction(e){var t;if("regularAction"===e.kind)if(e.action.disabled)(0,a.pipe)(e.action.notificationOnAttempt,o.map((e=>{this._params.notificationService.notify(ye.create("information",e,void 0,void 0,5e3)),this._params.userActionTrackingService.trackContexNotification("action")})));else if(J.isFollowUpQuestionActionInput(e.action)){const t=e.action;this._state.modify((e=>Object.assign(Object.assign({},e),{textBox:"",selectedAction:o.some(t)}))),this._params.routingViewModel.push({kind:"followUpPrompt",inputType:Q.match({radio:()=>"radio",string:()=>"string"})(e.action.args[0])})}else J.isQuickActionInput(e.action)?(this._state.modify((e=>Object.assign(Object.assign({},e),{selectedAction:o.none,textBox:""}))),null===(t=o.toNullable(this._params.genAISessionService.get()))||void 0===t||t.submitAction(e.action,o.toUndefined(this._lastResultSelectedVoice())),this._params.routingViewModel.push({kind:"thread"})):(0,j.Ub)(J.isSkillAction,J.isToneAction,J.isPlagiarismAction,J.isWritingExpertAction,J.isPerformanceScoreAction,J.isHumanWritingReportAction)(e.action)||(0,g.AS)(e.action);else"allResults"===e.kind?this._checkForGenAIUnavailableError():"go"===e.kind?this._go(o.none):(0,g.AS)(e)}_trackActionClick(e){"regularAction"===e.action.kind?this._params.tracking.actionButtonClicked(e.action.action.label,e.action.action.id,e.placement,e.position,this._genAIPromptsFulfilled.get()):"allResults"===e.action.kind?this._params.tracking.moreActionsButtonClicked(e.placement,e.position,this._genAIPromptsFulfilled.get()):"go"===e.action.kind||(0,g.AS)(e.action)}_trackActionMount(e){"regularAction"===e.action.kind?this._params.tracking.actionButtonRendered(e.action.action.label,e.action.action.id,e.placement,e.position,this._genAIPromptsFulfilled.get()):"allResults"===e.action.kind?this._params.tracking.actionButtonRendered("Show more","more",e.placement,e.position,this._genAIPromptsFulfilled.get()):"go"===e.action.kind||(0,g.AS)(e.action)}_trackActionShow(e){"regularAction"===e.action.kind?this._params.tracking.actionButtonShown(e.action.action.label,e.action.action.id,e.placement,e.position,this._genAIPromptsFulfilled.get()):"allResults"===e.action.kind?this._params.tracking.actionButtonShown("Show more","more",e.placement,e.position,this._genAIPromptsFulfilled.get()):"go"===e.action.kind||(0,g.AS)(e.action)}_handleAIUsageNotificationOnPromptSubmit(){(0,a.pipe)(this._genAISession.get(),o.chain(oe.toStarted),o.chain((e=>e.activeContext.specialView)),o.filter((e=>"aiUsageAlert"===e.kind)),o.map((()=>this._params.userActionTrackingService.trackAINotificationDismiss("document"))))}_checkForGenAIUnavailableError(){(0,a.pipe)(this._params.genAISessionService.get(),o.map((e=>e.session.get())),o.chain((e=>e.error)),o.map((()=>{this._params.notificationService.notify(ye.create("information","Generative AI features are temporarily unavailable."))})))}_go(e){var t;o.isSome(e)?(this._handleAIUsageNotificationOnPromptSubmit(),null===(t=o.toNullable(this._params.genAISessionService.get()))||void 0===t||t.submitAction(e.value,o.toUndefined(this._lastResultSelectedVoice())),this._params.routingViewModel.push({kind:"thread"})):o.isSome(this._state.get().selectedAction)?this._submitSelectedAction({textBox:this._state.get().textBox}):(this._handleAIUsageNotificationOnPromptSubmit(),this._submitUserPromptAction())}_stop(){var e,t,i,n,s,r;return i=this,n=void 0,r=function*(){yield null===(t=null===(e=o.toNullable(this._params.genAISessionService.get()))||void 0===e?void 0:e.stopInProgressResult())||void 0===t?void 0:t(),(0,a.pipe)(this._genAISession.get(),o.fold(a.constFalse,oe.fold({starting:a.constFalse,contextless:a.constFalse,started:e=>0===e.results.length})))&&"thread"===this._params.routingViewModel.activeView.get().kind&&this._params.routingViewModel.pop()},new((s=void 0)||(s=Promise))((function(e,t){function o(e){try{l(r.next(e))}catch(e){t(e)}}function a(e){try{l(r.throw(e))}catch(e){t(e)}}function l(t){var i;t.done?e(t.value):(i=t.value,i instanceof s?i:new s((function(e){e(i)}))).then(o,a)}l((r=r.apply(i,n||[])).next())}))}_insert(e,t){(0,Ce.s)("insertText",this._params.textEditorService.insertText((0,Oe.xn)((0,a.pipe)(e.replacementDelta,S.fold(a.identity,(e=>t===le.Q.GeneratedTextVoice.user?e.user:e.generic))),"")),this._logger,(()=>{var i;return null===(i=o.toNullable(this._params.genAISessionService.get()))||void 0===i?void 0:i.trackResultInsert(e.id,t===le.Q.GeneratedTextVoice.user)}),(t=>{this._params.logService.logEvent((0,ae.gR)({resultId:e.id,reason:(0,ke.$)(t).message}))}))}_copy(e,t){this._subscribeToCommand((()=>this._params.textEditorService.copyText((0,Oe.xn)((0,a.pipe)(e.replacementDelta,S.fold(a.identity,(e=>t===le.Q.GeneratedTextVoice.user?e.user:e.generic))),""))),(t=>(0,ae._0)({resultId:e.id,reason:(0,ke.$)(t).message})),(()=>{var i,n;return null===(n=null===(i=o.toNullable(this._params.genAISessionService.get()))||void 0===i?void 0:i.trackResultCopy)||void 0===n?void 0:n.call(i,e.id,t===le.Q.GeneratedTextVoice.user)}))}_subscribeToCommand(e,t,i=a.constVoid){try{(0,Se.b)(e()).pipe(h.s(1),_n.Q(this._disposed)).subscribe(i,(e=>{this._params.logService.logEvent(t(e))}))}catch(e){this._params.logService.logEvent(t(e))}}_tryInsertLatestResult(){(0,a.pipe)(this._genAISession.get(),o.chain(oe.toStarted),o.map((e=>e.results)),o.chain(C.d5),o.filter(le.Q.isStandardCompletedResult),o.map((e=>this._insert(e,(0,a.pipe)(this._lastResultSelectedVoice(),o.getOrElse((()=>le.Q.GeneratedTextVoice.generic)))))))}_onPromptFieldKeyPressEscape(e){e.menuOpened||(0,a.pipe)(this._genAISession.get(),o.chain(oe.toStarted),o.chain((e=>e.inProgressResult)),o.fold((()=>this._onClose(e)),(()=>this._stop())))}_rephrase(e,t){var i;null===(i=o.toNullable(this._params.genAISessionService.get()))||void 0===i||i.regenerateResult(e.id,{omitReferenceIds:o.none},t)}_dismissResult(e){var t;null===(t=o.toNullable(this._params.genAISessionService.get()))||void 0===t||t.dismissResult(e.id),this._state.modify((t=>Object.assign(Object.assign({},t),{reportMenuVisible:(0,a.pipe)(t.reportMenuVisible,o.filter((t=>!Tr.eq.equals(t,Tr.card(e.id))))),cardsState:{hoveredCard:(0,a.pipe)(t.cardsState.hoveredCard,o.filter((t=>t!==e.id))),focusedCard:(0,a.pipe)(t.cardsState.hoveredCard,o.filter((t=>t!==e.id)))}}))),(0,a.pipe)(this._genAISession.get(),o.fold(a.constFalse,oe.fold({starting:a.constFalse,contextless:a.constFalse,started:e=>0===e.results.length&&o.isNone(e.inProgressResult)})))&&"thread"===this._params.routingViewModel.activeView.get().kind&&this._params.routingViewModel.pop()}_dismissError(){var e;null===(e=o.toNullable(this._params.genAISessionService.get()))||void 0===e||e.dismissError()}_reportOffensiveResult(e){var t;null===(t=o.toNullable(this._params.genAISessionService.get()))||void 0===t||t.trackResultOffensive(e.id)}_reportOffensiveActions(){var e;null===(e=o.toNullable(this._params.genAISessionService.get()))||void 0===e||e.trackActionsOffensive()}_clickResultHeader(e){this._state.modify((t=>Object.assign(Object.assign({},t),{textBox:e,promptAutofocusToken:t.promptAutofocusToken+1})))}_onCreditsInfoClick(){this._params.userActionTrackingService.trackUsageInfoClick(),he(this._params.userService.user.get())?this._params.uphookViewModel.onUphookClick("grammarlyGoPrompts","grammarlyGo"):this._logger.warn("grammarlyGoPrompts uphook clicked by logged out user; this should not happen.")}_submitSelectedAction(e){(0,a.pipe)(this._state.get().selectedAction,o.chain((t=>(0,a.pipe)(t.args[0],Q.match({string:()=>{var i;return(0,a.pipe)(o.fromNullable(null===(i=e.textBox)||void 0===i?void 0:i.trim()),o.filter((e=>e.length>0)),o.map((e=>J.FollowUpQuestionActionValue.fromTextInput(t,e))))},radio:()=>(0,a.pipe)(o.fromNullable(e.selectedRadioOption),o.map((e=>J.FollowUpQuestionActionValue.fromRadioInput(t,e))))})))),o.map((e=>{var t;this._state.modify((e=>Object.assign(Object.assign({},e),{selectedAction:o.none,textBox:""}))),null===(t=o.toNullable(this._params.genAISessionService.get()))||void 0===t||t.submitAction(e,o.toUndefined(this._lastResultSelectedVoice())),o.isSome(e.generatesTextType)&&(this._popFollowUpPromptViews(),"home"===this._params.routingViewModel.activeView.get().kind&&this._params.routingViewModel.push({kind:"thread"}))})))}_lastResultSelectedVoice(){return(0,a.pipe)(this._genAISession.get(),o.chain(oe.toStarted),o.map((e=>e.results)),o.chain(C.d5),o.chain((e=>o.fromNullable(this._state.lens("overrideCardVoice").view((t=>t.get(e.id))).get()))))}_submitUserPromptAction(){(0,a.pipe)(this._state.get().textBox.trim(),o.fromPredicate((e=>""!==e)),o.chain((e=>(0,a.pipe)(this._genAISession.get(),o.chain(oe.toStarted),o.chain((t=>(0,a.pipe)(t.activeContext.userPromptAction,o.map((i=>({text:e,session:t,userPromptAction:i}))))))))),o.map((({text:e,session:t,userPromptAction:i})=>{var n;this._state.lens("textBox").set(""),null===(n=o.toNullable(this._params.genAISessionService.get()))||void 0===n||n.submitAction(J.UserPromptActionValue.fromInput(i,e,(0,a.pipe)(function(e,t){return(0,a.pipe)(oe.toStarted(e),o.chain((e=>(0,a.pipe)(function(e){return(0,a.pipe)(e.split(/\s/).filter((e=>e.length>3&&e.includes("."))),E.ci)}(t),o.map(C.x1((t=>{var i;return null!==(i=e.detectedReferences.get(t))&&void 0!==i?i:o.none}))),o.chain(E._S)))))}(t,e),o.map(C.x1((e=>(0,a.pipe)(e.url,o.map((t=>({url:t,referenceId:e.id}))))))),o.chain(E.ci)),o.none),o.toUndefined(this._lastResultSelectedVoice())),this._popFollowUpPromptViews(),"home"===this._params.routingViewModel.activeView.get().kind&&this._params.routingViewModel.push({kind:"thread"})})))}_popFollowUpPromptViews(){for(;"followUpPrompt"===this._params.routingViewModel.activeView.get().kind;)this._params.routingViewModel.pop()}_regenerateWithoutReference(e,t,i){var n;null===(n=o.toNullable(this._params.genAISessionService.get()))||void 0===n||n.regenerateResult(e.id,{omitReferenceIds:o.some([t])},i)}_searchReferences(e){(0,a.pipe)(function(e){return(0,a.pipe)(e.split(/\s/).filter((e=>e.length>3&&e.includes("."))),E.ci)}(e),o.map((e=>e.forEach((e=>{var t;return null===(t=o.toNullable(this._params.genAISessionService.get()))||void 0===t?void 0:t.searchReferences(e)})))))}}var Or=i(90720);var Nr=i(81238),Br=function(e,t,i,n){return new(i||(i=Promise))((function(s,r){function o(e){try{l(n.next(e))}catch(e){r(e)}}function a(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,a)}l((n=n.apply(e,t||[])).next())}))};class Pr{constructor(e){this._params=e,this._sub=new c.y,this._isVisuallyReady=f.s.create(!1),this._heightBehavior=f.s.create({kind:"fitContent",maxHeight:676}),this._widthBehavior=f.s.create({kind:"fitContent",minWidth:432,maxWidth:432}),this._dragBehavior=f.s.create({kind:"notDraggable"}),this._size=f.s.create(null),this._focusState=f.s.create({isFocused:!0}),this._interactionReadyStateByFeature=new Map,this.isVisuallyReady=this._isVisuallyReady.view(),this.heightBehavior=this._heightBehavior.view(),this.widthBehavior=this._widthBehavior.view(),this.dragBehavior=this._dragBehavior.view(),this.size=this._size.view(),this._onStart(),this._sub.add(this._params.lifecycleService.sizeBehavior.subscribe((e=>{var t;this._heightBehavior.set("fitContent"===e.heightBehavior.kind?{kind:e.heightBehavior.kind,maxHeight:null!==(t=e.heightBehavior.maxHeight)&&void 0!==t?t:676,height:e.heightBehavior.height}:{kind:e.heightBehavior.kind}),this._widthBehavior.set(function(e){var t,i,n,s;return"fitContent"===e.widthBehavior.kind?{kind:e.widthBehavior.kind,minWidth:null!==(t=e.widthBehavior.minWidth)&&void 0!==t?t:(s=e.widthBehavior.maxWidth,null!==s&&s<432?s:432),maxWidth:null!==(i=e.widthBehavior.maxWidth)&&void 0!==i?i:(n=e.widthBehavior.minWidth,n&&n>432?n:432)}:{kind:e.widthBehavior.kind}}(e))}))),this._sub.add(this._params.lifecycleService.dragBehavior.subscribe(p.H9(this._dragBehavior))),this._sub.add(this._focusState.pipe($t.B(100),Or.w("isFocused")).subscribe((e=>{we(this._params.lifecycleService.focusStateChanged(e)).catch((t=>{this._params.logService.logEvent((0,ae.Dq)({focusState:e,reason:(0,ke.$)(t).message}))}))})))}_onStart(){return Br(this,void 0,void 0,(function*(){try{yield we(this._params.lifecycleService.starting()),this._params.metricService.report({name:"assistant_lifecycle_starting",labels:void 0},{startMarks:[Nr.F.assistantOpenAttempt]})}catch(e){this._params.logService.logEvent((0,ae.mD)({reason:(0,ke.$)(e).message}))}}))}onVisuallyReady(e){return Br(this,void 0,void 0,(function*(){try{yield we(this._params.lifecycleService.visuallyReady(e)),this._params.metricService.report({name:"assistant_lifecycle_visually_ready",labels:void 0},{startMarks:["assistant_lifecycle_starting"],durationBetweenMarks:[Nr.F.assistantOpenAttempt,Nr.F.preStartServicesReady,n.assistantGetStart,n.assistantGetEnd,n.assistantComponentStart,n.assistantViewModelsCreated,n.assistantComponentEnd,n.assistantContainerMounted]}),this._isVisuallyReady.set(!0)}catch(e){this._params.logService.logEvent((0,ae.Ie)({reason:(0,ke.$)(e).message}))}}))}onInteractionReady(e){return Br(this,void 0,void 0,(function*(){if(!this._interactionReadyStateByFeature.has(e.kind))try{this._interactionReadyStateByFeature.set(e.kind,"pending"),yield we(this._params.lifecycleService.interactionReady(e)),this._interactionReadyStateByFeature.set(e.kind,"fulfilled"),yield this._params.metricService.report(function(e){return{name:"assistant_lifecycle_interaction_ready",labels:{feature:"gen-ai"===e.kind?"gen_ai":"revision"===e.kind?`revision_${e.feedForm}_${e.feedName}`:"tone-detector"===e.kind?"tone_detector":(0,g.AS)(e),success:e.success?"true":"false"}}}(e),{startMarks:["assistant_lifecycle_starting","assistant_lifecycle_visually_ready",Nr.F.assistantOpenAttempt]})}catch(t){"pending"===this._interactionReadyStateByFeature.get(e.kind)&&this._interactionReadyStateByFeature.delete(e.kind),this._params.logService.logEvent((0,ae.Jm)({interactionReadyInfo:e,reason:(0,ke.$)(t).message}))}}))}onReadyToDrag(e){return Br(this,void 0,void 0,(function*(){if("draggable"===this._dragBehavior.get().kind)try{yield we(this._params.lifecycleService.readyToDrag(e)),this._params.metricService.report({name:"assistant_lifecycle_ready_to_drag",labels:void 0},{startMarks:["assistant_lifecycle_starting",Nr.F.assistantOpenAttempt]})}catch(e){this._params.logService.logEvent((0,ae.cX)({reason:(0,ke.$)(e).message}))}}))}onFocusStateChange(e){this._focusState.set(e)}onSizeChange(e){this._size.set({width:e.width,height:e.height})}onClose(){return Br(this,void 0,void 0,(function*(){try{yield new Promise((e=>setTimeout(e))),yield this._params.lifecycleService.close()}catch(e){this._params.logService.logEvent((0,ae.sB)({reason:(0,ke.$)(e).message}))}}))}dispose(){this._sub.unsubscribe()}}class Dr{constructor(e,t){this._initialViewStack=e,this._viewEq=t,this._viewStack=f.s.create(this._initialViewStack),this.activeView=this._viewStack.view(E.d5)}push(e){this._viewStack.modify((t=>this._viewEq.equals(e,t[0])?t:E.qu(e,t)))}pop(){this._viewStack.modify((0,a.flow)(E.jE,(([e,t])=>(0,a.pipe)(E._S(t),o.getOrElse((()=>[e]))))))}popUntil(e){this._viewStack.modify((t=>{const i=t.findIndex(e);return(0,a.pipe)(i>=0?o.some(i):o.some(0),o.chain((e=>E._S(t.slice(e)))),o.getOrElse((()=>t)))}))}replace(e){this._viewStack.modify((t=>(0,a.pipe)(E.qu(e,E.RT(t)))))}has(e){return this._viewStack.view((t=>void 0!==t.find((t=>this._viewEq.equals(t,e)))))}}class Lr{constructor(e){this._subs=new c.y,this._state=f.s.create({hasBeenNonEmpty:o.none,textLength:o.none,wordCount:o.none}),this.state=this._state.view(),this._subs.add((0,Se.b)(e.textEditorService.trimmedTextLength).subscribe((e=>{const t=0===e;this._state.modify((i=>Object.assign(Object.assign({},i),{hasBeenNonEmpty:t?i.hasBeenNonEmpty:o.some(!0),textLength:o.some(e)})))}))),this._subs.add((0,Se.b)(e.textEditorService.wordCount).subscribe((e=>{this._state.lens("wordCount").set(o.some(e))})))}dispose(){this._subs.unsubscribe()}}var Ur=i(4187);class jr{constructor(e){this._params=e,this.institutionInfo=this._params.userService.user.view((e=>he(e)?e.institution:o.none)),this.isGrammarlyInstitutionMember=this._params.userService.user.view(me),this.isPremium=this._params.userService.user.view(fe),this.isPlagiarismDisabled=this._params.userService.user.view((e=>{var t;return!he(e)||!0===(null===(t=e.editorFeatures)||void 0===t?void 0:t.plagiarismDisabled)}))}}function Vr(e){var t,i,n,s;const r=new rt({hostInfo:e.lifecycleService.hostInfo,user:e.userService.user.get(),experience:e.kind}),k=r.getLogger(Vr.name);k.debug("Creating assistant view models.");const S=e.capiService instanceof b.V?null===(t=e.capiService.logEvents)||void 0===t?void 0:t.subscribe((e=>{r.logEvent(e)})):void 0,w="revision"===e.kind?f.s.create({kind:v.y.Kind.disabled}).view():e.genAIAvailabilityService.availability,A=new c.y,x=new l.B7,T=new lt({lifecycleService:e.lifecycleService,experience:e.kind,logService:r}),F=new ht({capiService:e.capiService,genAIAvailability:w,logService:r}),K="revision"!==e.kind?f.s.create(o.some(new it(Object.assign(Object.assign({},e),{genAIStartSessionOptions:e.genAIStartSessionOptions,genAIAvailability:w,userActionTrackingService:F,selectionContextAvailability:null===(i=e.selectionContextAvailabilityService)||void 0===i?void 0:i.availability,metricService:T,logService:r})))):f.s.create(o.none),O=f.s.create(o.none);A.add(K.pipe(d.n(o.fold((()=>u.of(o.none)),(e=>e.session.view(o.some))))).subscribe(p.H9(O))),"revision"!==e.kind&&A.add(O.subscribe((t=>{var i;return null===(i=e.notifyGenAISessionStateChanged)||void 0===i?void 0:i.call(e,(0,a.pipe)(t,o.chain((e=>"contextless"===e.kind?o.none:o.some({kind:e.kind,mode:e.mode,resultCount:"started"===e.kind?e.results.length:0})))))})));const P=new dt;A.add(K.view(o.map((e=>e.registerNotificationHandler((e=>P.notify(e)))))).subscribe());const D=new Pr({lifecycleService:e.lifecycleService,metricService:T,logService:r}),L=new Dr(function(e,t){var i,n,s;const r=null===(s=null===(n=null===(i=null==e?void 0:e.session)||void 0===i?void 0:i.get)||void 0===n?void 0:n.call(i))||void 0===s?void 0:s.mode;return E.Kv(C.oE(["toneReport"===t?o.some({kind:"toneReport"}):o.none,"pushRewrite"===r||"quickRewrite"===r?o.some({kind:"thread"}):o.none]),{kind:"home"})}(o.toNullable(K.get()),function(e){if("revision"===e.kind||"genAIAndRevision"===e.kind)switch(e.initialView){case void 0:return;case"toneReport":return e.toneDetectorService?e.initialView:void 0;default:(0,g.AS)(e.initialView)}}(e)),Ft.eq),U=new Ur.y(null!==(n=e.theme)&&void 0!==n?n:f.s.create(_.z)),j=function(e){const t=(0,Se.b)(e.textUpdated).pipe(B.Z(500),ut.Z(null),d.n((()=>e.getText({start:0,end:Number.MAX_SAFE_INTEGER})())),R.T(o.fromEither),N.oE,R.T((e=>e.trim())),I.F(),M.shareReplay({bufferSize:1,refCount:!0}));return Object.assign(e,{trimmedTextLength:(e.trimmedTextLength?(0,Se.b)(e.trimmedTextLength):t.pipe(R.T((e=>e.length)))).pipe(I.F(),M.shareReplay({bufferSize:1,refCount:!0})),wordCount:(e.wordCount?(0,Se.b)(e.wordCount):t.pipe(R.T((e=>pt(e).length)))).pipe(I.F(),M.shareReplay({bufferSize:1,refCount:!0}))})}(e.textEditorService),V=new Lr({textEditorService:j}),$=new xr({assistantUIActions:x,userActionTrackingService:F,genAISessionService:K,routingViewModel:L,logService:r}),H=new kt({assistantUIActions:x,feedbackService:e.feedbackService,routingViewModel:L,logService:r}),Z=o.fromNullable("revision"!==e.kind&&"genAIAndRevision"!==e.kind||!e.toneDetectorService?void 0:new fr({externalService:e.toneDetectorService,capiService:e.capiService,logService:r})),G=(0,a.pipe)(Z,o.map((t=>new Lt({assistantUIActions:x,toneDetectorServiceInternal:t,userService:e.userService,trackingService:e.trackingService,uphookService:e.uphookService,routingViewModel:L,lifecycleViewModel:D,logService:r})))),W=new jr({userService:e.userService}),z=new y(e.deepLinkService),q=(0,a.pipe)(o.fromNullable("genAI"!==e.kind?Object.assign(Object.assign({},e),{performanceScoreOptions:"genAIAndWritingExpert"!==e.kind?e.performanceScoreOptions:void 0,isAllSuggestionsFeedEnabled:"genAIAndWritingExpert"!==e.kind,isPlagiarismEnabled:"genAIAndWritingExpert"!==e.kind&&e.isPlagiarismEnabled,isWritingExpertEnabled:"genAIAndWritingExpert"===e.kind||e.isWritingExpertEnabled,partialPageModeSettings:"genAIAndWritingExpert"!==e.kind?e.partialPageModeSettings:void 0,shortFormFeedMode:"genAIAndRevision"===e.kind?"compact":"standard"}):void 0),o.map((t=>ur(Object.assign(Object.assign({},t),{routingViewModel:L,userViewModel:W,uphookService:e.uphookService,assistantUIActions:x,logService:r,metricService:T,lifecycleViewModel:D,deepLinkManager:z,experimentService:e.experimentService,notificationService:P})))));A.add(D.isVisuallyReady.pipe(m.p(a.identity),h.s(1)).subscribe((()=>{var e;return null===(e=o.toNullable(q))||void 0===e?void 0:e.start()})));const Q=(0,a.pipe)(q,o.map((e=>e.viewModels))),J=new br({uphookService:e.uphookService,userViewModel:W,trackingService:e.trackingService,logService:r,experimentService:e.experimentService}),Y=new Mr({assistantUIActions:x,lifecycleViewModel:D,routingViewModel:L,genAIAvailability:w,genAISessionService:K,textEditorService:j,userActionTrackingService:F,uphookViewModel:J,userService:e.userService,notificationService:P,logService:r,hasRevision:o.isSome(Q),textIsEmpty:V.state.view("textLength").view(o.map((e=>0===e))),tracking:e.trackingService}),X=new Ut({genAISession:O,activeView:L.activeView,genAIAvailability:w,toneDetectorViewModel:G,plagiarismViewModel:(0,a.pipe)(Q,o.map((e=>e.plagiarism))),writingExpertViewModel:(0,a.pipe)(Q,o.map((e=>e.writingExpert))),textEditorState:V.state,performanceScoreViewModel:(0,a.pipe)(Q,o.map((e=>e.performanceScore))),humanWritingReportViewModel:(0,a.pipe)(Q,o.map((e=>e.humanWritingReport)))}),ee=new Bi(x,X.state.view("contextualActions"),X.state.view("skillActions"),X.state.view("toneAction"),X.state.view("plagiarismAction"),X.state.view("writingExpertAction"),X.state.view("performanceScoreAction"),X.state.view("humanWritingReportAction"),F,(()=>o.isSome(Y.state.get().selectedAction)),(()=>Y.focusPromptField()),k),te=new St(P,x,L.activeView),ie=new Er({capiService:e.capiService,logService:r}),ne=new wr({userSurveyService:ie,assistantUIActions:x}),se=new hr({assistantUIActions:x,logService:r,routingViewModel:L,skillService:"revision"!==e.kind?e.skillService:void 0,experimentService:e.experimentService});"revision"!==e.kind&&e.selectionContextAvailabilityService&&e.selectionContextAvailabilityService.augment((e=>f.s.combine(e,L.activeView,((e,t)=>It(t)?e:{contextUpdatesClient:!1,contextUpdatesServer:!1}))));const re=(0,a.pipe)(o.fromNullable("revision"===e.kind||"genAIAndRevision"===e.kind?e.settingsOptions:void 0),o.map((e=>new pr({assistantUIActions:x,routingViewModel:L,options:e})))),oe=new At({assistantUIActions:x,onboardingService:o.fromNullable(e.onboardingService)}),ae=new yt({assistantUIActions:x,genAISessionService:K,logService:r,routingViewModel:L});return"revision"!==e.kind&&A.add(null===(s=e.skillService)||void 0===s?void 0:s.skills.subscribe((t=>{if("translate"===e.genAIStartSessionOptions.mode){const e=t.find((({id:e})=>"25"===e));e&&se.openSkill(e)}}))),{experience:e.kind,lifecycle:D,assistant:Y,textEditor:V,promptActions:X,promptMenu:ee,notifications:te,voiceProfile:$,feedbackForm:H,userSurvey:ne,skill:se,theme:U,settings:re,revision:Q,toneDetector:G,onboarding:oe,routing:L,user:W,logger:k,a11y:ae,uphook:J,notify:t=>{var i;null===(i=e.notifyAssistantUIAction)||void 0===i||i.call(e,t),x.next(t)},dispose:()=>{var t,i,n,s;k.debug("Disposing of assistant view models."),null==S||S.unsubscribe(),ae.dispose(),null===(t=e.dispose)||void 0===t||t.call(e),A.unsubscribe(),null===(i=o.toNullable(q))||void 0===i||i.dispose(),V.dispose(),Y.dispose(),ee.dispose(),te.dispose(),null==$||$.dispose(),H.dispose(),ne.dispose(),se.dispose(),T.dispose(),oe.dispose(),null===(n=o.toNullable(G))||void 0===n||n.dispose(),null===(s=o.toNullable(K.get()))||void 0===s||s.dispose(),z.dispose(),J.dispose()}}}(0,g.AS)(void 0);const $r=r.UI.Node.make((({state:e})=>s.createElement(ri.F.div,{className:Hr,"data-testid":"a11y-notification","aria-live":"polite",role:"status"},e.pipe(R.T((({messageId:e,messageText:t})=>t?s.createElement("span",{key:e,"data-testid":"a11y-notification-text"},t):null)))))),Hr=Qt.Ks.style({position:"absolute",width:"1px",height:"1px",padding:0,margin:"-1px",overflow:"hidden",clip:"rect(0,0,0,0)",border:0});var Zr=i(58372);const Gr=e=>s.createElement(li.hh,Object.assign({width:"24",height:"24",viewBox:"0 0 24 24",fill:ii.Q.Background.Brand.Default},e),s.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22ZM18.2071 9.20711C18.5976 8.81658 18.5976 8.18342 18.2071 7.79289C17.8166 7.40237 17.1834 7.40237 16.7929 7.79289L10 14.5858L8.20711 12.7929C7.81658 12.4024 7.18342 12.4024 6.79289 12.7929C6.40237 13.1834 6.40237 13.8166 6.79289 14.2071L10 17.4142L18.2071 9.20711Z",stroke:"none"}));var Wr=i(91047);const zr=()=>s.createElement(Jt.I,{icon:Wr.O,size:"large",accessibilityLabel:""}),qr=e=>s.createElement(li.hh,Object.assign({width:"18",height:"18",viewBox:"0 0 18 18"},e),s.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.0607 3.64286C9.5893 2.78571 8.4107 2.78571 7.93926 3.64286L3.16592 12.3214C2.69448 13.1786 3.28378 14.25 4.22667 14.25H13.7733C14.7162 14.25 15.3055 13.1786 14.8341 12.3214L10.0607 3.64286ZM8.25 6C8.25 5.58579 8.58579 5.25 9 5.25C9.41421 5.25 9.75 5.58579 9.75 6V9.75C9.75 10.1642 9.41421 10.5 9 10.5C8.58579 10.5 8.25 10.1642 8.25 9.75V6ZM9.75 12C9.75 12.4142 9.41421 12.75 9 12.75C8.58579 12.75 8.25 12.4142 8.25 12C8.25 11.5858 8.58579 11.25 9 11.25C9.41421 11.25 9.75 11.5858 9.75 12Z",stroke:"none"})),Qr=r.UI.Node.make((({state:e,notify:t})=>s.createElement(ri.F.div,{className:Yr,"data-id":e.pipe(R.T((({id:e})=>e))),onMouseOver:t({kind:"mouseOver"}),onMouseOut:t({kind:"mouseOut"})},e.pipe(R.T((e=>{switch(e.kind){case"feedbackSubmitted":return s.createElement(s.Fragment,null,s.createElement(Gr,{className:Xr}),s.createElement("div",null,"Thanks for the feedback!"));case"voiceTagRemoved":return s.createElement(s.Fragment,null,s.createElement(Gr,{className:Xr}),s.createElement("div",null,"Removed"));case"information":return s.createElement(s.Fragment,null,s.createElement(zr,null),s.createElement("div",null,e.text));case"warning":return s.createElement(s.Fragment,null,s.createElement(qr,{className:eo}),s.createElement("div",null,e.text));default:return(0,g.AS)(e)}}))),e.pipe(R.T((({id:e})=>s.createElement(Zr.X,{name:"notificationClose",onClick:t({kind:"dismissNotification",id:e})}))))))),Jr=Qt.Ks.keyframes({from:{transform:`translateY(${Qt.Ks.rem(.25)})`,opacity:0},to:{transform:"translateY(0)",opacity:1}}),Yr=Qt.Ks.style({background:si.NeutralGray100,color:ii.Q.Text.Base.Inverse,borderRadius:Qt.Ks.rem(ni.KD+ni.M6),display:"flex",flexDirection:"row",alignItems:"center",padding:`${Qt.Ks.rem(ti.CN)} ${Qt.Ks.rem(ti.CN)}`,gap:Qt.Ks.rem(ti.CN),fontSize:Qt.Ks.rem(.75),lineHeight:Qt.Ks.rem(1.125),animation:`${Jr} 0.1s ease-in`}),Xr=Qt.Ks.style(Object.assign({},(0,bi.QD)(1.5))),eo=Qt.Ks.style({fill:"#FFC444"}),to=r.UI.List.make(C.QW,Qr),io=r.UI.Grid.make((({slots:e})=>s.createElement("div",{className:so},e.content))),no=r.UI.Knot.make(io,{content:to}),so=Qt.Ks.style({display:"flex",flexDirection:"column",gap:Qt.Ks.rem(ti.v$),transition:"top 0.1s ease-in"});var ro,oo=i(78509);!function(e){e.interactOutside="interactOutside",e.closeButtonClick="closeButtonClick",e.unmount="unmount",e.other="other"}(ro||(ro={}));const ao=r.UI.Node.make((({view:e,notify:t})=>s.createElement(ri.F.Fragment,null,e("step").pipe(R.T(o.fold(a.constNull,(e=>s.createElement(oo.AM,{key:String(e.stepId),"data-testid":`onboarding-${String(e.stepId)}`,reference:e.reference,placement:e.placement,arrowAlignment:e.arrowAlignment,offset:e.offset,containerPadding:e.containerPadding,title:e.title,body:e.body,footer:e.footer,onClose:i=>t({kind:"onboardingStepUnmount",stepId:e.stepId,reason:i in ro?ro[i]:ro.other})(),onMount:t({kind:"onboardingStepMount",stepId:e.stepId})}))))))));var lo=i(41548),co=i(88423),uo=i(39606),po=i(58667);const mo=s.createContext({notifyUnmount:a.constVoid}),ho=e=>s.createElement(li.hh,Object.assign({width:"18",height:"18",viewBox:"0 0 18 18",fill:yi.A.BrandGreen60},e),s.createElement("path",{d:"M17.1056 9.44721L0.992696 17.5037C0.607324 17.6963 0.174955 17.3439 0.285972 16.9276L1.83393 11.1228C1.93505 10.7436 2.24864 10.4586 2.63576 10.394L9.52041 9.2466C9.79894 9.20018 9.79894 8.79982 9.52041 8.7534L2.63576 7.60596C2.24864 7.54144 1.93505 7.25644 1.83393 6.87723L0.285971 1.07239C0.174955 0.656082 0.607322 0.303661 0.992694 0.496347L17.1056 8.55279C17.4741 8.73705 17.4741 9.26295 17.1056 9.44721Z",stroke:"none"})),go=e=>s.createElement(li.hh,Object.assign({width:"32",height:"32",fill:ii.Q.Text.Base.Subdued,viewBox:"0 0 32 32"},e),s.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M24 16a8 8 0 1 1-16 0 8 8 0 0 1 16 0Zm1 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-11-3a1 1 0 0 0-1 1v4a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-4a1 1 0 0 0-1-1h-4Z",stroke:"none"}));var fo=i(53493);const vo="#161719",_o=ii.Q.Background.Neutral.Default,bo=e=>{var{children:t,style:i,name:n}=e,r=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(i[n[s]]=e[n[s]])}return i}(e,["children","style","name"]);const[a,l]=s.useState(null),c=s.useCallback((e=>{var t,i;let n=null;"contentDocument"in e.target&&(n=null!==(i=null===(t=e.target.contentDocument)||void 0===t?void 0:t.body)&&void 0!==i?i:null),l(n),n&&(n.style.margin="0",n.style.height="100vh",n.style.overflowY="hidden")}),[]),d=s.useContext(lo.q.Context);return s.useEffect((()=>{const e=d.subscribe((e=>{a&&lo.q.setRootCssVar(a,o.some(e))}));return()=>e.unsubscribe()}),[a]),s.createElement(s.Fragment,null,s.createElement("iframe",Object.assign({},r,{style:Object.assign({},i),onLoad:c,srcDoc:"<html><body></body></html>","data-testid":n})),a&&(0,fo.createPortal)(t,a))};function yo(e){return So(e)&&0===e.selectionStart}function ko(e){return So(e)&&e.selectionStart===e.value.length}function So(e){return e.selectionStart===e.selectionEnd}const Co=({fitContentHeight:e,text:t,ariaLabel:i,ariaControls:n,ariaHaspopup:r,ariaExpanded:o,onChange:a,placeholder:l,disabled:c,className:d,onFocus:u,onBlur:p,onKeyDownEnter:m,autofocus:h,onKeyDownArrowUp:g,onKeyDownArrowDown:f,onKeyDownShiftEnter:v,theme:_})=>{var b,y,k,S,C,E,w,A,I,x,T,F,R,K,M,O,N,B,P,D,L,U,j,V,$,H,Z,G,W,z,q;const Q=null!==(b=null==_?void 0:_.lineHeightRems)&&void 0!==b?b:1.375,J=Q+(null!==(k=null===(y=null==_?void 0:_.paddingRems)||void 0===y?void 0:y.top)&&void 0!==k?k:0)+(null!==(C=null===(S=null==_?void 0:_.paddingRems)||void 0===S?void 0:S.bottom)&&void 0!==C?C:0),[Y,X]=s.useState({kind:"rem",value:J}),[ee,te]=s.useState(null);return s.useEffect((()=>{ee&&void 0!==h&&(ee.focus(),ee.selectionStart=t.length,ee.selectionEnd=t.length)}),[h,ee]),s.useLayoutEffect((()=>{if(""===t)X({kind:"rem",value:J});else{const e=null==ee?void 0:ee.scrollHeight;X(e?{kind:"px",value:e}:{kind:"rem",value:J})}}),[t,ee,l]),s.createElement(bo,{className:d,style:{height:e?"rem"===Y.kind?Qt.Ks.rem(Y.value):Qt.Ks.px(Y.value):void 0,maxHeight:(null==_?void 0:_.maxHeightRems)?Qt.Ks.rem(_.maxHeightRems):"none",minHeight:(null==_?void 0:_.minHeightRems)?Qt.Ks.rem(_.minHeightRems):"none"},title:`${i} container`,name:"textarea-iframe"},s.createElement("style",{dangerouslySetInnerHTML:{__html:`\n      .textarea {\n        box-sizing: border-box;\n        border-radius: ${Qt.Ks.rem(ni.KD)};\n        overflow-y: auto;\n        padding: ${Qt.Ks.rem(null!==(w=null===(E=null==_?void 0:_.paddingRems)||void 0===E?void 0:E.top)&&void 0!==w?w:0)} ${Qt.Ks.rem(null!==(I=null===(A=null==_?void 0:_.paddingRems)||void 0===A?void 0:A.right)&&void 0!==I?I:0)} ${Qt.Ks.rem(null!==(T=null===(x=null==_?void 0:_.paddingRems)||void 0===x?void 0:x.bottom)&&void 0!==T?T:0)} ${Qt.Ks.rem(null!==(R=null===(F=null==_?void 0:_.paddingRems)||void 0===F?void 0:F.left)&&void 0!==R?R:0)};\n        width: 100%;\n        height: 100%;\n        border: none;\n        background: transparent;\n        resize: none;\n        font-family: Inter, sans-serif;\n        font-size: ${null!==(K=null==_?void 0:_.fontSize)&&void 0!==K?K:Qt.Ks.rem(.875)};\n        font-weight: 400;\n        color: ${null!==(M=null==_?void 0:_.color)&&void 0!==M?M:vo};\n      }\n      .textarea::placeholder {\n        color: ${_o};\n      }\n      .textarea:placeholder-shown {\n        padding: ${(null==_?void 0:_.placeholderPaddingRems)?`${Qt.Ks.rem(null!==(N=null===(O=_.placeholderPaddingRems)||void 0===O?void 0:O.top)&&void 0!==N?N:0)} ${Qt.Ks.rem(null!==(P=null===(B=_.placeholderPaddingRems)||void 0===B?void 0:B.right)&&void 0!==P?P:0)} ${Qt.Ks.rem(null!==(L=null===(D=_.placeholderPaddingRems)||void 0===D?void 0:D.bottom)&&void 0!==L?L:0)} ${Qt.Ks.rem(null!==(j=null===(U=_.placeholderPaddingRems)||void 0===U?void 0:U.left)&&void 0!==j?j:0)}`:`${Qt.Ks.rem(null!==($=null===(V=null==_?void 0:_.paddingRems)||void 0===V?void 0:V.top)&&void 0!==$?$:0)} ${Qt.Ks.rem(null!==(Z=null===(H=null==_?void 0:_.paddingRems)||void 0===H?void 0:H.right)&&void 0!==Z?Z:0)} ${Qt.Ks.rem(null!==(W=null===(G=null==_?void 0:_.paddingRems)||void 0===G?void 0:G.bottom)&&void 0!==W?W:0)} ${Qt.Ks.rem(null!==(q=null===(z=null==_?void 0:_.paddingRems)||void 0===z?void 0:z.left)&&void 0!==q?q:0)}`};\n      }\n      .textarea:focus {\n        outline: none;\n      }\n      `.replace(/\s/g,"")}}),s.createElement("textarea",{"aria-label":i,"aria-controls":n,"aria-haspopup":r,"aria-expanded":o,spellCheck:"false",className:"textarea",style:{lineHeight:Qt.Ks.rem(Q)},value:t,ref:te,onChange:e=>a(e.target.value),placeholder:l,disabled:c,onFocus:()=>null==u?void 0:u(),onBlur:()=>null==p?void 0:p(),onKeyDown:e=>{m&&"Enter"===e.key&&!e.shiftKey?(e.preventDefault(),e.stopPropagation(),m()):"ArrowUp"===e.key&&g&&yo(e.currentTarget)?(e.preventDefault(),e.stopPropagation(),g()):"ArrowDown"===e.key&&f&&ko(e.currentTarget)?(e.preventDefault(),e.stopPropagation(),f()):"Enter"===e.key&&e.shiftKey&&(e.preventDefault(),e.stopPropagation(),null==v||v())}}))};const Eo=e=>{var{useIframeWrapper:t}=e,i=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(i[n[s]]=e[n[s]])}return i}(e,["useIframeWrapper"]);return t?s.createElement(Co,Object.assign({},i)):s.createElement(wo,Object.assign({},i))},wo=({fitContentHeight:e,text:t,ariaLabel:i,ariaControls:n,ariaHaspopup:r,ariaExpanded:o,onChange:a,placeholder:l,disabled:c,onFocus:d,onBlur:u,onKeyDownEnter:p,autofocus:m,onKeyDownArrowUp:h,onKeyDownArrowDown:g,onKeyDownShiftEnter:f,theme:v,className:_})=>{var b,y,k,S,C;const E=null!==(b=null==v?void 0:v.lineHeightRems)&&void 0!==b?b:1.375,w=E+(null!==(k=null===(y=null==v?void 0:v.paddingRems)||void 0===y?void 0:y.top)&&void 0!==k?k:0)+(null!==(C=null===(S=null==v?void 0:v.paddingRems)||void 0===S?void 0:S.bottom)&&void 0!==C?C:0),[A,I]=s.useState({kind:"rem",value:w}),[x,T]=s.useState(null);return s.useEffect((()=>{x&&void 0!==m&&(x.focus(),x.selectionStart=t.length,x.selectionEnd=t.length)}),[m,x]),s.useLayoutEffect((()=>{if(""===t)I({kind:"rem",value:w});else{const e=null==x?void 0:x.scrollHeight;I(e?{kind:"px",value:e}:{kind:"rem",value:w})}}),[t,x,l]),s.createElement("div",{className:_,style:{height:e?"rem"===A.kind?Qt.Ks.rem(A.value):Qt.Ks.px(A.value):void 0,maxHeight:(null==v?void 0:v.maxHeightRems)?Qt.Ks.rem(v.maxHeightRems):"none",minHeight:(null==v?void 0:v.minHeightRems)?Qt.Ks.rem(v.minHeightRems):"none"},title:`${i} container`},s.createElement("textarea",{"aria-label":i,"aria-controls":n,"aria-haspopup":r,"aria-expanded":o,spellCheck:"false",className:Ao(v),style:{lineHeight:Qt.Ks.rem(E)},value:t,ref:T,onChange:e=>a(e.target.value),placeholder:l,disabled:c,onFocus:()=>null==d?void 0:d(),onBlur:()=>null==u?void 0:u(),onKeyDown:e=>{p&&"Enter"===e.key&&!e.shiftKey?(e.preventDefault(),e.stopPropagation(),p()):"ArrowUp"===e.key&&h&&yo(e.currentTarget)?(e.preventDefault(),e.stopPropagation(),h()):"ArrowDown"===e.key&&g&&ko(e.currentTarget)?(e.preventDefault(),e.stopPropagation(),g()):"Enter"===e.key&&e.shiftKey&&(e.preventDefault(),e.stopPropagation(),null==f||f())}}))},Ao=e=>{var t,i,n,s,r,o,a,l,c,d,u,p,m,h,g,f,v,_,b,y,k,S,C,E,w,A;return Qt.Ks.style({boxSizing:"border-box",borderRadius:Qt.Ks.rem(ni.KD),overflowY:"auto",padding:`${Qt.Ks.rem(null!==(i=null===(t=null==e?void 0:e.paddingRems)||void 0===t?void 0:t.top)&&void 0!==i?i:0)} ${Qt.Ks.rem(null!==(s=null===(n=null==e?void 0:e.paddingRems)||void 0===n?void 0:n.right)&&void 0!==s?s:0)} ${Qt.Ks.rem(null!==(o=null===(r=null==e?void 0:e.paddingRems)||void 0===r?void 0:r.bottom)&&void 0!==o?o:0)} ${Qt.Ks.rem(null!==(l=null===(a=null==e?void 0:e.paddingRems)||void 0===a?void 0:a.left)&&void 0!==l?l:0)}`,width:"100%",height:"100%",border:"none",background:"transparent",resize:"none",fontFamily:"Inter, sans-serif",fontSize:null!==(c=null==e?void 0:e.fontSize)&&void 0!==c?c:Qt.Ks.rem(.875),fontWeight:400,color:null!==(d=null==e?void 0:e.color)&&void 0!==d?d:yi.A.TextBaseDefault,$nest:{"&::placeholder":{color:yi.A.TextBaseSubduedColor},"&:placeholder-shown":{padding:(null==e?void 0:e.placeholderPaddingRems)?`${Qt.Ks.rem(null!==(p=null===(u=e.placeholderPaddingRems)||void 0===u?void 0:u.top)&&void 0!==p?p:0)} ${Qt.Ks.rem(null!==(h=null===(m=e.placeholderPaddingRems)||void 0===m?void 0:m.right)&&void 0!==h?h:0)} ${Qt.Ks.rem(null!==(f=null===(g=e.placeholderPaddingRems)||void 0===g?void 0:g.bottom)&&void 0!==f?f:0)} ${Qt.Ks.rem(null!==(_=null===(v=e.placeholderPaddingRems)||void 0===v?void 0:v.left)&&void 0!==_?_:0)}`:`${Qt.Ks.rem(null!==(y=null===(b=null==e?void 0:e.paddingRems)||void 0===b?void 0:b.top)&&void 0!==y?y:0)} ${Qt.Ks.rem(null!==(S=null===(k=null==e?void 0:e.paddingRems)||void 0===k?void 0:k.right)&&void 0!==S?S:0)} ${Qt.Ks.rem(null!==(E=null===(C=null==e?void 0:e.paddingRems)||void 0===C?void 0:C.bottom)&&void 0!==E?E:0)} ${Qt.Ks.rem(null!==(A=null===(w=null==e?void 0:e.paddingRems)||void 0===w?void 0:w.left)&&void 0!==A?A:0)}`},"&:focus":{outline:"none"}}})};var Io=i(44387);const xo="goBtn",To="stopBtn",Fo={top:ti.v$,right:3.5*ti.CN,bottom:ti.v$,left:ti.CN},Ro={top:ti.v$,right:ti.CN,bottom:ti.v$,left:ti.CN},Ko=Qt.Ks.style({display:"flex",position:"relative",alignItems:"flex-start",padding:0,gap:Qt.Ks.rem(ti.or),justifyContent:"space-between"}),Mo=Qt.Ks.style({flexGrow:1,paddingTop:Qt.Ks.rem(ti.or+ti.vW)}),Oo=Qt.Ks.style({flexGrow:1,paddingTop:Qt.Ks.rem(ti.or+ti.vW),paddingBottom:Qt.Ks.rem(ti.or+ti.vW)}),No=Qt.Ks.style({width:Qt.Ks.percent(100),border:"none"}),Bo={position:"absolute",bottom:Qt.Ks.rem(ti.v$),right:Qt.Ks.rem(ti.CN)},Po=(0,bi.T2)(Bo,To),Do=(0,bi.T2)(Object.assign(Object.assign({},Bo),{$nest:{"&[data-disabled='true']":{opacity:1,$nest:{"& svg":{fill:si.NeutralGray30}}}}}),xo),Lo=Qt.Ks.joinClasses([xo,Qt.Ks.style(Do)]),Uo=Qt.Ks.joinClasses([To,Qt.Ks.style(Po)]),jo=r.UI.Node.make((({state:e,notify:t})=>{const{notifyUnmount:i}=s.useContext(mo),{onMount:n}=(0,po.y)((0,a.flow)(P.M((e=>t({kind:ft.t.Kind.mount,name:Et.e.promptInput,element:e})())),co.j((()=>i({kind:ft.t.Kind.unmount,name:Et.e.promptInput}))))),r=s.useContext(Io.D);return s.createElement(ri.F.form,{className:Ko,mount:n,"aria-label":"Find a prompt"},s.createElement(ri.F.div,{className:r.view((e=>e.useIframeTextfieldWrapper?Mo:Oo))},Ct.zV([e,r]).pipe(R.T((([{placeholder:e,kind:i,text:n,autofocusToken:r,ariaControls:a,ariaExpanded:l},c])=>s.createElement(Eo,{text:n,theme:{paddingRems:Fo,placeholderPaddingRems:Ro,maxHeightRems:20,minHeightRems:2},useIframeWrapper:c.useIframeTextfieldWrapper,ariaLabel:"Type a prompt, after typing your prompt press tab to review results, or enter to activate your prompt",ariaControls:a,ariaExpanded:l,ariaHaspopup:"listbox",className:No,placeholder:"ready"===i?o.toUndefined(e):void 0,fitContentHeight:!0,autofocus:r,onChange:e=>t({kind:ft.t.Kind.promptFieldTextChange,text:e})(),onKeyDownEnter:t({kind:ft.t.Kind.promptFieldKeyPressEnter,text:n,fieldReadyState:i}),onFocus:t({kind:ft.t.Kind.promptFieldFocusChange,focused:!0}),onBlur:t({kind:ft.t.Kind.promptFieldFocusChange,focused:!1}),onKeyDownArrowUp:t({kind:ft.t.Kind.promptFieldKeyPressArrowUp}),onKeyDownArrowDown:t({kind:ft.t.Kind.promptFieldKeyPressArrowDown})}))))),e.pipe(R.T((({kind:e,text:i,genAIAvailability:n})=>v.y.isUnavailable(n)?null:"waitingForResult"===e?s.createElement(oi.$,{variant:"tertiary",className:Uo,onClick:t({kind:ft.t.Kind.generateStopButtonClick}),name:"generateStop",compact:!0,size:"large"},s.createElement(go,null)):"ready"===e&&""!==i.trim()?s.createElement(oi.$,{variant:"tertiary",className:Lo,onClick:t({kind:ft.t.Kind.promptSubmitButtonClick,text:i}),disabled:""===i.trim()||v.y.isUnavailable(n),name:"promptSend",compact:!0,size:"large"},s.createElement(ho,null)):null))))}));var Vo=i(74168),$o=i(60946);function Ho(e){return t=>{e.forEach((e=>{"function"==typeof e?e(t):null!==e&&(e.current=t)}))}}const Zo=s.createContext({scrollableContainer:f.s.create(o.none),registerIntersectionObserver:()=>({dispose:a.constVoid}),scrolling:f.s.create(!1),isDefault:!0}),Go=s.forwardRef((function(e,t){var{children:i,className:n,onScroll:r,style:a}=e,l=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(i[n[s]]=e[n[s]])}return i}(e,["children","className","onScroll","style"]);const c=s.useMemo((()=>f.s.create(o.none)),[]),d=s.useMemo((()=>new Map),[]),u=s.useCallback((e=>{const t=Array.from(d.entries());for(const[i,{observers:n}]of t)d.set(i,{intersectionObserver:zo(e,i,n),observers:n})}),[d]),m=s.useCallback(((e,t,i)=>{var n,s;const r=d.get(e),a=null!==(n=null==r?void 0:r.observers)&&void 0!==n?n:new Map;a.set(t,i);const l=null!==(s=null==r?void 0:r.intersectionObserver)&&void 0!==s?s:zo(o.toNullable(c.get()),e,a);return d.set(e,{intersectionObserver:l,observers:a}),l.observe(t),{dispose:()=>{const i=d.get(e);i&&(i.intersectionObserver.unobserve(t),i.observers.delete(t),0===i.observers.size&&(i.intersectionObserver.disconnect(),d.delete(e)))}}}),[d]);s.useEffect((()=>()=>{d.forEach((e=>{Array.from(e.observers.keys()).forEach((t=>{e.intersectionObserver.unobserve(t)})),e.observers.clear(),e.intersectionObserver.disconnect()})),d.clear()}),[]);const h=s.useMemo((()=>f.s.create(0)),[]),g=s.useMemo((()=>f.s.create(!1)),[]),v=s.useMemo((()=>p.d9(h.pipe(O.i(1)),100,!0).pipe(ut.Z(!1),P.M(p.H9(g)))),[h,g]);jt.R.useSubscriptionTo(v);const _=s.useMemo((()=>({scrollableContainer:c,registerIntersectionObserver:m,scrolling:g,isDefault:!1})),[c,m,g]),b=s.useMemo((()=>f.s.create(o.none)),[]),y=s.useMemo((()=>f.s.create(o.none)),[]),k=s.useMemo((()=>Ct.zV([qo(c,b),qo(c,y)]).pipe(R.T((([e,t])=>({topOverflow:e,bottomOverflow:t}))),ut.Z({topOverflow:!1,bottomOverflow:!1}),M.skipBy(U.OW({topOverflow:U.zF,bottomOverflow:U.zF})))),[b,y,c]);return s.createElement(ri.F.div,Object.assign({},l,{className:Qt.Ks.joinClasses([Wo,n]),"data-role":"scroll",mount:Ho([t,e=>{u(e),c.set(o.fromNullable(e))}]),onScroll:e=>{var t,i;null==r||r(e),h.set(null!==(i=null===(t=o.toNullable(c.get()))||void 0===t?void 0:t.scrollTop)&&void 0!==i?i:0)},style:a,"data-overflow-top":k.pipe(R.T((e=>e.topOverflow))),"data-overflow-bottom":k.pipe(R.T((e=>e.bottomOverflow)))}),s.createElement("div",{style:{margin:0,display:"none"},ref:e=>b.set(o.fromNullable(e)),"aria-hidden":!0}),s.createElement(Zo.Provider,{value:_},i),s.createElement("div",{style:{margin:0,display:"none"},ref:e=>y.set(o.fromNullable(e)),"aria-hidden":!0}))})),Wo=Qt.Ks.style({position:"relative",overflowY:"auto"});function zo(e,t,i){return new IntersectionObserver((e=>e.forEach((e=>{var t;return null===(t=i.get(e.target))||void 0===t?void 0:t(e)}))),{root:e,rootMargin:t})}function qo(e,t){return f.s.combine(e,t,((e,t)=>(0,a.pipe)(k.CO(o.option)(e,t),o.map((([e,t])=>function(e,t){const i={root:e,rootMargin:"0px",threshold:[0,1]};return Vo.ht(t,i).pipe(m.p(gr.J_),R.T((e=>1!==e[0].intersectionRatio)),ut.Z(t.offsetHeight>e.offsetHeight))}(e,t)))))).pipe(N.oE,d.n(a.identity),$o.g(u.of(!0)))}var Qo=i(67270);const Jo=()=>{const{registerIntersectionObserver:e,isDefault:t}=s.useContext(Zo),i=s.useRef([]),n=s.useRef(new l.B7),r=s.useRef(n.current.pipe(B.Z(0),Pi.QE(Qo.X),P.M((()=>{i.current=i.current.reduce(((e,t)=>(t.ref.isConnected?e.push(t):t.disposable.dispose(),e)),[])}))).subscribe());return s.useEffect((()=>function(){r.current.unsubscribe(),i.current.forEach((({disposable:e})=>e.dispose()))}),[]),{refCallback:s.useCallback(((s,r)=>o=>{if(o)if(s(),t)r();else{const t=e("",o,(e=>{e.isIntersecting&&(r(),t.dispose())}));i.current.push({ref:o,disposable:t}),n.current.next()}}),[e,t])}},Yo=()=>s.createElement("div",{role:"separator",className:Qt.Ks.style({position:"relative",width:"100%"})},s.createElement("div",{className:Qt.Ks.style({position:"absolute",bottom:0,left:Qt.Ks.rem(xi),right:Qt.Ks.rem(Ti),borderBottom:`0.5px solid ${yi.A.BorderBaseSubduedColor}`})})),Xo=r.UI.Node.make((({view:e,notify:t})=>{const{refCallback:i}=Jo();return s.createElement(ri.F.div,{className:ea,"data-testid":"action-store",id:"prompt-studio-action-store",role:"listbox","aria-label":"Prompt ideas, press arrow keys to navigate options, press enter to trigger the focused option, and escape to close the popover"},e("actionGroups").pipe(R.T((e=>{let n=-1;return e.map((({label:e,actions:r})=>s.createElement(s.Fragment,{key:e},e.trim().length>0&&s.createElement("h3",{className:ta},e),r.map((({label:r,icon:a,action:l},c)=>{n++;const d="regularAction"===l.kind?o.toUndefined(l.action.badge):void 0,u="regularAction"===l.kind?l.action.isUphook:void 0,p=d?`${r} from ${e} group, ${d}`:`${r} from ${e} group`;return s.createElement(s.Fragment,{key:r},0!==c&&s.createElement(Yo,null),s.createElement(Ci,{key:r,label:r,ariaLabel:p,icon:a,badge:d,isUphook:u,onClick:t({kind:ft.t.Kind.actionBrickClick,action:l,position:n,placement:"allActions"}),ref:i(t({kind:ft.t.Kind.actionBrickMount,action:l,position:n,placement:"allActions"}),t({kind:ft.t.Kind.actionBrickShow,action:l,position:n,placement:"allActions"}))}))})))))}))))})),ea=Qt.Ks.style({padding:`${Qt.Ks.rem(2.25)} 0 ${Qt.Ks.rem(1)} 0`,display:"flex",flexDirection:"column"}),ta=Qt.Ks.style({margin:0,fontSize:Qt.Ks.rem(.875),lineHeight:Qt.Ks.rem(1.3125),fontWeight:700,padding:`${Qt.Ks.rem(ti.v$)} ${Qt.Ks.rem(ti.Jj)}`,color:ii.Q.Text.Base.Default});var ia=i(74836);const na=r.UI.Node.make((()=>s.createElement("div",{className:sa},s.createElement(ia.E,{as:"span",variant:"text-small"},"No results found")))),sa=Qt.Ks.style({padding:`${Qt.Ks.rem(9*ti.vW)} ${Qt.Ks.rem(ti.CN)}`});var ra=i(19840);const oa=e=>s.createElement(li.hh,Object.assign({width:"24",height:"24",viewBox:"0 0 24 24",fill:"none"},e),s.createElement("path",{d:"M14 11.5H16.7929L8.92289 19.37L10.4851 13.1213L10.6404 12.5H10H7.20711L15.0771 4.62999L13.5149 10.8787L13.3596 11.5H14Z",stroke:ii.Q.Text.Base.Subdued,strokeMiterlimit:"4.25735"})),aa="brick",la=(0,bi.T2)({padding:`0 ${Qt.Ks.rem(ti.v$)} 0 ${Qt.Ks.rem(ti.or)}`},aa),ca={display:"flex",alignItems:"center",gap:Qt.Ks.rem(ti.v$)},da=(0,bi.T2)({minHeight:Qt.Ks.rem(1.75),fontSize:Qt.Ks.rem(.75),lineHeight:Qt.Ks.rem(1.125),color:si.NeutralGray80},aa),ua=(0,bi.T2)({minHeight:Qt.Ks.rem(2),fontSize:Qt.Ks.rem(.875),lineHeight:Qt.Ks.rem(1.375),color:ii.Q.Text.Base.Default},aa),pa=(0,bi.T2)({boxShadow:`inset 0 0 0 ${Qt.Ks.rem(.125)} ${yi.A.BrandGreen60}`},aa),ma=(0,bi.T2)({boxShadow:"none",color:si.NeutralGray80,$nest:{"&:not([data-disabled='true'])[data-hovered='true'], &:not([data-disabled='true'])[data-active='true']":{color:yi.A.NeutralGray80,boxShadow:`inset 0 0 0 1px ${yi.A.NeutralGray40}`,backgroundColor:yi.A.NeutralGray10}}},aa),ha={textAlign:"left",whiteSpace:"initial",lineHeight:Qt.Ks.rem(1.125),margin:`${Qt.Ks.rem(.25)} 0 ${Qt.Ks.rem(.25)} 0`},ga=(0,bi.QD)(1.5),fa=Qt.Ks.joinClasses([aa,Qt.Ks.style(la)]),va=Qt.Ks.style(ca),_a=(Qt.Ks.style(da),Qt.Ks.style(ua)),ba=Qt.Ks.style(pa),ya=(Qt.Ks.style(ma),Qt.Ks.style(ha)),ka=Qt.Ks.style(ga),Sa=(0,ra.yY)(oi.$),Ca=s.forwardRef((function({action:e,label:t,icon:i,onClick:n},r){return s.createElement(Sa,Object.assign({variant:"secondary",onClick:n,name:"actionBrick"},(0,ra.Ly)("actionBrick",fa,"go"===e.kind?ba:null,_a)),s.createElement("div",{className:va,ref:r},(0,a.pipe)(i,S.fold((e=>{switch(e){case"go":return s.createElement(oa,{className:ka});case"plagiarism":case"plagiarismDetected":return s.createElement(gi,{className:ka});case"plagiarismAndAiDetector":return s.createElement(mi,{className:ka});case"writingExpert":return s.createElement(fi,{className:ka});case"performanceScoreEmpty":return s.createElement(ui,{className:ka});case"performanceScoreSome":return s.createElement(di,{className:ka});case"performanceScoreSuccess":return s.createElement(pi,{className:ka});case"humanWritingReport":return s.createElement(vi,null,s.createElement(Jt.I,{icon:Xt,accessibilityLabel:""}));default:return(0,g.AS)(e)}}),(e=>s.createElement("img",{src:e,className:wa})))),s.createElement("span",Object.assign({className:ya},z(t)))))})),Ea=r.UI.Node.make((({notify:e,state:t})=>{const{refCallback:i}=Jo();return s.createElement(ri.F.Fragment,null,t.pipe(R.T((({action:t,label:n,icon:r,position:o,placement:a})=>s.createElement(Ca,{action:t,label:n,icon:r,onClick:e({kind:ft.t.Kind.actionBrickClick,action:t,position:o,placement:a}),ref:i(e({kind:ft.t.Kind.actionBrickMount,action:t,position:o,placement:a}),e({kind:ft.t.Kind.actionBrickShow,action:t,position:o,placement:a}))})))))})),wa=Qt.Ks.style({width:Qt.Ks.rem(1.25),height:Qt.Ks.rem(1.25)}),Aa="prompt-studio-search-results",Ia=r.UI.Grid.make((({slots:e,state:t,view:i,notify:n})=>{const{refCallback:r}=Jo(),{ref:a,onMount:l}=jt.R.useElWatcher();return jt.R.useSubscriptionTo(t.pipe(I.F(((e,t)=>e.query===t.query&&e.actions.length===t.actions.length)),Ot.E(a.pipe(N.oE,I.F())),Pi.QE(Di.$),R.T((([{query:e,actions:t}])=>{n({kind:ft.t.Kind.promptSearchResultsUpdate,query:e,resultsCount:t.length})()})))),s.createElement("div",{className:Fa,"data-testid":"search-results",id:Aa,role:"listbox","aria-label":"Prompt ideas, press arrow keys to navigate options, press enter to trigger the focused option, and escape to close the popover",ref:l},e.goAction,s.createElement("div",{className:Ka,"aria-hidden":!0}),s.createElement(ri.F.Fragment,null,i("actions").pipe(R.T((e=>e.map((({label:e,icon:t,action:i},a)=>{const l="regularAction"===i.kind?o.toUndefined(i.action.badge):void 0,c="regularAction"===i.kind?i.action.isUphook:void 0,d=l?`${e}, ${l}`:e;return s.createElement(s.Fragment,{key:e},0!==a&&s.createElement(Yo,null),s.createElement(Ci,{key:e,label:e,ariaLabel:d,badge:l,isUphook:c,icon:t,onClick:n({kind:ft.t.Kind.actionBrickClick,action:i,position:a,placement:"search"}),ref:r(n({kind:ft.t.Kind.actionBrickMount,action:i,position:a,placement:"search"}),n({kind:ft.t.Kind.actionBrickShow,action:i,position:a,placement:"search"}))}))})))))))})),xa=r.UI.Union.asOption(r.UI.Composite.make(r.UI.Grid.make((({slots:e})=>s.createElement("div",{className:Ra,"aria-hidden":!0},e.action))),Ea)),Ta=r.UI.Knot.make(Ia,{goAction:xa}),Fa=Qt.Ks.style({background:"transparent",display:"flex",flexDirection:"column",alignItems:"flex-start"}),Ra=Qt.Ks.style({padding:`${Qt.Ks.rem(9*ti.vW)} ${Qt.Ks.rem(ti.CN)} 0 ${Qt.Ks.rem(ti.CN)}`}),Ka=Qt.Ks.style({marginTop:Qt.Ks.rem(7*ti.vW)});var Ma=i(15363);const Oa=r.UI.Node.make((({view:e,notify:t})=>{const{ref:i,onMount:n}=jt.R.useElWatcher();return jt.R.useSubscriptionTo(e("query").pipe(I.F(),Ot.E(i.pipe(N.oE,I.F())),Pi.QE(Di.$),R.T((([e])=>{t({kind:ft.t.Kind.promptSearchResultsUpdate,query:e,resultsCount:0})()})))),s.createElement(Ma.s,null,s.createElement(ri.F.Fragment,null,e("query").pipe(R.T((e=>s.createElement("div",{"data-testid":"empty-search-results",id:Aa,role:"listbox",ref:n},bt(0,e)))))))})),Na=r.UI.Union.make("kind",{none:r.UI.Node.empty,emptySearchResults:na,searchResults:Ta,actionStore:Xo}),Ba=r.UI.Knot.make(r.UI.Grid.make((({slots:e,notify:t})=>{const{onMount:i}=(0,po.y)(P.M((e=>t({kind:ft.t.Kind.mount,name:Et.e.promptMenuContent,element:e})())));return s.createElement(s.Fragment,null,s.createElement(oi.$,{variant:"tertiary",compact:!0,style:Ua,onClick:t({kind:ft.t.Kind.collapsePromptMenuButtonClick}),name:"collapsePromptMenu",size:"small","aria-label":"Close popover",title:"Close popover"},s.createElement(li.In.Arrow,{direction:li.bO.down})),s.createElement(Go,{className:La},s.createElement("div",{ref:i,onKeyDown:e=>{"ArrowDown"===e.key?t({kind:ft.t.Kind.promptMenuKeyPressArrowDown})():"ArrowUp"===e.key&&t({kind:ft.t.Kind.promptMenuKeyPressArrowUp})()}},e.content)))})),{content:Na}),Pa=r.UI.Union.make("kind",{none:r.UI.Node.empty,emptySearchResults:Oa,popup:Ba}),Da=r.UI.Union.asOption(Pa),La=Qt.Ks.style({$nest:{'&[data-role="scroll"]':{borderBottom:`0.5px solid ${ii.Q.Border.Base.Subdued}`}}}),Ua={default:{position:"absolute",top:Qt.Ks.rem(ti.v$),right:Qt.Ks.rem(ti.v$),zIndex:1}},ja=r.UI.Grid.make((({slots:e,view:t,notify:i})=>{const{onMount:n,rect:r}=jt.R.useRectWatcher(),{notifyUnmount:l}=s.useContext(mo),{ref:c,onMount:d}=(0,po.y)((0,a.flow)(P.M((e=>i({kind:ft.t.Kind.mount,name:Et.e.promptInputAndMenuContainer,element:e})())),co.j((()=>l({kind:ft.t.Kind.unmount,name:Et.e.promptInputAndMenuContainer})))));return s.createElement(ri.F.div,{className:Za,"data-testid":"prompt-container"},s.createElement(ri.F.div,{mount:d,className:Ga,"data-expanded":t("menuExpanded"),onKeyUp:t("menuExpanded").pipe(R.T((e=>t=>{"Escape"===t.key&&i({kind:ft.t.Kind.promptFieldKeyPressEscape,menuOpened:e})()}))),onFocus:()=>{var e;return i({kind:ft.t.Kind.promptFieldAndMenuFocusChange,focused:(null===(e=o.toNullable(c.get()))||void 0===e?void 0:e.contains(Z(document)))||!1})()},onBlur:()=>{var e;return i({kind:ft.t.Kind.promptFieldAndMenuFocusChange,focused:(null===(e=o.toNullable(c.get()))||void 0===e?void 0:e.contains(Z(document)))||!1})()}},e.promptStudioMenu,s.createElement("div",{ref:n},e.promptField)),Ct.zV([r,t("menuExpanded")]).pipe(R.T((([e,t])=>(0,a.pipe)(e,o.filter((()=>t)),o.fold(a.constNull,(({height:e})=>s.createElement("div",{className:Wa,style:{height:e},role:"presentation"}))))))))})),Va=r.UI.Knot.make(ja,{promptField:jo,promptStudioMenu:Da}),$a=r.UI.Union.asOption(Va),Ha=ti.Jj,Za=Qt.Ks.style({position:"relative",margin:`${Qt.Ks.rem(ti.v$)} ${Qt.Ks.rem(ti.Jj)} ${Qt.Ks.rem(Ha)} ${Qt.Ks.rem(ti.Jj)}`}),Ga=Qt.Ks.style({background:ii.Q.Background.Base.Default,boxShadow:uo.R$.boxShadow,border:uo.R$.border,borderRadius:Qt.Ks.rem(ni.KD+ni.M6),$nest:{"&[data-expanded='true']":{boxShadow:uo.$t.boxShadow,border:uo.$t.border,position:"absolute",bottom:0,width:"100%",display:"grid",gridTemplateRows:"1fr auto",zIndex:10}}}),Wa=Qt.Ks.style({opacity:0,pointerEvents:"none",visibility:"hidden"});const za="data-card",qa=e=>{var{children:t,style:i}=e,n=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(i[n[s]]=e[n[s]])}return i}(e,["children","style"]);return s.createElement(ri.F.article,Object.assign({[za]:!0,className:(0,Se.b)(i).pipe(R.T((e=>Qt.Ks.style({display:"flex",flexDirection:"column",color:ii.Q.Text.Base.Default,padding:Qt.Ks.rem(ti.Jj),minWidth:0},e))))},n),t)};var Qa=i(34303),Ja=i(50581);function Ya(e,t=!1){return s.useMemo((()=>e.pipe(d.n(o.fold((()=>u.of(o.none)),(e=>{return(t?(i=e,new hn.c((e=>{const t=new Qa.default((t=>{e.next(Ja.Rect.fromRectLike(t[0].contentRect))}));return t.observe(i),()=>t.disconnect()}))):Vo.sc(e)).pipe(ut.Z(e),R.T((()=>o.some(e.getBoundingClientRect()))));var i}))))),[e])}var Xa=i(65011);function el(e,t){const i=s.useMemo((()=>Ct.zV([t.pipe(N.oE,R.T((e=>o.fromNullable(H(e,3)))),N.oE),e.pipe(M.skipBy(o.getEq(U.w_)))]).pipe(B.Z(0),R.T(Xa.Es),P.M((e=>{e.scrollTop=e.scrollHeight-e.clientHeight})))),[t]);jt.R.useSubscriptionTo(i)}const tl=e=>{var{isActive:t,children:i,onHovered:n,onFocused:r,onCopy:o,style:a}=e,l=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(i[n[s]]=e[n[s]])}return i}(e,["isActive","children","onHovered","onFocused","onCopy","style"]);const c=s.useRef(null);return s.createElement(qa,Object.assign({},l,{mount:c,style:Object.assign(Object.assign({},nl),a),"data-active":t,onMouseEnter:()=>null==n?void 0:n(!0),onMouseLeave:()=>null==n?void 0:n(!1),onFocus:()=>{var e;return null==r?void 0:r((null===(e=c.current)||void 0===e?void 0:e.contains(Z(document)))||!1)},onBlur:()=>{var e;return null==r?void 0:r((null===(e=c.current)||void 0===e?void 0:e.contains(Z(document)))||!1)},onCopy:o}),i)},il={backgroundColor:ii.Q.Background.Base.Default},nl={backgroundColor:"transparent",gap:Qt.Ks.rem(ti.v$),padding:Qt.Ks.rem(ti.Jj),$nest:{[`& ${(0,bi.xP)("primaryBtn",bi.GL)}`]:{fontSize:Qt.Ks.rem(.875)},[`& ${(0,bi.xP)("rephraseBtn",bi.GL)}`]:{fontSize:Qt.Ks.rem(.875)},"&:focus, &:hover":Object.assign({},il),"&[data-active='true']":Object.assign({},il)}};const sl="prompt-result",rl="data-card-type",ol=e=>{var{header:t,footer:i,isActive:n,onHovered:r,onFocused:o,onCopy:a,body:l,style:c}=e,d=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(i[n[s]]=e[n[s]])}return i}(e,["header","footer","isActive","onHovered","onFocused","onCopy","body","style"]);return s.createElement(tl,Object.assign({"aria-live":"polite"},d,{[rl]:sl,isActive:n,onHovered:r,onFocused:o,style:c,onCopy:a}),t,l,i)};var al=i(22414);const ll=(0,ra.yY)(Go),cl=e=>{var t;const i=s.useMemo((()=>{var t;return null!==(t=e.menuRef)&&void 0!==t?t:u.of(o.none)}),[e.menuRef]),r=s.useMemo((()=>{var t;return null!==(t=e.scrollContentToBottomToken)&&void 0!==t?t:u.of(o.none)}),[e.scrollContentToBottomToken]),{onMount:l,ref:c}=jt.R.useElWatcher(),{onMount:d,ref:p}=jt.R.useElWatcher();el(r,p);const m=Ya(c),h=Ya(i),g=s.useMemo((()=>f.s.create(!1)),[]),v=s.useMemo((()=>p.pipe(R.T(o.fold((()=>{g.set(!1)}),(e=>{g.set(e.scrollTop>0)}))))),[p]),_=s.useMemo((()=>e.onRectChange?m.pipe(N.oE,R.T((t=>{var i;null===(i=e.onRectChange)||void 0===i||i.call(e,t)}))):D.w),[m]),b=s.useMemo((()=>{var t;return Ct.zV([h,m,e.heightBehavior,null!==(t=e.menuVerticalMargin)&&void 0!==t?t:u.of(void 0)]).pipe(R.T((([e,t,i,n])=>(0,a.pipe)(e,o.fold((()=>({sentinelHeight:void 0,menuMaxHeight:void 0})),(e=>{if("fitContent"===i.kind){const t=e.height+(null!=n?n:0);return{sentinelHeight:Math.min(i.maxHeight,t),menuMaxHeight:i.maxHeight-(null!=n?n:0)}}return{sentinelHeight:void 0,menuMaxHeight:(0,a.pipe)(t,o.fold(a.constUndefined,(e=>Math.max(e.height-(null!=n?n:0),0))))}}))))),ut.Z({sentinelHeight:void 0,menuMaxHeight:void 0}))}),[h,m]),y=s.useMemo((()=>i.pipe(N.Kc((e=>b.pipe(P.M((({menuMaxHeight:t})=>{e.style.setProperty("max-height",`${t}px`)}))))))),[b,i]);return jt.R.useSubscriptionTo(v),jt.R.useSubscriptionTo(b),jt.R.useSubscriptionTo(y),jt.R.useSubscriptionTo(_),s.createElement(al.j.Provider,{value:{portalContainer:c}},s.createElement(ri.F.div,{dir:"ltr","data-testid":"assistant",role:"dialog","aria-label":"Grammarly Assistant","data-dragging":e.dragBehavior.pipe(R.T((e=>"draggable"===e.kind&&e.isDragging))),tabIndex:0,onFocus:e.onFocus,onBlur:e.onBlur,className:Qt.Ks.joinClasses([pl,e.containerClassName]),style:Ct.zV([e.heightBehavior,e.widthBehavior]).pipe(R.T((([e,t])=>Object.assign(Object.assign({},"fitContainer"===e.kind?{height:"100%"}:{maxHeight:e.maxHeight,height:e.height}),"fitContainer"===t.kind?{width:"100%"}:{minWidth:t.minWidth,maxWidth:t.maxWidth})))),mount:t=>{var i;performance.mark(n.assistantContainerMounted),l(t),null===(i=e.onMountContainer)||void 0===i||i.call(e,t)}},e.a11yNotification,s.createElement(ri.F.header,{className:Ct.zV([g,e.dragBehavior]).pipe(R.T((([e,t])=>hl(e,"draggable"===t.kind)))),"aria-label":"Grammarly Assistant Header",mount:e.onMountHeader},e.header),s.createElement("div",{className:fl,"data-testid":"notifications"},s.createElement(ri.F.div,{className:g.view((0,j.Sw)(bl,_l))},e.notifications)),s.createElement(ll,{mount:d,className:Qt.Ks.joinClasses([gl,e.contentClassName]),onScroll:e=>g.set(e.currentTarget.scrollTop>0),style:(null!==(t=e.canScrollContent)&&void 0!==t?t:u.of(!0)).pipe(R.T((0,j.Sw)("auto","hidden")),R.T((e=>({overflowY:e})))),role:"main"},e.content),s.createElement("footer",{className:Qt.Ks.joinClasses([yl,e.footerClassName])},e.footer),s.createElement(ri.F.Fragment,null,b.pipe(R.T((({sentinelHeight:e})=>e?s.createElement("div",{key:"sentinel",className:kl,role:"presentation",style:{height:e}}):null)))),e.onboarding))},dl="header",ul="content",pl=Qt.Ks.style({overflow:"hidden",fontFamily:"Inter, sans-serif",padding:0,margin:0,borderRadius:"inherit",display:"grid",gridTemplateColumns:"1fr 0",gridTemplateRows:"auto 0 1fr auto",gridTemplateAreas:'"header sentinel" "notifications sentinel" "content sentinel" "footer sentinel"',background:ii.Q.Background.Base.Default,color:ii.Q.Text.Base.Default,$nest:{[`&:has(.${dl} [role=button][data-hovered=true])`]:{$nest:{[`.${dl}`]:{background:"inherit"}}},"&[data-dragging='true']":{cursor:"grabbing",$nest:{[`.${ul}`]:{pointerEvents:"none"},[`.${dl}`]:{pointerEvents:"none",background:yi.A.ButtonBackgroundTertiaryActive}}}}}),ml={minWidth:0},hl=(e,t)=>Qt.Ks.joinClasses([dl,Qt.Ks.style(Object.assign(Object.assign({},ml),{gridArea:"header",display:"flex",alignItems:"center",justifyContent:"space-between",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit",height:Qt.Ks.rem(3),gap:Qt.Ks.rem(ti.v$),padding:`0 ${Qt.Ks.rem(ti.v$)} 0 ${Qt.Ks.rem(ti.Jj)}`,boxSizing:"border-box",clipPath:e?"inset(0 0 -5px 0)":void 0,boxShadow:e?uo.R$.boxShadow:void 0,borderBottom:e?uo.R$.border:`0.5px solid ${yi.A.BorderBaseSubduedColor}`,zIndex:e?1:void 0,cursor:t?"grab":void 0,position:"relative","--grammarly-app-region":"drag",$nest:{button:{"--grammarly-app-region":"no-drag"},"&:hover":{background:t?yi.A.ButtonBackgroundTertiaryHover:void 0}}}))]),gl=Qt.Ks.joinClasses([ul,Qt.Ks.style(Object.assign(Object.assign({},ml),{gridArea:"content",$nest:{[`& [${za}] + [${za}]`]:{borderTop:`0.5px solid ${yi.A.BorderBaseSubduedColor}`},[`& [${rl}="${sl}"] + [${rl}="${sl}"]`]:{borderTop:0,position:"relative",$nest:{"&::before":{content:"''",position:"absolute",top:0,left:Qt.Ks.rem(1),right:Qt.Ks.rem(1),borderTop:`0.5px solid ${yi.A.BorderBaseSubduedColor}`}}}}}))]),fl=Qt.Ks.style({position:"relative",gridArea:"notifications"}),vl={zIndex:1e3,position:"absolute",right:Qt.Ks.rem(ti.v$),marginLeft:Qt.Ks.rem(ti.v$)},_l=Qt.Ks.style(Object.assign(Object.assign({},vl),{top:0})),bl=Qt.Ks.style(Object.assign(Object.assign({},vl),{top:Qt.Ks.rem(ti.or)})),yl=Qt.Ks.style(Object.assign(Object.assign({},ml),{gridArea:"footer",borderBottomLeftRadius:"inherit",borderBottomRightRadius:"inherit"})),kl=Qt.Ks.style({gridArea:"sentinel",visibility:"hidden"});function Sl(e){return"focus"===e.kind}function Cl(e){return"mount"===e.kind}function El(e){return"headerMount"===e.kind}function wl(e){return"rectChange"===e.kind}const Al=r.UI.Grid.make((({slots:e,notify:t,view:i})=>{const n=s.useContext(lo.q.Context);return s.createElement(cl,{key:"assistant-container",onFocus:t({kind:"focus",focused:!0}),onBlur:t({kind:"focus",focused:!1}),heightBehavior:i("heightBehavior"),widthBehavior:i("widthBehavior"),dragBehavior:i("dragBehavior"),menuRef:i("menuRef"),menuVerticalMargin:n.pipe(R.T((e=>(1+Ha)*e))),scrollContentToBottomToken:i("scrollContentToBottomToken"),canScrollContent:i("canScrollContent"),onMountContainer:e=>{e&&t({kind:"mount",element:e})()},onMountHeader:e=>{e&&t({kind:"headerMount",element:e})()},onRectChange:e=>{e&&t({kind:"rectChange",rect:e})()},header:e.header,content:e.content,footer:e.footer,notifications:e.notifications,onboarding:e.onboarding,a11yNotification:e.a11yNotification})}));var Il,xl=i(24871),Tl=i(96675),Fl=i(73921),Rl=i(44451);!function(e){let t,i;!function(e){e.ok="ok",e.satisfied="satisfied",e.dissatisfied="dissatisfied"}(t=e.Mood||(e.Mood={})),function(e){e.resultCard="resultCard",e.quickReplyInitialActions="quickReplyInitialActions",e.intentCard="intentCard"}(i=e.Source||(e.Source={}))}(Il||(Il={}));const Kl=e=>s.createElement(li.hh,Object.assign({width:"24",height:"24",fill:"none",viewBox:"0.5 0 24 24"},e),s.createElement("path",{d:"M12.5 23.25C18.7132 23.25 23.75 18.2132 23.75 12C23.75 5.7868 18.7132 0.75 12.5 0.75C6.2868 0.75 1.25 5.7868 1.25 12C1.25 18.2132 6.2868 23.25 12.5 23.25Z",fill:"url(#paint0_linear_4506_11023_disheartening_emoji)",stroke:"none"}),s.createElement("path",{d:"M8.97126 19.5491C10.9569 18.1193 14.0431 18.1193 16.0295 19.5491C16.3344 19.7674 16.5155 19.5315 16.4184 19.3455C14.4879 15.6555 10.5121 15.6555 8.58164 19.3455C8.48451 19.5315 8.66564 19.7674 8.97126 19.5491Z",fill:"#302C3B",stroke:"none"}),s.createElement("path",{d:"M19.895 12.8239C17.9806 13.5491 15.4865 12.8809 14.1909 11.2954C13.9925 11.0531 13.7945 11.2046 13.8328 11.376C14.5936 14.775 17.807 15.6364 20.1654 13.0721C20.2839 12.9435 20.1886 12.7133 19.895 12.8239Z",fill:"#302C3B",stroke:"none"}),s.createElement("path",{d:"M10.8091 11.2954C9.51351 12.8813 7.01976 13.5491 5.10501 12.8239C4.81176 12.7133 4.71614 12.9431 4.83464 13.0721C7.19301 15.6364 10.4064 14.775 11.1673 11.376C11.2059 11.2046 11.0079 11.0531 10.8091 11.2954Z",fill:"#302C3B",stroke:"none"}),s.createElement("defs",null,s.createElement("linearGradient",{id:"paint0_linear_4506_11023_disheartening_emoji",x1:"12.5002",y1:"23.25",x2:"12.5002",y2:"0.750188",gradientUnits:"userSpaceOnUse"},s.createElement("stop",{stopColor:"#FFA027"}),s.createElement("stop",{offset:"0.2723",stopColor:"#FFC151"}),s.createElement("stop",{offset:"0.7633",stopColor:"#FFC93F"}),s.createElement("stop",{offset:"1",stopColor:"#FFE261"})))),Ml=e=>s.createElement(li.hh,Object.assign({width:"24",height:"24",fill:"none",viewBox:"0.5 0 24 24"},e),s.createElement("path",{d:"M12.5 23.25C18.7132 23.25 23.75 18.2132 23.75 12C23.75 5.7868 18.7132 0.75 12.5 0.75C6.2868 0.75 1.25 5.7868 1.25 12C1.25 18.2132 6.2868 23.25 12.5 23.25Z",fill:"url(#paint0_linear_4506_11027_neutral_emoji)",stroke:"none"}),s.createElement("path",{d:"M17.3266 17.25H7.6726C6.7336 17.25 6.7336 15.75 7.6726 15.75H17.3266C18.2656 15.75 18.2656 17.25 17.3266 17.25Z",fill:"#302C3B",stroke:"none"}),s.createElement("path",{d:"M8.7496 12.1875C9.68158 12.1875 10.4371 11.1801 10.4371 9.9375C10.4371 8.69486 9.68158 7.6875 8.7496 7.6875C7.81762 7.6875 7.0621 8.69486 7.0621 9.9375C7.0621 11.1801 7.81762 12.1875 8.7496 12.1875Z",fill:"#302C3B",stroke:"none"}),s.createElement("path",{d:"M16.2496 12.1875C17.1816 12.1875 17.9371 11.1801 17.9371 9.9375C17.9371 8.69486 17.1816 7.6875 16.2496 7.6875C15.3176 7.6875 14.5621 8.69486 14.5621 9.9375C14.5621 11.1801 15.3176 12.1875 16.2496 12.1875Z",fill:"#302C3B",stroke:"none"}),s.createElement("defs",null,s.createElement("linearGradient",{id:"paint0_linear_4506_11027_neutral_emoji",x1:"12.5002",y1:"23.25",x2:"12.5002",y2:"0.750188",gradientUnits:"userSpaceOnUse"},s.createElement("stop",{stopColor:"#FFA027"}),s.createElement("stop",{offset:"0.2723",stopColor:"#FFC151"}),s.createElement("stop",{offset:"0.7633",stopColor:"#FFC93F"}),s.createElement("stop",{offset:"1",stopColor:"#FFE261"})))),Ol=e=>s.createElement(li.hh,Object.assign({width:"24",height:"24",fill:"none",viewBox:"0.5 0 24 24"},e),s.createElement("path",{d:"M12.5 23.25C18.7132 23.25 23.75 18.2132 23.75 12C23.75 5.7868 18.7132 0.75 12.5 0.75C6.2868 0.75 1.25 5.7868 1.25 12C1.25 18.2132 6.2868 23.25 12.5 23.25Z",fill:"url(#paint0_linear_11994_841_smiling_emoji)",stroke:"none"}),s.createElement("path",{d:"M5.82085 15.8453C7.89191 15.8453 9.57085 14.1663 9.57085 12.0953C9.57085 10.0242 7.89191 8.34528 5.82085 8.34528C3.74978 8.34528 2.07085 10.0242 2.07085 12.0953C2.07085 14.1663 3.74978 15.8453 5.82085 15.8453Z",fill:"url(#paint1_radial_11994_841_smiling_emoji)",stroke:"none"}),s.createElement("path",{d:"M19.1792 15.75C21.2502 15.75 22.9292 14.0711 22.9292 12C22.9292 9.92893 21.2502 8.25 19.1792 8.25C17.1081 8.25 15.4292 9.92893 15.4292 12C15.4292 14.0711 17.1081 15.75 19.1792 15.75Z",fill:"url(#paint2_radial_11994_841_smiling_emoji)",stroke:"none"}),s.createElement("path",{d:"M14.0844 9.3015C15.5 7.72425 17.7012 7.7235 19.1176 9.3015C19.3344 9.543 19.4634 9.282 19.3944 9.07725C18.0181 5.0055 15.1831 5.0055 13.8069 9.07725C13.7379 9.282 13.8669 9.54262 14.0844 9.3015Z",fill:"#302C3B",stroke:"none"}),s.createElement("path",{d:"M5.88312 9.3015C7.29949 7.72425 9.49999 7.7235 10.9164 9.3015C11.1331 9.543 11.2629 9.282 11.1931 9.07725C9.81687 5.0055 6.98187 5.0055 5.60562 9.07725C5.53699 9.282 5.66562 9.54262 5.88312 9.3015Z",fill:"#302C3B",stroke:"none"}),s.createElement("path",{d:"M17.1961 13.647C14.3352 15.7061 10.6614 15.705 7.802 13.647C7.397 13.356 7.15512 13.6706 7.28487 13.9178C9.4805 18.1151 15.5187 18.1144 17.7147 13.9178C17.8437 13.6703 17.6026 13.3556 17.1961 13.647Z",fill:"#302C3B",stroke:"none"}),s.createElement("defs",null,s.createElement("linearGradient",{id:"paint0_linear_11994_841_smiling_emoji",x1:"12.5002",y1:"23.25",x2:"12.5002",y2:"0.750188",gradientUnits:"userSpaceOnUse"},s.createElement("stop",{stopColor:"#FFA027"}),s.createElement("stop",{offset:"0.2723",stopColor:"#FFC151"}),s.createElement("stop",{offset:"0.7633",stopColor:"#FFC93F"}),s.createElement("stop",{offset:"1",stopColor:"#FFE261"})),s.createElement("radialGradient",{id:"paint1_radial_11994_841_smiling_emoji",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(5.82103 12.0952) scale(3.75 3.75)"},s.createElement("stop",{stopColor:"#F18D84"}),s.createElement("stop",{offset:"0.2514",stopColor:"#F29180",stopOpacity:"0.7486"}),s.createElement("stop",{offset:"0.5118",stopColor:"#F49E73",stopOpacity:"0.4882"}),s.createElement("stop",{offset:"0.7755",stopColor:"#F8B25F",stopOpacity:"0.2245"}),s.createElement("stop",{offset:"1",stopColor:"#FDCA47",stopOpacity:"0"})),s.createElement("radialGradient",{id:"paint2_radial_11994_841_smiling_emoji",cx:"0",cy:"0",r:"1",gradientUnits:"userSpaceOnUse",gradientTransform:"translate(19.179 12) scale(3.75)"},s.createElement("stop",{stopColor:"#F18D84"}),s.createElement("stop",{offset:"0.2514",stopColor:"#F29180",stopOpacity:"0.7486"}),s.createElement("stop",{offset:"0.5118",stopColor:"#F49E73",stopOpacity:"0.4882"}),s.createElement("stop",{offset:"0.7755",stopColor:"#F8B25F",stopOpacity:"0.2245"}),s.createElement("stop",{offset:"1",stopColor:"#FDCA47",stopOpacity:"0"})))),Nl="submitBtn",Bl={padding:Qt.Ks.rem(ti.Jj),gap:Qt.Ks.rem(ti.Jj)},Pl={color:ii.Q.Text.Base.Default,fontWeight:700,fontSize:Qt.Ks.rem(1.25),lineHeight:Qt.Ks.rem(1.5),margin:0},Dl={border:`${Qt.Ks.px(1)} solid ${si.NeutralGray20}`,borderRadius:Qt.Ks.rem(ni.KD),padding:`${Qt.Ks.rem(ti.v$+ti.sp)} ${Qt.Ks.rem(ti.v$)}`,height:Qt.Ks.rem(8)},Ll={display:"flex",alignItems:"flex-start",$nest:{"& input[type='checkbox']":{margin:`${Qt.Ks.rem(ti.vW)} ${Qt.Ks.rem(ti.v$)} 0 0`,minWidth:Qt.Ks.rem(1),minHeight:Qt.Ks.rem(1)},"& label":{color:ii.Q.Text.Base.Default,fontWeight:400,fontSize:Qt.Ks.rem(.75),lineHeight:Qt.Ks.rem(1.125)}}},Ul=Object.assign({width:Qt.Ks.percent(100)},(0,bi.T2)({fontSize:Qt.Ks.rem(.875)},Nl)),jl={display:"flex",flexDirection:"column",gap:Qt.Ks.rem(ti.v$)},Vl=Bl,$l=Qt.Ks.style(Pl),Hl=Qt.Ks.style(Dl),Zl=Qt.Ks.style(Ll),Gl=(Qt.Ks.style({fontWeight:700}),Qt.Ks.joinClasses([Nl,Qt.Ks.style(Ul)])),Wl=Qt.Ks.style(jl),zl=s.createContext(null),ql=e=>{const{children:t,label:i}=e,n=(0,Rl.Z)(e),{radioGroupProps:r,labelProps:o}=(0,xl.m)(Object.assign(Object.assign({},e),{orientation:"horizontal"}),n);return s.createElement("div",Object.assign({className:Jl},r),s.createElement("h1",Object.assign({className:$l},o),i),s.createElement(zl.Provider,{value:n},s.createElement("div",{className:Yl},t)))},Ql=e=>{const{icon:t,label:i,value:n}=e,r=s.useContext(zl);if(!r)return console.error("Score should be a child of ScoreGroup"),null;const o=s.useRef(null),{inputProps:a}=(0,xl.z)(e,r,o),{focusProps:l,isFocusVisible:c}=(0,Tl.og)(),d=r.selectedValue===n,u=(0,Fl.Bi)();return s.createElement("label",Object.assign({},(0,ra.Ly)(Xl,d&&ec,c&&tc)),s.createElement(Ma.s,null,s.createElement("input",Object.assign({},(0,Fl.v6)(a,l),{ref:o,"aria-labelledby":u}))),t,s.createElement(ia.E,{id:u,as:"span",variant:"text-small"},i))},Jl=Qt.Ks.style({display:"flex",flexDirection:"column",gap:Qt.Ks.rem(ti.Jj)}),Yl=Qt.Ks.style({display:"flex",flexDirection:"row",justifyContent:"space-between",paddingLeft:Qt.Ks.rem(ti.Jj),paddingRight:Qt.Ks.rem(ti.Jj)}),Xl=Qt.Ks.style({width:Qt.Ks.rem(5),height:Qt.Ks.rem(5),cursor:"pointer",display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center",gap:Qt.Ks.rem(ti.v$),borderRadius:Qt.Ks.rem(ni.KY),fontWeight:400,fontSize:Qt.Ks.rem(.75),lineHeight:Qt.Ks.rem(1.125),$nest:{"&:hover":{backgroundColor:ii.Q.Background.Base.Subdued}}}),ec=Qt.Ks.style({backgroundColor:si.Blue10,$nest:{"&:hover":{backgroundColor:si.Blue10}}}),tc=Qt.Ks.style({boxShadow:"0 0 0 2px rgb(2, 126, 111)"}),ic=Qt.Ks.style(Object.assign({},(0,bi.QD)(1.5))),nc=(0,ra.yY)((({selectedScore:e,onSelectScore:t})=>s.createElement(ql,{label:"How do you like Grammarly?",value:e,onChange:t},s.createElement(Ql,{value:Il.Mood.dissatisfied,label:"I dislike it",icon:s.createElement(Kl,{className:ic})}),s.createElement(Ql,{value:Il.Mood.ok,label:"It's OK",icon:s.createElement(Ml,{className:ic})}),s.createElement(Ql,{value:Il.Mood.satisfied,label:"I like it!",icon:s.createElement(Ol,{className:ic})})))),sc=(0,ra.yY)(Eo),rc=r.UI.Node.make((({state:e,view:t,notify:i})=>{const n=s.useContext(Io.D),r="domainCheckbox"+gt.G7(5);return s.createElement(qa,{style:Vl},s.createElement(nc,{selectedScore:t("formData").pipe(R.T((e=>e.mood))),onSelectScore:e=>i({kind:ft.t.Kind.feedbackFormChange,feedbackData:{mood:e}})()}),s.createElement(sc,{ariaLabel:"tell us why",className:Hl,placeholder:"How can we improve?",fitContentHeight:!1,text:t("formData").pipe(R.T((({message:e})=>null!=e?e:""))),onChange:e=>i({kind:ft.t.Kind.feedbackFormChange,feedbackData:{message:e}})(),useIframeWrapper:n.view((e=>e.useIframeTextfieldWrapper))}),e.pipe(R.T((({formData:e,domain:t,source:n})=>s.createElement("div",{className:Wl},(0,a.pipe)(t,o.fold(a.constNull,(t=>s.createElement("div",{className:Zl},s.createElement("input",{type:"checkbox",id:r,checked:void 0!==e.domain,onChange:i({kind:ft.t.Kind.feedbackFormChange,feedbackData:{domain:void 0!==e.domain?void 0:t}})}),s.createElement("label",{htmlFor:r},"Include the domain ",s.createElement("b",null,t)," with my feedback to help improve Grammarly."))))),(0,a.pipe)(o.fromNullable(void 0!==e.mood?Object.assign(Object.assign({},e),{mood:e.mood,source:n}):null),o.fold((()=>s.createElement(oi.$,{disabled:!0,className:Gl,onClick:a.constVoid},"Submit")),(e=>s.createElement(oi.$,{disabled:!1,className:Gl,onClick:i({kind:ft.t.Kind.feedbackFormSubmitButtonClick,feedbackData:e})},"Submit")))))))))})),oc=e=>s.createElement(li.hh,{className:e.className,viewBox:"0 0 20 20",width:20,height:20},s.createElement("path",{d:"M8.58541 3.37143C9.36646 2.59038 10.6328 2.59038 11.4138 3.37143L16.6283 8.5859C17.4094 9.36695 17.4094 10.6333 16.6283 11.4143L11.4138 16.6288C10.6328 17.4098 9.36646 17.4098 8.58541 16.6288L3.37094 11.4143C2.58989 10.6333 2.58989 9.36695 3.37094 8.5859L8.58541 3.37143ZM11.4371 6.25011C11.4371 5.4562 10.7935 4.81261 9.99962 4.81261C9.20571 4.81261 8.56212 5.4562 8.56212 6.25011V10.6251C8.56212 11.3163 9.04996 11.8936 9.70011 12.0314C9.04996 12.1692 8.56212 12.7464 8.56212 13.4376C8.56212 14.2315 9.20571 14.8751 9.99962 14.8751C10.7935 14.8751 11.4371 14.2315 11.4371 13.4376C11.4371 12.7464 10.9493 12.1692 10.2991 12.0314C10.9493 11.8936 11.4371 11.3163 11.4371 10.6251V6.25011Z",fill:"#D31332",stroke:"#D31332"})),ac=({options:e,onSubmit:t,onCancel:i})=>{const[n,r]=s.useState(o.none),[l,c]=s.useState(!1);return s.createElement(ri.F.form,{id:"radioOptionsForm",onSubmit:e=>{(0,a.pipe)(n,o.fold((()=>c(!0)),t)),e.preventDefault()},className:Qt.Ks.style(lc)},s.createElement("fieldset",{className:mc,style:{borderColor:l?si.Red60:"transparent"}},(0,a.pipe)(e,C.Tj((e=>s.createElement("span",{key:e,className:cc},s.createElement("input",{type:"radio",id:e,value:e,name:e,checked:(0,a.pipe)(n,o.filter((t=>t===e)),o.isSome),onChange:()=>{c(!1),r(o.some(e))},style:{margin:`0 ${Qt.Ks.rem(.5)} 0 0`}}),s.createElement("label",{htmlFor:e},e)))))),l&&s.createElement("div",{className:pc},s.createElement(oc,{className:uc})," Make a selection"),s.createElement("div",{className:dc},s.createElement(oi.$,{type:"submit",form:"radioOptionsForm",name:"submitSelectedRadioOption",style:{default:lc}},"Submit"),"",s.createElement(oi.$,{variant:"tertiary",onClick:i,name:"cancelRadioOptionSelection",style:{default:lc}},"Cancel")))},lc={fontSize:Qt.Ks.rem(.875)},cc=Qt.Ks.style({display:"inline-flex",alignItems:"center"}),dc=Qt.Ks.style({paddingTop:Qt.Ks.rem(.5)}),uc=Qt.Ks.style({minWidth:"unset",minHeight:"unset"}),pc=Qt.Ks.style({color:si.Red60,lineHeight:Qt.Ks.rem(1.5)}),mc=Qt.Ks.style({marginLeft:`calc(-1 * ${Qt.Ks.rem(.25)})`,padding:Qt.Ks.rem(.25),display:"flex",flexDirection:"column",gap:Qt.Ks.rem(.5),width:"fit-content",border:"1px solid transparent",borderRadius:Qt.Ks.rem(.25),margin:0}),hc=r.UI.Node.make((({view:e,notify:t})=>s.createElement(qa,{style:fc,"data-testid":"follow-up-prompt"},s.createElement(ri.F.div,{className:vc},s.createElement(ri.F.img,{src:e("iconUrl"),style:{width:Qt.Ks.rem(1.25),height:Qt.Ks.rem(1.25)}}),s.createElement(ri.F.span,Object.assign({},z(e("header"))))),s.createElement(ri.F.div,null,e("hintsHeader")),e("hintsItems").pipe(R.T((0,a.flow)(C.Tj((e=>s.createElement("li",{key:e},e))),E._S,o.fold(a.constNull,(e=>s.createElement("ul",{key:"action-followup-radio-list",className:_c},e)))))),e("radioOptions").pipe(R.T(o.fold(a.constNull,(e=>s.createElement(ac,{key:"radioOptions",options:e,onSubmit:e=>t({kind:ft.t.Kind.radioOptionsSubmitButtonClick,selectedOption:e})(),onCancel:t({kind:ft.t.Kind.radioOptionsCancelButtonClick})})))))))),gc=r.UI.Union.asOption(hc),fc={fontWeight:400,fontSize:Qt.Ks.rem(.875),lineHeight:Qt.Ks.rem(1.3125),padding:`${Qt.Ks.rem(ti.CN)} ${Qt.Ks.rem(ti.Jj)} ${Qt.Ks.rem(1.5)} ${Qt.Ks.rem(ti.Jj)}`,borderBottom:`0.5px solid ${yi.A.BorderBaseSubduedColor}`},vc=Qt.Ks.style({display:"flex",alignItems:"start",gap:Qt.Ks.rem(ti.v$),color:ii.Q.Text.Base.Subdued,fontSize:Qt.Ks.rem(.875),lineHeight:Qt.Ks.rem(1.3125),padding:`${Qt.Ks.rem(ti.v$)} 0`}),_c=Qt.Ks.style({padding:`0 0 0 ${Qt.Ks.rem(ti.v5+ti.sp)}`,margin:0}),bc=(0,Yt.w)("nocolor",(({title:e,titleId:t,desc:i,descId:n,...r})=>s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",viewBox:"0 0 24 24","aria-hidden":"true",stroke:"transparent","aria-labelledby":t,"aria-describedby":n,...r},i?s.createElement("desc",{id:n},i):null,e?s.createElement("title",{id:t},e):null,s.createElement("path",{fill:"#FFC8D2",fillRule:"evenodd",d:"m6.75 6.926 5.113-1.676 5.113 1.676v3.45a8.64 8.64 0 0 1-3.164 6.684l-1.949 1.597-1.95-1.597a8.64 8.64 0 0 1-3.163-6.683z",clipRule:"evenodd"}),s.createElement("g",{filter:"url(#tnessa)"},s.createElement("path",{fill:"#EE445F",fillRule:"evenodd",d:"M11.863 5.25v13.407l-1.95-1.597a8.64 8.64 0 0 1-3.163-6.683V6.926z",clipRule:"evenodd"})),s.createElement("defs",null,s.createElement("filter",{id:"tnessa",width:15.113,height:23.407,x:1.75,y:.25,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse"},s.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),s.createElement("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),s.createElement("feOffset",null),s.createElement("feGaussianBlur",{stdDeviation:2.5}),s.createElement("feColorMatrix",{values:"0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 1 0"}),s.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_5231_1810"}),s.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_5231_1810",result:"shape"})))))),yc=(0,Yt.w)("nocolor",(({title:e,titleId:t,desc:i,descId:n,...r})=>s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",viewBox:"0 0 24 24","aria-hidden":"true",stroke:"transparent","aria-labelledby":t,"aria-describedby":n,...r},i?s.createElement("desc",{id:n},i):null,e?s.createElement("title",{id:t},e):null,s.createElement("path",{fill:"#B3D1FF",fillRule:"evenodd",d:"M12 18a6 6 0 1 0 0-12 6 6 0 0 0 0 12",clipRule:"evenodd",opacity:.6}),s.createElement("g",{filter:"url(#aritya)"},s.createElement("path",{fill:"#548AFF",d:"M18 12a6 6 0 1 1-11.723-1.806 4.456 4.456 0 0 1 5.315 1.103 4.265 4.265 0 0 0 6.001.46c.022-.019.17-.164.376-.367q.03.3.031.61"})),s.createElement("defs",null,s.createElement("filter",{id:"aritya",width:22,height:18.25,x:1,y:4.75,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse"},s.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),s.createElement("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),s.createElement("feOffset",null),s.createElement("feGaussianBlur",{stdDeviation:2.5}),s.createElement("feColorMatrix",{values:"0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0.8 0"}),s.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_5231_1804"}),s.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_5231_1804",result:"shape"})))))),kc=(0,Yt.w)("nocolor",(({title:e,titleId:t,desc:i,descId:n,...r})=>s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",viewBox:"0 0 24 24","aria-hidden":"true",stroke:"transparent","aria-labelledby":t,"aria-describedby":n,...r},i?s.createElement("desc",{id:n},i):null,e?s.createElement("title",{id:t},e):null,s.createElement("path",{fill:"#B9F9EA",fillRule:"evenodd",d:"M12 18a6 6 0 1 0 0-12 6 6 0 0 0 0 12",clipRule:"evenodd"}),s.createElement("g",{filter:"url(#ementa)"},s.createElement("path",{fill:"#0FDCAC",fillRule:"evenodd",d:"M12 13.5A3.75 3.75 0 1 0 12 6a3.75 3.75 0 0 0 0 7.5m0 4.5a3.75 3.75 0 1 0 0-7.5 3.75 3.75 0 0 0 0 7.5",clipRule:"evenodd"})),s.createElement("path",{fill:"#C0F9EC",fillRule:"evenodd",d:"M15 12a3.74 3.74 0 0 1-3 1.5A3.74 3.74 0 0 1 9 12a3.74 3.74 0 0 1 3-1.5c1.227 0 2.316.59 3 1.5",clipRule:"evenodd"}),s.createElement("defs",null,s.createElement("filter",{id:"ementa",width:17.5,height:22,x:3.25,y:1,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse"},s.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),s.createElement("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),s.createElement("feOffset",null),s.createElement("feGaussianBlur",{stdDeviation:2.5}),s.createElement("feColorMatrix",{values:"0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 1 0"}),s.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_5231_1822"}),s.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_5231_1822",result:"shape"})))))),Sc=(0,Yt.w)("nocolor",(({title:e,titleId:t,desc:i,descId:n,...r})=>s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",viewBox:"0 0 24 24","aria-hidden":"true",stroke:"transparent","aria-labelledby":t,"aria-describedby":n,...r},i?s.createElement("desc",{id:n},i):null,e?s.createElement("title",{id:t},e):null,s.createElement("path",{fill:"#E8C7FF",fillRule:"evenodd",d:"M12 18a6 6 0 1 0 0-12 6 6 0 0 0 0 12",clipRule:"evenodd"}),s.createElement("g",{filter:"url(#iverya)"},s.createElement("path",{fill:"#D29CFA",fillRule:"evenodd",d:"M12 18a4.494 4.494 0 0 0 4.488-4.5c0-2.485-2.01-4.5-4.488-4.5a4.494 4.494 0 0 0-4.487 4.5c0 2.485 2.009 4.5 4.487 4.5",clipRule:"evenodd"})),s.createElement("g",{filter:"url(#iveryb)"},s.createElement("path",{fill:"#BC78ED",fillRule:"evenodd",d:"M12 18a3 3 0 1 0 0-6 3 3 0 0 0 0 6",clipRule:"evenodd"})),s.createElement("defs",null,s.createElement("filter",{id:"iverya",width:18.975,height:19,x:2.513,y:4,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse"},s.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),s.createElement("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),s.createElement("feOffset",null),s.createElement("feGaussianBlur",{stdDeviation:2.5}),s.createElement("feColorMatrix",{values:"0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0.934441 0"}),s.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_5231_1816"}),s.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_5231_1816",result:"shape"})),s.createElement("filter",{id:"iveryb",width:16,height:16,x:4,y:7,colorInterpolationFilters:"sRGB",filterUnits:"userSpaceOnUse"},s.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),s.createElement("feColorMatrix",{in:"SourceAlpha",result:"hardAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),s.createElement("feOffset",null),s.createElement("feGaussianBlur",{stdDeviation:2.5}),s.createElement("feColorMatrix",{values:"0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0.5 0"}),s.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_5231_1816"}),s.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_5231_1816",result:"shape"})))))),Cc=(0,Yt.w)("nocolor",(({title:e,titleId:t,desc:i,descId:n,...r})=>s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",viewBox:"0 0 24 24","aria-hidden":"true",stroke:"transparent","aria-labelledby":t,"aria-describedby":n,...r},i?s.createElement("desc",{id:n},i):null,e?s.createElement("title",{id:t},e):null,s.createElement("path",{fill:"url(#oldera)",fillRule:"evenodd",d:"M11.537 11.537q-2.712.392-4.145-1.04-1.43-1.431-1.04-4.145 2.714-.39 4.145 1.04c.955.955 1.318 2.447 1.04 4.145",clipRule:"evenodd"}),s.createElement("path",{fill:"url(#olderb)",fillRule:"evenodd",d:"M17.648 6.352q.39 2.713-1.04 4.145-1.433 1.432-4.145 1.04-.393-2.713 1.04-4.145c.954-.954 2.446-1.317 4.145-1.04",clipRule:"evenodd"}),s.createElement("path",{fill:"url(#olderc)",fillRule:"evenodd",d:"M12.463 12.463q2.712-.392 4.145 1.04 1.43 1.431 1.04 4.145-2.714.39-4.145-1.04c-.955-.955-1.318-2.447-1.04-4.145",clipRule:"evenodd"}),s.createElement("path",{fill:"url(#olderd)",fillRule:"evenodd",d:"M6.353 17.648q-.393-2.713 1.04-4.145 1.431-1.432 4.145-1.04.39 2.713-1.04 4.145c-.955.954-2.447 1.317-4.145 1.04",clipRule:"evenodd"}),s.createElement("defs",null,s.createElement("linearGradient",{id:"oldera",x1:11.64,x2:6.24,y1:9.84,y2:9.84,gradientUnits:"userSpaceOnUse"},s.createElement("stop",{stopColor:"#D2E3FF"}),s.createElement("stop",{offset:1,stopColor:"#548AFF"})),s.createElement("linearGradient",{id:"olderb",x1:12.36,x2:17.76,y1:8.04,y2:8.04,gradientUnits:"userSpaceOnUse"},s.createElement("stop",{stopColor:"#FFD0D8"}),s.createElement("stop",{offset:1,stopColor:"#EE445F"})),s.createElement("linearGradient",{id:"olderc",x1:12.36,x2:17.76,y1:14.16,y2:14.16,gradientUnits:"userSpaceOnUse"},s.createElement("stop",{stopColor:"#ECD1FF"}),s.createElement("stop",{offset:1,stopColor:"#BC78ED"})),s.createElement("linearGradient",{id:"olderd",x1:12,x2:6.6,y1:15.96,y2:15.96,gradientUnits:"userSpaceOnUse"},s.createElement("stop",{offset:.196,stopColor:"#CAFAEF"}),s.createElement("stop",{offset:1,stopColor:"#0FDCAC"}))))));var Ec=i(88793);const wc=({icon:e,categoryLabel:t,scoreSubtitle:i,progressValue:n,progressBarColor:r,trackColor:o,showOkIcon:l})=>{const c=(0,Fl.Bi)(),d=(0,Fl.Bi)(),u=(0,Fl.Bi)();return s.createElement("li",{"aria-labelledby":`${c} ${d} ${u}`,className:Ac},(0,a.pipe)(e,S.fold((e=>s.createElement(vi,{className:xc,"aria-hidden":!0},s.createElement(Jt.I,{icon:e,accessibilityLabel:"",size:"large"}))),(e=>s.createElement("img",{src:e,className:Mc,"aria-hidden":!0})))),s.createElement(ia.E,{as:"span",variant:"text-small",marginRight:4,id:c},t),s.createElement("span",{hidden:!0,id:d},null!==n?`${Math.round(100*n)}%`:""),s.createElement("div",{className:Rc,style:{backgroundColor:r,borderColor:o},"aria-hidden":!0},s.createElement("div",{className:Kc,style:{width:n?`${Math.round(100*n)}%`:0,backgroundColor:o}})),s.createElement("div",{className:Fc},l&&s.createElement(vi,{className:Tc,"aria-hidden":!0},s.createElement(Jt.I,{icon:Ec.k,accessibilityLabel:"",variant:"deletion"})),s.createElement(ia.E,{as:"span",variant:"text-small",color:"base-subdued",className:Ic,id:u},i)))},Ac=Qt.Ks.style({display:"contents"}),Ic=Qt.Ks.style({whiteSpace:"nowrap"}),xc=Qt.Ks.style({marginRight:Qt.Ks.rem(ti.v$)}),Tc=Qt.Ks.style({marginRight:Qt.Ks.rem(ti.v$)}),Fc=Qt.Ks.style({marginLeft:Qt.Ks.rem(ti.Jj),display:"flex",alignItems:"center"}),Rc=Qt.Ks.style({height:Qt.Ks.rem(ti.or),width:"100%",position:"relative",borderRadius:Qt.Ks.rem(ni.KD),borderStyle:"solid",borderWidth:"1px",boxSizing:"border-box"}),Kc=Qt.Ks.style({position:"absolute",left:0,bottom:0,height:"100%"}),Mc=Qt.Ks.style({width:Qt.Ks.rem(1.5),height:Qt.Ks.rem(1.5)}),Oc={correctness:"Looking good",clarity:"Very clear",engagement:"Very engaging",delivery:"Just right",styleGuide:"All good"},Nc={correctness:"No alerts",clarity:"So far so good",engagement:"Nothing yet",delivery:"Nothing yet",styleGuide:"Nothing yet"};const Bc=r.UI.Node.make((({state:e})=>{const t=(0,Fl.Bi)();return s.createElement(ri.F.Fragment,null,e.pipe(R.T((({score:e,isTextEmpty:i,styleGuideEnabled:n,institutionLogoUrl:r})=>{const o=function(e,t){return i=>{if(t||"loading"===e.status||"tooSmall"===e.status)return Nc[i];{switch(i){case"clarity":return function({score:e,alerts:t}){return 0===t?Oc.clarity:0===e?`${t} ${gt.td(t,"alert","alerts")}`:e<.2?"Unclear":e<.7?"A bit unclear":e<.85?"Mostly clear":e<.95?"Clear":Oc.clarity}(e.outcomeScores.clarity);case"engagement":return function({score:e,alerts:t}){return 0===t?Oc.engagement:0===e?`${t} ${gt.td(t,"alert","alerts")}`:e<.2?"Bland":e<.8?"A bit bland":e<.95?"Engaging":Oc.engagement}(e.outcomeScores.engagement);case"delivery":return function({score:e,alerts:t}){return 0===t?Oc.delivery:0===e?`${t} ${gt.td(t,"alert","alerts")}`:e<.2?"Serious issues":e<.8?"Very off":e<.95?"Slightly off":Oc.delivery}(e.outcomeScores.delivery)}const t=e.outcomeScores[i].alerts;return t>0?`${t} ${gt.td(t,"alert","alerts")}`:Oc[i]}}}(e,i),l=function(e,t){return i=>{if(t)return null;switch(e.status){case"loading":case"tooSmall":return null;case"ok":return 0===e.outcomeScores[i].alerts?1:e.outcomeScores[i].score;default:(0,g.AS)(e)}}}(e,i),c=function(e,t){return i=>{if(t)return!0;switch(e.status){case"loading":case"tooSmall":return!0;case"ok":return 0===e.outcomeScores[i].alerts;default:(0,g.AS)(e)}}}(e,i);return s.createElement("ul",{className:Pc,key:"outcomes-grid","aria-labelledby":t},s.createElement("span",{hidden:!0,id:t},"Outcome scores"),s.createElement(wc,{categoryLabel:"Correctness",icon:S.left(bc),scoreSubtitle:o("correctness"),progressValue:l("correctness"),showOkIcon:c("correctness"),progressBarColor:ii.Q.Background.Correctness.Subdued,trackColor:ii.Q.Background.Correctness.Default}),s.createElement(wc,{categoryLabel:"Clarity",icon:S.left(yc),scoreSubtitle:o("clarity"),progressValue:l("clarity"),showOkIcon:c("clarity"),progressBarColor:ii.Q.Background.Clarity.Subdued,trackColor:ii.Q.Background.Clarity.Default}),s.createElement(wc,{categoryLabel:"Engagement",icon:S.left(kc),scoreSubtitle:o("engagement"),progressValue:l("engagement"),showOkIcon:c("engagement"),progressBarColor:ii.Q.Background.Engagement.Subdued,trackColor:ii.Q.Background.Engagement.Default}),s.createElement(wc,{categoryLabel:"Delivery",icon:S.left(Sc),scoreSubtitle:o("delivery"),progressValue:l("delivery"),showOkIcon:c("delivery"),progressBarColor:ii.Q.Background.Delivery.Subdued,trackColor:ii.Q.Background.Delivery.Default}),n&&s.createElement(wc,{categoryLabel:"Style guide",icon:(0,a.pipe)(r,S.fromOption((()=>Cc))),scoreSubtitle:o("styleGuide"),progressValue:l("styleGuide"),showOkIcon:c("styleGuide"),progressBarColor:ii.Q.Background.Business.Subdued,trackColor:ii.Q.Background.Business.Default}))}))))})),Pc=Qt.Ks.style({display:"grid",gridTemplateColumns:`min-content min-content minmax(${Qt.Ks.rem(2)}, ${Qt.Ks.rem(6)}) min-content`,gridTemplateRows:"auto",rowGap:Qt.Ks.rem(ti.v$),alignItems:"center",padding:`${Qt.Ks.rem(ti.or)} 0`});var Dc=i(61229),Lc=i(80764);const Uc=({score:e,className:t})=>s.createElement(Dc.s,{direction:"column",align:"center",className:t},s.createElement(ia.E,{as:"strong",variant:"heading-large"},e),s.createElement(ia.E,{as:"span",align:"center",variant:"text-small",color:"base-subdued",className:jc},"of 100")),jc=Qt.Ks.style({whiteSpace:"nowrap"}),Vc=e=>s.createElement(li.hh,Object.assign({width:"64",height:"64",viewBox:"0 0 64 64"},e,{fill:"none"}),s.createElement("circle",{cx:"32",cy:"32",r:"19",stroke:"#C6CBDE",strokeWidth:"2"}),s.createElement("path",{d:"M25 33L30 38L49.5 18.5",stroke:"white",strokeWidth:"8",strokeLinecap:"round"}),s.createElement("path",{d:"M25 33L30 38L49.5 18.5",stroke:"#15C39A",strokeWidth:"3",strokeLinecap:"round"})),$c=(0,ra.yY)(Dc.s),Hc=(0,ra.yY)(ia.E),Zc=r.UI.Node.make((({state:e})=>s.createElement($c,{direction:"row",gap:4,align:"center"},e.pipe(R.T(Qi({loading:()=>s.createElement(Vc,{className:Wc}),tooSmall:()=>s.createElement(Vc,{className:Wc}),ok:e=>100===e.generalScore?s.createElement(Vc,{className:Wc}):s.createElement(Uc,{score:e.generalScore,className:Gc})}))),s.createElement(Dc.s,{direction:"column"},s.createElement(Lc.D,{as:"h2",variant:"heading-xsmall"},"Overall score"),s.createElement(Hc,{as:"p",variant:"text-small",color:"base-subdued"},e.pipe(R.T(Qi({loading:()=>"Grammarly needs at least 30 words to calculate a score.",tooSmall:()=>"Grammarly needs at least 30 words to calculate a score.",ok:e=>100===e.generalScore?"Great! This text scores 100 out of 100.":"The score represents the quality of this text. Increase it by addressing issues."})))))))),Gc=Qt.Ks.style({width:Qt.Ks.rem(4),height:Qt.Ks.rem(4),minWidth:Qt.Ks.rem(4),minHeight:Qt.Ks.rem(4),boxSizing:"border-box",padding:`${Qt.Ks.rem(ti.v$)} ${Qt.Ks.rem(ti.or)} ${Qt.Ks.rem(ti.sp)} ${Qt.Ks.rem(ti.or)}`}),Wc=Qt.Ks.style({minWidth:Qt.Ks.rem(4),minHeight:Qt.Ks.rem(4)}),zc=r.UI.Grid.make((({slots:e,state:t,notify:i})=>{const{onMount:n}=(0,po.y)((0,a.flow)(Ot.E(t),P.M((([e,t])=>i({kind:"performanceScoreMountAction",score:t})()))));return s.createElement(qa,{"data-testid":"performance-score",mount:n},e.overallScore,s.createElement("div",{className:Jc,"aria-hidden":!0}),e.outcomeScores)})),qc=r.UI.Knot.make(zc,{overallScore:Zc,outcomeScores:Bc}),Qc=r.UI.Union.asOption(qc),Jc=Qt.Ks.style({borderTop:`1px solid ${ii.Q.Border.Base.Subdued}`,margin:`${Qt.Ks.rem(ti.v$)} 0`}),Yc=({children:e,style:t})=>s.createElement(ri.F.h1,{className:(0,Se.b)(t).pipe(R.T((e=>Qt.Ks.style({color:ii.Q.Text.Base.Default,margin:0,padding:`0 0 ${Qt.Ks.rem(ti.v$)} 0`,fontWeight:700,fontSize:Qt.Ks.rem(1),lineHeight:Qt.Ks.rem(1.5),overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},e))))},e);var Xc=i(31488),ed=i(78044);const td=(0,Yt.w)("color",(({title:e,titleId:t,desc:i,descId:n,...r})=>s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16","aria-hidden":"true",stroke:"transparent","aria-labelledby":t,"aria-describedby":n,...r},i?s.createElement("desc",{id:n},i):null,e?s.createElement("title",{id:t},e):null,s.createElement("path",{fill:"#646B81",stroke:"#646B81",strokeWidth:2,d:"m7 7 1 1.333L9 7z"}))));var id=i(12166);const nd={border:`1px solid ${ii.Q.Background.Neutral.Default}`,borderRadius:Qt.Ks.rem(ni.KD),width:Qt.Ks.rem(15),height:Qt.Ks.rem(2),boxSizing:"border-box",position:"relative"},sd={padding:`${Qt.Ks.rem(ti.or)} ${Qt.Ks.rem(ti.CN)}`,width:"100%",height:"100%",border:"none",background:"transparent",position:"relative",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",gap:Qt.Ks.rem(ti.or)},rd={fontWeight:400,fontSize:Qt.Ks.rem(.875),lineHeight:Qt.Ks.rem(1.375),color:ii.Q.Text.Base.Default},od={padding:Qt.Ks.rem(ti.or),background:"white",boxShadow:uo.R$.boxShadow,border:uo.R$.border,borderRadius:Qt.Ks.rem(ni.KD),width:Qt.Ks.rem(15),boxSizing:"border-box",overflowY:"auto",maxHeight:Qt.Ks.rem(8.125),zIndex:9999,$nest:{"& > ul":{listStyle:"none",padding:0,margin:0,$nest:{"& > li":{padding:0,margin:0}}}}},ad={border:"none",background:"transparent",width:"100%",cursor:"pointer",overflow:"hidden",textOverflow:"ellipsis",fontSize:Qt.Ks.rem(.875),lineHeight:Qt.Ks.rem(1.375),color:ii.Q.Text.Base.Default,padding:`${Qt.Ks.rem(.1875)} ${Qt.Ks.rem(ti.CN)}`,borderRadius:Qt.Ks.rem(ni.KD),display:"flex",justifyContent:"flex-start",$nest:{"&:hover":{color:ii.Q.Text.Base.Inverse,background:si.NeutralGray40}}},ld=Qt.Ks.style(nd),cd=Qt.Ks.style(sd),dd=Qt.Ks.style(rd),ud=Qt.Ks.style(od),pd=Qt.Ks.style(ad),md=new ed.C(999999);function hd({label:e,selection:t,className:i,menuClassName:n,placeholder:r,options:o,optionsGroupLabel:a,onSelectionChange:c,onOptionsExpanded:d,renderOption:u,disabled:p=!1}){const[h,g]=s.useState(!1),f=s.useRef(md.newId().toString()),v=s.useRef(md.newId().toString()),_=s.useRef(null),[b,y]=s.useState(null),[k,S]=s.useState(null),{styles:C,attributes:E}=(0,Xc.E)(b,k,{placement:"bottom-start",modifiers:[{name:"offset",options:{offset:[0,4]}}]}),w=s.useMemo((()=>new l.B7),[]),A=s.useMemo((()=>w.pipe($t.B(100),m.p((e=>!e)),P.M((()=>{g(!1)})))),[w,g]);return jt.R.useSubscriptionTo(A),s.createElement("div",Object.assign({},(0,ra.Ly)(ld,i,p?fd:void 0),{ref:y}),s.createElement("button",{ref:_,disabled:p,"aria-disabled":p,className:cd,onClick:()=>{var e;h?g(!1):(g(!0),w.next(!0),null==d||d(t),null===(e=_.current)||void 0===e||e.focus())},onFocus:()=>{w.next(!0)},onBlur:()=>w.next(!1),type:"button","aria-haspopup":"listbox","aria-owns":f.current,"aria-expanded":h,"aria-labelledby":v.current},s.createElement("div",{id:v.current,className:dd},t?u?u(t):e(t):r),s.createElement(td,null)),h&&s.createElement("div",Object.assign({ref:S,style:C.popper},E.popper,{className:Qt.Ks.joinClasses([ud,n]),onFocus:()=>w.next(!0),onBlur:()=>w.next(!1)}),s.createElement("ul",{"aria-label":"menu-options",role:"listbox",id:f.current},a?s.createElement("header",{className:gd,role:"presentation"},a):null,o.map(((t,i)=>{const n=e(t);return s.createElement("li",{key:i,"aria-label":n,role:"option"},s.createElement("button",{className:pd,onClick:(0,id.e)((()=>{c(t),g(!1)}))},u?u(t):e(t)))})))))}const gd=Qt.Ks.style({padding:Qt.Ks.rem(ti.v$),paddingRight:Qt.Ks.rem(ti.Jj),fontSize:Qt.Ks.rem(.75),lineHeight:"1.5em",color:ii.Q.Text.Base.Subdued}),fd=Qt.Ks.style({opacity:.4}),vd=({pageRange:e,onPageRangeHeaderMount:t})=>{const{onMount:i}=(0,po.y)(P.M(t));return s.createElement(ri.F.div,{className:_d,mount:i},"Pages ",e.startPage,"-",e.endPage)},_d=Qt.Ks.style({fontSize:Qt.Ks.rem(.75),fontWeight:400});var bd=i(44551),yd=i(14342),kd=i(56453);const Sd=s.forwardRef((function(e,t){var{defaultHeight:i,initialVisible:n=!1,resetHeightToDefault:r=D.w,visibleOffset:o=500,children:a}=e,l=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(i[n[s]]=e[n[s]])}return i}(e,["defaultHeight","initialVisible","resetHeightToDefault","visibleOffset","children"]);const[c,d]=s.useState(n),[u,p]=s.useState(i),m=s.useRef(null),{registerIntersectionObserver:h}=s.useContext(Zo);return s.useEffect((()=>{const e=r.subscribe((()=>p(i)));return()=>e.unsubscribe()}),[i]),s.useEffect((()=>{const e=m.current;if(e){const t=h(`${o}px 0px ${o}px 0px`,e,(t=>{t.isIntersecting||p(e.offsetHeight),d(t.isIntersecting)}));return()=>t.dispose()}return()=>{}}),[m]),s.createElement("div",Object.assign({},l,{ref:Ho([m,t])}),c?a:s.createElement("div",{style:{height:u}}))})),Cd=({item:e,kind:t,notify:i})=>(n,s,r)=>{if(i({kind:t,item:e,sourceId:n,actions:s,scope:r})(),!s.some((e=>"notify"===e.type&&e.userAction===Nn.nm.Click)))return;const o=(e=>{if(!e)return;const t=e.lastIndexOf(":");return t<0?void 0:e.slice(t+1)})(n);switch(o){case"accept":return void i({kind:ft.t.Kind.suggestionAcceptClick})();case"actions-menu-incorrect-report":return void i({kind:ft.t.Kind.actionsMenuReportIncorrectClick})();case"actions-menu-mute":return void i({kind:ft.t.Kind.actionsMenuMuteClick})();case"actions-menu-offensive-report":return void i({kind:ft.t.Kind.actionsMenuReportOffensiveClick})();case"dict":return void i({kind:ft.t.Kind.addToDictionaryClick})();case"dismiss":return void i({kind:ft.t.Kind.suggestionDismissClick})();default:return}};var Ed=i(96955);const wd=e=>{const t=s.useRef(null),i=function(e,t){switch(e){case"behavior:animation:fadeIn":return{className:Qt.Ks.style(Id(xd,Fd(t))),direction:"in"};case"behavior:animation:fadeOut":return{className:Qt.Ks.style(Id(Td,Fd(t))),direction:"out"};default:(0,g.xb)(e)}}(e.type,e.timeCurve),[n,r]=s.useState("in"===i.direction?i.className:void 0);return s.useEffect((()=>()=>{var e,n;t.current&&!(null!==(n=null===(e=t.current.shadowRoot)||void 0===e?void 0:e.ownerDocument.defaultView)&&void 0!==n?n:window).matchMedia("(prefers-reduced-motion: reduce)").matches&&function(e,t){(0,a.pipe)((0,a.tuple)((0,a.pipe)(t,o.fromPredicate((e=>"out"===e.direction))),Ad(e)),(0,a.tupled)(k.CO(o.option)),L.Mi((([t,i])=>{var n,s;const r=null!==(s=null===(n=e.shadowRoot)||void 0===n?void 0:n.ownerDocument)&&void 0!==s?s:document,l=e.getBoundingClientRect(),c=e.cloneNode(!0);c.classList.add(t.className),c.style.position="absolute",c.style.top=`${l.top}px`,c.style.left=`${l.left}px`,c.style.width=`${l.width}px`,c.style.height=`${l.height}px`,requestAnimationFrame((()=>{(0,a.pipe)(i.find((e=>r.contains(e))),o.fromNullable,L.Mi((e=>{c.addEventListener("animationend",(()=>{r.contains(c)&&c.remove()})),e.appendChild(c)})))}))})))}(t.current,i)}),[i]),s.createElement("div",{"data-testid":"behavior-animation-wrapper","data-animation":e.type,ref:t,className:n,onAnimationEnd:()=>r(void 0)},e.children)};function Ad(e,t=[]){return(0,a.pipe)(e.parentElement,o.fromNullable,o.chain((e=>Ad(e,[...t,e]))),o.alt((()=>E.ci(t))))}const Id=(e,t)=>({$nest:{"@media (prefers-reduced-motion: no-preference)":{animation:`${e} ${Qt.Ks.seconds(.3)} ${t}`}}}),xd=Qt.Ks.keyframes({from:{opacity:0,visibility:"hidden"},to:{opacity:1,visibility:"visible"}}),Td=Qt.Ks.keyframes({from:{opacity:1,visibility:"visible"},to:{opacity:0,visibility:"hidden"}});function Fd(e){return e.replace(/[A-Z]/g,(e=>`-${e.toLowerCase()}`))}var Rd=i(14737),Kd=i(32345);const Md=Qt.Ks.keyframes({from:{transform:"rotate(0deg)"},to:{transform:"rotate(360deg)"}}),Od=Qt.Ks.style({animation:`${Md} 1s linear infinite`,width:Qt.Ks.rem(1),height:Qt.Ks.rem(1),minWidth:Qt.Ks.rem(1),minHeight:Qt.Ks.rem(1)}),Nd=e=>{const{className:t}=e,i=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(i[n[s]]=e[n[s]])}return i}(e,["className"]);return s.createElement(li.hh,Object.assign({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},(0,ra.Ly)(Od,t),i),s.createElement("circle",{cx:"8",cy:"8",r:"5",stroke:"#C2C6D4",strokeWidth:"2"}),s.createElement("path",{d:"M13 8C13 8.76694 12.8236 9.5236 12.4844 10.2114C12.1452 10.8993 11.6523 11.4999 11.0438 11.9668C10.4354 12.4336 9.72765 12.7543 8.97545 12.9039C8.22325 13.0535 7.44671 13.0281 6.7059 12.8296",stroke:"#05735A",strokeWidth:"2",strokeLinecap:"round"}))};function Bd(e,t){return!e||void 0===t||void 0===t.cardPosition||t.cardPosition.isFirst&&t.cardPosition.isLast?null:t.cardPosition.isLast?s.createElement(Ma.s,null," and open previous suggestion"):s.createElement(Ma.s,null," and open next suggestion")}function Pd(e){return Object.assign(Object.assign({},(0,Kd.$R)()),{ggoPrimary:t=>{const i=Bd(t.name===Nn.A7.ButtonAccept.toString(),e);return s.createElement(oi.$,Object.assign({},jd(t),{variant:"primary",style:[t.verticalAlign===Nn.G4.Middle?Dd:void 0,Ud(t.horizontalAlign)]}),t.text,i)},primary:t=>{const i=t.name===Nn.A7.ButtonAccept.toString(),n=Bd(i,e),r=i&&(null==e?void 0:e.acceptButtonsLoading),o=jd(t);return s.createElement(oi.$,Object.assign({},jd(t),{variant:"primary",style:[t.verticalAlign===Nn.G4.Middle?Dd:void 0,Ud(t.horizontalAlign)],onClick:r?void 0:o.onClick,"aria-label":r?"Loading":o["aria-label"],"aria-disabled":!!r||t["aria-disabled"],animationMode:r?Rd.g.None:void 0,"data-testid":`primary-button-${t.id}`}),r?s.createElement(s.Fragment,null,t.text,n,s.createElement(Nd,null)):s.createElement(s.Fragment,null,t.text,n))},secondary:t=>{const i=Bd(t.name===Nn.A7.ButtonDismiss.toString(),e);return s.createElement(oi.$,Object.assign({},jd(t),{variant:"tertiary",style:[t.verticalAlign===Nn.G4.Middle?Dd:void 0,Ud(t.horizontalAlign)]}),t.text,i)},toggle:e=>{const t=(e,t=1)=>`inset 0 0 0 ${t}px ${e}`,i=(e,i=1)=>`${t(e,i)}, 0 0 0 2px ${ii.Q.Text.Base.Inverse}, 0 0 0 4px ${yi.A.BorderBrandDefault}`;return s.createElement(oi.$,Object.assign({},jd(e),{variant:"secondary",size:"small",style:[e.verticalAlign===Nn.G4.Middle?Dd:void 0,Ud(e.horizontalAlign),{default:{boxShadow:t(ii.Q.Border.Base.Subdued),$nest:Object.assign(Object.assign({},(0,ai.Ek)(i(ii.Q.Border.Base.Subdued))),{"& > div > span, & > div, & > *":{color:Qt.Ks.important(ii.Q.Text.Base.Default)}})},hovered:{backgroundColor:yi.A.ButtonBackgroundSecondaryHover,boxShadow:t(yi.A.BorderBrandDefault),$nest:Object.assign(Object.assign({},(0,ai.Ek)(i(yi.A.BorderBrandDefault))),{"& > div > span, & > div, & > *":{color:Qt.Ks.important(yi.A.ButtonTextSecondaryHover)}})},active:{backgroundColor:yi.A.ButtonBackgroundSecondaryActive,boxShadow:t(yi.A.BorderBrandDefault),$nest:Object.assign(Object.assign({},(0,ai.Ek)(i(yi.A.BorderBrandDefault))),{"& > div > span, & > div, & > *":{color:Qt.Ks.important(yi.A.ButtonTextSecondaryActive)}})},selected:{backgroundColor:"transparent",boxShadow:t(yi.A.BorderBrandDefault,1.5),$nest:Object.assign(Object.assign({},(0,ai.Ek)(i(yi.A.BorderBrandDefault,1.5))),{"& > div > span, & > div, & > *":{color:Qt.Ks.important(yi.A.ColorBrandDefault),fontWeight:Qt.Ks.important("bold")}})}}]}),e.text)}})}const Dd={default:{$nest:{"& span":{verticalAlign:"initial"}}}},Ld={[Nn.wq.Left]:{default:{textAlign:"left"}},[Nn.wq.Center]:{default:{textAlign:"center"}},[Nn.wq.Right]:{default:{textAlign:"end"}}};function Ud(e){return void 0!==e?Ld[e]:Ld[Nn.wq.Left]}function jd(e){return Object.assign({name:e.name,onClick:e.onClick,"aria-label":e.meta.label,"aria-describedby":e["aria-describedby"],title:void 0!==e.tooltip&&e.state!==Nn.w.Disabled?(0,Kd.Nv)(e.tooltip):void 0},function(e){switch(e){case Nn.w.Enabled:return{disabled:!1};case Nn.w.Disabled:return{disabled:!0};case Nn.w.Selected:return{disabled:!1,active:!0};case Nn.w.Deselected:return{disabled:!1,active:!1};case Nn.w.Hidden:return{hidden:!0};default:return(0,g.AS)(e)}}(e.state))}var Vd=i(34050),$d=i(23625);const Hd=e=>{const t=s.useRef(null),i=`${e.id}-collapsed-content`,[n,r]=s.useState(!1),o=s.useCallback((t=>{r(t),e.onHoverChanged(t)}),[]),{hoverProps:a}=(0,Vd.Mk)({onHoverChange:o}),{focusWithinProps:l}=(0,Vd.Rb)({onFocusWithinChange:o}),{buttonProps:c}=(0,$d.s)({onPress:t=>e.onPress(t.target.getBoundingClientRect()),elementType:"button"},t);return s.createElement("button",Object.assign({},c,a,l,{className:Zd.button}),s.createElement("div",{id:i,className:Zd.content},e.child,s.createElement(Ma.s,null,"Open suggestion card"),s.createElement("div",{role:"tooltip",style:{opacity:n?1:0}},e.quickActions)))},Zd=Qt.Ks.stylesheet({button:[{position:"relative",minHeight:Qt.Ks.rem(3.5),display:"flex",textAlign:"start",alignItems:"center",width:"100%",background:"transparent",cursor:"pointer",border:0}],content:[{display:"flex",alignItems:"center",$nest:{"& > div:first-of-type":{flexGrow:1}}}]});var Gd=i(53326),Wd=i(8071),zd=i(24243),qd=i(92186);function Qd({item:e,state:t,className:i,name:n,ariaLabel:r}){const o=s.useMemo((()=>n?`${n}-item`:"menu-item"),[n]),a=s.useRef(null),{menuItemProps:l,isDisabled:c,isSelected:d}=(0,Gd.Os)({key:e.key},t,a);return jt.R.useEffectOnDidMount((()=>{if(null!==a.current)try{const e=a.current.focus.bind(a.current);a.current.focus=t=>{var i;(null===(i=a.current)||void 0===i?void 0:i.matches(":hover"))||e(t)}}catch(e){}})),s.createElement("li",Object.assign({"data-testid":o},l,{ref:a,className:Qt.Ks.joinClasses([Yd(c,d),i]),"aria-label":r}),s.createElement("span",{className:Jd},e.rendered))}const Jd=Qt.Ks.style({display:"flex",alignItems:"center",fontFamily:"Inter",fontSize:Qt.Ks.rem(.875),lineHeight:Qt.Ks.rem(1.3125),fontWeight:400,color:yi.A.TextBaseDefault}),Yd=(e,t)=>Qt.Ks.style(Object.assign(Object.assign({display:"flex",alignItems:"center",minHeight:Qt.Ks.rem(2),padding:`${Qt.Ks.rem(ti.or)} ${Qt.Ks.rem(ti.v5)} ${Qt.Ks.rem(ti.or)} ${Qt.Ks.rem(ti.CN)}`,borderRadius:Qt.Ks.rem(ni.KD),opacity:e?.4:void 0,cursor:"pointer"},t&&!e?{background:yi.A.MenuBackgroundSelected,boxShadow:`inset  0 0 0 1px ${yi.A.MenuBorderDefault}`}:{}),{$nest:{"&:hover":e?{}:{background:yi.A.MenuBackgroundHover,boxShadow:`inset  0 0 0 1px ${yi.A.MenuBorderDefault}`,$nest:{"& i":{stroke:yi.A.MenuIconHover,fill:yi.A.MenuIconHover}}},"&:focus, &:focus-visible":e?{}:{boxShadow:`0 0 0 1px ${ii.Q.Background.Base.Default}, 0 0 0 3px ${yi.A.BorderBrandDefault}`,outline:"none",background:yi.A.MenuBackgroundSelected,$nest:{"& i":{stroke:yi.A.MenuIconSelected,fill:yi.A.MenuIconSelected}}},"& i":{marginLeft:Qt.Ks.rem(-ti.or),marginRight:Qt.Ks.rem(ti.v$),minWidth:Qt.Ks.rem(1.5),minHeight:Qt.Ks.rem(1.5)},"& span":{fontWeight:t?700:void 0}}}));var Xd=i(33931);function eu({name:e,section:t,state:i,onAction:n,theme:r={}}){const o=s.useMemo((()=>e?`${e}-section`:"dropdown-menu-section"),[e]),{itemProps:a,headingProps:l,groupProps:c}=(0,Gd.y7)({heading:t.rendered,"aria-label":t["aria-label"]}),{separatorProps:d}=(0,Xd.r)({elementType:"li"});return s.createElement(s.Fragment,null,t.key!==i.collection.getFirstKey()&&s.createElement("li",Object.assign({},d,{className:nu})),s.createElement("li",Object.assign({"data-testid":o},a,{className:Qt.Ks.joinClasses([tu,r.section])}),Boolean(t.rendered)&&s.createElement("h5",Object.assign({},l,{className:iu}),t.rendered),s.createElement("ul",Object.assign({},c,{className:su}),Array.from(t.childNodes).map((t=>s.createElement(Qd,{key:t.key,item:t,state:i,onAction:n,className:r.item,name:e}))))))}const tu=Qt.Ks.style({padding:0}),iu=Qt.Ks.style({margin:0,fontSize:Qt.Ks.rem(.75),fontWeight:400,lineHeight:Qt.Ks.rem(1.125),color:ii.Q.Text.Base.Subdued,padding:`${Qt.Ks.rem(ti.v$)} ${Qt.Ks.rem(ti.v5)} ${Qt.Ks.rem(ti.v$)} ${Qt.Ks.rem(ti.CN)}`}),nu=Qt.Ks.style({borderTop:`1px solid ${ii.Q.Border.Base.Subdued}`,margin:`${Qt.Ks.rem(ti.v$)} ${Qt.Ks.rem(-ti.Jj)}`}),su=Qt.Ks.style({listStyle:"none",margin:0,padding:0,outline:Qt.Ks.important("none")});var ru=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(i[n[s]]=e[n[s]])}return i};function ou(e){var{name:t,className:i,theme:n={},onMouseOver:r,onMouseLeave:o}=e,a=ru(e,["name","className","theme","onMouseOver","onMouseLeave"]);const l=s.useMemo((()=>t?`${t}-list`:"menu-list"),[t]),c=(0,qd.p)(a),d=s.useRef(null),{menuProps:u}=(0,Gd.b)(a,c,d),p=(0,Fl.v6)(u,{onMouseOver:r,onMouseLeave:o});return s.createElement("ul",Object.assign({"data-testid":l},p,{ref:d,className:Qt.Ks.joinClasses([au,n.list,i])}),Array.from(c.collection).map((e=>"section"===e.type?s.createElement(eu,{key:e.key,section:e,state:c,theme:n}):s.createElement(Qd,{key:e.key,name:t,item:e,state:c,className:n.item,ariaLabel:e["aria-label"]}))))}const au=Qt.Ks.style({listStyle:"none",margin:0,outline:Qt.Ks.important("none"),padding:`${Qt.Ks.rem(ti.v$)} ${Qt.Ks.rem(ti.Jj)}`});var lu=i(93669),cu=i(1);const du=e=>{var t,{children:i,className:n,state:r,offset:o=4,onTransitionEnd:a,portalContainer:l}=e,c=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(i[n[s]]=e[n[s]])}return i}(e,["children","className","state","offset","onTransitionEnd","portalContainer"]);const d=s.useRef(null),{popoverProps:u}=function(e,t){const{triggerRef:i,popoverRef:n,isNonModal:s,isKeyboardDismissDisabled:r}=e,o=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(i[n[s]]=e[n[s]])}return i}(e,["triggerRef","popoverRef","isNonModal","isKeyboardDismissDisabled"]),{overlayProps:a,underlayProps:l}=(0,cu.e)({isOpen:t.isOpen,onClose:t.close,shouldCloseOnBlur:!0,isDismissable:!1!==s,isKeyboardDismissDisabled:r,shouldCloseOnInteractOutside:(e,t)=>{const i=null==t?void 0:t.composedPath();return!i||!i.some((e=>{var t;return e instanceof Node&&(null===(t=n.current)||void 0===t?void 0:t.contains(e))}))}},n),{overlayProps:c,arrowProps:d,placement:u}=(0,lu.v8)(Object.assign(Object.assign({},o),{targetRef:i,overlayRef:n,isOpen:t.isOpen,onClose:void 0}));return(0,lu.H_)({isDisabled:s}),(0,Fl.Nf)((()=>t.isOpen&&!s&&n.current?(0,lu.hD)([n.current]):()=>{}),[s,t.isOpen,n]),{popoverProps:(0,Fl.v6)(a,c),arrowProps:d,underlayProps:l,placement:u}}(Object.assign(Object.assign({},c),{isNonModal:!0,offset:o,popoverRef:d}),r);return s.createElement(lu.hJ,{portalContainer:l},s.createElement("div",Object.assign({},u,{style:Object.assign(Object.assign({},u.style),{minWidth:null===(t=c.triggerRef.current)||void 0===t?void 0:t.clientWidth}),ref:d,className:Qt.Ks.joinClasses([pu,n]),onTransitionEnd:e=>{if(e.target===d.current)return null==a?void 0:a()}}),s.createElement(lu.Rz,{onDismiss:r.close}),s.createElement("div",{className:uu},i),s.createElement(lu.Rz,{onDismiss:r.close})))},uu=Qt.Ks.style({width:Qt.Ks.percent(100)}),pu=Qt.Ks.style({display:"flex",flexDirection:"column",alignItems:"flex-start",background:ii.Q.Background.Base.Default,boxShadow:uo.R$.boxShadow,border:uo.R$.border,borderRadius:Qt.Ks.rem(ni.KD)});var mu=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(i[n[s]]=e[n[s]])}return i};function hu(e){var{placement:t="bottom start",theme:i={},name:n,portalContainer:r,title:o}=e,a=mu(e,["placement","theme","name","portalContainer","title"]);const l=s.useMemo((()=>n?`${n}-trigger`:"menu-trigger"),[n]),c=s.useRef(null),d=(0,Wd.I)(a),u=(0,Gd.Vi)(Object.assign(Object.assign({},a),{type:"menu"}),d,c),p=u.menuTriggerProps,{onPress:m,onPressStart:h}=p,g=mu(p,["onPress","onPressStart"]),{menuProps:f}=u;return s.createElement(s.Fragment,null,s.createElement(oi.$,Object.assign({},g,{variant:"tertiary",name:l,onClick:()=>d.open(),mount:e=>c.current=e,active:d.isOpen,"aria-label":a["aria-label"],title:null!=o?o:a["aria-label"],className:i.button,style:i.buttonStyle}),a.label),s.createElement(zd.A,{in:d.isOpen},((e,o)=>s.createElement(du,{state:d,triggerRef:c,placement:t,portalContainer:r,className:e,onTransitionEnd:o},s.createElement(ou,Object.assign({},a,f,{name:n,theme:i,onAction:e=>{var t;return null===(t=a.onAction)||void 0===t?void 0:t.call(a,e)}}))))))}var gu=i(66836);const fu=e=>{const t=t=>"known"===t.source.kind?s.createElement(e.designSystem.icon[t.source.name],{key:t.source.name,backgroundColor:t.backgroundColor}):s.createElement(e.designSystem.image,Object.assign({key:t.source.name,backgroundColor:t.backgroundColor},t.source));return s.createElement(al.j.Consumer,null,(({portalContainer:i})=>s.createElement(ri.F.Fragment,null,i.view(o.fold(a.constNull,(i=>s.createElement(hu,{label:t(e.icon),portalContainer:i,placement:"bottom right",theme:{button:vu,item:_u},"aria-label":e.menu.meta.label,onAction:t=>(0,a.pipe)(e.menu.sections,C.cy((e=>e.items)),C.i8((e=>e.id===String(t))),L.Mi((t=>e.onClick(t.onClickActions,t.id)()))),title:e.menu.meta.label},e.menu.sections.map(((e,i)=>s.createElement(gu.wn,{key:i,title:e.title},e.items.map((e=>s.createElement(gu.q7,{key:e.id,textValue:e.id},e.icon&&t(e.icon),e.text)))))))))))))},vu=Qt.Ks.style({flexShrink:0,alignItems:"center",justifyContent:"center",height:Qt.Ks.rem(2),width:Qt.Ks.rem(2)}),_u=Qt.Ks.style({$nest:{"& i":{height:Qt.Ks.rem(2),width:Qt.Ks.rem(2)}}});var bu=i(3202);const yu={width:Qt.Ks.rem(1.5),height:Qt.Ks.rem(1.5),minWidth:Qt.Ks.rem(1.5),minHeight:Qt.Ks.rem(1.5)},ku=Qt.Ks.style(yu);function Su(e){return Object.assign(Object.assign({},Ed.J),{animation:wd,button:Pd(null==e?void 0:e.buttonDesignSystemParams),icon:Object.assign(Object.assign({},bu.s),{[Nn.yg.More]:e=>s.createElement(li.In.EllipsisSmall,{className:ku})}),text:e=>Ed.J.text(function(e){var t,i;return e.format.includes(Nn.lk.Bold)&&(null===(t=e.meta.label)||void 0===t?void 0:t.startsWith("insert"))&&e.textColor.startsWith("CoreBlue")?Object.assign(Object.assign({},e),{textColor:Nn.Q1.CoreNeutral90,outlineColor:e.format.includes(Nn.lk.Outline)?Nn.Q1.CoreNeutral90:e.outlineColor}):e.format.includes(Nn.lk.Bold)&&(null===(i=e.meta.label)||void 0===i?void 0:i.startsWith("delete"))?Object.assign(Object.assign({},e),{textColor:Nn.Q1.CoreNeutral50,outlineColor:e.format.includes(Nn.lk.Outline)?Nn.Q1.CoreNeutral50:e.outlineColor}):e}(e)),dropDownMenuButton:fu,collapsedCard:Hd,nativeExperimentalGBConsistencyUpsellFooter:Ed.J.nativeExperimentalGBConsistencyUpsellFooter})}const Cu=U.OW({item:Hi.W.Item.eq,isFocused:U.zF,isFirst:U.zF,isLast:U.zF,isWaitingForAlertsToBeApplied:U.zF,prevFocusedItemPosition:o.getEq(bd.$k)}),Eu=r.UI.Node.make((({state:e,notify:t})=>{const{scrolling:i}=s.useContext(Zo);return s.createElement(ri.F.Fragment,null,Li.h(e.pipe(h.s(1)),e.pipe(B.Z(50))).pipe(R.T((({item:e,isFocused:n,isFirst:r,isLast:l,isWaitingForAlertsToBeApplied:c})=>s.createElement(s.Fragment,null,r?null:s.createElement(Lu,null),s.createElement("div",{className:n?Iu:Au},s.createElement(kd.R,{key:`${e.id}-${n?"expanded":"collapsed"}`,sduiRootId:e.id,content:e.content,designSystem:Su({buttonDesignSystemParams:{acceptButtonsLoading:c,cardPosition:{isFirst:r,isLast:l}}}),notify:(n,s,r)=>{const o=i.get()?s.filter((e=>"hoverStateChanged"!==e.type)):s;o.length>0&&Cd({item:e,kind:"longFormCardSduiNotify",notify:t})(n,o,r)},transitions:[],prevContent:o.none,onAnimationEnd:a.constVoid,onMount:t({isFocused:n,kind:"longFormCardMount",item:e}),longFormCardState:{viewKind:n?"focused":"collapsed"}})))))))})),wu=e=>({padding:`${Qt.Ks.rem(ti.or)} 0`,borderRadius:"inherit",$nest:{"&:hover":{backgroundColor:e?void 0:ii.Q.Background.Base.Subdued}}}),Au=Qt.Ks.style(wu(!1)),Iu=Qt.Ks.style(wu(!0)),xu=Qt.Ks.keyframes({from:{transform:"scaleY(1)",opacity:1},to:{transform:"scaleY(0.75)",opacity:0}}),Tu={animation:`${Qt.Ks.keyframes({from:{transform:"scaleY(0.75)",opacity:0},to:{transform:"scaleY(1)",opacity:1}})} 200ms ease-in-out`},Fu={animation:`${xu} 200ms ease-in-out`,position:"absolute",width:"100%"},Ru=Qt.Ks.style(Object.assign(Object.assign({},Tu),{transformOrigin:"bottom"})),Ku=Qt.Ks.style(Object.assign(Object.assign({},Tu),{transformOrigin:"top"})),Mu=Qt.Ks.style(Object.assign(Object.assign({},Fu),{transformOrigin:"bottom"})),Ou=Qt.Ks.style(Object.assign(Object.assign({},Fu),{transformOrigin:"top"})),Nu=r.UI.Transition.make({collapseForward:Mu,collapseBackward:Ou},{expandForward:Ru,expandBackward:Ku}),Bu=Qt.Ks.style({position:"relative"}),Pu=U.OW({isFocused:U.zF,itemId:U.kK}),Du=r.UI.Knot.make(r.UI.Grid.make((({slots:e,view:t})=>{const i=s.useContext(lo.q.Context),{ref:n,onMount:r}=jt.R.useElWatcher(),o=s.useMemo((()=>t("isFocused").pipe(Ht.J(),m.p((([e,t])=>e&&!t)),ct.u(null))),[]),{scrollableContainer:a}=s.useContext(Zo),l=s.useMemo((()=>t("isFocused").pipe(ut.Z(!1),Ht.J(),m.p((([e,t])=>!e&&t)),d.n((()=>n.pipe(N.oE,h.s(1)))),Ot.E(a.pipe(N.oE)),yd.c(200),P.M((([e,t])=>{e.offsetTop<t.scrollTop?t.scroll({top:e.offsetTop,left:0,behavior:"smooth"}):e.offsetTop+e.offsetHeight>t.scrollTop+t.offsetHeight?t.scroll({top:e.offsetTop-t.offsetHeight/2,left:0,behavior:"smooth"}):e.scrollIntoView({behavior:"smooth",block:"nearest"})})))),[n]);return jt.R.useSubscriptionTo(l),s.createElement(ri.F.Fragment,null,Ct.zV([i,t("itemId")]).pipe(R.T((([t,i])=>s.createElement(Sd,{visibleOffset:500,defaultHeight:4*t,resetHeightToDefault:o,"data-testid":i,className:Bu,ref:r,role:"listitem"},e.content)))))})),{content:r.UI.Animated.make(Nu,Eu)}),Lu=()=>s.createElement("div",{className:Uu}),Uu=Qt.Ks.style({margin:`0 ${Qt.Ks.rem(ti.Jj)}`,borderBottom:`1px solid ${ii.Q.Border.Base.Subdued}`}),ju=r.UI.List.make(C.QW,Du),Vu=()=>s.createElement("svg",{fill:"none",viewBox:"0 0 64 64",role:"img","aria-hidden":!0,focusable:!1},s.createElement("g",{stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",clipPath:"url(#EmptyH_a)"},s.createElement("path",{fill:"#FCE5E5",strokeMiterlimit:"10",d:"M62.4 11.2H23.24C22.16 28.28 3.64 40.4 7.8 62.4h39.16C43.6 35.2 61.32 28.28 62.4 11.2Z"}),s.createElement("path",{fill:"#FCE5E5",strokeMiterlimit:"10",d:"M59.2 8H20.04C18.96 25.08.44 37.2 4.6 59.2h39.16C40.8 32.8 58.13 25.08 59.2 8Z"}),s.createElement("path",{fill:"#FEFAE9",strokeMiterlimit:"10",d:"M56 4.8H17.4C16.35 21.88-1.91 34 2.2 56H40C36.67 34 54.93 21.88 56 4.8Z"}),s.createElement("path",{d:"M24 13.6h20M20 22.4h20M14.4 32h20M9.6 42.8H24"}),s.createElement("path",{fill:"#F8E485",strokeMiterlimit:"10",d:"M.55 10.12a4.29 4.29 0 1 1 7.43-4.3l16.3 28.24-7.43 4.3L.55 10.11Z"}),s.createElement("path",{fill:"#79A8F2",strokeMiterlimit:"10",d:"M.55 10.12a4.29 4.29 0 1 1 7.43-4.3l3.21 5.58-7.43 4.29-3.21-5.57Z"}),s.createElement("path",{fill:"#F8C6DA",strokeMiterlimit:"10",d:"M.55 10.12a4.29 4.29 0 1 1 7.43-4.3l.64 1.12-7.43 4.29-.64-1.11Z"}),s.createElement("path",{fill:"#FEFAE9",strokeMiterlimit:"10",d:"m16.85 38.35 7.43-4.29-.07 8.47-7.36-4.18Z"}),s.createElement("path",{fill:"#0E101A",strokeMiterlimit:"10",d:"m20.2 39.88 3.72-2.14.3 4.79-4.01-2.65Z"})),s.createElement("defs",null,s.createElement("clipPath",{id:"EmptyH_a"},s.createElement("path",{fill:"#fff",d:"M0 0h64v64H0z"})))),$u=()=>s.createElement("svg",{fill:"none",viewBox:"0 0 64 64",role:"img","aria-hidden":!0,focusable:!1},s.createElement("path",{fill:"#FEFAE9",stroke:"#1F243C",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M24.56 10.36h34.93L43.53 46.6H8.59l15.97-36.24Z"}),s.createElement("path",{stroke:"#0E101A",strokeLinecap:"round",d:"M19.37 34.76c1.06-.2 2.53-.27 3.52-.82.64-.36.79.58 1.16.82 1.14.77 2.28-.09 3.26-.74.95-.63 1.14-.56 1.8.26.89 1.09 2.87.23 3.97-.03.38-.1.8-.17 1.13.06.68.49 1.48.63 2.28.75 1.15.19 2.26.29 3.42.3.67.01.83.26 1.35.52 1.09.54 2.8-.15 3.9-.37M22.4 27.57c1.54-.08 3.24.04 4.58-.82.2-.13.46-.25.69-.35.12-.05.6.92.83 1.02.57.26 1.27.19 1.88.04.57-.15 1.36-.78 1.89-.33.6.52.71.78 1.57.6.85-.2 1.31-.3 2.07-.04a6.3 6.3 0 0 0 3.73.26c.41-.09 4.57-.66 4.77-.26M24.01 20.46c1.95-.4 3.92-.75 5.81-1.4.24-.09.45-.14.7-.14.29 0 .34.29.48.52.57.95 1.56.59 2.45.56.85-.03 1.6.16 2.47.05.4-.05 1.44-.49 1.82-.31.22.1.3.4.52.53.64.38.91.44 1.65.2.58-.2 1.11.07 1.71-.3.14-.1.64-.61.7-.27.08.43.14.75.56.88 1.43.46 2.92-.5 4.33-.54"}),s.createElement("path",{fill:"#F9C7C7",stroke:"#1F243C",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M14.77 9.5c0 1.19.96 2.14 2.14 2.14h5.14V7.37H16.9c-1.18 0-2.14.95-2.14 2.14Z"}),s.createElement("path",{fill:"#FEFAE9",stroke:"#1F243C",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M19.74 9.5c0-2.6 2.1-4.7 4.7-4.7h31.28v9.41H24.45a4.7 4.7 0 0 1-4.7-4.7Z"}),s.createElement("circle",{cx:"56.15",cy:"9.51",r:"4.71",fill:"#FEFAE9",stroke:"#1F243C",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10"}),s.createElement("path",{fill:"#F9C7C7",fillRule:"evenodd",d:"M56.54 7.37a2.14 2.14 0 1 0 0 4.27h4.52a2.14 2.14 0 0 0 0-4.27h-4.52Z",clipRule:"evenodd"}),s.createElement("path",{fill:"#1F243C",d:"M54.9 9.5c0-.9.73-1.63 1.64-1.63v-1A2.64 2.64 0 0 0 53.9 9.5h1Zm1.64 1.64c-.9 0-1.64-.73-1.64-1.63h-1a2.64 2.64 0 0 0 2.64 2.63v-1Zm4.52 0h-4.52v1h4.52v-1Zm0 0v1-1Zm1.64-1.63c0 .9-.73 1.63-1.64 1.63v1a2.64 2.64 0 0 0 2.64-2.63h-1Zm-1.64-1.64c.9 0 1.64.73 1.64 1.64h1a2.64 2.64 0 0 0-2.64-2.64v1Zm0 0v-1 1Zm-4.52 0h4.52v-1h-4.52v1Z"}),s.createElement("path",{fill:"#F9C7C7",stroke:"#1F243C",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M.8 45.5c0 1.19.96 2.14 2.14 2.14h5.13v-4.27H2.94c-1.18 0-2.14.95-2.14 2.14Z"}),s.createElement("path",{fill:"#FEFAE9",stroke:"#1F243C",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M5.77 45.5c0-2.6 2.1-4.7 4.7-4.7h30.47v9.41H10.47a4.7 4.7 0 0 1-4.7-4.7Z"}),s.createElement("path",{fill:"#79A8F2",stroke:"#1F243C",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M41.27 48.55h8.66v14.37l-4.35-1.7-4.31 1.7V48.55Z"}),s.createElement("path",{fill:"#F8E485",stroke:"#1F243C",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M35.2 44c0-1.11.8-2.1 1.1-3.13.33-1.05.27-2.32.87-3.21.62-.9 1.81-1.21 2.68-1.86.83-.65 1.49-1.73 2.53-2.08.99-.34 2.12.13 3.22.13 1.07 0 2.23-.47 3.22-.13 1.01.35 1.67 1.43 2.53 2.08.87.65 2.06.96 2.68 1.86.63.86.54 2.16.87 3.21C55.23 41.9 56 42.9 56 44c0 1.11-.8 2.1-1.1 3.13-.33 1.05-.27 2.32-.87 3.21-.62.9-1.81 1.21-2.68 1.86-.83.65-1.49 1.73-2.53 2.08-.98.34-2.12-.13-3.22-.13-1.07 0-2.23.47-3.22.13-1.01-.35-1.67-1.43-2.53-2.08-.87-.65-2.06-.96-2.68-1.86-.63-.86-.54-2.16-.87-3.21-.33-1.03-1.1-2.02-1.1-3.13Z"}),s.createElement("mask",{id:"SuccessD_a",width:"23",height:"24",x:"34",y:"32",maskUnits:"userSpaceOnUse",style:{maskType:"alpha"}},s.createElement("path",{fill:"#F8E485",stroke:"#1F243C",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M54.6 49.2c-.55.96-1.74 1.42-2.51 2.16-.81.74-1.4 1.87-2.36 2.35-.99.47-2.18.14-3.25.27-1.05.14-2.16.75-3.23.53-1.02-.2-1.77-1.17-2.73-1.72-.92-.53-2.16-.71-2.84-1.5-.71-.8-.74-2.07-1.16-3.06-.42-1-1.3-1.86-1.4-2.95-.1-1.07.62-2.15.87-3.22.22-1.05.05-2.3.6-3.26.56-.96 1.75-1.42 2.52-2.16.81-.74 1.4-1.87 2.36-2.35.99-.47 2.18-.14 3.25-.27 1.05-.14 2.16-.75 3.23-.53 1.02.2 1.77 1.17 2.73 1.72.92.54 2.16.71 2.84 1.5.71.8.74 2.07 1.16 3.06.43 1 1.3 1.86 1.4 2.95.1 1.07-.62 2.15-.87 3.22-.22 1.05-.05 2.3-.6 3.26Z"})),s.createElement("g",{mask:"url(#SuccessD_a)"},s.createElement("path",{fill:"#FEFAE9",d:"m52.26 29.95 2.49 2.5-19.9 19.9-2.5-2.5zM60.33 37.48l-4.35-4.34-19.9 19.9 4.35 4.35z"}),s.createElement("path",{stroke:"#1F243C",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M35.2 44c0-1.11.8-2.1 1.1-3.13.33-1.05.27-2.32.87-3.21.62-.9 1.81-1.21 2.68-1.86.83-.65 1.49-1.73 2.53-2.08.99-.34 2.12.13 3.22.13 1.07 0 2.23-.47 3.22-.13 1.01.35 1.67 1.43 2.53 2.08.87.65 2.06.96 2.68 1.86.63.86.54 2.16.87 3.21C55.23 41.9 56 42.9 56 44c0 1.11-.8 2.1-1.1 3.13-.33 1.05-.27 2.32-.87 3.21-.62.9-1.81 1.21-2.68 1.86-.83.65-1.49 1.73-2.53 2.08-.98.34-2.12-.13-3.22-.13-1.07 0-2.23.47-3.22.13-1.01-.35-1.67-1.43-2.53-2.08-.87-.65-2.06-.96-2.68-1.86-.63-.86-.54-2.16-.87-3.21-.33-1.03-1.1-2.02-1.1-3.13Z"}))),Hu=()=>s.createElement("svg",{viewBox:"0 0 64 64",fill:"none",role:"img","aria-hidden":!0,focusable:!1},s.createElement("path",{d:"M32 17.0729V14.2794C32 10.9579 29.3256 8.26562 26.0273 8.26562C22.8634 8.26562 20.2749 10.7422 20.0684 13.8747C19.3378 13.6432 18.5607 13.5183 17.7559 13.5183C13.5089 13.5183 10.0667 16.9842 10.0667 21.2594C10.0667 23.1991 10.7741 24.9718 11.9455 26.3302C9.65381 27.0843 8 29.2536 8 31.8125C8 34.3859 9.67469 36.5651 11.9849 37.3072C10.7904 38.6712 10.0667 40.4619 10.0667 42.4227C10.0667 46.6979 13.5089 50.1637 17.7559 50.1637C18.5561 50.1637 19.3285 50.0403 20.0545 49.8115C20.1032 53.0899 22.7591 55.7323 26.0273 55.7323C29.3256 55.7323 32 53.04 32 49.7187V47.0131",fill:"url(#AiDetectedIllustration_paint0_linear_2020_7610)"}),s.createElement("path",{d:"M32 49.7187C32 53.0403 34.6744 55.7344 37.9728 55.7344C41.1365 55.7344 43.7251 53.2579 43.9315 50.1253C44.6621 50.3568 45.4392 50.4819 46.244 50.4819C50.4912 50.4819 53.9333 47.0157 53.9333 42.7405C53.9333 40.8008 53.2259 39.0283 52.0544 37.6699C54.3461 36.9157 56 34.7464 56 32.1875C56 29.6141 54.3253 27.4349 52.0152 26.6928C53.2096 25.3288 53.9333 23.5381 53.9333 21.5774C53.9333 17.3022 50.4912 13.8362 46.244 13.8362C45.444 13.8362 44.6715 13.9597 43.9456 14.1886C43.8968 10.9101 41.2411 8.2677 37.9728 8.2677C34.6744 8.2677 32 10.9579 32 14.2794",fill:"url(#AiDetectedIllustration_paint1_linear_2020_7610)"}),s.createElement("path",{d:"M31.5 17.0729C31.5 17.349 31.7239 17.5729 32 17.5729C32.2761 17.5729 32.5 17.349 32.5 17.0729H31.5ZM20.0684 13.8747L19.9174 14.3514C20.0638 14.3978 20.2235 14.3743 20.3504 14.2876C20.4772 14.201 20.5572 14.0609 20.5673 13.9076L20.0684 13.8747ZM11.9455 26.3302L12.1018 26.8051C12.2605 26.7529 12.3826 26.6248 12.4273 26.4638C12.472 26.3028 12.4333 26.1302 12.3242 26.0036L11.9455 26.3302ZM11.9849 37.3072L12.3611 37.6366C12.472 37.5099 12.5117 37.3359 12.4668 37.1737C12.4218 37.0114 12.2982 36.8827 12.1379 36.8312L11.9849 37.3072ZM20.0545 49.8115L20.5545 49.804C20.5521 49.6461 20.4753 49.4985 20.3472 49.4061C20.2191 49.3136 20.0549 49.2871 19.9042 49.3346L20.0545 49.8115ZM32.5 47.0131C32.5 46.7369 32.2761 46.5131 32 46.5131C31.7239 46.5131 31.5 46.7369 31.5 47.0131H32.5ZM43.9315 50.1253L44.0825 49.6487C43.936 49.6023 43.7764 49.6258 43.6495 49.7124C43.5227 49.799 43.4426 49.9392 43.4325 50.0925L43.9315 50.1253ZM52.0544 37.6699L51.8981 37.1949C51.7394 37.2471 51.6173 37.3752 51.5726 37.5362C51.5279 37.6972 51.5666 37.8699 51.6758 37.9964L52.0544 37.6699ZM52.0152 26.6928L51.639 26.3634C51.5281 26.4901 51.4884 26.6641 51.5334 26.8263C51.5783 26.9886 51.702 27.1173 51.8623 27.1688L52.0152 26.6928ZM43.9456 14.1886L43.4457 14.196C43.448 14.354 43.5249 14.5015 43.653 14.594C43.7811 14.6865 43.9453 14.7129 44.096 14.6654L43.9456 14.1886ZM22.0627 38.4556C21.9521 38.7086 22.0674 39.0034 22.3204 39.1141C22.5734 39.2248 22.8682 39.1094 22.9789 38.8564L22.0627 38.4556ZM28.3448 25.3438L28.8007 25.1385C28.7196 24.9583 28.5399 24.8427 28.3422 24.8438C28.1445 24.8448 27.966 24.9622 27.8867 25.1434L28.3448 25.3438ZM33.8806 38.8612C33.9939 39.113 34.2899 39.2253 34.5417 39.1119C34.7936 38.9986 34.9058 38.7026 34.7925 38.4508L33.8806 38.8612ZM40.2605 38.6557C40.2605 38.9319 40.4844 39.1557 40.7605 39.1557C41.0367 39.1557 41.2605 38.9319 41.2605 38.6557H40.2605ZM41.2605 25.8333C41.2605 25.5572 41.0367 25.3333 40.7605 25.3333C40.4844 25.3333 40.2605 25.5572 40.2605 25.8333H41.2605ZM32.5 17.0729V14.2794H31.5V17.0729H32.5ZM32.5 14.2794C32.5 10.685 29.6049 7.76562 26.0273 7.76562V8.76562C29.0463 8.76562 31.5 11.2309 31.5 14.2794H32.5ZM26.0273 7.76562C22.5954 7.76562 19.7929 10.4512 19.5695 13.8418L20.5673 13.9076C20.7568 11.0332 23.1315 8.76562 26.0273 8.76562V7.76562ZM20.2195 13.3981C19.4407 13.1513 18.6128 13.0183 17.7559 13.0183V14.0183C18.5087 14.0183 19.2349 14.1351 19.9174 14.3514L20.2195 13.3981ZM17.7559 13.0183C13.2295 13.0183 9.56669 16.7113 9.56669 21.2594H10.5667C10.5667 17.2572 13.7882 14.0183 17.7559 14.0183V13.0183ZM9.56669 21.2594C9.56669 23.3228 10.3198 25.2105 11.5668 26.6567L12.3242 26.0036C11.2285 24.733 10.5667 23.0753 10.5667 21.2594H9.56669ZM11.7892 25.8552C9.29657 26.6754 7.5 29.0333 7.5 31.8125H8.5C8.5 29.4739 10.0111 27.4931 12.1018 26.8051L11.7892 25.8552ZM7.5 31.8125C7.5 34.6076 9.31927 36.9761 11.832 37.7832L12.1379 36.8312C10.0301 36.1541 8.5 34.1641 8.5 31.8125H7.5ZM11.6088 36.9778C10.3371 38.4298 9.56669 40.3366 9.56669 42.4227H10.5667C10.5667 40.5871 11.2436 38.9125 12.3611 37.6366L11.6088 36.9778ZM9.56669 42.4227C9.56669 46.9708 13.2295 50.6637 17.7559 50.6637V49.6637C13.7882 49.6637 10.5667 46.4249 10.5667 42.4227H9.56669ZM17.7559 50.6637C18.6078 50.6637 19.4308 50.5323 20.2048 50.2883L19.9042 49.3346C19.2262 49.5483 18.5044 49.6637 17.7559 49.6637V50.6637ZM19.5546 49.8189C19.6073 53.3671 22.4824 56.2323 26.0273 56.2323V55.2323C23.0357 55.2323 20.5992 52.8126 20.5545 49.804L19.5546 49.8189ZM26.0273 56.2323C29.6049 56.2323 32.5 53.3129 32.5 49.7187H31.5C31.5 52.7671 29.0463 55.2323 26.0273 55.2323V56.2323ZM32.5 49.7187V47.0131H31.5V49.7187H32.5ZM31.5 49.7187C31.5 53.313 34.3949 56.2344 37.9728 56.2344V55.2344C34.9539 55.2344 32.5 52.7675 32.5 49.7187H31.5ZM37.9728 56.2344C41.4046 56.2344 44.207 53.5488 44.4304 50.1582L43.4325 50.0925C43.2432 52.9669 40.8685 55.2344 37.9728 55.2344V56.2344ZM43.7805 50.602C44.5592 50.8487 45.3871 50.9819 46.244 50.9819V49.9819C45.4913 49.9819 44.7651 49.8649 44.0825 49.6487L43.7805 50.602ZM46.244 50.9819C50.7705 50.9819 54.4333 47.2887 54.4333 42.7405H53.4333C53.4333 46.7428 50.2119 49.9819 46.244 49.9819V50.9819ZM54.4333 42.7405C54.4333 40.677 53.6802 38.7895 52.433 37.3433L51.6758 37.9964C52.7715 39.267 53.4333 40.9246 53.4333 42.7405H54.4333ZM52.2107 38.1448C54.7034 37.3246 56.5 34.9667 56.5 32.1875H55.5C55.5 34.5261 53.9889 36.5069 51.8981 37.1949L52.2107 38.1448ZM56.5 32.1875C56.5 29.3924 54.6808 27.0239 52.1681 26.2168L51.8623 27.1688C53.9699 27.8459 55.5 29.8359 55.5 32.1875H56.5ZM52.3914 27.0222C53.6629 25.5702 54.4333 23.6633 54.4333 21.5774H53.4333C53.4333 23.4128 52.7563 25.0875 51.639 26.3634L52.3914 27.0222ZM54.4333 21.5774C54.4333 17.0292 50.7705 13.3362 46.244 13.3362V14.3362C50.2119 14.3362 53.4333 17.5751 53.4333 21.5774H54.4333ZM46.244 13.3362C45.3923 13.3362 44.5691 13.4677 43.7952 13.7117L44.096 14.6654C44.7738 14.4517 45.4957 14.3362 46.244 14.3362V13.3362ZM44.4455 14.1811C44.3927 10.6328 41.5177 7.7677 37.9728 7.7677V8.7677C40.9644 8.7677 43.4009 11.1873 43.4457 14.196L44.4455 14.1811ZM37.9728 7.7677C34.3953 7.7677 31.5 10.6848 31.5 14.2794H32.5C32.5 11.2311 34.9535 8.7677 37.9728 8.7677V7.7677ZM22.9789 38.8564L28.8029 25.5442L27.8867 25.1434L22.0627 38.4556L22.9789 38.8564ZM27.8889 25.549L33.8806 38.8612L34.7925 38.4508L28.8007 25.1385L27.8889 25.549ZM24.0781 35.7291H32.7725V34.7291H24.0781V35.7291ZM41.2605 38.6557V25.8333H40.2605V38.6557H41.2605Z",fill:si.Purple80}),s.createElement("defs",null,s.createElement("linearGradient",{id:"AiDetectedIllustration_paint0_linear_2020_7610",x1:"15",y1:"15",x2:"51",y2:"50",gradientUnits:"userSpaceOnUse"},s.createElement("stop",{stopColor:si.Purple0}),s.createElement("stop",{offset:"1",stopColor:si.Purple20})),s.createElement("linearGradient",{id:"AiDetectedIllustration_paint1_linear_2020_7610",x1:"15",y1:"15",x2:"51",y2:"50",gradientUnits:"userSpaceOnUse"},s.createElement("stop",{stopColor:si.Purple0}),s.createElement("stop",{offset:"1",stopColor:si.Purple20})))),Zu=r.UI.Node.make((({notify:e,view:t})=>s.createElement(qa,{"aria-busy":"true","aria-live":"polite","data-testid":"plagiarism-empty",style:Wu,mount:e({kind:"plagiarismFeedSuccessMountAction"})},t("aiDetectorScore").pipe(R.T((t=>{const{summary:i,illustration:n,details:r}=(0,a.pipe)(t,o.fold((()=>({summary:"No plagiarism detected",illustration:s.createElement(Vu,null),details:s.createElement(s.Fragment,null,"We compared your document to billions of web pages and academic papers and found no duplicate text.")})),(e=>e<1?{summary:"No plagiarism or AI text detected",illustration:s.createElement($u,null),details:s.createElement(s.Fragment,null,"Your document doesnt match anything in our references or contain common AI text patterns.")}:{summary:"Possible AI text detected",illustration:s.createElement(Hu,null),details:s.createElement(s.Fragment,null,s.createElement("b",null,e,"%")," of your document contains patterns often found in AI text.")})));return s.createElement(s.Fragment,null,s.createElement("div",{className:zu},s.createElement(Yc,{style:Gu},i),s.createElement("p",{className:qu},r),s.createElement(oi.$,{variant:"secondary",style:Ju,onClick:e({kind:"seeAllSuggestions"})},"See all suggestions")),s.createElement("div",{className:Qu},n))})))))),Gu={whiteSpace:"normal"},Wu={padding:`${Qt.Ks.rem(ti.Jj)}`,display:"flex",flexDirection:"column-reverse",justifyContent:"center",alignItems:"center",gap:`${Qt.Ks.rem(ti.Jj)}`,height:"100%",boxSizing:"border-box"},zu=Qt.Ks.style({textAlign:"center",padding:`${Qt.Ks.rem(ti.Jj)} ${Qt.Ks.rem(ti.Jj)} 0 ${Qt.Ks.rem(ti.Jj)}`}),qu=Qt.Ks.style({margin:0,color:yi.A.TextBaseSubduedColor,fontSize:Qt.Ks.rem(.875),lineHeight:"1.5em",fontWeight:400}),Qu=Qt.Ks.style({width:Qt.Ks.rem(6),height:Qt.Ks.rem(6),minWidth:Qt.Ks.rem(6),minHeight:Qt.Ks.rem(6)}),Ju={default:{marginTop:Qt.Ks.rem(ti.v$),alignSelf:"flex-start"}},Yu=e=>s.createElement(li.hh,Object.assign({width:"36",height:"36",viewBox:"0 0 36 36"},e),s.createElement("rect",{width:"36",height:"36",rx:"18",fill:"#09646C",stroke:"none"}),s.createElement("path",{d:"M19.4062 21.6132C21.1214 21.2406 22.0558 20.2882 22.5 18.8303C20.636 18.8303 19.125 17.3433 19.125 15.5089C19.125 13.6745 20.636 12.1875 22.5 12.1875C24.364 12.1875 25.875 13.5803 25.875 15.5089C25.875 17.4375 25.5 22.3125 19.4062 23.8125V21.6132Z",fill:"white",stroke:"none"}),s.createElement("path",{d:"M10.4062 21.6132C12.1214 21.2406 13.0558 20.2882 13.5 18.8303C11.636 18.8303 10.125 17.3433 10.125 15.5089C10.125 13.6745 11.636 12.1875 13.5 12.1875C15.364 12.1875 16.875 13.5803 16.875 15.5089C16.875 17.4375 16.5 22.3125 10.4062 23.8125V21.6132Z",fill:"white",stroke:"none"})),Xu=e=>s.createElement(li.hh,Object.assign({width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"none"},e),s.createElement("path",{d:"M12 6.40232V5.35476C12 4.10922 10.9971 3.09961 9.76022 3.09961C8.57379 3.09961 7.60307 4.02832 7.52566 5.20302C7.25167 5.1162 6.96028 5.06935 6.65845 5.06935C5.06582 5.06935 3.77501 6.36908 3.77501 7.97228C3.77501 8.69965 4.0403 9.36441 4.47956 9.87381C3.62018 10.1566 3 10.9701 3 11.9297C3 12.8947 3.62801 13.7119 4.49435 13.9902C4.04639 14.5017 3.77501 15.1732 3.77501 15.9085C3.77501 17.5117 5.06582 18.8114 6.65845 18.8114C6.95854 18.8114 7.24819 18.7651 7.52044 18.6793C7.53871 19.9087 8.53465 20.8996 9.76022 20.8996C10.9971 20.8996 12 19.89 12 18.6445V17.6299",fill:si.Purple10}),s.createElement("path",{d:"M12 18.6445C12 19.8901 13.0029 20.9004 14.2398 20.9004C15.4262 20.9004 16.3969 19.9717 16.4743 18.797C16.7483 18.8838 17.0397 18.9307 17.3415 18.9307C18.9342 18.9307 20.225 17.6309 20.225 16.0277C20.225 15.3003 19.9597 14.6356 19.5204 14.1262C20.3798 13.8434 21 13.0299 21 12.0703C21 11.1053 20.372 10.2881 19.5057 10.0098C19.9536 9.49831 20.225 8.82677 20.225 8.09152C20.225 6.48831 18.9342 5.18858 17.3415 5.18858C17.0415 5.18858 16.7518 5.23489 16.4796 5.32072C16.4613 4.09128 15.4654 3.10039 14.2398 3.10039C13.0029 3.10039 12 4.10922 12 5.35476",fill:si.Purple10}),s.createElement("path",{d:"M11.5 6.40232C11.5 6.67846 11.7239 6.90232 12 6.90232C12.2761 6.90232 12.5 6.67846 12.5 6.40232H11.5ZM7.52566 5.20302L7.37462 5.67966C7.52107 5.72607 7.68072 5.70257 7.8076 5.61595C7.93447 5.52933 8.01448 5.38919 8.02458 5.2359L7.52566 5.20302ZM4.47956 9.87381L4.63585 10.3488C4.79455 10.2965 4.91669 10.1685 4.96136 10.0075C5.00603 9.84649 4.96733 9.67382 4.85822 9.54729L4.47956 9.87381ZM4.49435 13.9902L4.87049 14.3196C4.98143 14.1929 5.02116 14.0189 4.97619 13.8567C4.93122 13.6944 4.80759 13.5657 4.64727 13.5142L4.49435 13.9902ZM7.52044 18.6793L8.02038 18.6719C8.01804 18.5139 7.94119 18.3664 7.81312 18.2739C7.68505 18.1814 7.52081 18.1549 7.37015 18.2024L7.52044 18.6793ZM12.5 17.6299C12.5 17.3538 12.2761 17.1299 12 17.1299C11.7239 17.1299 11.5 17.3538 11.5 17.6299H12.5ZM16.4743 18.797L16.6253 18.3203C16.4789 18.274 16.3192 18.2975 16.1923 18.3841C16.0655 18.4707 15.9855 18.6108 15.9754 18.7641L16.4743 18.797ZM19.5204 14.1262L19.3641 13.6513C19.2054 13.7035 19.0833 13.8315 19.0386 13.9925C18.9939 14.1535 19.0326 14.3262 19.1418 14.4527L19.5204 14.1262ZM19.5057 10.0098L19.1295 9.6804C19.0186 9.80708 18.9789 9.98108 19.0239 10.1433C19.0688 10.3056 19.1925 10.4343 19.3528 10.4858L19.5057 10.0098ZM16.4796 5.32072L15.9797 5.32816C15.982 5.48612 16.0589 5.63367 16.187 5.72613C16.3151 5.81859 16.4793 5.84508 16.63 5.79757L16.4796 5.32072ZM7.98723 14.2956C7.87655 14.5486 7.99191 14.8434 8.2449 14.9541C8.49789 15.0648 8.79271 14.9494 8.90339 14.6964L7.98723 14.2956ZM10.6293 9.50391L11.0852 9.29869C11.0041 9.11842 10.8244 9.00288 10.6267 9.00392C10.429 9.00496 10.2505 9.12238 10.1712 9.3035L10.6293 9.50391ZM12.4203 14.7012C12.5336 14.953 12.8296 15.0653 13.0814 14.9519C13.3332 14.8386 13.4455 14.5426 13.3321 14.2908L12.4203 14.7012ZM14.7852 14.4959C14.7852 14.772 15.0091 14.9959 15.2852 14.9959C15.5613 14.9959 15.7852 14.772 15.7852 14.4959H14.7852ZM15.7852 9.6875C15.7852 9.41136 15.5613 9.1875 15.2852 9.1875C15.0091 9.1875 14.7852 9.41136 14.7852 9.6875H15.7852ZM12.5 6.40232V5.35476H11.5V6.40232H12.5ZM12.5 5.35476C12.5 3.83628 11.2764 2.59961 9.76022 2.59961V3.59961C10.7178 3.59961 11.5 4.38216 11.5 5.35476H12.5ZM9.76022 2.59961C8.30572 2.59961 7.12116 3.73734 7.02674 5.17014L8.02458 5.2359C8.08498 4.3193 8.84186 3.59961 9.76022 3.59961V2.59961ZM7.6767 4.72638C7.35459 4.62431 7.01229 4.56935 6.65845 4.56935V5.56935C6.90827 5.56935 7.14875 5.60809 7.37462 5.67966L7.6767 4.72638ZM6.65845 4.56935C4.78649 4.56935 3.27501 6.09614 3.27501 7.97228H4.27501C4.27501 6.64202 5.34515 5.56935 6.65845 5.56935V4.56935ZM3.27501 7.97228C3.27501 8.82342 3.58595 9.60315 4.1009 10.2003L4.85822 9.54729C4.49465 9.12567 4.27501 8.57588 4.27501 7.97228H3.27501ZM4.32327 9.39886C3.26294 9.74778 2.5 10.7498 2.5 11.9297H3.5C3.5 11.1904 3.97742 10.5654 4.63585 10.3488L4.32327 9.39886ZM2.5 11.9297C2.5 13.1164 3.27259 14.1229 4.34143 14.4662L4.64727 13.5142C3.98343 13.3009 3.5 12.673 3.5 11.9297H2.5ZM4.11821 13.6608C3.59312 14.2604 3.27501 15.048 3.27501 15.9085H4.27501C4.27501 15.2984 4.49966 14.743 4.87049 14.3196L4.11821 13.6608ZM3.27501 15.9085C3.27501 17.7846 4.78649 19.3114 6.65845 19.3114V18.3114C5.34515 18.3114 4.27501 17.2388 4.27501 15.9085H3.27501ZM6.65845 19.3114C7.01022 19.3114 7.35052 19.2571 7.67073 19.1562L7.37015 18.2024C7.14586 18.2731 6.90686 18.3114 6.65845 18.3114V19.3114ZM7.0205 18.6867C7.04278 20.1859 8.25802 21.3996 9.76022 21.3996V20.3996C8.81128 20.3996 8.03465 19.6315 8.02038 18.6719L7.0205 18.6867ZM9.76022 21.3996C11.2764 21.3996 12.5 20.1629 12.5 18.6445H11.5C11.5 19.6171 10.7178 20.3996 9.76022 20.3996V21.3996ZM12.5 18.6445V17.6299H11.5V18.6445H12.5ZM11.5 18.6445C11.5 20.1628 12.7234 21.4004 14.2398 21.4004V20.4004C13.2824 20.4004 12.5 19.6174 12.5 18.6445H11.5ZM14.2398 21.4004C15.6943 21.4004 16.8788 20.2627 16.9732 18.8299L15.9754 18.7641C15.915 19.6807 15.1581 20.4004 14.2398 20.4004V21.4004ZM16.3233 19.2737C16.6453 19.3757 16.9876 19.4307 17.3415 19.4307V18.4307C17.0918 18.4307 16.8513 18.3919 16.6253 18.3203L16.3233 19.2737ZM17.3415 19.4307C19.2135 19.4307 20.725 17.9038 20.725 16.0277H19.725C19.725 17.358 18.6549 18.4307 17.3415 18.4307V19.4307ZM20.725 16.0277C20.725 15.1765 20.414 14.3968 19.899 13.7997L19.1418 14.4527C19.5054 14.8744 19.725 15.4241 19.725 16.0277H20.725ZM19.6767 14.6011C20.737 14.2522 21.5 13.2502 21.5 12.0703H20.5C20.5 12.8096 20.0226 13.4346 19.3641 13.6513L19.6767 14.6011ZM21.5 12.0703C21.5 10.8836 20.7274 9.87711 19.6586 9.53376L19.3528 10.4858C20.0166 10.6991 20.5 11.327 20.5 12.0703H21.5ZM19.8819 10.3392C20.4069 9.73965 20.725 8.95201 20.725 8.09152H19.725C19.725 8.70152 19.5003 9.25697 19.1295 9.6804L19.8819 10.3392ZM20.725 8.09152C20.725 6.21537 19.2135 4.68858 17.3415 4.68858V5.68858C18.6549 5.68858 19.725 6.76125 19.725 8.09152H20.725ZM17.3415 4.68858C16.9898 4.68858 16.6494 4.7429 16.3292 4.84386L16.63 5.79757C16.8542 5.72688 17.0932 5.68858 17.3415 5.68858V4.68858ZM16.9795 5.31328C16.9572 3.81404 15.742 2.60039 14.2398 2.60039V3.60039C15.1888 3.60039 15.9654 4.36851 15.9797 5.32816L16.9795 5.31328ZM14.2398 2.60039C12.7238 2.60039 11.5 3.83605 11.5 5.35476H12.5C12.5 4.38239 13.282 3.60039 14.2398 3.60039V2.60039ZM8.90339 14.6964L11.0874 9.70432L10.1712 9.3035L7.98723 14.2956L8.90339 14.6964ZM10.1734 9.70913L12.4203 14.7012L13.3321 14.2908L11.0852 9.29869L10.1734 9.70913ZM9.0293 13.7109H12.2897V12.7109H9.0293V13.7109ZM15.7852 14.4959V9.6875H14.7852V14.4959H15.7852Z",fill:si.Purple60}));function ep(e){if(Number.isFinite(e)){if(0===e)return 100;if(1===e)return 0;{const t=e<.01?.01:e>.99?.99:e;return Math.round(100*(1-t))}}return 0}const tp=e=>s.createElement(li.hh,Object.assign({width:"24",height:"24",viewBox:"0 0 24 24",fill:"none"},e),s.createElement("path",{d:"M15.6807 4.59375C17.754 4.59375 19.4352 6.27498 19.4352 8.34831V17.2458C19.4352 19.3191 17.754 21.0004 15.6807 21.0004H8.32133C6.248 21.0004 4.56677 19.3191 4.56677 17.2458V8.34831C4.56677 6.27498 6.248 4.59375 8.32133 4.59375",fill:ii.Q.Background.Plagiarism.Subdued}),s.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14.3233 6.28561H9.67657C8.9274 6.28561 8.32029 5.67849 8.32029 4.92933V4.35627C8.32029 3.60711 8.9274 3 9.67657 3H14.3233C15.0725 3 15.6796 3.60711 15.6796 4.35627V4.92933C15.6796 5.67849 15.0725 6.28561 14.3233 6.28561Z"}),s.createElement("path",{d:"M15.0166 15.4359H8.9824H15.0166ZM15.0166 10.9531H8.9824H15.0166Z",fill:ii.Q.Background.Plagiarism.Subdued}),s.createElement("path",{d:"M15.6807 4.59375C17.754 4.59375 19.4352 6.27498 19.4352 8.34831V17.2458C19.4352 19.3191 17.754 21.0004 15.6807 21.0004H8.32133C6.248 21.0004 4.56677 19.3191 4.56677 17.2458V8.34831C4.56677 6.27498 6.248 4.59375 8.32133 4.59375M15.0166 15.4359H8.9824M15.0166 10.9531H8.9824M14.3233 6.28561H9.67657C8.9274 6.28561 8.32029 5.67849 8.32029 4.92933V4.35627C8.32029 3.60711 8.9274 3 9.67657 3H14.3233C15.0725 3 15.6796 3.60711 15.6796 4.35627V4.92933C15.6796 5.67849 15.0725 6.28561 14.3233 6.28561Z",stroke:ii.Q.Background.Plagiarism.Default,strokeLinecap:"round",strokeLinejoin:"round"})),ip=r.UI.Node.make((({state:e})=>s.createElement(ri.F.Fragment,null,e.pipe(R.T((e=>(0,a.pipe)(e.aiDetectorScore,o.fold((()=>s.createElement(np,Object.assign({},e))),(t=>s.createElement(sp,Object.assign({},e,{aiDetectorScore:t}))))))))))),np=({originality:e,sourceCount:t})=>s.createElement("footer",{className:rp},s.createElement(Yu,null),s.createElement("span",{className:ap},s.createElement("b",null,ep(e),"% of your document")," matches text",(0,a.pipe)(t,o.fold((()=>" "),(e=>` in ${e} sources `))),"on the web or in academic databases.")),sp=({originality:e,sourceCount:t,aiDetectorScore:i})=>s.createElement("footer",{className:Qt.Ks.joinClasses([rp,op])},s.createElement(tp,{className:lp}),s.createElement("span",{className:ap},1===e?s.createElement(s.Fragment,null,s.createElement("b",null,"No plagiarism detected"),s.createElement("br",null),"Your document doesnt match anything in our references"):s.createElement(s.Fragment,null,s.createElement("b",null,ep(e),"% of your document matches",(0,a.pipe)(t,o.fold((()=>" "),(e=>` ${e} `))),"external sources"),s.createElement("br",null),"Matches were found on the web or in academic databases")),s.createElement(Xu,{className:lp}),s.createElement("span",{className:ap},0===i?s.createElement(s.Fragment,null,s.createElement("b",null,"No AI-generated text detected"),s.createElement("br",null),"Your document doesnt contain common AI text patterns"):s.createElement(s.Fragment,null,s.createElement("b",null,i,"% of your document appears to be AI-generated"),s.createElement("br",null),"Contains patterns often found in AI text"))),rp=Qt.Ks.style({padding:`${Qt.Ks.rem(1.0625)} ${Qt.Ks.rem(1.1875)}`,backgroundColor:yi.A.BackgroundBaseSubdued,borderTop:`0.5px solid ${yi.A.BorderBaseSubduedColor}`,boxSizing:"border-box",display:"flex",alignItems:"center",flexDirection:"row",gap:Qt.Ks.rem(ti.Jj)}),op=Qt.Ks.style({display:"grid",gridTemplateColumns:"max-content auto",columnGap:Qt.Ks.rem(ti.or),rowGap:Qt.Ks.rem(ti.v$),alignItems:"start",paddingLeft:Qt.Ks.rem(1)}),ap=Qt.Ks.style({fontSize:Qt.Ks.rem(.75),lineHeight:Qt.Ks.rem(1.125),color:ii.Q.Text.Base.Subdued}),lp=Qt.Ks.style({alignItems:"start"}),cp=Qt.Ks.keyframes({"0%":{transform:"translateX(-300px)"},"85%, 100%":{transform:"translateX(calc(100%))"}}),dp=Qt.Ks.style({overflow:"hidden",position:"absolute",top:0,right:0,bottom:0,left:0}),up=e=>{var t,i,n;const s=Qt.Ks.color(null!==(t=e.overlayGradientCenterColor)&&void 0!==t?t:"rgba(0, 0, 0, 1)"),r=Qt.Ks.color(null!==(i=e.overlayGradientEndColor)&&void 0!==i?i:"rgba(255, 255, 255, 0)"),o=`rgba(${s.red()}, ${s.green()}, ${s.blue()}, ${s.alpha()})`,a=`rgba(${r.red()}, ${r.green()}, ${r.blue()}, ${r.alpha()})`;return Qt.Ks.style({width:"100%",height:"100%",pointerEvents:"none",mixBlendMode:null!==(n=e.overlayBlendMode)&&void 0!==n?n:"overlay",background:`linear-gradient(90deg,${a} 0px,${o} 120px,${o} 180px,${a} 300px)`,backgroundRepeat:"no-repeat",animationDelay:"300ms",animationDuration:"1.5s",animationName:cp,animationTimingFunction:"linear",animationIterationCount:"infinite"})},pp=e=>s.createElement("div",{className:dp},s.createElement("div",{className:up(e)})),mp=()=>s.createElement("svg",{fill:"none",viewBox:"0 0 64 64",role:"img","aria-hidden":!0,focusable:!1},s.createElement("g",{clipPath:"url(#EmptyC_a)"},s.createElement("path",{fill:"#F9C7C7",stroke:"#0E101A",strokeMiterlimit:"10",d:"m29.48 18.98-3.27 21.53-22.38-9.64L18.9 14.03a6.1 6.1 0 0 1 10.58 4.95Z"}),s.createElement("path",{fill:"#F28C8C",stroke:"#0E101A",strokeMiterlimit:"10",d:"M13.54 51.78c7.04 0 12.75-5.68 12.75-12.69 0-7-5.7-12.69-12.75-12.69A12.72 12.72 0 0 0 .8 39.09c0 7 5.7 12.7 12.74 12.7Z"}),s.createElement("path",{fill:"#8ECBDE",stroke:"#0E101A",d:"M13.54 48.59a9.52 9.52 0 0 0 9.54-9.5c0-5.25-4.27-9.5-9.54-9.5A9.52 9.52 0 0 0 4 39.09c0 5.25 4.28 9.5 9.54 9.5Z"}),s.createElement("path",{stroke:"#0E101A",d:"M13.54 48.59a9.52 9.52 0 0 0 9.54-9.5c0-5.25-4.27-9.5-9.54-9.5A9.52 9.52 0 0 0 4 39.09c0 5.25 4.28 9.5 9.54 9.5Z"}),s.createElement("path",{fill:"#DDEFF5",d:"M20.7 45.37a9.51 9.51 0 0 1-5.1 3l-9.88-14.7a9.57 9.57 0 0 1 4.72-3.56L20.7 45.37Z"}),s.createElement("path",{stroke:"#0E101A",strokeMiterlimit:"10",d:"M13.54 48.59a9.52 9.52 0 0 0 9.54-9.5c0-5.25-4.27-9.5-9.54-9.5A9.52 9.52 0 0 0 4 39.09c0 5.25 4.28 9.5 9.54 9.5Z"}),s.createElement("path",{fill:"#F9C7C7",stroke:"#0E101A",strokeMiterlimit:"10",d:"m34.52 18.98 3.27 21.53 22.38-9.64L45.1 14.03a6.1 6.1 0 0 0-10.58 4.95Z"}),s.createElement("path",{fill:"#F28C8C",stroke:"#0E101A",strokeMiterlimit:"10",d:"M50.46 51.78c7.03 0 12.74-5.68 12.74-12.69 0-7-5.7-12.69-12.74-12.69A12.72 12.72 0 0 0 37.7 39.09c0 7 5.7 12.7 12.75 12.7Z"}),s.createElement("path",{fill:"#8ECBDE",stroke:"#0E101A",d:"M50.46 48.59a9.52 9.52 0 0 0 9.54-9.5c0-5.25-4.28-9.5-9.54-9.5a9.52 9.52 0 0 0-9.54 9.5c0 5.25 4.27 9.5 9.54 9.5Z"}),s.createElement("path",{stroke:"#0E101A",d:"M50.46 48.59a9.52 9.52 0 0 0 9.54-9.5c0-5.25-4.28-9.5-9.54-9.5a9.52 9.52 0 0 0-9.54 9.5c0 5.25 4.27 9.5 9.54 9.5Z"}),s.createElement("path",{fill:"#DDEFF5",d:"M57.61 45.37a9.51 9.51 0 0 1-5.1 3l-9.88-14.7a9.57 9.57 0 0 1 4.72-3.56l10.26 15.26Z"}),s.createElement("path",{stroke:"#0E101A",strokeMiterlimit:"10",d:"M50.46 48.59a9.52 9.52 0 0 0 9.54-9.5c0-5.25-4.28-9.5-9.54-9.5a9.52 9.52 0 0 0-9.54 9.5c0 5.25 4.27 9.5 9.54 9.5Z"}),s.createElement("path",{fill:"#F9C7C7",stroke:"#0E101A",strokeMiterlimit:"10",d:"M36.4 31.35h-8.8l1.25-8.24a3.17 3.17 0 0 1 3.15-2.7 3.2 3.2 0 0 1 3.15 2.7l1.25 8.24Z"}),s.createElement("path",{fill:"#F28C8C",stroke:"#0E101A",strokeMiterlimit:"10",d:"M32 36.18a4.57 4.57 0 1 0 .02-9.13 4.57 4.57 0 0 0-.02 9.13Z"}),s.createElement("path",{fill:"#0E101A",stroke:"#0E101A",strokeMiterlimit:"10",d:"M32 33.22a1.6 1.6 0 1 0 0-3.2 1.6 1.6 0 0 0 0 3.2Z"}),s.createElement("path",{fill:"#87E8D1",stroke:"#0E101A",strokeLinejoin:"round",d:"M61.64 2.7c-2.8.62-9.61 2.33-7.74 11.68 2.8.3 11.21-2.34 7.74-11.69Z"}),s.createElement("path",{stroke:"#0E101A",strokeLinejoin:"round",d:"M56.7 10.64 63.2.4"}),s.createElement("path",{fill:"#87E8D1",stroke:"#0E101A",strokeLinejoin:"round",d:"M6.44 10.94c-1.9 5.36-.2 10.75 12.3 9.39 0-2.26-3.44-10.28-12.3-9.39Z"}),s.createElement("path",{stroke:"#0E101A",strokeLinejoin:"round",d:"M15.3 17.14 2.9 8.72"}),s.createElement("path",{fill:"#87E8D1",stroke:"#0E101A",strokeLinejoin:"round",d:"M36.58 61.7c-.65-4.37-3.42-8.63-12.94-9.48.38 4.98 2.53 12.23 12.94 9.48Z"}),s.createElement("path",{stroke:"#0E101A",strokeLinejoin:"round",d:"m27.5 55.34 12.16 8.22"})),s.createElement("defs",null,s.createElement("clipPath",{id:"EmptyC_a"},s.createElement("path",{fill:"#fff",d:"M0 0h64v64H0z"})))),hp=r.UI.Node.make((({view:e})=>s.createElement(qa,{"aria-busy":"true","aria-live":"polite",style:gp,"data-testid":"plagiarism-loading"},s.createElement("div",{className:Cp},s.createElement("div",{className:Ep},s.createElement(Yc,{style:fp},e("aiDetectorEnabled").pipe(R.T((e=>e?"Checking for plagiarism and AI text...":"Checking for plagiarism...")))),s.createElement(ri.F.p,{className:wp},"Were comparing your document to billions of web pages and academic papers",e("aiDetectorEnabled").pipe(R.T((e=>e?", and detecting patterns often used by AI.":"."))))),s.createElement("div",{className:Ap},s.createElement(mp,null))),s.createElement("div",{className:vp},s.createElement("div",{className:_p},s.createElement(pp,null),s.createElement("div",{className:bp}),s.createElement("div",{className:yp}),s.createElement("div",{className:kp})),s.createElement("div",{className:Sp}),s.createElement("div",{className:_p},s.createElement(pp,null),s.createElement("div",{className:bp}),s.createElement("div",{className:yp}),s.createElement("div",{className:kp})),s.createElement("div",{className:Sp}),s.createElement("div",{className:_p},s.createElement(pp,null),s.createElement("div",{className:bp}),s.createElement("div",{className:yp}),s.createElement("div",{className:kp})),s.createElement("div",{className:Sp}),s.createElement("div",{className:_p},s.createElement(pp,null),s.createElement("div",{className:bp}),s.createElement("div",{className:yp}),s.createElement("div",{className:kp})))))),gp={padding:0},fp={whiteSpace:"normal"},vp=Qt.Ks.style({display:"flex",flexDirection:"column",margin:Qt.Ks.rem(1)}),_p=Qt.Ks.style({display:"flex",alignItems:"center",position:"relative",height:Qt.Ks.rem(2.25)}),bp=Qt.Ks.style({height:Qt.Ks.rem(.5),width:Qt.Ks.rem(.5),borderRadius:"50%",background:si.NeutralGray10,marginRight:Qt.Ks.rem(1.25)}),yp=Qt.Ks.style({height:Qt.Ks.rem(.5),width:Qt.Ks.rem(3.875),borderRadius:Qt.Ks.rem(ni.M6),background:si.NeutralGray10,marginRight:Qt.Ks.rem(ti.Jj)}),kp=Qt.Ks.style({height:Qt.Ks.rem(.5),width:Qt.Ks.rem(7.875),borderRadius:Qt.Ks.rem(ni.M6),background:si.NeutralGray10}),Sp=Qt.Ks.style({margin:`${Qt.Ks.rem(.5)} ${Qt.Ks.rem(1)}`,borderBottom:`1px solid ${ii.Q.Border.Base.Subdued}`}),Cp=Qt.Ks.style({display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:Qt.Ks.rem(ti.Jj)}),Ep=Qt.Ks.style({display:"flex",flexDirection:"column",marginRight:Qt.Ks.rem(2),justifyContent:"center"}),wp=Qt.Ks.style({margin:0,color:yi.A.TextBaseSubduedColor,fontSize:Qt.Ks.rem(.875),lineHeight:Qt.Ks.rem(1.3125),fontWeight:400}),Ap=Qt.Ks.style({width:Qt.Ks.rem(4),height:Qt.Ks.rem(4),minWidth:Qt.Ks.rem(4),minHeight:Qt.Ks.rem(4)}),Ip=()=>s.createElement("svg",{width:"64",height:"64",viewBox:"0 0 64 64",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.createElement("circle",{cx:"32",cy:"32.5",r:"32",fill:"#F9EA9E"}),s.createElement("path",{d:"M48.3961 29.2909L39.2608 19.4111C38.9744 19.1247 38.6308 18.9529 38.2299 18.9529H26.775H15.3487C14.9191 18.9529 14.5182 19.1533 14.2605 19.497L6.32793 29.3482C5.8411 29.9496 5.8411 30.8946 6.35657 31.4674L25.744 53.8617C25.8586 54.0049 26.0304 54.1195 26.1736 54.2054C26.2022 54.2054 26.2022 54.234 26.2308 54.234C26.2881 54.2627 26.374 54.2913 26.4313 54.3199C26.4599 54.3199 26.4599 54.3486 26.4886 54.3486C26.5459 54.3772 26.6318 54.3772 26.689 54.3772C26.7177 54.3772 26.7463 54.3772 26.775 54.3772C26.8609 54.3772 26.9181 54.3772 27.0041 54.3486C27.0327 54.3486 27.0327 54.3486 27.0613 54.3486C27.1186 54.3486 27.2045 54.3199 27.2618 54.2913C27.2904 54.2913 27.3191 54.2913 27.3477 54.2627C27.405 54.234 27.4336 54.2054 27.4909 54.1767C27.5195 54.1481 27.5768 54.1481 27.6054 54.1195L27.6341 54.0908C27.6913 54.0336 27.7773 53.9763 27.8345 53.919L48.3961 31.5819C48.9688 30.9233 48.9688 29.8923 48.3961 29.2909Z",fill:"#303A68"}),s.createElement("path",{d:"M54.4671 27.4294L45.3318 17.5495C45.0454 17.2631 44.7018 17.0913 44.3008 17.0913H32.8459H21.4483C21.0187 17.0913 20.6178 17.2918 20.3601 17.6354L12.4275 27.4866C11.9407 28.088 11.9407 29.0331 12.4562 29.6058L31.8436 52.0002C32.13 52.3152 32.5023 52.487 32.8746 52.487C33.2469 52.487 33.6478 52.3438 33.9341 52.0288L54.4957 29.6917C55.0398 29.0617 55.0398 28.0594 54.4671 27.4294Z",fill:"url(#paint0_linear_4597_20798)"}),s.createElement("path",{d:"M45.3318 17.5495C45.0454 17.2631 44.7018 17.0913 44.3008 17.0913H32.8459H21.4483C21.0187 17.0913 20.6178 17.2918 20.3601 17.6354L12.4275 27.4866C11.9407 28.088 11.9407 29.0331 12.4562 29.6058L31.8436 52.0002C32.4164 52.6588 33.3614 52.6588 33.9341 52.0288L54.4957 29.6917C55.0685 29.0617 55.0685 28.0594 54.4957 27.458L45.3318 17.5495Z",stroke:"#303A68",strokeMiterlimit:"10"}),s.createElement("path",{d:"M28.6648 17.0913L24.3405 27.9735C24.1974 28.3458 24.1687 28.7753 24.3119 29.1762L32.8745 52.487",stroke:"#303A68",strokeMiterlimit:"10"}),s.createElement("path",{d:"M37.0554 17.0913L41.3796 27.9735C41.5228 28.3458 41.5514 28.7753 41.4083 29.1762L32.8457 52.487",stroke:"#303A68",strokeMiterlimit:"10"}),s.createElement("path",{d:"M54.8966 28.5461H12.0552",stroke:"#303A68",strokeMiterlimit:"10"}),s.createElement("path",{d:"M45.217 19.4683L44.8447 18.1796C44.8161 18.0937 44.7588 18.0364 44.6729 18.0078L43.3842 17.6355C43.1551 17.5782 43.1551 17.2346 43.3842 17.1487L44.6729 16.7764C44.7588 16.7477 44.8161 16.6905 44.8447 16.6045L45.217 15.3159C45.2743 15.0868 45.6179 15.0868 45.7039 15.3159L46.0761 16.6045C46.1048 16.6905 46.1621 16.7477 46.248 16.7764L47.5366 17.1487C47.7657 17.2059 47.7657 17.5496 47.5366 17.6355L46.248 18.0078C46.1621 18.0364 46.1048 18.0937 46.0761 18.1796L45.7039 19.4683C45.6179 19.726 45.2743 19.726 45.217 19.4683Z",fill:"white"}),s.createElement("defs",null,s.createElement("linearGradient",{id:"paint0_linear_4597_20798",x1:"20.8994",y1:"41.0591",x2:"44.8759",y2:"17.0825",gradientUnits:"userSpaceOnUse"},s.createElement("stop",{stopColor:"#979DFF"}),s.createElement("stop",{offset:"0.9971",stopColor:"#FFCEDD"}))));var xp=i(20294),Tp=i(30451);const Fp=e=>s.createElement(li.hh,{className:e.className,fill:"none",viewBox:"0 0 20 20",width:20,height:20},s.createElement("path",{d:"M3 8.06034L6.15789 3.75H9.31579M3 8.06034L10.5 16.25M3 8.06034H7.34211M18 8.06034L14.8421 3.75H11.6842M18 8.06034L10.5 16.25M18 8.06034H13.2632M10.5 16.25L7.34211 8.06034M10.5 16.25L13.2632 8.06034M7.34211 8.06034H13.2632M7.34211 8.06034L9.31579 3.75M13.2632 8.06034L11.6842 3.75M11.6842 3.75H9.31579",stroke:"#7A3500",strokeLinecap:"round",strokeLinejoin:"round"}));const Rp=e=>{var{children:t,style:i}=e,n=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(i[n[s]]=e[n[s]])}return i}(e,["children","style"]);return s.createElement(oi.$,Object.assign({style:Object.assign(Object.assign({},i),{default:{backgroundColor:xp.Q1.Background.Premium.Default,color:xp.Q1.Text.Premium.Default},active:{backgroundColor:Tp.B7,color:xp.Q1.Text.Premium.Default},hovered:{backgroundColor:Tp.B7,color:xp.Q1.Text.Premium.Default}})},n),s.createElement(Fp,null),null!=t?t:"Go Premium")},Kp=r.UI.Node.make((({notify:e,state:t})=>{const{onMount:i}=(0,po.y)(P.M((()=>e({kind:"uphookShow"})())));return s.createElement(ri.F.Fragment,null,t.pipe(R.T((({isEligibleForFreeTrial:t,isGrammarlyPro:n,isInProductDiscounts:r})=>s.createElement(Rp,{onClick:e({kind:"uphookClick"}),mount:i,"data-testid":"uphook-button",className:Mp},((e,t,i)=>i?t?"Get 50% off Pro":"Get 50% off Premium":e?"Try for Free":t?"Get Pro":"Go Premium")(t.get(),n.get(),r.get()))))))})),Mp=Qt.Ks.style({flex:1}),Op=r.UI.Grid.make((({slots:e,notify:t,view:i})=>s.createElement(qa,{"aria-busy":"true","aria-live":"polite","data-testid":"plagiarism-uphook",style:Bp},s.createElement(Ip,null),s.createElement("div",{className:Pp},s.createElement(Yc,{style:Dp},i("aiDetectorEnabled").pipe(R.T((e=>e?"Detect plagiarism and AI text":"Plagiarism")))),s.createElement(ri.F.p,{className:Lp},i("aiDetectorEnabled").pipe(R.T((e=>e?"Grammarly finds parts of your text that may need citations for external sources or AI generation.":"Grammarly compares billions of web pages to your document and alerts you to passages that may need citations.")))),s.createElement("div",{className:Up},e.uphook,s.createElement(oi.$,{variant:"tertiary",onClick:t({kind:"plagiarismUphookDismiss"})},"Maybe later")))))),Np=r.UI.Knot.make(Op,{uphook:Kp}),Bp={padding:Qt.Ks.rem(qt.Jj),display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:Qt.Ks.rem(qt.v5),height:"100%",boxSizing:"border-box"},Pp=Qt.Ks.style({textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",paddingLeft:Qt.Ks.rem(qt.Jj),paddingRight:Qt.Ks.rem(qt.Jj),gap:Qt.Ks.rem(qt.v$)}),Dp={whiteSpace:"normal",padding:0},Lp=Qt.Ks.style({margin:0,color:yi.A.TextBaseSubduedColor,fontSize:Qt.Ks.rem(.875),lineHeight:"1.5em",fontWeight:400}),Up=Qt.Ks.style({display:"flex",alignItems:"center",justifyContent:"center",gap:Qt.Ks.rem(.5)}),jp=e=>s.createElement(li.hh,Object.assign({width:"76",height:"76",viewBox:"0 0 76 76"},e),s.createElement("rect",{width:"76",height:"76",rx:"38",fill:"#FFBF47",stroke:"none"}),s.createElement("path",{d:"M40.9687 45.6279C44.5895 44.8414 46.5622 42.8307 47.5 39.753C43.565 39.753 40.375 36.6137 40.375 32.7411C40.375 28.8686 43.565 25.7292 47.5 25.7292C51.435 25.7292 54.625 28.6697 54.625 32.7411C54.625 36.8126 53.8333 47.1042 40.9687 50.2709V45.6279Z",fill:"#7A3500",stroke:"none"}),s.createElement("path",{d:"M21.9687 45.6279C25.5895 44.8414 27.5622 42.8307 28.5 39.753C24.565 39.753 21.375 36.6137 21.375 32.7411C21.375 28.8686 24.565 25.7292 28.5 25.7292C32.435 25.7292 35.625 28.6697 35.625 32.7411C35.625 36.8126 34.8333 47.1042 21.9687 50.2709V45.6279Z",fill:"#7A3500",stroke:"none"})),Vp=r.UI.Grid.make((({slots:e,notify:t,state:i})=>s.createElement(ri.F.div,{className:Hp},i.pipe(R.T((({promptText:i})=>s.createElement(s.Fragment,null,s.createElement(ia.E,{as:"p"},s.createElement("span",null,i)),s.createElement("div",{className:Zp},e.uphook),s.createElement(oi.$,{variant:"tertiary",onClick:t({kind:"plagiarismUphookDismiss"})},"Maybe later")))))))),$p=r.UI.Knot.make(Vp,{uphook:Kp}),Hp=Qt.Ks.style({marginTop:Qt.Ks.rem(3),backgroundColor:ii.Q.Background.Base.Subdued,textAlign:"center",borderRadius:Qt.Ks.rem(ni.Dk),padding:Qt.Ks.rem(1),fontSize:Qt.Ks.rem(1),lineHeight:Qt.Ks.rem(1.5),display:"flex",alignItems:"center",flexDirection:"column"}),Zp=Qt.Ks.style({marginTop:Qt.Ks.rem(1),marginBottom:Qt.Ks.rem(.5),width:`calc(100% - ${Qt.Ks.rem(1)})`,display:"flex"}),Gp=r.UI.Grid.make((({slots:e,view:t,notify:i})=>{const{onMount:n}=(0,po.y)((0,a.flow)(P.M(i({kind:"plagiarismFeedMount"})),co.j(or.notifyFeedUnmount)));return s.createElement(qa,{"data-testid":"plagiarism-smart-uphook",style:zp,mount:n,"aria-live":"polite"},s.createElement(ri.F.div,{className:Qp},s.createElement(Yc,{style:qp},"Plagiarism detected"),t("citationDropdown").pipe(R.T(o.fold(a.constNull,(e=>s.createElement(hd,{disabled:!0,className:Xp,menuClassName:em,placeholder:e.placeholder,options:e.select.items,optionsGroupLabel:"Citation style",selection:e.select.items.find((t=>t.id===e.selectedItem)),onSelectionChange:()=>{},onOptionsExpanded:()=>{},label:e=>e.label,renderOption:e=>e.label})))))),s.createElement(Go,{className:Jp},e.cardList),s.createElement("div",{className:Yp},s.createElement(jp,null),s.createElement(Lc.D,{as:"h2",variant:"heading-xsmall",marginTop:4},"Plagiarism detected"),s.createElement(ia.E,{as:"p",marginTop:1},s.createElement(ri.F.b,null,t("originality").pipe(R.T(ep)),"%"),s.createElement(ri.F.span,null," ","of your document matches text",t("sourceCount").pipe(R.T(o.fold((()=>" on the web or in academic databases."),(e=>` in ${e} sources`)))))),e.uphookPrompt))})),Wp=r.UI.Knot.make(Gp,{cardList:ju,uphookPrompt:$p}),zp={padding:0,display:"grid",gridTemplateRows:"auto 1fr auto",height:"100%"},qp={whiteSpace:"normal",padding:0,color:ii.Q.Text.Base.Subdued},Qp=Qt.Ks.style({display:"flex",alignItems:"flex-start",justifyContent:"space-between",padding:`${Qt.Ks.rem(ti.v$)} ${Qt.Ks.rem(ti.Jj)}`,paddingTop:Qt.Ks.rem(ti.Jj)}),Jp=Qt.Ks.style({filter:"blur(4px)",pointerEvents:"none",userSelect:"none",$nest:{'&[data-overflow-top="true"]':{borderTop:`0.5px solid ${ii.Q.Border.Base.Subdued}`}}}),Yp=Qt.Ks.style({padding:`${Qt.Ks.rem(ti.Oj)} ${Qt.Ks.rem(ti.Jj)} ${Qt.Ks.rem(ti.Jj)} ${Qt.Ks.rem(ti.Jj)}`,backgroundColor:ii.Q.Background.Base.Default,borderTop:`1px solid ${ii.Q.Border.Base.Subdued}`,boxSizing:"border-box",display:"flex",alignItems:"center",flexDirection:"column",gap:0,boxShadow:"0px -6px 31px 0px rgba(0, 0, 0, 0.25)",textAlign:"center"}),Xp=Qt.Ks.style({width:"min-content",height:Qt.Ks.rem(1.5),$nest:{"& > button":{padding:`${Qt.Ks.rem(3*ti.vW)} ${Qt.Ks.rem(ti.or)} ${Qt.Ks.rem(3*ti.vW)} ${Qt.Ks.rem(ti.v$)}`}}}),em=Qt.Ks.style({width:Qt.Ks.rem(9.75)}),tm=e=>s.createElement(li.hh,Object.assign({width:"88",height:"88",viewBox:"0 0 88 88",stroke:"none"},e),s.createElement("rect",{width:"88",height:"88",rx:"44",fill:"#EAFAF9",stroke:"none"}),s.createElement("path",{d:"M29 45.1111L38.2308 54L59 34",stroke:"#016A5E",strokeWidth:"6",strokeLinecap:"square",fill:"#EAFAF9"})),im=r.UI.Grid.make((({slots:e,notify:t})=>s.createElement(qa,{"aria-busy":"true","aria-live":"polite","data-testid":"plagiarism-smart-uphook-empty",mount:t({kind:"plagiarismFeedSuccessMountAction"}),style:sm},s.createElement("div",{className:rm},s.createElement(tm,null),s.createElement(Lc.D,{as:"h2",variant:"heading-xsmall",marginTop:4},"Nice job!"),s.createElement(ia.E,{as:"p",marginTop:2},"No plagiarism was detected in your text.")),e.uphookPrompt))),nm=r.UI.Knot.make(im,{uphookPrompt:$p}),sm={height:"100%",boxSizing:"border-box",textAlign:"center"},rm=Qt.Ks.style({display:"flex",flexGrow:1,flexDirection:"column",alignItems:"center",justifyContent:"center"}),om=r.UI.Grid.make((({slots:e,view:t,notify:i})=>{const{onMount:n}=(0,po.y)((0,a.flow)(P.M(i({kind:"plagiarismFeedMount"})),co.j(or.notifyFeedUnmount)));return s.createElement(qa,{"data-testid":"plagiarism-non-empty",style:dm,mount:n,"aria-live":"polite"},s.createElement(ri.F.div,{className:pm},s.createElement(Yc,{style:um},t("aiDetectorEnabled").pipe(R.T((e=>e?"Plagiarism and AI text check":"Plagiarism detected"))),t("pageRange").pipe(R.T(o.fold(a.constNull,(e=>s.createElement(vd,{pageRange:e,onPageRangeHeaderMount:a.constVoid})))))),t("citationDropdown").pipe(R.T(o.fold(a.constNull,(e=>s.createElement(hd,{className:mm,menuClassName:hm,placeholder:e.placeholder,options:e.select.items,optionsGroupLabel:"Citation style",selection:e.select.items.find((t=>t.id===e.selectedItem)),onSelectionChange:e=>i({kind:"sduiCitationDropdownSelect",actions:e.onClickActions,sourceId:e.id})(),onOptionsExpanded:e=>i({kind:"sduiCitationDropdownOpen",currentSourceId:null==e?void 0:e.id})(),label:e=>e.label,renderOption:e=>e.label})))))),s.createElement(Go,{className:cm},e.cardList),e.footer)})),am=r.UI.Knot.make(om,{cardList:ju,footer:r.UI.Union.asOption(ip)}),lm=r.UI.Union.make("kind",{loadingState:hp,emptyState:Zu,nonEmptyState:am,uphookState:Np,smartUphookState:Wp,smartUphookEmptyState:nm}),cm=Qt.Ks.style({$nest:{'&[data-overflow-top="true"]':{borderTop:`0.5px solid ${yi.A.BorderBaseSubduedColor}`}}}),dm={padding:0,display:"grid",gridTemplateRows:"auto 1fr auto",height:"100%"},um={whiteSpace:"normal",padding:0},pm=Qt.Ks.style({display:"flex",alignItems:"flex-start",justifyContent:"space-between",padding:`${Qt.Ks.rem(ti.v$)} ${Qt.Ks.rem(ti.Jj)}`,paddingTop:Qt.Ks.rem(ti.Jj)}),mm=Qt.Ks.style({width:"min-content",height:Qt.Ks.rem(1.5),$nest:{"& > button":{padding:`${Qt.Ks.rem(3*ti.vW)} ${Qt.Ks.rem(ti.or)} ${Qt.Ks.rem(3*ti.vW)} ${Qt.Ks.rem(ti.v$)}`}}}),hm=Qt.Ks.style({width:Qt.Ks.rem(9.75)}),gm=r.UI.Node.make((({view:e})=>s.createElement(qa,{"data-testid":"settings"},e("content"))));var fm=i(60918);const vm=r.UI.Grid.make((({slots:e})=>s.createElement("div",{className:km},s.createElement("h2",{className:Sm},"Looks like you got signed out"),e.content,e.signIn))),_m=r.UI.Union.make("kind",{free:r.UI.Node.make((()=>s.createElement("p",{className:Cm},"Sign back in to use personalized features and generative AI."))),premium:r.UI.Node.make((()=>s.createElement(s.Fragment,null,s.createElement("p",{className:Cm},"Youre missing out on your Premium features. Sign back in to:"),s.createElement("ul",{className:Em},s.createElement("li",null,s.createElement(fm.l,{className:wm}),"Rewrite full sentences"),s.createElement("li",null,s.createElement(fm.l,{className:wm}),"Strike the right tone"),s.createElement("li",null,s.createElement(fm.l,{className:wm}),"Use generative AI"))))),business:r.UI.Node.make((()=>s.createElement(s.Fragment,null,s.createElement("p",{className:Cm},"Youre missing out on your Grammarly Business features. Sign back in to:"),s.createElement("ul",{className:Em},s.createElement("li",null,s.createElement(fm.l,{className:wm}),"Rewrite full sentences"),s.createElement("li",null,s.createElement(fm.l,{className:wm}),"Strike the right tone"),s.createElement("li",null,s.createElement(fm.l,{className:wm}),"Access time-saving snippets"),s.createElement("li",null,s.createElement(fm.l,{className:wm}),"Maintain your brand voice"),s.createElement("li",null,s.createElement(fm.l,{className:wm}),"Use generative AI")))))}),bm=r.UI.Union.asOption(r.UI.Node.make((({notify:e})=>s.createElement(oi.$,{name:"signBackIn",onClick:e({kind:ft.t.Kind.signInButtonClick})},"Sign in")))),ym=r.UI.Knot.make(vm,{content:_m,signIn:bm}),km=Qt.Ks.style({padding:Qt.Ks.rem(ti.Jj)}),Sm=Qt.Ks.style({fontSize:Qt.Ks.rem(1),lineHeight:"1.5em",margin:0}),Cm=Qt.Ks.style({fontSize:Qt.Ks.rem(.875),lineHeight:"1.5em",margin:`0 0 ${Qt.Ks.rem(ti.Jj)} 0`,color:ii.Q.Text.Base.Subdued}),Em=Qt.Ks.style({fontSize:Qt.Ks.rem(.875),margin:`${Qt.Ks.rem(ti.Jj)} 0`,paddingInlineStart:Qt.Ks.rem(2),listStyle:"none",position:"relative",$nest:{"& > li":{margin:`${Qt.Ks.rem(ti.v$)} 0`}}}),wm=Qt.Ks.style({width:Qt.Ks.rem(1.5),height:Qt.Ks.rem(1.5),position:"absolute",left:0,marginTop:Qt.Ks.rem(-.25)}),Am={padding:0,height:Qt.Ks.rem(14.625),overflow:"hidden",boxSizing:"border-box",maxHeight:"inherit",display:"flex",justifyContent:"center",alignItems:"center",borderBottomLeftRadius:"inherit",borderBottomRightRadius:"inherit"},Im={height:"100%",borderBottomLeftRadius:"inherit",borderBottomRightRadius:"inherit"},xm=Qt.Ks.style(Object.assign(Object.assign({},Im),{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"})),Tm=Qt.Ks.style(Object.assign(Object.assign({},Im),{border:"none",margin:"0",width:"100%"})),Fm=Qt.Ks.style({color:ii.Q.Text.Base.Subdued,fontSize:Qt.Ks.rem(.75),fontFamily:"Inter",fontWeight:700,lineHeight:Qt.Ks.rem(1.125)}),Rm=Qt.Ks.style({color:ii.Q.Text.Base.Subdued,fontSize:Qt.Ks.rem(.75),fontFamily:"Inter",lineHeight:Qt.Ks.rem(1.125)}),Km=Qt.Ks.style({visibility:"hidden",position:"absolute"}),Mm=r.UI.Node.make((({state:e,view:t,notify:i})=>{const{notifyUnmount:n}=s.useContext(mo),{ref:r,onMount:o}=(0,po.y)((0,a.flow)(P.M((e=>i({kind:ft.t.Kind.mount,name:Et.e.skill,element:e})())),co.j((()=>n({kind:ft.t.Kind.unmount,name:Et.e.skill}))))),l=s.useMemo((()=>t("status").pipe(Ht.J(),m.p((([e,t])=>"loading"===e&&"ready"===t)),d.n((()=>r.pipe(N.oE,P.M((e=>e.focus()))))))),[r]);return jt.R.useSubscriptionTo(l),s.createElement(qa,{"data-testid":"skill",style:t("size").pipe(R.T((e=>Object.assign(Object.assign({},Am),{height:e.height}))))},e.pipe(R.T((({status:e,srcUrl:t})=>"loading"===e||"ready"===e?s.createElement(s.Fragment,null,"loading"===e&&s.createElement("div",{className:xm},s.createElement(Nd,null),s.createElement("span",{className:Rm},"Loading...")),s.createElement("iframe",{"aria-busy":"loading"===e,key:t,src:t,ref:o,allow:`clipboard-write ${t}`,className:Qt.Ks.joinClasses([Tm,"loading"===e?Km:void 0])})):"error"===e?s.createElement("div",{className:xm},s.createElement(qr,null),s.createElement("span",{className:Fm},"Something went wrong"),s.createElement("span",{className:Rm},"Please try again.")):(0,g.AS)(e)))))})),Om=r.UI.Union.asOption(Mm),Nm=()=>s.createElement("svg",{width:"64",height:"64",viewBox:"0 0 64 64",fill:"none","aria-hidden":!0,focusable:!1},s.createElement("g",{filter:"url(#filter0_d_8024_21772)"},s.createElement("path",{d:"M55.8852 31.8162C55.8852 45.1944 45.0401 56.0395 31.6619 56.0395C18.2837 56.0395 7.43851 45.1944 7.43851 31.8162C7.43851 18.438 18.2837 7.59281 31.6619 7.59281C45.0401 7.59281 55.8852 18.438 55.8852 31.8162Z",fill:"#F8E485",stroke:"#0E101A",strokeWidth:"0.923895"}),s.createElement("path",{d:"M21.7978 23.7215C22.8908 23.928 23.9428 23.2174 24.1473 22.1344C24.3519 21.0514 23.6317 20.0061 22.5387 19.7996C21.4456 19.5932 20.3937 20.3037 20.1892 21.3867C19.9846 22.4697 20.7048 23.515 21.7978 23.7215Z",fill:"#0E101A"}),s.createElement("path",{d:"M41.4843 27.4402C42.5774 27.6467 43.6293 26.9362 43.8339 25.8532C44.0384 24.7702 43.3182 23.7249 42.2252 23.5184C41.1322 23.3119 40.0803 24.0225 39.8757 25.1055C39.6711 26.1885 40.3913 27.2338 41.4843 27.4402Z",fill:"#0E101A"}),s.createElement("path",{d:"M24.2816 34.395C24.2816 34.395 29.559 33.4257 32.7662 37.1937L24.2816 34.395Z",fill:"#F8E485"}),s.createElement("path",{d:"M24.2816 34.395C24.2816 34.395 29.559 33.4257 32.7662 37.1937",stroke:"black",strokeWidth:"0.923895",strokeMiterlimit:"10",strokeLinecap:"round",strokeLinejoin:"round"}),s.createElement("mask",{id:"path-6-outside-1_8024_21772",maskUnits:"userSpaceOnUse",x:"8.96191",y:"33.5461",width:"27",height:"25",fill:"black"},s.createElement("rect",{fill:"white",x:"8.96191",y:"33.5461",width:"27",height:"25"}),s.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M21.6191 56.9757L22.7965 55.6378C14.6478 59.7692 7.64857 53.1582 10.6855 43.2215C11.3435 41.0674 11.0422 39.168 10.8093 37.6995C10.5628 36.1455 10.3928 35.0741 11.5172 34.6942C14.0431 33.8393 15.4863 36.7255 15.2158 42.3628C18.0521 41.5103 19.8629 40.6726 21.2853 40.0146C22.7461 39.3389 23.7971 38.8527 25.1283 38.7347C26.0211 38.6556 27.1853 39.1115 28.5046 39.6282C29.906 40.1771 31.4825 40.7945 33.0945 40.912C35.6349 41.0955 34.3174 45.1814 31.2708 44.3961C30.8221 44.2809 30.3668 44.0484 29.8691 43.7942C29.0231 43.3622 28.0546 42.8677 26.7878 42.7801C29.4925 44.3034 30.3464 45.5253 28.8772 48.4425C28.8772 48.4425 28.1305 47.4427 26.0982 46.98C29.0752 48.9892 29.2384 50.4874 27.7364 52.796C27.2302 52.3594 26.1822 51.7586 24.7362 51.689C29.8615 53.7446 26.4662 59.3702 21.6191 56.9757Z"})),s.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M21.6191 56.9757L22.7965 55.6378C14.6478 59.7692 7.64857 53.1582 10.6855 43.2215C11.3435 41.0674 11.0422 39.168 10.8093 37.6995C10.5628 36.1455 10.3928 35.0741 11.5172 34.6942C14.0431 33.8393 15.4863 36.7255 15.2158 42.3628C18.0521 41.5103 19.8629 40.6726 21.2853 40.0146C22.7461 39.3389 23.7971 38.8527 25.1283 38.7347C26.0211 38.6556 27.1853 39.1115 28.5046 39.6282C29.906 40.1771 31.4825 40.7945 33.0945 40.912C35.6349 41.0955 34.3174 45.1814 31.2708 44.3961C30.8221 44.2809 30.3668 44.0484 29.8691 43.7942C29.0231 43.3622 28.0546 42.8677 26.7878 42.7801C29.4925 44.3034 30.3464 45.5253 28.8772 48.4425C28.8772 48.4425 28.1305 47.4427 26.0982 46.98C29.0752 48.9892 29.2384 50.4874 27.7364 52.796C27.2302 52.3594 26.1822 51.7586 24.7362 51.689C29.8615 53.7446 26.4662 59.3702 21.6191 56.9757Z",fill:"#F9EA9E"}),s.createElement("path",{d:"M22.7965 55.6378L23.4901 56.2482L22.3788 54.8138L22.7965 55.6378ZM21.6191 56.9757L20.9255 56.3652L20.1291 57.2701L21.2098 57.804L21.6191 56.9757ZM10.6855 43.2215L11.5691 43.4916L11.5691 43.4914L10.6855 43.2215ZM10.8093 37.6995L9.89676 37.8442L10.8093 37.6995ZM11.5172 34.6942L11.8129 35.5694L11.8134 35.5693L11.5172 34.6942ZM15.2158 42.3628L14.293 42.3185L14.2303 43.6237L15.4817 43.2476L15.2158 42.3628ZM21.2853 40.0146L21.6732 40.8532L21.2853 40.0146ZM25.1283 38.7347L25.2099 39.655L25.2099 39.655L25.1283 38.7347ZM28.5046 39.6282L28.1677 40.4885L28.5046 39.6282ZM33.0945 40.912L33.0274 41.8334L33.0279 41.8335L33.0945 40.912ZM31.2708 44.3961L31.5014 43.5015L31.5006 43.5013L31.2708 44.3961ZM29.8691 43.7942L29.4489 44.6171L29.8691 43.7942ZM26.7878 42.7801L26.8516 41.8584L26.3345 43.5851L26.7878 42.7801ZM28.8772 48.4425L28.137 48.9953L29.0306 50.1918L29.7023 48.8581L28.8772 48.4425ZM26.0982 46.98L26.3032 46.0792L25.5813 47.7458L26.0982 46.98ZM27.7364 52.796L27.1329 53.4956L27.9339 54.1865L28.5108 53.2999L27.7364 52.796ZM24.7362 51.689L24.7806 50.7662L24.3923 52.5465L24.7362 51.689ZM22.103 55.0274L20.9255 56.3652L22.3126 57.5861L23.4901 56.2482L22.103 55.0274ZM9.80196 42.9515C8.21218 48.1532 9.20062 52.6777 11.8945 55.3599C14.6148 58.0683 18.8498 58.6746 23.2143 56.4619L22.3788 54.8138C18.5946 56.7323 15.2556 56.0989 13.1983 54.0505C11.1146 51.9759 10.1219 48.2266 11.5691 43.4916L9.80196 42.9515ZM9.89676 37.8442C10.1299 39.3143 10.3914 41.0217 9.80191 42.9516L11.5691 43.4914C12.2956 41.1131 11.9544 39.0216 11.7217 37.5547L9.89676 37.8442ZM11.2214 33.8189C10.8038 33.96 10.4382 34.1906 10.1678 34.5389C9.90133 34.8821 9.78146 35.2699 9.73319 35.6357C9.6443 36.3092 9.78198 37.1206 9.89676 37.8442L11.7217 37.5547C11.59 36.7243 11.5195 36.2231 11.5651 35.8774C11.5841 35.7336 11.6171 35.6852 11.6273 35.6721C11.6336 35.6641 11.6684 35.6183 11.8129 35.5694L11.2214 33.8189ZM16.1386 42.4071C16.2762 39.5396 15.9913 37.2198 15.2457 35.6893C14.8668 34.9115 14.3335 34.2665 13.6055 33.9095C12.8591 33.5435 12.0364 33.5431 11.221 33.819L11.8134 35.5693C12.2609 35.4178 12.5659 35.4576 12.792 35.5685C13.0365 35.6884 13.3207 35.957 13.5846 36.4985C14.1244 37.6068 14.4259 39.5487 14.293 42.3185L16.1386 42.4071ZM20.8974 39.1761C19.4867 39.8287 17.7228 40.6445 14.9499 41.478L15.4817 43.2476C18.3813 42.3761 20.2392 41.5165 21.6732 40.8532L20.8974 39.1761ZM25.0468 37.8144C23.5293 37.9489 22.3342 38.5115 20.8974 39.1761L21.6732 40.8532C23.1581 40.1662 24.065 39.7564 25.2099 39.655L25.0468 37.8144ZM28.8416 38.768C28.1917 38.5135 27.5321 38.2544 26.9197 38.0724C26.3145 37.8925 25.6671 37.7594 25.0467 37.8144L25.2099 39.655C25.4824 39.6308 25.8634 39.6861 26.3933 39.8436C26.9161 39.999 27.4982 40.2263 28.1677 40.4885L28.8416 38.768ZM33.1616 39.9905C31.7128 39.885 30.2669 39.3262 28.8416 38.768L28.1677 40.4885C29.5452 41.028 31.2521 41.7041 33.0274 41.8334L33.1616 39.9905ZM31.0402 45.2908C33.0568 45.8106 34.5818 44.6954 35.1311 43.3715C35.3991 42.7257 35.4703 41.9426 35.1461 41.2517C34.7967 40.5072 34.0764 40.0566 33.1611 39.9905L33.0279 41.8335C33.3828 41.8591 33.4505 41.9881 33.4734 42.0367C33.5214 42.139 33.5491 42.3628 33.4244 42.6633C33.1885 43.2319 32.5314 43.767 31.5014 43.5015L31.0402 45.2908ZM29.4489 44.6171C29.9222 44.8588 30.4736 45.1453 31.041 45.291L31.5006 43.5013C31.1706 43.4165 30.8114 43.2381 30.2892 42.9714L29.4489 44.6171ZM26.7241 43.7018C27.7815 43.7749 28.5974 44.1822 29.4489 44.6171L30.2892 42.9714C29.4488 42.5423 28.3277 41.9605 26.8516 41.8584L26.7241 43.7018ZM29.7023 48.8581C30.476 47.322 30.7784 45.9677 30.2472 44.7254C29.7453 43.5513 28.5923 42.7361 27.2412 41.9751L26.3345 43.5851C27.688 44.3475 28.3143 44.9048 28.5482 45.4518C28.7529 45.9305 28.7476 46.6458 28.052 48.0269L29.7023 48.8581ZM25.8931 47.8809C26.7894 48.0849 27.3747 48.4005 27.7208 48.6422C27.895 48.7639 28.0114 48.8688 28.078 48.9349C28.1114 48.968 28.1324 48.9914 28.1419 49.0024C28.1466 49.008 28.1485 49.0103 28.1476 49.0093C28.1472 49.0087 28.1461 49.0073 28.1443 49.005C28.1434 49.0039 28.1424 49.0025 28.1411 49.0009C28.1405 49.0001 28.1399 48.9992 28.1392 48.9983C28.1388 48.9978 28.1385 48.9973 28.1381 48.9969C28.1379 48.9966 28.1376 48.9962 28.1375 48.9961C28.1372 48.9957 28.137 48.9953 28.8772 48.4425C29.6174 47.8896 29.6171 47.8892 29.6168 47.8888C29.6167 47.8887 29.6164 47.8883 29.6162 47.888C29.6158 47.8875 29.6154 47.8869 29.6149 47.8863C29.614 47.8851 29.6131 47.8839 29.6121 47.8826C29.6102 47.88 29.608 47.8772 29.6056 47.8742C29.6009 47.868 29.5953 47.861 29.589 47.853C29.5762 47.8371 29.56 47.8175 29.5404 47.7948C29.5011 47.7493 29.4479 47.691 29.3795 47.6232C29.2426 47.4874 29.0453 47.3134 28.7788 47.1273C28.2435 46.7535 27.4393 46.3378 26.3032 46.0792L25.8931 47.8809ZM28.5108 53.2999C29.2971 52.0914 29.8145 50.856 29.494 49.5548C29.1821 48.2882 28.1416 47.2445 26.615 46.2142L25.5813 47.7458C27.0317 48.7247 27.5614 49.4347 27.6999 49.9967C27.8297 50.524 27.6778 51.192 26.962 52.2922L28.5108 53.2999ZM24.6918 52.6119C25.9073 52.6703 26.7634 53.1768 27.1329 53.4956L28.3399 52.0964C27.6971 51.5419 26.457 50.8468 24.7806 50.7662L24.6918 52.6119ZM21.2098 57.804C23.9894 59.1771 26.6084 58.3216 27.7106 56.4746C28.256 55.5607 28.3939 54.4321 27.945 53.3617C27.4985 52.297 26.5256 51.4112 25.0801 50.8315L24.3923 52.5465C25.5094 52.9946 26.0341 53.5828 26.241 54.0763C26.4455 54.564 26.3926 55.0775 26.1239 55.5277C25.5981 56.4088 24.0959 57.1688 22.0283 56.1473L21.2098 57.804Z",fill:"black",mask:"url(#path-6-outside-1_8024_21772)"})),s.createElement("defs",null,s.createElement("filter",{id:"filter0_d_8024_21772",x:"0.331055",y:"5.4856",width:"57.6621",height:"57.9946",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},s.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),s.createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),s.createElement("feOffset",{dx:"-5",dy:"5"}),s.createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.776471 0 0 0 0 0.796078 0 0 0 0 0.870588 0 0 0 1 0"}),s.createElement("feBlend",{mode:"normal",in2:"BackgroundImageFix",result:"effect1_dropShadow_8024_21772"}),s.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"effect1_dropShadow_8024_21772",result:"shape"})))),Bm=r.UI.Node.make((({notify:e})=>{const{onMount:t}=(0,po.y)(P.M(e({kind:ft.t.Kind.toneReportLoadedEmptyMount})));return s.createElement(qa,{mount:t,key:"tone-report-empty","data-testid":"tone-report-empty",style:Pm},s.createElement(Nm,null),s.createElement(Yc,{style:Dm},"We couldn't detect a tone"),s.createElement("p",{className:Lm},"To see an analysis of your tone, write more and check again."),s.createElement(oi.$,{variant:"secondary",onClick:e({kind:ft.t.Kind.toneReportBackToSuggestionsButtonClick})},"See all suggestions"))})),Pm={padding:`${Qt.Ks.rem(ti.Jj)}`,display:"flex",justifyContent:"center",alignItems:"center",gap:`${Qt.Ks.rem(ti.Jj)}`,boxSizing:"border-box"},Dm={whiteSpace:"normal",padding:0},Lm=Qt.Ks.style({margin:0,color:yi.A.TextBaseSubduedColor,fontSize:Qt.Ks.rem(.875),lineHeight:"1.5em",fontWeight:400,textAlign:"center"});var Um=i(37099);const jm=({uphookButton:e,uphookTitle:t,uphookEmojiId:i})=>s.createElement(ri.F.div,{className:Vm,key:"tone-report-footer"},s.createElement(ri.F.div,{className:$m},(0,a.pipe)(i,o.map((e=>s.createElement(Um.UV,{id:e,className:Hm,key:"uphookEmoji"}))),o.getOrElse((()=>s.createElement(s.Fragment,null)))),s.createElement("div",{className:Zm},t)),e),Vm=Qt.Ks.style({borderTop:`1px solid ${yi.A.FooterBorder}`,marginTop:Qt.Ks.rem(.5),paddingTop:Qt.Ks.rem(.75),display:"grid",gridTemplateColumns:"1fr auto",alignItems:"center"}),$m=Qt.Ks.style({display:"flex",alignItems:"center",flexBasis:Qt.Ks.percent(45)}),Hm=Qt.Ks.style({padding:Qt.Ks.rem(ti.sp),marginRight:Qt.Ks.rem(ti.CN),width:Qt.Ks.rem(ti.C2),height:Qt.Ks.rem(ti.C2)}),Zm=Qt.Ks.style({paddingTop:Qt.Ks.rem(ti.sp),marginRight:Qt.Ks.rem(ti.sp),fontSize:Qt.Ks.rem(.875)});var Gm=i(40046);const Wm=(0,Yt.w)("color",(({title:e,titleId:t,desc:i,descId:n,...r})=>s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16","aria-hidden":"true",stroke:"transparent","aria-labelledby":t,"aria-describedby":n,...r},i?s.createElement("desc",{id:n},i):null,e?s.createElement("title",{id:t},e):null,s.createElement("path",{fill:"#646B81",d:"M9.2 8a1.2 1.2 0 1 1-2.4 0 1.2 1.2 0 0 1 2.4 0M9.2 12.8a1.2 1.2 0 1 1-2.4 0 1.2 1.2 0 0 1 2.4 0M9.2 3.2a1.2 1.2 0 1 1-2.4 0 1.2 1.2 0 0 1 2.4 0"})))),zm=(0,Yt.w)("color",(({title:e,titleId:t,desc:i,descId:n,...r})=>s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16","aria-hidden":"true",stroke:"transparent","aria-labelledby":t,"aria-describedby":n,...r},i?s.createElement("desc",{id:n},i):null,e?s.createElement("title",{id:t},e):null,s.createElement("path",{stroke:"#646B81",d:"M13.5 8.635q-.001.137-.047.265l-1.797 3.607-.008.016-.007.017c-.116.284-.371.46-.641.46H6.4c-.362 0-.7-.316-.7-.77V7.578c0-.218.086-.417.215-.553l3.589-3.796.264.279c.08.09.128.202.132.321l-.012.143-.523 2.663-.117.597H13.2c.138 0 .3.13.3.346zM3.6 7.23c.14 0 .3.128.3.346v5.077c0 .218-.16.346-.3.346h-.8c-.14 0-.3-.128-.3-.346V7.577c0-.218.16-.346.3-.346z"})))),qm=(0,Yt.w)("color",(({title:e,titleId:t,desc:i,descId:n,...r})=>s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16","aria-hidden":"true",stroke:"transparent","aria-labelledby":t,"aria-describedby":n,...r},i?s.createElement("desc",{id:n},i):null,e?s.createElement("title",{id:t},e):null,s.createElement("path",{stroke:"#646B81",d:"M2.5 7.865c0-.09.017-.181.047-.265l1.797-3.607.008-.016.007-.017c.116-.283.371-.46.641-.46h4.6c.362 0 .7.316.7.77v4.653a.8.8 0 0 1-.215.553l-3.589 3.796-.264-.279a.5.5 0 0 1-.132-.322l.012-.142.523-2.663.117-.597H2.8c-.138 0-.3-.13-.3-.346zm9.9 1.404c-.14 0-.3-.128-.3-.346V3.846c0-.218.16-.346.3-.346h.8c.14 0 .3.128.3.346v5.077c0 .218-.16.346-.3.346z"}))));function Qm(e){var{children:t,onOpenChange:i,title:n,placement:r="bottom end"}=e,l=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(i[n[s]]=e[n[s]])}return i}(e,["children","onOpenChange","title","placement"]);return s.createElement(al.j.Consumer,null,(({portalContainer:e})=>s.createElement(ri.F.Fragment,null,e.view(o.fold(a.constNull,(e=>s.createElement(hu,Object.assign({},l,{portalContainer:e,placement:r,title:n,onOpenChange:e=>null==i?void 0:i(e)}),t)))))))}const Jm=({status:e,description:t})=>{const[i,n]=e===Kt.On?[Xm,ih]:e===Kt.Off?[eh,nh]:(0,g.AS)(e),r=(0,a.pipe)(t,o.fold((()=>s.createElement(li.In.Info,{className:n})),(e=>s.createElement(Gm.m_,{title:s.createElement("div",{className:rh},e)},s.createElement(li.In.Info,{className:n})))));return s.createElement("div",{className:i},s.createElement("div",{className:sh},e,"-BRAND ",r))},Ym={display:"inline-flex",flexDirection:"column",justifyContent:"center",alignItems:"center",borderRadius:Qt.Ks.rem(ti.or),paddingRight:Qt.Ks.rem(ti.or),paddingLeft:Qt.Ks.rem(ti.or),textTransform:"uppercase",letterSpacing:"0.04em",fontSize:Qt.Ks.rem(ti.v$+ti.sp),lineHeight:Qt.Ks.rem(ti.Jj)},Xm=Qt.Ks.style(Ym,{background:yi.A.OnBrandBadge,color:yi.A.OnBrandBadgeLabel}),eh=Qt.Ks.style(Ym,{background:yi.A.OffBrandBadge,color:yi.A.OffBrandBadgeLabel}),th={width:Qt.Ks.rem(ti.v$+ti.sp),minWidth:"unset",minHeight:"unset",paddingLeft:Qt.Ks.rem(ti.v$)},ih=Qt.Ks.style(th,{stroke:yi.A.OnBrandBadgeIcon,fill:yi.A.OnBrandBadgeIcon}),nh=Qt.Ks.style(th,{stroke:yi.A.OffBrandBadgeIcon,fill:yi.A.OffBrandBadgeIcon}),sh=Qt.Ks.style({display:"flex",justifyContent:"center",whiteSpace:"nowrap"}),rh=Qt.Ks.style({maxWidth:Qt.Ks.rem(65*ti.or),textAlign:"left",whiteSpace:"normal",overflow:"hidden",display:"-webkit-box","-webkit-line-clamp":5,"-webkit-box-orient":"vertical"}),oh=({tone:e,index:t,onReportPositiveFeedback:i,onReportNegativeFeedback:n})=>{const r=(0,a.pipe)(e.brandToneInfo,o.fold((()=>s.createElement(Gm.m_,{title:`${e.prevalence} intensity`},s.createElement("div",{className:mh},[0,1,2,3,4].map((t=>{const i=t/5<=e.confidence;return s.createElement("div",{key:`${e.name}-intensity-${t}`,className:i?gh:hh})}))))),(({status:e,description:t})=>s.createElement(Jm,{status:e,description:t}))));return s.createElement("div",{"data-testid":"tone-report-tone","data-tone-report-tone-name":e.name,role:`tone-${t}-${e.name}`,className:lh},s.createElement("div",{className:ch},s.createElement(Um.UV,{id:e.emojiId,className:dh}),s.createElement("span",{className:uh},e.name)),s.createElement("div",{className:ph},r),s.createElement(Qm,{"aria-label":`${e.name} Tone Actions Menu`,placement:"left",label:s.createElement(Wm,{className:fh}),onAction:e=>{switch(e){case"likeTone":return i();case"dislikeTone":return n();default:return}}},s.createElement(gu.wn,{title:"Help us improve"},s.createElement(gu.q7,{key:"likeTone",textValue:"likeTone"},s.createElement(zm,{className:vh}),"Tone seems correct"),s.createElement(gu.q7,{key:"dislikeTone",textValue:"dislikeTone"},s.createElement(qm,{className:vh}),"Tone seems incorrect"))))},ah={height:Qt.Ks.rem(5*ti.vW),width:Qt.Ks.rem(5*ti.vW),borderRadius:Qt.Ks.percent(50),marginRight:Qt.Ks.rem(3*ti.vW)},lh=Qt.Ks.style({display:"grid",alignItems:"center",gridTemplateColumns:"0.6fr 0.5fr auto",height:Qt.Ks.rem(2.5)}),ch=Qt.Ks.style({display:"flex",alignItems:"center",flexBasis:Qt.Ks.percent(45)}),dh=Qt.Ks.style({padding:Qt.Ks.rem(ti.sp),marginRight:Qt.Ks.rem(ti.CN),width:Qt.Ks.rem(ti.C2),height:Qt.Ks.rem(ti.C2)}),uh=Qt.Ks.style({textTransform:"capitalize",fontSize:Qt.Ks.rem(.875),lineHeight:Qt.Ks.rem(1.3125)}),ph=Qt.Ks.style({display:"inline-flex"}),mh=Qt.Ks.style({display:"flex"}),hh=Qt.Ks.style(ah,{backgroundColor:yi.A.IndicatorDotDefault,borderStyle:"solid",borderColor:yi.A.Blue40,borderWidth:"1px"}),gh=Qt.Ks.style(ah,{backgroundColor:yi.A.IndicatorDotActive,borderStyle:"solid",borderColor:yi.A.IndicatorDotActive,borderWidth:"1px"}),fh=Qt.Ks.style({padding:Qt.Ks.rem(ti.or)}),vh=Qt.Ks.style({marginRight:Qt.Ks.rem(ti.v$)}),_h=r.UI.Grid.make((({slots:e,state:t,view:i,notify:n})=>{const{onMount:r}=(0,po.y)(P.M((()=>n({kind:ft.t.Kind.toneReportLoadedNonEmptyMount})())));return s.createElement(qa,{mount:r,key:"tone-report","data-testid":"tone-report"},s.createElement("div",{className:yh},s.createElement(ri.F.div,{className:kh},t.pipe(R.T((e=>function({tones:e,onBrandTitleEnabled:t}){const i=(0,a.pipe)(e,E.pb((e=>o.isSome(e.brandToneInfo)&&e.brandToneInfo.value.status===Kt.Off)),o.map(E.Tj((e=>e.confidence))),o.map(E.TS(0,$.max($.ordNumber)))),n=e.filter((e=>o.isSome(e.brandToneInfo)&&e.brandToneInfo.value.status===Kt.On)).length;return o.isSome(i)&&i.value>.75?"Your tone may sound off to readers":o.isSome(i)?"Something sounds slightly off...":n>0&&t?"You're on-brand! Great job!":n>0?"Your writing sounds clear and aligned. Great job!":"How this may sound to readers:"}(e)))))),s.createElement(ri.F.div,{className:Sh,"data-testid":"tone-report-items"},i("tones").pipe(R.T((e=>e.map(((e,t)=>s.createElement(oh,{key:e.name,index:t,tone:e,onReportPositiveFeedback:n({kind:ft.t.Kind.toneReportToneLikeButtonClick,toneName:e.name}),onReportNegativeFeedback:n({kind:ft.t.Kind.toneReportToneDislikeButtonClick,toneName:e.name})}))))))),i("uphookInfo").pipe(R.T(o.fold((()=>null),(({title:t,emojiId:i})=>s.createElement(jm,{key:"tone-report-footer",uphookTitle:t,uphookEmojiId:i,uphookButton:e.uphook}))))))})),bh=r.UI.Knot.make(_h,{uphook:Kp}),yh=Qt.Ks.style({display:"flex",alignItems:"flex-start"}),kh=Qt.Ks.style({flexGrow:1,fontStyle:"normal",fontWeight:"bold",fontSize:Qt.Ks.rem(1),lineHeight:Qt.Ks.rem(1.5)}),Sh=Qt.Ks.style({marginTop:Qt.Ks.rem(.5)}),Ch=r.UI.Node.make((()=>s.createElement(qa,{style:Eh},s.createElement(Nd,null),s.createElement("span",{className:wh},"Loading...")))),Eh={display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",minHeight:Qt.Ks.rem(9.5)},wh=Qt.Ks.style({color:ii.Q.Text.Base.Subdued,fontSize:Qt.Ks.rem(.75),fontFamily:"Inter",lineHeight:Qt.Ks.rem(1.125)}),Ah=r.UI.Union.make("kind",{loading:Ch,loadedEmpty:Bm,loadedNonEmpty:bh}),Ih=1.375;const xh=e=>{var{text:t,onChange:i,placeholder:n,disabled:r,className:o,onFocus:a,onBlur:l,autofocus:c,onKeyUpEscape:d}=e,u=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(i[n[s]]=e[n[s]])}return i}(e,["text","onChange","placeholder","disabled","className","onFocus","onBlur","autofocus","onKeyUpEscape"]);const[p,m]=s.useState(null);return s.useEffect((()=>{p&&void 0!==c&&p.focus()}),[c,p]),s.createElement(bo,{className:o,style:{height:Qt.Ks.rem(Ih)},name:"text-input-iframe"},s.createElement("style",{dangerouslySetInnerHTML:{__html:`\n      .textBox {\n        box-sizing: border-box;\n        border-radius: ${Qt.Ks.rem(ni.KD)};\n        overflow-y: auto;\n        width: 100%;\n        height: 100%;\n        border: none;\n        padding: 0;\n        background: transparent;\n        resize: none;\n        font-family: Inter, sans-serif;\n        font-size: ${Qt.Ks.rem(.875)};\n        font-weight: 400;\n        color: ${vo};\n      }\n      .textBox::placeholder {\n        color: ${_o};\n      }\n      .textBox:focus {\n        outline: none;\n      }\n      `.replace(/\s/g,"")}}),s.createElement("input",Object.assign({},u,{className:"textBox",style:{lineHeight:Qt.Ks.rem(Ih)},value:t,ref:m,onChange:e=>i(e.target.value),placeholder:n,disabled:r,onFocus:()=>null==a?void 0:a(),onBlur:()=>null==l?void 0:l(),onKeyUp:e=>{d&&"Escape"===e.key&&(e.preventDefault(),e.stopPropagation(),d())}})))};var Th=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(i[n[s]]=e[n[s]])}return i};const Fh=e=>{var{text:t,onChange:i,placeholder:n,disabled:r,className:o,onFocus:a,onBlur:l,autofocus:c,onKeyUpEscape:d}=e,u=Th(e,["text","onChange","placeholder","disabled","className","onFocus","onBlur","autofocus","onKeyUpEscape"]);const[p,m]=s.useState(null);return s.useEffect((()=>{p&&void 0!==c&&p.focus()}),[c,p]),s.createElement("div",{className:o,style:{height:Qt.Ks.rem(Ih)}},s.createElement("input",Object.assign({},u,{className:Rh,style:{lineHeight:Qt.Ks.rem(Ih)},value:t,ref:m,onChange:e=>i(e.target.value),placeholder:n,disabled:r,onFocus:()=>null==a?void 0:a(),onBlur:()=>null==l?void 0:l(),onKeyUp:e=>{d&&"Escape"===e.key&&(e.preventDefault(),e.stopPropagation(),d())}})))},Rh=Qt.Ks.style({boxSizing:"border-box",borderRadius:Qt.Ks.rem(ni.KD),overflowY:"auto",width:"100%",height:"100%",border:"none",padding:0,background:"transparent",resize:"none",fontFamily:"Inter, sans-serif",fontSize:Qt.Ks.rem(.875),fontWeight:400,color:yi.A.TextBaseDefault,$nest:{"&::placeholder":{color:yi.A.TextBaseSubduedColor},"&:focus":{outline:"none"}}}),Kh={padding:`${Qt.Ks.rem(ti.or)} ${Qt.Ks.rem(ti.or+ti.Oh)} ${Qt.Ks.rem(ti.or)} ${Qt.Ks.rem(ti.CN)}`,border:`1px solid ${ii.Q.Background.Neutral.Default}`,borderRadius:Qt.Ks.rem(ni.KD),width:Qt.Ks.rem(15),height:Qt.Ks.rem(2),boxSizing:"border-box",position:"relative"},Mh={position:"absolute",right:Qt.Ks.rem(ti.v$),top:Qt.Ks.rem(.1875),border:"none",background:"transparent",display:"flex",alignItems:"center",cursor:"pointer",width:Qt.Ks.rem(1.5),height:Qt.Ks.rem(1.5),padding:0},Oh=Object.assign(Object.assign({},(0,bi.QD)(1.5)),{$nest:{"& svg":{stroke:ii.Q.Text.Base.Subdued}}}),Nh={padding:Qt.Ks.rem(ti.or),background:"white",boxShadow:uo.R$.boxShadow,border:uo.R$.border,borderRadius:Qt.Ks.rem(ni.KD),width:Qt.Ks.rem(15),boxSizing:"border-box",overflowY:"auto",maxHeight:Qt.Ks.rem(8.125),zIndex:9999,$nest:{"& > ul":{listStyle:"none",padding:0,margin:0,$nest:{"& > li":{padding:0,margin:0}}}}},Bh={border:"none",background:"transparent",width:"100%",cursor:"pointer",overflow:"hidden",textOverflow:"ellipsis",fontSize:Qt.Ks.rem(.875),lineHeight:Qt.Ks.rem(1.375),color:ii.Q.Text.Base.Default,padding:`${Qt.Ks.rem(.1875)} ${Qt.Ks.rem(ti.CN)}`,borderRadius:Qt.Ks.rem(ni.KD),display:"flex",justifyContent:"flex-start",$nest:{"&:hover":{color:ii.Q.Text.Base.Inverse,background:si.NeutralGray40},"& mark":{backgroundColor:"unset",fontWeight:"bold"},"&:hover > mark":{color:ii.Q.Text.Base.Inverse}}},Ph={width:Qt.Ks.percent(100),border:"none"},Dh=Qt.Ks.style(Kh),Lh=Qt.Ks.style(Mh),Uh=Qt.Ks.style(Oh),jh=Qt.Ks.style(Nh),Vh=Qt.Ks.style(Bh),$h=Qt.Ks.style({whiteSpace:"pre"}),Hh=Qt.Ks.style(Ph),Zh=(0,ra.yY)((e=>{var{useIframeWrapper:t}=e,i=Th(e,["useIframeWrapper"]);return t?s.createElement(xh,Object.assign({},i)):s.createElement(Fh,Object.assign({},i))})),Gh=new ed.C(999999);function Wh({text:e,placeholder:t,clearButton:i,selectOnBlur:n,label:r,options:o,className:a,filterBy:c=((e,t)=>r(e).toLowerCase().includes(t.toLowerCase())),onInputChange:d,onSelectionChange:u}){const[p,h]=s.useState(!1),g=s.useRef(Gh.newId().toString()),[f,v]=s.useState(null),[_,b]=s.useState(null),{styles:y,attributes:k}=(0,Xc.E)(f,_,{placement:"bottom-start",modifiers:[{name:"offset",options:{offset:[0,4]}}]}),S=o.filter((t=>c(t,e.trim()))),C=p&&S.length>0,E=s.useMemo((()=>new l.B7),[]);jt.R.useSubscriptionTo(E.pipe($t.B(50),m.p((e=>!e)),P.M((()=>{h(!1),n&&""!==e.trim()&&u(S.length>0?S[0]:null)}))));const w=s.useContext(Io.D);return s.createElement("div",Object.assign({},(0,ra.Ly)(Dh,a),{ref:v}),s.createElement(Zh,{className:Hh,placeholder:t,onChange:d,text:e,onFocus:()=>{h(!0),E.next(!0)},onBlur:()=>E.next(!1),role:"combobox","aria-haspopup":"listbox","aria-owns":g.current,"aria-expanded":C,useIframeWrapper:w.view((e=>e.useIframeTextfieldWrapper))}),""!==e.trim()&&!!i&&s.createElement("button",{onClick:(0,id.e)((()=>u(null))),className:Lh,"aria-label":"Clear",type:"button"},s.createElement(li.In.Close,{className:Uh})),C&&s.createElement("div",Object.assign({ref:b,style:y.popper},k.popper,{className:jh,onFocus:()=>E.next(!0),onBlur:()=>E.next(!1)}),s.createElement("ul",{"aria-label":"menu-options",role:"listbox",id:g.current},S.map((t=>{const i=r(t);return s.createElement("li",{key:i,"aria-label":i,role:"option"},s.createElement("button",{className:Vh,onClick:(0,id.e)((()=>{u(t),h(!1)}))},s.createElement(zh,{label:i,pattern:e})))})))))}const zh=({label:e,pattern:t})=>{if(""===t.trim())return s.createElement(s.Fragment,null,e);const i=t.trim(),n=e.split(new RegExp(i,"i")),r=(0,a.pipe)(n.map(((e,t)=>({token:e,mark:!1,end:t*i.length+n.slice(0,t).join("").length+e.length}))),C.ft({token:"",mark:!0,end:0})).map(((t,n,s)=>t.mark&&n>0?{token:e.slice(s[n-1].end,s[n-1].end+i.length),mark:!0}:{token:t.token,mark:!1})).filter((e=>e.token.length>0));return s.createElement(s.Fragment,null,r.map(((e,t)=>e.mark?s.createElement("mark",{key:t,className:$h},e.token):s.createElement("span",{key:t,className:$h},e.token))))},qh=e=>s.createElement(li.hh,Object.assign({width:"12",height:"12",viewBox:"0 0 12 12",fill:"none"},e),s.createElement("path",{stroke:"#fff",strokeLinecap:"round",strokeWidth:".857",d:"m4 4 2 2m2 2L6 6m0 0 2-2M6 6 4 8"})),Qh=({kind:e,label:t,description:i,iconUrl:n,isUnselectable:r,onToggle:o})=>s.createElement(Gm.m_,{title:i},s.createElement("button",{disabled:"disabled"===e,className:Jh,"data-kind":e,"data-unselectable":r,onClick:(0,id.e)((()=>{"disabled"!==e&&o("selected"!==e&&("unselected"===e||(0,g.AS)(e)))}))},n?s.createElement("img",{src:n,className:Xh}):null,s.createElement("span",null,t),r&&"selected"===e?s.createElement(qh,{className:Yh}):null)),Jh=Qt.Ks.style({display:"flex",alignItems:"center",justifyContent:"center",gap:Qt.Ks.rem(ti.v$),padding:`${Qt.Ks.rem(ti.or)} ${Qt.Ks.rem(.625)} ${Qt.Ks.rem(ti.or)} ${Qt.Ks.rem(ti.v$)}`,background:ii.Q.Background.Base.Default,color:ii.Q.Text.Base.Default,border:`${Qt.Ks.px(1)} solid transparent`,borderRadius:Qt.Ks.rem(1.875),fontSize:Qt.Ks.rem(.875),lineHeight:Qt.Ks.rem(1.375),boxSizing:"border-box",$nest:{"&[data-kind='unselected']":{border:`${Qt.Ks.px(1)} solid ${si.NeutralGray10}`,color:ii.Q.Text.Base.Default,cursor:"pointer"},"&[data-kind='disabled']":{border:`${Qt.Ks.px(1)} solid ${si.NeutralGray10}`,color:si.NeutralGray40,cursor:"default"},"&[data-kind='selected']":{border:`${Qt.Ks.px(2)} solid ${yi.A.BrandGreen60}`,padding:`${Qt.Ks.rem(.1875)} ${Qt.Ks.rem(.5625)} ${Qt.Ks.rem(.1875)} ${Qt.Ks.rem(.4375)}`,position:"relative",$nest:{"&[data-unselectable='true']":{cursor:"pointer"}}}}}),Yh=Qt.Ks.style(Object.assign(Object.assign({position:"absolute",top:Qt.Ks.rem(-(ti.or+ti.vW)),right:Qt.Ks.rem(-(ti.or+ti.vW)),boxSizing:"content-box"},(0,bi.QD)(.75)),{border:`${Qt.Ks.rem(.125)} solid white`,borderRadius:"50%",background:yi.A.BrandGreen60,display:"flex",alignItems:"center",justifyContent:"center"})),Xh=Qt.Ks.style({width:Qt.Ks.rem(1.25),height:Qt.Ks.rem(1.25)}),eg=({chips:e,className:t,onToggle:i})=>s.createElement(ri.F.div,Object.assign({},(0,ra.Ly)(tg,t)),e.pipe(R.T(C.Tj((e=>s.createElement(Qh,Object.assign({},e,{onToggle:t=>i(e,t),key:e.label}))))))),tg=Qt.Ks.style({display:"flex",flexWrap:"wrap",gap:Qt.Ks.rem(ti.or),$nest:{div:{marginTop:Qt.Ks.rem(ti.or)}}}),ig={margin:0,padding:Qt.Ks.rem(ti.Jj),gap:Qt.Ks.rem(ti.Jj),boxSizing:"border-box",minHeight:"100%"},ng={color:ii.Q.Text.Base.Default,fontWeight:700,fontSize:Qt.Ks.rem(.875),lineHeight:Qt.Ks.rem(1.375),margin:0},sg={color:ii.Q.Text.Base.Subdued,fontWeight:400,fontSize:Qt.Ks.rem(.75),lineHeight:Qt.Ks.rem(1.125)},rg={marginTop:Qt.Ks.rem(ti.v$)},og={color:si.NeutralGray60,fontWeight:400,fontSize:Qt.Ks.rem(.75),lineHeight:Qt.Ks.rem(1.125)},ag={display:"flex",justifyContent:"flex-end",gap:Qt.Ks.rem(ti.v$),flexGrow:1,alignItems:"flex-end"},lg={fontSize:Qt.Ks.important(Qt.Ks.rem(.875))},cg={marginTop:Qt.Ks.rem(ti.v$)},dg={marginTop:Qt.Ks.rem(ti.v$)},ug={display:"flex",alignItems:"center",gap:Qt.Ks.rem(ti.v$)},pg={width:Qt.Ks.rem(1.5),height:Qt.Ks.rem(1.5),display:"flex",alignItems:"center",justifyContent:"center"},mg=Qt.Ks.style({display:"grid",minHeight:"100%",gridTemplateRows:"minmax(min-content, auto)"}),hg=ig,gg=Qt.Ks.style(ng),fg=Qt.Ks.style(rg),vg=Qt.Ks.style(sg),_g=Qt.Ks.style(og),bg=Qt.Ks.style(ag),yg=Qt.Ks.style(lg),kg=Qt.Ks.style(lg),Sg=Qt.Ks.style(cg),Cg=Qt.Ks.style(dg),Eg=Qt.Ks.style(ug),wg=Qt.Ks.style(pg),Ag=r.UI.Node.make((({view:e,state:t,notify:i})=>s.createElement("div",{className:mg},s.createElement(qa,{style:hg,"data-testid":"voice-profile"},s.createElement("section",null,s.createElement("h2",{className:gg},"Formality"),s.createElement(eg,{className:fg,chips:e("styles").pipe(R.T(C.Tj((e=>Object.assign(Object.assign({},e),{isUnselectable:!1}))))),onToggle:e=>i({kind:ft.t.Kind.styleToggleClick,id:e.id})()})),s.createElement("section",null,s.createElement("h2",{className:gg},"Tone"),s.createElement(ri.F.div,{className:vg},"Select up to"," ",e("maxSelectableTones").pipe(R.T((e=>{return t=e,Number.isInteger(t)&&t>=0&&t<10?function(e){return["zero","one","two","three","four","five","six","seven","eight","nine"][e]}(e):`${e}`;var t})))),s.createElement(eg,{className:fg,chips:e("tones").pipe(R.T(C.Tj((e=>Object.assign(Object.assign({},e),{isUnselectable:!0}))))),onToggle:(e,t)=>i({kind:ft.t.Kind.toneToggleClick,selected:t,id:e.id})()})),t.pipe(R.T((e=>(0,a.pipe)(e.roles,E._S,o.fold(a.constNull,(t=>s.createElement("section",null,s.createElement("h2",{className:gg},"Your profession"),s.createElement(Wh,{className:Sg,placeholder:"Product designer",text:e.roleTypeaheadText,onInputChange:e=>i({kind:"updateRoleTypeaheadText",text:e})(),onSelectionChange:e=>i({kind:ft.t.Kind.roleTypeaheadSelectionChange,role:o.fromNullable(e)})(),options:t,label:e=>e.label,clearButton:!0,selectOnBlur:!0})))))))),s.createElement("section",null,s.createElement("h2",{className:gg},"I write in"),s.createElement(ri.F.Fragment,null,t.pipe(R.T((({dialects:e,selectedDialect:t})=>s.createElement(hd,{className:Cg,options:e.filter((e=>!Ae.Dialect.Id.eq.equals(e.id,t.id))),selection:t,onSelectionChange:e=>i({kind:ft.t.Kind.dialectDropdownSelectionChange,dialect:e})(),label:e=>e.label,renderOption:e=>s.createElement("div",{className:Eg},s.createElement("div",{className:wg},s.createElement("img",{src:e.iconUrl,style:{width:Qt.Ks.rem(1),height:Qt.Ks.rem(1)}})),e.label)})))))),e("description").pipe(R.T((e=>""!==e.trim()?s.createElement("div",{className:_g},e):null))),s.createElement(ri.F.div,{className:bg},s.createElement(oi.$,{variant:"tertiary",className:kg,onClick:i({kind:ft.t.Kind.voiceProfileCloseButtonClick}),name:"closeVoiceProfile"},"Close"),e("applyButtonEnabled").pipe(R.T((e=>s.createElement(oi.$,{className:yg,onClick:i({kind:ft.t.Kind.voiceProfileUseVoiceButtonClick}),disabled:!e,name:"applyVoiceProfile"},"Use this voice"))))))))),Ig=({className:e})=>s.createElement("div",Object.assign({role:"separator"},(0,ra.Ly)(xg,e))),xg=Qt.Ks.style({position:"relative",width:"100%",borderBottom:`0.5px solid ${si.NeutralGray10}`});var Tg;!function(e){let t;!function(e){e.create=function(e){return e}}(t=e.Id||(e.Id={}))}(Tg||(Tg={}));const Fg=({tabs:e,activeTabId:t,onActiveTabChange:i,children:n})=>s.createElement(s.Fragment,null,s.createElement("div",{className:Kg,role:"tablist"},e.map((e=>s.createElement("button",{key:e.id,onClick:()=>i(e.id),tabIndex:0,className:Mg,id:`tab-${e.id}`,"aria-label":`${e.label} ${e.id===t?"Selected.":""}`,"aria-controls":`tabpanel-${e.id}`,"aria-selected":t===e.id,role:"tab",type:"button"},e.label)))),n),Rg=e=>{var{id:t,isActive:i,children:n,className:r,style:o}=e,a=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(i[n[s]]=e[n[s]])}return i}(e,["id","isActive","children","className","style"]);return s.createElement("div",Object.assign({role:"tabpanel",id:`tabpanel-${t}`,"aria-labelledby":`tab-${t}`,hidden:!i,style:i?o:void 0,className:i?r:void 0},a),n)},Kg=Qt.Ks.style({display:"flex",alignContent:"flex-start",gap:Qt.Ks.rem(ti.v$)}),Mg=Qt.Ks.style({cursor:"pointer",border:"none",display:"flex",alignItems:"center",background:"transparent",borderBottom:`${Qt.Ks.rem(ti.sp)} solid transparent`,fontWeight:400,fontSize:Qt.Ks.rem(.75),lineHeight:Qt.Ks.rem(1.125),height:Qt.Ks.rem(1.5),color:yi.A.TextBaseSubduedColor,$nest:{'&[aria-selected="true"]':{borderBottomColor:yi.A.TextBaseSubduedColor,fontWeight:700},'&[aria-selected="false"]:hover':{borderBottomColor:si.NeutralGray10}}}),Og=(0,Yt.w)("color",(({title:e,titleId:t,desc:i,descId:n,...r})=>s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16","aria-hidden":"true",stroke:"transparent","aria-labelledby":t,"aria-describedby":n,...r},i?s.createElement("desc",{id:n},i):null,e?s.createElement("title",{id:t},e):null,s.createElement("path",{stroke:"#646B81",strokeLinejoin:"round",d:"M5.727 6.615H3V14h10V6.615h-2.727m-4.546 0V4.273a2.273 2.273 0 1 1 4.545 0v2.342m-4.545 0h4.546"})))),Ng="editBtn",Bg={default:{backgroundColor:yi.A.NeutralGray0}},Pg={gap:0,backgroundImage:"url(https://assets.grammarly.com/cheetah/v1/voice-profile/cheetah-my-voice-bg.svg)",backgroundPosition:"right",backgroundRepeat:"no-repeat",backgroundSize:"auto 100%",padding:`${Qt.Ks.rem(ti.CN)} ${Qt.Ks.rem(ti.Jj)}`,$nest:{[`.${Ng}`]:{opacity:0,pointerEvents:"none",$nest:{"&:focus":{opacity:1,pointerEvents:"auto"}}},[`&:hover .${Ng}, &:focus .${Ng}`]:{opacity:1,pointerEvents:"auto"}}},Dg=e=>Qt.Ks.style({display:"flex",justifyContent:"space-between",marginBottom:e?Qt.Ks.rem(ti.v$):Qt.Ks.rem(ti.sp+ti.or)}),Lg=Qt.Ks.style({margin:0,fontSize:Qt.Ks.rem(1.25),lineHeight:Qt.Ks.rem(1.5),fontWeight:700}),Ug=Qt.Ks.style({display:"flex",flexDirection:"row",alignItems:"flex-end",justifyContent:"space-between",gap:Qt.Ks.rem(ti.v$)}),jg=Qt.Ks.style({display:"flex",flexDirection:"column",gap:Qt.Ks.rem(ti.v$),flexGrow:1}),Vg=Qt.Ks.style({display:"flex",flexDirection:"column",gap:Qt.Ks.rem(ti.or)}),$g=Qt.Ks.style({color:yi.A.TextBaseSubduedColor,fontWeight:400,fontSize:Qt.Ks.rem(.75),lineHeight:Qt.Ks.rem(1.125),margin:0}),Hg=Qt.Ks.style({display:"flex",alignItems:"center",gap:Qt.Ks.rem(ti.v$)}),Zg=Qt.Ks.style({width:Qt.Ks.rem(1.5),height:Qt.Ks.rem(1.5),display:"flex",alignItems:"center",justifyContent:"center",$nest:{"& img":{width:Qt.Ks.rem(1),height:Qt.Ks.rem(1)}}}),Gg=Qt.Ks.style({width:Qt.Ks.rem(1.5),height:Qt.Ks.rem(1.5)}),Wg=Qt.Ks.style({display:"flex",flexDirection:"column",gap:Qt.Ks.rem(ti.or)}),zg=Qt.Ks.style({display:"flex",alignItems:"center",gap:Qt.Ks.rem(ti.or),height:Qt.Ks.rem(1.5),color:yi.A.TextBaseSubduedColor,fontSize:Qt.Ks.rem(.875),lineHeight:Qt.Ks.rem(1.3125),fontWeight:500}),qg=Qt.Ks.style({display:"flex",alignItems:"center",gap:Qt.Ks.rem(ti.v$)}),Qg=Qt.Ks.style({maxWidth:Qt.Ks.rem(15),width:"100%"});const Jg=e=>{var{children:t,active:i}=e,n=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(i[n[s]]=e[n[s]])}return i}(e,["children","active"]);const r=s.useRef(null);return s.createElement(s.Fragment,null,r.current&&i?s.createElement(oo.AM,Object.assign({},n,{reference:r.current})):null,s.cloneElement(t,{ref:r}))},Yg=s.forwardRef((function({name:e,active:t,onClick:i},n){return s.createElement("button",{tabIndex:0,"aria-label":e,"aria-pressed":t,"data-active":t,onClick:i,ref:n,className:Xg},e)})),Xg=Qt.Ks.style({display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",height:Qt.Ks.rem(2),borderRadius:Qt.Ks.rem(ni.KD),border:`${Qt.Ks.rem(ti.sp)} solid transparent`,padding:`${Qt.Ks.rem(ti.sp+ti.or)} ${Qt.Ks.rem(ti.v$)}`,backgroundColor:yi.A.Green0,color:yi.A.Green90,lineHeight:Qt.Ks.rem(1.3125),fontSize:Qt.Ks.rem(.875),$nest:{"&:hover":{backgroundColor:Qt.Ks.color(yi.A.Green10).mix(Qt.Ks.color(yi.A.NeutralGray10)).toRGBA().toString(),color:yi.A.Green80},'&[data-active="true"]':{outline:`${Qt.Ks.rem(ti.sp)} solid ${yi.A.Green80}`}}}),ef=({profileName:e,sectionName:t,tagName:i,activeTagId:n,onVoiceTagPopoverClose:r,onKeepClick:l,onRemoveClick:c,onVoiceTagClick:d})=>s.createElement(Jg,{active:(0,a.pipe)(n,o.exists((n=>n===Ie.createId({tagName:i,sectionName:t,profileName:e})))),onClose:n=>{"keep"===n?l():"remove"===n?c(i,e,t):r()},title:s.createElement("h1",{className:tf},"Does this sound like you?"),footer:s.createElement(oo.HR.Consumer,null,(({closePopover:e})=>s.createElement(s.Fragment,null,s.createElement(oi.$,{onClick:()=>e("keep"),style:nf,textPosition:"everywhere"},s.createElement(zm,null),"Yes, keep it"),s.createElement(oi.$,{onClick:()=>e("remove"),style:nf,textPosition:"everywhere"},s.createElement(qm,null),"No, remove it"))))},s.createElement(Yg,{name:i,active:(0,a.pipe)(n,o.exists((n=>n===Ie.createId({tagName:i,sectionName:t,profileName:e})))),onClick:()=>d(i,e,t)})),tf=Qt.Ks.style({fontSize:Qt.Ks.rem(.875),lineHeight:Qt.Ks.rem(1.375),fontWeight:700,margin:0}),nf={default:{gap:Qt.Ks.rem(ti.or),padding:`0 ${Qt.Ks.rem(ti.v$)} 0 ${Qt.Ks.rem(ti.or)}`,color:yi.A.TextBaseDefault,backgroundColor:ii.Q.Background.Base.Default},hovered:{color:yi.A.TextBaseDefault,backgroundColor:yi.A.NeutralGray10},active:{color:yi.A.TextBaseDefault,backgroundColor:yi.A.NeutralGray10}},sf=({profile:e,activeProfileName:t,activeTagId:i,onVoiceTagPopoverClose:n,onKeepClick:r,onRemoveClick:a,onVoiceTagClick:l})=>s.createElement(Rg,{id:Tg.Id.create(e.name),isActive:e.name===o.toNullable(t),className:rf},e.summary,s.createElement("div",{className:af},e.sections.map((t=>s.createElement("div",{key:t.name},t.name,s.createElement("div",{className:lf},0===t.tags.length?s.createElement("div",{className:of},"Detected qualities will appear here"):t.tags.map((o=>s.createElement(ef,{key:o.name,tagName:o.name,sectionName:t.name,profileName:e.name,activeTagId:i,onVoiceTagPopoverClose:n,onKeepClick:r,onRemoveClick:a,onVoiceTagClick:l}))))))))),rf=Qt.Ks.style({fontSize:Qt.Ks.rem(.875),lineHeight:Qt.Ks.rem(1.3125),display:"flex",flexDirection:"column",gap:Qt.Ks.rem(ti.CN),paddingTop:Qt.Ks.rem(ti.v$)}),of=Qt.Ks.style({padding:`0 ${Qt.Ks.rem(ti.v$)}`,background:yi.A.NeutralGray0,color:yi.A.TextBaseSubduedColor,borderRadius:Qt.Ks.rem(ni.KD),height:Qt.Ks.rem(2),fontSize:Qt.Ks.rem(.875),lineHeight:Qt.Ks.rem(1.3125),display:"flex",justifyContent:"center",alignItems:"center"}),af=Qt.Ks.style({display:"flex",flexDirection:"column",gap:Qt.Ks.rem(ti.CN)}),lf=Qt.Ks.style({marginTop:Qt.Ks.rem(ti.v$),display:"flex",flexWrap:"wrap",gap:Qt.Ks.rem(ti.or)}),cf=(0,ra.yY)((({onEditButtonClick:e,onSaveButtonClick:t,onCancelButtonClick:i,onDialectDropdownChange:n,onRoleDropdownChange:r,userName:l,isEditing:c,selectedRole:d,roles:u,dialects:p,selectedDialect:m})=>s.createElement(qa,{style:Pg},s.createElement("div",{className:Dg(c)},s.createElement("h1",{className:Lg},l),c?null:s.createElement(oi.$,{variant:"secondary",onClick:e,className:Ng,style:Bg,size:"small"},"Edit")),c?s.createElement("div",{className:Ug},s.createElement("div",{className:jg},0!==u.length&&s.createElement("div",{className:Vg},s.createElement("h2",{className:$g},"My role"),s.createElement(hd,{placeholder:"Select a role...",options:u,selection:o.toUndefined(d),onSelectionChange:r,label:e=>e.id,renderOption:e=>e.id,menuClassName:Qg,className:Qg})),s.createElement("div",{className:Vg},s.createElement("h2",{className:$g},"I write in"),s.createElement(hd,{options:p,selection:m,onSelectionChange:n,label:e=>e.label,menuClassName:Qg,className:Qg,renderOption:e=>s.createElement("div",{className:Hg},s.createElement("div",{className:Zg},s.createElement("img",{src:e.iconUrl,alt:""})),e.label)}))),s.createElement("div",{className:qg},s.createElement(oi.$,{variant:"tertiary",onClick:i},"Cancel"),s.createElement(oi.$,{onClick:t},"Save"))):s.createElement("div",{className:Wg},(0,a.pipe)(d,o.fold(a.constNull,(e=>s.createElement("div",{className:zg},s.createElement(vi,{className:Gg},s.createElement(Jt.I,{icon:Og,accessibilityLabel:"Role"})),s.createElement("span",null,e.label))))),s.createElement("div",{className:zg},s.createElement("div",{className:Zg},s.createElement("img",{src:m.iconUrl,alt:""})),s.createElement("span",null,m.label)))))),df=r.UI.Node.make((({view:e,state:t,notify:i})=>s.createElement(ri.F.div,{className:uf},s.createElement(cf,{onEditButtonClick:i({kind:ft.t.Kind.voiceSelectionsEditButtonClick}),onDialectDropdownChange:e=>i({kind:ft.t.Kind.voiceDialectDropdownSelectionChange,dialect:e})(),onRoleDropdownChange:e=>i({kind:ft.t.Kind.voiceRoleDropdownSelectionChange,role:e})(),onSaveButtonClick:i({kind:ft.t.Kind.voiceSelectionsSaveButtonClick}),onCancelButtonClick:i({kind:ft.t.Kind.voiceSelectionsCancelButtonClick}),userName:e("userName"),isEditing:e("isEditing"),selectedRole:e("selectedRole"),selectedDialect:e("selectedDialect"),roles:e("roles"),dialects:e("dialects")}),s.createElement(qa,{style:pf},s.createElement(ri.F.div,null,t.pipe(R.T((e=>s.createElement(s.Fragment,null,s.createElement("div",{className:mf},s.createElement("div",null,s.createElement("h1",{className:hf},e.title),s.createElement("h2",{className:gf},e.subTitle)),s.createElement(Fg,{key:"Tabs",tabs:e.profiles.map((e=>({id:Tg.Id.create(e.name),label:e.name}))),activeTabId:Tg.Id.create(o.toNullable(e.activeProfileName)||""),onActiveTabChange:e=>i({kind:ft.t.Kind.voiceProfileTabChange,profileName:e})()})),e.profiles.map((t=>s.createElement(sf,{key:t.name,profile:t,activeProfileName:e.activeProfileName,activeTagId:e.activeTagId,onVoiceTagPopoverClose:i({kind:ft.t.Kind.voiceTagPopoverClose}),onKeepClick:i({kind:ft.t.Kind.voiceTagPopoverKeepButtonClick}),onRemoveClick:(e,t,n)=>i({kind:ft.t.Kind.voiceTagPopoverRemoveButtonClick,tagName:e,profileName:t,sectionName:n})(),onVoiceTagClick:(e,t,n)=>i({kind:ft.t.Kind.voiceTagClick,tagName:e,profileName:t,sectionName:n})()})))))))),s.createElement(Ig,null),s.createElement("p",{className:ff},"You can prompt Grammarly to rewrite text in your voice."))))),uf=Qt.Ks.style({display:"flex",flexDirection:"column"}),pf={gap:Qt.Ks.rem(ti.Jj),padding:`${Qt.Ks.rem(ti.CN)} ${Qt.Ks.rem(ti.Jj)} ${Qt.Ks.rem(ti.Jj)} ${Qt.Ks.rem(ti.Jj)}`},mf=Qt.Ks.style({display:"flex",justifyContent:"space-between",alignItems:"flex-start"}),hf=Qt.Ks.style({fontSize:Qt.Ks.rem(.875),lineHeight:Qt.Ks.rem(1.3125),fontWeight:700,margin:0}),gf=Qt.Ks.style({color:yi.A.TextBaseSubduedColor,fontWeight:400,fontSize:Qt.Ks.rem(.75),lineHeight:Qt.Ks.rem(1.125),margin:0}),ff=Qt.Ks.style({margin:0,padding:0,fontSize:Qt.Ks.rem(.875),lineHeight:Qt.Ks.rem(1.25),fontStyle:"italic",color:ii.Q.Text.Base.Subdued}),vf=Qt.Ks.style({display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"space-between"}),_f=Qt.Ks.style({position:"relative",height:Qt.Ks.rem(1),borderRadius:Qt.Ks.rem(.25),overflow:"hidden"}),bf=e=>`linear-gradient(90deg, ${e[0]} 0%, ${e[1]} 100%)`,yf=({lineColorGradient:e=["#F5F5F5","#D9D9D9"],gapInRem:t=.6,lineWidthPercents:i=[95,85,75],overlayGradient:n=[]})=>{const r={background:bf(e)},o={gap:Qt.Ks.rem(t)},a=s.createElement(pp,{overlayBlendMode:"soft-light",overlayGradientCenterColor:n[0],overlayGradientEndColor:n[1]});return s.createElement("div",{className:vf,style:o},s.createElement("div",{className:_f,style:Object.assign(Object.assign({},r),{width:Qt.Ks.percent(i[0])})},a),s.createElement("div",{className:_f,style:Object.assign(Object.assign({},r),{width:Qt.Ks.percent(i[1])})},a),s.createElement("div",{className:_f,style:Object.assign(Object.assign({},r),{width:Qt.Ks.percent(i[2])})},a))},kf=Qt.Ks.style({display:"flex",flexDirection:"column",flex:1,gap:Qt.Ks.rem(.125),borderRadius:`${Qt.Ks.rem(2)} ${Qt.Ks.rem(2)} ${Qt.Ks.rem(2)} 0`,padding:`${Qt.Ks.rem(ti.C2)}`,background:`linear-gradient(265.79deg, ${si.Green90} 0%, ${si.Green100} 101.29%)`}),Sf=(0,j.Ub)(Ln.isLoadingEvaluationAndSuggestions,Ln.isNonEmptyLoadingEvaluation),Cf=({state:e})=>s.createElement(ri.F.Fragment,null,e.pipe(R.T((e=>Sf(e)?s.createElement("div",{className:kf,key:"evaluationResult","aria-busy":"true"},s.createElement(Lc.D,{variant:"heading-xsmall",as:"h4",color:"base-inverse"},"Reviewing your text"),s.createElement(yf,{lineColorGradient:["rgba(55, 85,\t81)","rgba(47, 102,\t96)"],overlayGradient:["rgba(0, 0, 0, 0.15)","rgba(255, 255, 255, 0)"],gapInRem:.375,lineWidthPercents:[100,98,96]})):s.createElement("div",{className:kf,key:"evaluationResult","aria-busy":"false","aria-live":"polite"},s.createElement(Lc.D,{variant:"heading-xsmall",as:"h4",color:"base-inverse"},e.evaluationResult.title),s.createElement(ia.E,{variant:"text-small",as:"span",color:"base-inverse"},e.evaluationResult.subTitle)))))),Ef=()=>s.createElement("svg",{width:"36",height:"37",viewBox:"0 0 36 37",fill:"none",xmlns:"http://www.w3.org/2000/svg"},s.createElement("g",{filter:"url(#filter0_i_3099_29594)"},s.createElement("path",{d:"M0 18.8572C0 8.91605 8.05888 0.857178 18 0.857178C27.9411 0.857178 36 8.91605 36 18.8572C36 28.7983 27.9411 36.8572 18 36.8572H0V18.8572Z",fill:"#FFFFFF",className:Af}),s.createElement("path",{opacity:"0.5",d:"M11.9998 21.1906L20.3331 12.8572L18.6665 19.5239H21.9998L13.6665 27.8572L15.3331 21.1906H11.9998Z",fill:"black",fillOpacity:"0.5"})),s.createElement("defs",null,s.createElement("filter",{id:"filter0_i_3099_29594",x:"0",y:"0.857178",width:"37.5",height:"39",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},s.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),s.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),s.createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),s.createElement("feOffset",{dx:"1.5",dy:"3"}),s.createElement("feGaussianBlur",{stdDeviation:"1.5"}),s.createElement("feComposite",{in2:"hardAlpha",operator:"arithmetic",k2:"-1",k3:"1"}),s.createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.571383 0 0 0 0 0.684049 0 0 0 0 0 0 0 0 0.15 0"}),s.createElement("feBlend",{mode:"normal",in2:"shape",result:"effect1_innerShadow_3099_29594"})))),wf=Qt.Ks.keyframes({"0%":{fill:yi.A.LightGreen},"33%":{fill:yi.A.YellowGreen},"66%":{fill:yi.A.Teal40},"100%":{fill:yi.A.LightGreen}}),Af=Qt.Ks.style({animation:`${wf} 15s infinite`}),If=r.UI.Node.make((({state:e})=>s.createElement(qa,{"aria-live":"polite","data-testid":"writing-expert-loading",style:Tf},s.createElement(Df,null,s.createElement(Cf,{state:e}),e.pipe(m.p(Ln.isEvaluationFinishedLoadingSuggestions),ct.u(s.createElement("div",{className:Ff,key:"headerLoading","aria-busy":"true"},s.createElement(Lc.D,{variant:"heading-xsmall",as:"h4",color:"base-default"},"Coming up with suggestions"),s.createElement(Ef,null))),ut.Z(null))),s.createElement(ri.F.div,{"aria-busy":"true",className:Rf,style:{visibility:e.pipe(R.T((e=>Ln.isEvaluationFinishedLoadingSuggestions(e)?"visible":"hidden")))}},[1,2,3,4].map((e=>s.createElement("div",{key:e,className:Kf},s.createElement("div",{className:xf}),s.createElement("div",{style:{flex:1}},s.createElement(yf,null))))))))),xf=Qt.Ks.style({height:Qt.Ks.rem(ti.Jj),width:Qt.Ks.rem(ti.Jj),content:'" "',borderRadius:"50%",background:si.NeutralGray0}),Tf={padding:0,paddingBottom:Qt.Ks.rem(ti.Jj)},Ff=Qt.Ks.style({display:"flex",justifyContent:"space-between",alignItems:"center"}),Rf=Qt.Ks.style({padding:`0 ${Qt.Ks.rem(1)}`,display:"flex",flexDirection:"column",gap:Qt.Ks.rem(1.75)}),Kf=Qt.Ks.style({display:"flex",gap:Qt.Ks.rem(ti.v$),flexDirection:"row"}),Mf=r.UI.Node.make((({state:e,notify:t})=>s.createElement(qa,{"aria-busy":"false","aria-live":"assertive","data-testid":"writing-expert-empty",style:Nf},s.createElement(ri.F.div,{className:Of},e.pipe(R.T((({sduiItem:e})=>s.createElement("div",{className:Of,key:`writing-expert-feed-state-${e.id}`},s.createElement(kd.R,{sduiRootId:e.id,content:e.content.content,designSystem:Su(),notify:Cd({item:e,kind:"longFormCardSduiNotify",notify:t}),transitions:[],prevContent:o.none,onAnimationEnd:j.Yi,onMount:j.Yi}))))))))),Of=Qt.Ks.style({textAlign:"center",padding:`${Qt.Ks.rem(qt.Jj)} ${Qt.Ks.rem(qt.Jj)} 0 ${Qt.Ks.rem(qt.Jj)}`}),Nf={padding:`${Qt.Ks.rem(qt.Jj)}`,display:"flex",flexDirection:"column-reverse",justifyContent:"center",alignItems:"center",gap:`${Qt.Ks.rem(qt.Jj)}`,height:"100%",boxSizing:"border-box"},Bf=r.UI.Grid.make((({slots:e,state:t,notify:i})=>{const{onMount:n}=(0,po.y)((0,a.flow)(P.M(i({kind:"writingExpertFeedMount"})),co.j(or.notifyFeedUnmount)));return s.createElement(qa,{"data-testid":"writing-expert-non-empty",style:Uf,mount:n,"aria-live":"polite"},s.createElement(Df,null,s.createElement(Cf,{state:t})),s.createElement(Go,{className:jf},e.cardList))})),Pf=r.UI.Knot.make(Bf,{cardList:ju}),Df=({children:e})=>s.createElement(ri.F.div,{style:{display:"flex",flexDirection:"column",padding:Qt.Ks.rem(ti.Jj),gap:Qt.Ks.rem(ti.CN)}},e),Lf=r.UI.Union.make("kind",{[Ln.Kind.loadingEvaluationAndSuggestions]:If,[Ln.Kind.evaluationFinishedLoadingSuggestions]:If,[Ln.Kind.empty]:Mf,[Ln.Kind.error]:Mf,[Ln.Kind.nonEmpty]:Pf,[Ln.Kind.nonEmptyLoadingEvaluation]:Pf}),Uf={padding:0,display:"grid",gridTemplateRows:"auto 1fr auto",height:"100%"},jf=Qt.Ks.style({$nest:{'&[data-overflow-top="true"]':{borderTop:`0.5px solid ${yi.A.BorderBaseSubduedColor}`}}});var Vf=i(2617);const $f=r.UI.Node.make((({view:e,notify:t})=>{const i=e=>{e&&e.focus()};return s.createElement(qa,{style:Hf,"data-testid":e("error").pipe(R.T((e=>`error-${e.reason}`))),role:"alert"},s.createElement(ri.F.div,{className:Gf},e("error").pipe(R.T((e=>s.createElement(s.Fragment,null,s.createElement(qr,{className:qf,width:24,height:24}),s.createElement("span",{className:Wf},e.header)))))),s.createElement(ri.F.div,{className:zf},e("error").pipe(R.T((e=>e.text)))),s.createElement(ri.F.Fragment,null,e("showDismissButton").pipe(R.T((e=>e?s.createElement(oi.$,{"aria-label":"Dismiss error",className:Qf,mount:i,name:"dismissButton",onClick:t({kind:ft.t.Kind.errorCardDismissButtonClick}),size:"small",variant:"tertiary"},s.createElement(Vf.C,{width:16})):null)))))})),Hf={gap:Qt.Ks.rem(ti.v$),padding:`${Qt.Ks.rem(ti.CN)} ${Qt.Ks.rem(ti.Jj)}`},Zf=r.UI.Union.asOption($f),Gf=Qt.Ks.style({display:"flex",alignItems:"center",gap:Qt.Ks.rem(ti.v$),marginTop:Qt.Ks.rem(ti.or),marginBottom:Qt.Ks.rem(ti.or)}),Wf=Qt.Ks.style({fontSize:Qt.Ks.rem(.875),lineHeight:Qt.Ks.rem(1.375),fontWeight:700,color:ii.Q.Text.Base.Default}),zf=Qt.Ks.style({fontSize:Qt.Ks.rem(.75),lineHeight:Qt.Ks.rem(1.125),color:ii.Q.Text.Base.Subdued,whiteSpace:"break-spaces",overflowWrap:"anywhere"}),qf=Qt.Ks.style((0,bi.QD)(1.5)),Qf=Qt.Ks.style({alignSelf:"flex-end",marginTop:Qt.Ks.rem(ti.v$),marginBottom:Qt.Ks.rem(ti.v$)}),Jf=r.UI.Node.make((({view:e})=>s.createElement(qa,{style:ev,"data-testid":"document-overview"},s.createElement(Yc,{style:Xf},"This document"),s.createElement(ri.F.div,{className:tv},e("title")),s.createElement(ri.F.div,{className:iv},e("summary"))))),Yf=r.UI.Union.asOption(Jf),Xf={userSelect:"none",padding:0},ev={position:"relative",padding:`${Qt.Ks.rem(ti.v$)} ${Qt.Ks.rem(ti.Jj)}`,gap:Qt.Ks.rem(ti.v$),fontSize:Qt.Ks.rem(ti.CN),lineHeight:Qt.Ks.rem(ti.Jj+ti.sp)},tv=Qt.Ks.style({fontSize:Qt.Ks.rem(ti.CN+ti.sp),color:ii.Q.Text.Base.Subdued,fontWeight:600}),iv=Qt.Ks.style({color:ii.Q.Text.Base.Default}),nv=e=>s.createElement(li.hh,Object.assign({width:"20",height:"20",viewBox:"0 0 20 20"},e),s.createElement("path",{d:"M5.31255 7.11538H14.6876M5.31255 10H14.6876M5.00006 13.6951V16.25L8.33339 13.6951C10.5282 13.6951 14.2996 13.6951 16.2502 13.6951C16.9406 13.6951 17.5001 13.1354 17.5001 12.4451V5C17.5001 4.30964 16.9404 3.75 16.2501 3.75H3.75001C3.05965 3.75 2.5 4.30965 2.50001 5.00001L2.50005 12.4451C2.50005 13.1354 3.05969 13.6951 3.75005 13.6951H5.00006Z",fill:"none"})),sv=e=>s.createElement(li.hh,Object.assign({width:"12",height:"15",viewBox:"0 0 12 15"},e),s.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0.5 0.5C0.776142 0.5 1 0.723858 1 1V2H11.5C11.7022 2 11.8845 2.12182 11.9619 2.30866C12.0393 2.4955 11.9966 2.71055 11.8536 2.85355L8.70711 6L11.8536 9.14645C11.9966 9.28945 12.0393 9.5045 11.9619 9.69134C11.8845 9.87818 11.7022 10 11.5 10H1V14.5C1 14.7761 0.776142 15 0.5 15C0.223858 15 0 14.7761 0 14.5V1C0 0.723858 0.223858 0.5 0.5 0.5ZM1 9H10.2929L7.64645 6.35355C7.45118 6.15829 7.45118 5.84171 7.64645 5.64645L10.2929 3H1V9Z",stroke:"none"})),rv="reportMenuBtnIcon",ov=(0,bi.T2)((0,bi.QD)(1.5),rv),av=({title:e,name:t,label:i,buttonClass:n,onAction:r,onOpenChange:o,children:a})=>{const l={minWidth:Qt.Ks.rem(2),minHeight:Qt.Ks.rem(2),lineHeight:Qt.Ks.rem(2)};return s.createElement(Qm,{"aria-label":e,title:e,name:t,label:i,theme:{button:n,buttonStyle:{default:Object.assign({padding:0},l),icon:l}},onAction:r,onOpenChange:o},a)},lv=({reportMenuButtonClassName:e,onClickReportOffensive:t,onClickProvideFeedback:i,onOpenChange:n})=>s.createElement(av,{title:"Provide feedback",name:"reportMenu",label:s.createElement(sv,{className:Qt.Ks.joinClasses([rv,Qt.Ks.style(ov)])}),buttonClass:e,onAction:e=>{switch(e){case"provideFeedback":return i();case"reportOffensive":return t()}},onOpenChange:n},s.createElement(gu.q7,{key:"provideFeedback",textValue:"provideFeedback"},s.createElement(nv,null),"Share your thoughts"),s.createElement(gu.q7,{key:"reportOffensive",textValue:"reportOffensive"},s.createElement(li.In.Report,null),"Report as offensive")),cv=r.UI.Node.make((({view:e})=>s.createElement(qa,{"aria-busy":"true","data-testid":"intent-loading"},s.createElement(Yc,null,e("header")),s.createElement("div",{className:dv},s.createElement(pp,null))))),dv=Qt.Ks.style({height:Qt.Ks.rem(.5),borderRadius:Qt.Ks.rem(ti.vW),background:si.NeutralGray10,flexGrow:1,maxWidth:Qt.Ks.rem(22.5),position:"relative",marginBottom:Qt.Ks.rem(ti.or)}),uv=r.UI.Node.make((({view:e,notify:t})=>s.createElement(qa,{style:hv,"data-testid":"intent"},s.createElement(Yc,null,e("header")),s.createElement(lv,{reportMenuButtonClassName:fv,onClickProvideFeedback:t({kind:ft.t.Kind.openFeedbackFormButtonClick,source:Il.Source.intentCard}),onClickReportOffensive:t({kind:ft.t.Kind.reportOffensiveActionsButtonClick}),onOpenChange:e=>t({kind:ft.t.Kind.reportMenuVisibilityChange,trigger:Tr.uiItem(Et.e.intentCard),visible:e})()}),s.createElement(ri.F.div,Object.assign({className:gv},z(e("text"),[...W,"person"])))))),pv=r.UI.Union.make("kind",{loading:cv,loaded:uv}),mv=r.UI.Union.asOption(pv),hv={position:"relative",gap:Qt.Ks.rem(ti.sp)},gv=Qt.Ks.style({color:ii.Q.Text.Base.Default,fontStyle:"normal",fontWeight:400,fontSize:Qt.Ks.rem(.875),lineHeight:Qt.Ks.rem(1.3125),fontFeatureSettings:"'ss01' on",$nest:{"& person":{fontWeight:700,$nest:{"&::before":{content:"''",display:"inline-block",width:Qt.Ks.rem(1.25),height:Qt.Ks.rem(1.25),marginRight:Qt.Ks.rem(ti.sp),backgroundSize:"cover",verticalAlign:"text-bottom",backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundImage:`url('data:image/svg+xml;utf8,${encodeURIComponent(`<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M7.95768 3.00512C8.95983 3.00512 9.7855 3.83575 9.7855 4.8769V6.01259C9.7855 7.05374 8.95983 7.88437 7.95768 7.88437C6.95553 7.88437 6.12986 7.05374 6.12986 6.01259V4.8769C6.12986 3.83575 6.95553 3.00512 7.95768 3.00512ZM10.5847 4.8769C10.5847 3.40916 9.41586 2.20593 7.95768 2.20593C6.4995 2.20593 5.33067 3.40916 5.33067 4.8769V6.01259C5.33067 7.48032 6.4995 8.68355 7.95768 8.68355C8.20909 8.68355 8.45189 8.64779 8.68159 8.58107C8.68635 8.65317 8.69342 8.72016 8.70392 8.78578C8.81061 9.45248 9.17662 10.0499 9.72211 10.4478C9.88673 10.5679 10.0776 10.6652 10.3757 10.8171L11.2702 11.2732C11.6108 11.4469 11.7408 11.5145 11.8477 11.5924C12.2227 11.866 12.4743 12.2767 12.5477 12.7351C12.5589 12.8055 12.5645 12.8807 12.5672 12.995H9.90666C9.68597 12.995 9.50707 13.1739 9.50707 13.3946C9.50707 13.6152 9.68597 13.7941 9.90666 13.7941H12.9694C13.19 13.7941 13.3689 13.6152 13.3689 13.3946L13.369 13.3588C13.369 13.0242 13.369 12.81 13.3368 12.6088C13.2301 11.9421 12.8641 11.3446 12.3186 10.9468C12.154 10.8267 11.9632 10.7294 11.665 10.5775C11.6546 10.5721 11.644 10.5667 11.6332 10.5612L10.7705 10.1214C10.43 9.94773 10.2999 9.88006 10.1931 9.80215C9.81805 9.52861 9.56642 9.11785 9.49307 8.65949C9.4762 8.55408 9.47217 8.43819 9.47124 8.19619C10.1462 7.71137 10.5847 6.9116 10.5847 6.01259V4.8769Z" fill="${si.NeutralGray60}"/><path fill-rule="evenodd" clip-rule="evenodd" d="M7.91127 3.00512C6.90913 3.00512 6.08346 3.83575 6.08346 4.8769V6.01259C6.08346 7.05374 6.90913 7.88437 7.91127 7.88437C8.91342 7.88437 9.73909 7.05374 9.73909 6.01259V4.8769C9.73909 3.83575 8.91342 3.00512 7.91127 3.00512ZM5.28427 4.8769C5.28427 3.40916 6.45309 2.20593 7.91127 2.20593C9.36946 2.20593 10.5383 3.40916 10.5383 4.8769V6.01259C10.5383 7.48032 9.36946 8.68355 7.91127 8.68355C7.65987 8.68355 7.41706 8.64779 7.18737 8.58107C7.1826 8.65317 7.17553 8.72016 7.16503 8.78578C7.05834 9.45248 6.69233 10.0499 6.14684 10.4478C5.98222 10.5679 5.7914 10.6652 5.49326 10.8171L4.59875 11.2732C4.25818 11.4469 4.12811 11.5145 4.02129 11.5924C3.64626 11.866 3.39463 12.2767 3.32128 12.7351C3.31001 12.8055 3.30447 12.8807 3.30176 12.995H10.2779C10.4986 12.995 10.6775 13.1739 10.6775 13.3946C10.6775 13.6152 10.4986 13.7941 10.2779 13.7941H2.8996C2.67891 13.7941 2.50001 13.6152 2.50001 13.3946L2.5 13.3588C2.49996 13.0242 2.49994 12.81 2.53214 12.6088C2.63883 11.9421 3.00484 11.3446 3.55033 10.9468C3.71494 10.8267 3.90577 10.7294 4.2039 10.5775C4.21438 10.5721 4.22499 10.5667 4.23574 10.5612L5.09841 10.1214C5.43899 9.94773 5.56906 9.88006 5.67588 9.80215C6.0509 9.52861 6.30254 9.11785 6.37589 8.65949C6.39276 8.55408 6.39678 8.43819 6.39771 8.19619C5.72278 7.71137 5.28427 6.9116 5.28427 6.01259V4.8769Z" fill="${si.NeutralGray60}"/></svg>`)}')`}}}}}),fv=Qt.Ks.style({position:"absolute",top:Qt.Ks.rem(ti.CN),right:Qt.Ks.rem(ti.CN)});var vv=i(44169);function _v(e,t){var i,n;const[r,o]=(0,s.useState)(void 0);return(0,s.useEffect)((()=>{e.current&&e.current.scrollWidth>e.current.clientWidth&&o(t)}),[null===(i=e.current)||void 0===i?void 0:i.scrollWidth,null===(n=e.current)||void 0===n?void 0:n.clientWidth,t]),r}const bv=({title:e,url:t})=>{const i=s.useRef(null),n=_v(i,e);return(0,a.pipe)(t,o.fold((()=>s.createElement("span",{className:yv,title:n,ref:i},e)),(t=>s.createElement(vv.G,{className:yv,title:n,ref:i,href:t},e))))},yv=Qt.Ks.style({overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",textAlign:"left",$nest:{"&:visited":{color:"inherit"}}}),kv=r.UI.Node.make((({view:e})=>s.createElement(qa,{style:Cv,"data-testid":"detected-references"},s.createElement("span",{className:Ev},"Detected references"),s.createElement(ri.F.ul,{className:wv},e("detectedReferences").pipe(R.T((e=>e.map((({title:e,iconUrl:t,url:i},n)=>s.createElement("li",{key:n,className:Av},s.createElement("img",{src:t,className:Iv,alt:""}),s.createElement(bv,{title:e,url:i}))))))))))),Sv=r.UI.Union.asOption(kv),Cv={position:"relative",padding:`${Qt.Ks.rem(ti.v$)} ${Qt.Ks.rem(ti.Jj)}`,gap:0},Ev=Qt.Ks.style({fontSize:Qt.Ks.rem(ti.CN),lineHeight:Qt.Ks.rem(ti.Jj+ti.sp),color:ii.Q.Text.Base.Subdued,userSelect:"none"}),wv=Qt.Ks.style({fontSize:Qt.Ks.rem(ti.CN),lineHeight:Qt.Ks.rem(ti.Jj+ti.sp),color:ii.Q.Text.Base.Default,margin:0,padding:0}),Av=Qt.Ks.style({height:Qt.Ks.rem(ti.v5),display:"flex",alignItems:"center",borderRadius:Qt.Ks.rem(ni.KD)}),Iv=Qt.Ks.style({minWidth:Qt.Ks.rem(ti.Jj),height:Qt.Ks.rem(ti.Jj),marginRight:Qt.Ks.rem(ti.v$)}),xv=(0,Yt.w)("color",(({title:e,titleId:t,desc:i,descId:n,...r})=>s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16","aria-hidden":"true",stroke:"transparent","aria-labelledby":t,"aria-describedby":n,...r},i?s.createElement("desc",{id:n},i):null,e?s.createElement("title",{id:t},e):null,s.createElement("path",{stroke:"#646B81",strokeLinecap:"round",d:"M4 5.375 8 2l4 3.375m-8 5.25L8 14l4-3.375"})))),Tv=(0,Yt.w)("color",(({title:e,titleId:t,desc:i,descId:n,...r})=>s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16","aria-hidden":"true",stroke:"transparent","aria-labelledby":t,"aria-describedby":n,...r},i?s.createElement("desc",{id:n},i):null,e?s.createElement("title",{id:t},e):null,s.createElement("path",{stroke:"#646B81",strokeLinecap:"round",d:"m5 2 3 3.176L11 2M5 14l3-3.177L11 14"})))),Fv=({children:e,style:t})=>s.createElement("i",{className:Qt.Ks.style(Rv,t),"aria-hidden":"true"},e),Rv={display:"inline-flex",alignItems:"center",justifyContent:"center",width:Qt.Ks.rem(1),height:Qt.Ks.rem(1),$nest:{"& > svg":{transform:"scale(calc(var(--rem)/16))"}}},Kv=({feedForm:e,onClick:t})=>s.createElement(oi.$,{variant:"tertiary",size:"small",style:Mv,onClick:t},"shortForm"===e?s.createElement(s.Fragment,null,s.createElement("span",{className:Ov},"Show more"),s.createElement(Fv,null,s.createElement(xv,null))):"longForm"===e?s.createElement(s.Fragment,null,s.createElement("span",{className:Ov},"Show less"),s.createElement(Fv,null,s.createElement(Tv,null))):(0,g.AS)(e)),Mv={default:{gap:Qt.Ks.rem(ti.or),padding:Qt.Ks.rem(ti.or),paddingLeft:Qt.Ks.rem(ti.v$)},icon:{minHeight:Qt.Ks.rem(1),minWidth:Qt.Ks.rem(1)}},Ov=Qt.Ks.style({fontSize:Qt.Ks.rem(.75),lineHeight:Qt.Ks.rem(1.125)}),Nv=e=>{const t=gt.td(e.count,"suggestion","suggestions");return s.createElement("div",null,s.createElement("div",{className:Pv},s.createElement("h2",{className:Dv,"aria-label":`${e.count} ${t}`,tabIndex:0},"Review ",t),s.createElement("div",{"aria-hidden":"true",className:Bv},e.count)),(0,a.pipe)(e.pageRange,o.fold(a.constNull,(t=>s.createElement(vd,{pageRange:t,onPageRangeHeaderMount:e.onPageRangeHeaderMount})))))},Bv=Qt.Ks.style({display:"flex",alignItems:"center",justifyContent:"center",fontSize:Qt.Ks.rem(.75),fontStyle:"normal",fontWeight:700,lineHeight:Qt.Ks.rem(1.125),color:ii.Q.Text.Base.Inverse,padding:`0 ${Qt.Ks.rem(ti.or)}`,background:yi.A.BackgroundNeutralDefault,borderRadius:Qt.Ks.rem(ni.KY),border:`1px solid ${ii.Q.Text.Base.Inverse}`}),Pv=Qt.Ks.style({display:"flex",alignItems:"center",gap:Qt.Ks.rem(ti.v$)}),Dv=Qt.Ks.style({fontWeight:700,fontSize:Qt.Ks.rem(1),lineHeight:Qt.Ks.rem(1.5),margin:0}),Lv=(0,Yt.w)("color",(({title:e,titleId:t,desc:i,descId:n,...r})=>s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16","aria-hidden":"true",stroke:"transparent","aria-labelledby":t,"aria-describedby":n,...r},i?s.createElement("desc",{id:n},i):null,e?s.createElement("title",{id:t},e):null,s.createElement("path",{stroke:"#646B81",strokeLinecap:"round",d:"M11 2 5 8l6 6"}))));var Uv=i(15753);const jv=Qt.Ks.style({position:"relative"}),Vv=Qt.Ks.style({overscrollBehavior:"contain",overflowX:"auto",scrollSnapType:"x mandatory",position:"relative",width:0,minWidth:"100%"}),$v=(Qt.Ks.style({scrollSnapAlign:"start"}),Qt.Ks.style({display:"flex",flexDirection:"row",flexWrap:"nowrap"}),{position:"absolute",top:"50%",zIndex:1,$nest:{"&.override":{transform:"translate(0,-50%)"}}}),Hv=Qt.Ks.style({left:Qt.Ks.rem(ti.v$)}),Zv=Qt.Ks.style({right:Qt.Ks.rem(ti.v$)}),Gv=Qt.Ks.style({scrollbarWidth:"none","-ms-overflow-style":"none",$nest:{"&::-webkit-scrollbar":{width:0,height:0}}}),Wv=({count:e=1,hideScrollbar:t=!1,children:i})=>{const{onMount:n,rect:r}=jt.R.useRectWatcher(),{ref:l,onMount:c}=jt.R.useElWatcher(),d=s.useMemo((()=>f.s.create({scroll:0,width:0,scrollWidth:0,itemAverageWidth:0})),[]);jt.R.useSubscriptionTo(s.useMemo((()=>Ct.zV([l.pipe(N.oE,I.F()),r.pipe(N.oE,I.F())]).pipe(B.Z(100),P.M((([t])=>{const i=t.clientWidth,n=t.scrollWidth;d.set({scroll:t.scrollLeft,width:i,scrollWidth:n,itemAverageWidth:Math.min(i,n/e)})})))),[e,l,r]));const u=s.useCallback(((e=!1)=>{(0,a.pipe)(l.get(),o.map((t=>{const{scroll:i,itemAverageWidth:n}=d.get();t.scroll({top:0,left:i+(e?1:-1)*n,behavior:"smooth"})})))}),[l]);return s.createElement("div",{className:jv,ref:n},s.createElement("div",{ref:c,className:Qt.Ks.joinClasses([Vv,t?Gv:void 0]),onScroll:e=>{e.target instanceof HTMLDivElement&&d.lens("scroll").set(e.target.scrollLeft)},"data-role":"scroll"},i),s.createElement(ri.F.Fragment,null,d.pipe(R.T((({scroll:e,width:t,scrollWidth:i})=>s.createElement(s.Fragment,null,e>0?s.createElement(oi.$,{name:"scroll_left",title:"Scroll left","aria-label":"Scroll left",variant:"round",className:Qt.Ks.joinClasses([Qt.Ks.style($v),Hv,"override"]),onClick:()=>u(),"aria-hidden":!0,tabIndex:-1},s.createElement(Lv,null)):null,i-t-e>0?s.createElement(oi.$,{name:"scroll_right",title:"Scroll right","aria-label":"Scroll right",variant:"round",className:Qt.Ks.joinClasses([Qt.Ks.style($v),Zv,"override"]),onClick:()=>u(!0),"aria-hidden":!0,tabIndex:-1},s.createElement(Uv.E,null)):null))))))},zv=({percent:e,lensId:t})=>s.createElement("div",{className:qv(t),"aria-hidden":"true"},s.createElement("div",{className:Qv(t),style:{transform:`scaleX(${e})`}})),qv=e=>Qt.Ks.style({border:`1px solid ${Jv[e]}`,width:Qt.Ks.rem(2.5),height:Qt.Ks.rem(.25),boxSizing:"border-box",borderRadius:Qt.Ks.rem(ti.sp)}),Qv=e=>Qt.Ks.style({backgroundColor:Jv[e],border:0,width:"100%",height:"100%",transformOrigin:"left",transition:"transform 0.2s linear"}),Jv={[$i.lensAllSuggestionFeedShortForm]:ii.Q.Background.Neutral.Default,[$i.lensAllSuggestionFeed]:ii.Q.Background.Neutral.Default,[$i.lensCorrectnessFeed]:ii.Q.Background.Correctness.Default,[$i.lensClarityFeed]:ii.Q.Background.Clarity.Default,[$i.lensDeliveryFeed]:ii.Q.Background.Delivery.Default,[$i.lensEngagementFeed]:ii.Q.Background.Engagement.Default,[$i.lensStyleGuideFeed]:ii.Q.Background.Neutral.Default,[$i.lensPremiumFeed]:ii.Q.Background.Premium.Default,[$i.plagiarismFeed]:ii.Q.Background.Plagiarism.Default,[$i.writingExpertFeed]:ii.Q.Background.Brand.Default};var Yv=i(12174);const Xv={backgroundColor:ii.Q.Background.Neutral.Default},e_={neutral:{backgroundColor:Xv.backgroundColor},business:{backgroundColor:ii.Q.Background.Business.Default},addition:{backgroundColor:ii.Q.Background.Addition.Default},clarity:{backgroundColor:ii.Q.Background.Clarity.Default},correctness:{backgroundColor:ii.Q.Background.Correctness.Default},critical:{backgroundColor:ii.Q.Background.Critical.Default},deletion:{backgroundColor:ii.Q.Background.Deletion.Default},delivery:{backgroundColor:ii.Q.Background.Delivery.Default},engagement:{backgroundColor:ii.Q.Background.Engagement.Default},plagiarism:{backgroundColor:ii.Q.Background.Plagiarism.Default},premium:{backgroundColor:ii.Q.Background.Premium.Default,color:ii.Q.Text.Premium.Default},pro:{backgroundColor:ii.Q.Background.Pro.Default,color:ii.Q.Text.Pro.Default},success:{backgroundColor:ii.Q.Background.Success.Default},warning:{backgroundColor:ii.Q.Background.Warning.Default}},t_=s.forwardRef((function(e,t){const{className:i,as:n="span",...r}=e;return s.createElement(n,{ref:t,className:(0,Yv.$)("gds-sr-only",i),...r})})),i_={width:"auto",height:"auto",transform:"scaleX(0.3)"},n_=s.forwardRef((function(e,t){const{screenReaderText:i,style:n,displayText:r,...o}=(e=>{const{count:t,getAriaLabelText:i,specialCharBefore:n,specialCharAfter:s,style:r,variant:o,...a}=e,l=null!=n||null!=s,c=l?`${null!=n?n:""}${t}${null!=s?s:""}`:(d=t)<=99?d.toString():d>99&&d<1e3?"99+":"1K+";var d;const u=null==i?void 0:i(l?t:c,n,s),p=Object.assign((e=>{var t;return null==e?Xv:null!=(t=e_[e])?t:Xv})(o),r);return{displayText:c,screenReaderText:u,style:p,...a}})(e);return s.createElement(ia.E,{ref:t,as:"span",variant:"text-xsmall",weight:"bold",className:(0,Yv.$)("gds-badge",e.className),style:n,...o},s.createElement("span",{"aria-hidden":!0},r),s.createElement(t_,{style:i_},i))})),s_=({counter:e})=>s.createElement("span",{className:r_},s.createElement("span",{className:o_},s.createElement(n_,{variant:"premium",count:e,getAriaLabelText:e=>e+" suggestions"}))),r_=Qt.Ks.style({width:Qt.Ks.rem(2.5),height:Qt.Ks.rem(.25),boxSizing:"border-box",position:"relative",fontSize:Qt.Ks.rem(.75)}),o_=Qt.Ks.style({left:"50%",top:"50%",transform:"translate(-50%, -50%)",position:"absolute"}),a_=r.UI.Node.make((({view:e,notify:t})=>s.createElement(ri.F.Fragment,null,e("lenses").pipe(R.T((i=>{const n=i.some(ir);return i.length>0?s.createElement("section",{className:c_,"aria-label":"Filter suggestions"},s.createElement(Wv,{count:i.length,hideScrollbar:!0},s.createElement("div",{className:l_(i.length)},i.map(((i,r)=>s.createElement(s.Fragment,{key:i.lensId},r>0?s.createElement("div",{className:d_}):null,s.createElement(oi.$,{variant:"tertiary",contained:!0,size:"small",name:`${i.label}-button`,style:u_(n),active:e("activeLensId").pipe(R.T((e=>i.lensId===e))),onClick:t({kind:"lensesHeaderToggle",lensId:i.lensId}),onFocus:t({kind:"lensesHeaderFocus",lensId:i.lensId}),onBlur:t({kind:"lensesHeaderBlur"}),"aria-label":Ct.zV([e("focusedLensId"),e("focusedLensSuggestionCount")]).pipe(R.T((([e,t])=>(0,a.pipe)(e,o.filter((e=>e===i.lensId)),o.fold((()=>{}),(()=>`${i.label}, ${t} ${gt.td(t,"suggestion","suggestions")}`))))))},ir(i)?s.createElement(s_,{counter:i.suggestionCount}):s.createElement(zv,{percent:i.percent,lensId:i.lensId}),s.createElement("span",null,i.label)))))))):null})))))),l_=e=>Qt.Ks.style({display:"grid",gridTemplateColumns:Array.from({length:e}).map(((e,t)=>t>0?"1px minmax(min-content, 1fr)":"minmax(min-content, 1fr)")).join(" "),alignItems:"center"}),c_=Qt.Ks.style({borderTop:`1px solid ${ii.Q.Border.Base.Subdued}`,borderBottom:`1px solid ${ii.Q.Border.Base.Subdued}`,margin:`${Qt.Ks.rem(ti.v$)} 0`}),d_=Qt.Ks.style({height:"100%",borderLeft:`1px solid ${ii.Q.Border.Base.Subdued}`}),u_=e=>({default:{display:"flex",flexDirection:"column",gap:Qt.Ks.rem(e?ti.v$:ti.or),padding:`${Qt.Ks.rem(e?1:.75)} ${Qt.Ks.rem(ti.v$)} ${Qt.Ks.rem(.5)} ${Qt.Ks.rem(ti.v$)}`,borderRadius:0,color:ii.Q.Text.Base.Subdued,fontSize:Qt.Ks.rem(.75),lineHeight:Qt.Ks.rem(1.125),scrollSnapAlign:"start"},hovered:{boxShadow:"none"},active:{boxShadow:"none"},selected:{boxShadow:"none",fontWeight:"bold",backgroundColor:ii.Q.Background.Base.Subdued}}),p_=r.UI.Node.make((({state:e,notify:t})=>{const{onMount:i}=(0,po.y)(P.M(t({kind:"longFormFeedEmptyMount"})));return s.createElement(qa,{style:v_,"data-testid":"long-form-feed-empty","aria-live":"polite",mount:i},e.pipe(R.T((({content:e})=>s.createElement(s.Fragment,null,s.createElement("div",{className:__},s.createElement("p",{className:b_},e.title),s.createElement("p",{className:y_},e.description)),s.createElement("div",{className:k_},e.illustration))))))})),m_=r.UI.Node.make((({state:e,notify:t})=>{const{onMount:i}=(0,po.y)(P.M(t({kind:"longFormFeedSuccessMount"})));return s.createElement(qa,{style:v_,"data-testid":"long-form-feed-success","aria-live":"polite",mount:i},e.pipe(R.T((({content:e,goBackFrom:i})=>s.createElement(s.Fragment,null,s.createElement("div",{className:__},s.createElement("p",{className:b_},e.title),s.createElement("p",{className:y_},e.description),(0,a.pipe)(i,o.fold(a.constNull,(e=>s.createElement(oi.$,{variant:"secondary",style:f_,onClick:t({kind:"goBack",goBackFrom:e})},"See all suggestions"))))),s.createElement("div",{className:k_},e.illustration))))))})),h_=r.UI.Grid.make((({slots:e,state:t,notify:i})=>{const{onMount:n}=(0,po.y)(P.M(i({kind:"longFormFeedSuccessMount"})));return s.createElement(qa,{style:v_,"data-testid":"long-form-feed-success","aria-live":"polite",mount:n},t.pipe(R.T((({content:t,premiumSuggestionCount:i,isGrammarlyPro:n})=>s.createElement(s.Fragment,null,s.createElement("div",{className:__},s.createElement("p",{className:b_},t.title),i>0?s.createElement("p",{className:y_},"There are no more free suggestions.",s.createElement("br",null),"But ",s.createElement("b",null,i)," ",n?"Pro":"Premium"," ",i>1?"suggestions are":"suggestion is"," waiting for you."):s.createElement("p",{className:y_},"There are no more free suggestions.",s.createElement("br",null),"Get unlimited access to suggestions for tone, clarity, and more with a"," ",n?"Pro":"Premium"," plan."),s.createElement("div",{className:S_},e.uphook)),s.createElement("div",{className:k_},t.illustration))))))})),g_=r.UI.Knot.make(h_,{uphook:Kp}),f_={default:{marginTop:Qt.Ks.rem(ti.v$),alignSelf:"flex-start"}},v_={padding:`${Qt.Ks.rem(ti.Jj)}`,display:"flex",flexDirection:"column-reverse",justifyContent:"center",alignItems:"center",gap:`${Qt.Ks.rem(ti.Jj)}`,height:"100%",boxSizing:"border-box"},__=Qt.Ks.style({textAlign:"center",padding:`${Qt.Ks.rem(ti.Jj)} ${Qt.Ks.rem(ti.Jj)} 0 ${Qt.Ks.rem(ti.Jj)}`}),b_=Qt.Ks.style({margin:0,color:yi.A.TextBaseDefault,fontSize:Qt.Ks.rem(1),lineHeight:"1.5em",fontWeight:700}),y_=Qt.Ks.style({margin:0,color:yi.A.TextBaseSubduedColor,fontSize:Qt.Ks.rem(.875),lineHeight:"1.5em",fontWeight:400}),k_=Qt.Ks.style({width:Qt.Ks.rem(6),height:Qt.Ks.rem(6),minWidth:Qt.Ks.rem(6),minHeight:Qt.Ks.rem(6)}),S_=Qt.Ks.style({marginTop:Qt.Ks.rem(ti.Jj)}),C_=r.UI.Node.make((({view:e})=>s.createElement(qa,{"aria-busy":"true",style:E_,"data-testid":"long-form-feed-loading"},s.createElement("div",{className:w_},s.createElement(pp,null),s.createElement(ri.F.div,{className:K_},s.createElement("div",{className:M_}),e("supportsShortForm").pipe(R.T((0,j.Sw)(s.createElement("div",{className:O_}),null)))),s.createElement("div",{className:N_},s.createElement("div",{className:B_}),s.createElement("div",{className:B_}),s.createElement("div",{className:B_}),s.createElement("div",{className:B_})),s.createElement("div",{className:P_},s.createElement("div",{className:D_}),s.createElement("div",{className:L_})),s.createElement("div",{className:U_(!0)}),s.createElement("div",{className:U_(!1)}),s.createElement("div",{className:j_},s.createElement("div",{className:V_}),s.createElement("div",{className:$_}))),s.createElement("div",{className:A_},s.createElement("div",{className:I_},s.createElement(pp,null),s.createElement("div",{className:x_}),s.createElement("div",{className:T_}),s.createElement("div",{className:F_})),s.createElement("div",{className:R_}),s.createElement("div",{className:I_},s.createElement(pp,null),s.createElement("div",{className:x_}),s.createElement("div",{className:T_}),s.createElement("div",{className:F_})),s.createElement("div",{className:R_}),s.createElement("div",{className:I_},s.createElement(pp,null),s.createElement("div",{className:x_}),s.createElement("div",{className:T_}),s.createElement("div",{className:F_})),s.createElement("div",{className:R_}),s.createElement("div",{className:I_},s.createElement(pp,null),s.createElement("div",{className:x_}),s.createElement("div",{className:T_}),s.createElement("div",{className:F_})))))),E_={padding:0},w_=Qt.Ks.style({display:"flex",flexDirection:"column",position:"relative",padding:`${Qt.Ks.rem(ti.Jj)}`,borderBottom:`1px solid ${ii.Q.Border.Base.Subdued}`}),A_=Qt.Ks.style({display:"flex",flexDirection:"column",margin:Qt.Ks.rem(1)}),I_=Qt.Ks.style({display:"flex",alignItems:"center",position:"relative",height:Qt.Ks.rem(2.25)}),x_=Qt.Ks.style({height:Qt.Ks.rem(.5),width:Qt.Ks.rem(.5),borderRadius:"50%",background:si.NeutralGray10,marginRight:Qt.Ks.rem(1.25)}),T_=Qt.Ks.style({height:Qt.Ks.rem(.5),width:Qt.Ks.rem(3.875),borderRadius:Qt.Ks.rem(ni.M6),background:si.NeutralGray10,marginRight:Qt.Ks.rem(ti.Jj)}),F_=Qt.Ks.style({height:Qt.Ks.rem(.5),width:Qt.Ks.rem(7.875),borderRadius:Qt.Ks.rem(ni.M6),background:si.NeutralGray10}),R_=Qt.Ks.style({margin:`${Qt.Ks.rem(.5)} ${Qt.Ks.rem(1)}`,borderBottom:`1px solid ${ii.Q.Border.Base.Subdued}`}),K_=Qt.Ks.style({display:"flex",flexDirection:"row",justifyContent:"space-between",gap:Qt.Ks.rem(ti.v$),alignItems:"center"}),M_=Qt.Ks.style({width:Qt.Ks.rem(11.875),height:Qt.Ks.rem(1),borderRadius:Qt.Ks.rem(ni.M6),background:si.NeutralGray10}),O_=Qt.Ks.style({flex:1,maxWidth:Qt.Ks.rem(3.5),height:Qt.Ks.rem(.5),borderRadius:Qt.Ks.rem(ni.M6),background:si.NeutralGray10}),N_=Qt.Ks.style({display:"flex",flexDirection:"row",justifyContent:"space-between",marginTop:Qt.Ks.rem(11.5*ti.or)}),B_=Qt.Ks.style({width:Qt.Ks.rem(3.5625),height:Qt.Ks.rem(.5),borderRadius:Qt.Ks.rem(ni.M6),background:si.NeutralGray10,margin:`0 ${Qt.Ks.rem(9.5*ti.vW)}`}),P_=Qt.Ks.style({display:"flex",flexDirection:"row",gap:Qt.Ks.rem(ti.or),alignItems:"center",marginTop:Qt.Ks.rem(8.5*ti.or)}),D_=Qt.Ks.style({width:Qt.Ks.rem(1.25),height:Qt.Ks.rem(1.25),borderRadius:"50%",background:si.NeutralGray10}),L_=Qt.Ks.style({flex:1,height:Qt.Ks.rem(.5),borderRadius:Qt.Ks.rem(ni.M6),background:si.NeutralGray10}),U_=e=>Qt.Ks.style({height:Qt.Ks.rem(.5),borderRadius:Qt.Ks.rem(ni.M6),background:si.NeutralGray10,marginTop:Qt.Ks.rem(e?2.5*ti.or:ti.Jj)}),j_=Qt.Ks.style({display:"flex",flexDirection:"row",gap:Qt.Ks.rem(ti.Jj),alignItems:"center",marginTop:Qt.Ks.rem(ti.Jj+ti.sp)}),V_=Qt.Ks.style({width:Qt.Ks.rem(4.125),height:Qt.Ks.rem(2),borderRadius:Qt.Ks.rem(ni.KD),background:si.NeutralGray10}),$_=Qt.Ks.style({width:Qt.Ks.rem(3.125),height:Qt.Ks.rem(.5),borderRadius:Qt.Ks.rem(ni.M6),background:si.NeutralGray10}),H_=(0,ra.yY)(Nv),Z_=r.UI.Grid.make((({slots:e,view:t,notify:i})=>{const{onMount:n}=(0,po.y)((0,a.flow)(P.M(i({kind:"longFormFeedMount"})),co.j(or.notifyFeedUnmount)));return s.createElement(qa,{"data-testid":"long-form-feed",style:{padding:0,display:"grid",gridTemplateRows:"auto auto 1fr",height:"100%"},mount:n},s.createElement(Yc,{style:Object.assign(Object.assign({},G_),{padding:`${Qt.Ks.rem(ti.v$)} ${Qt.Ks.rem(ti.Jj)}`,paddingTop:Qt.Ks.rem(ti.Jj)})},s.createElement(H_,{count:t("suggestionCount"),pageRange:t("pageRange"),onPageRangeHeaderMount:i({kind:"partialPageRangeHeaderMount"})}),t("canCollapseToShortForm").pipe(R.T((0,j.Sw)(s.createElement(Kv,{feedForm:"longForm",onClick:i({kind:"toggleShortFormFeed"})}),null)))),e.lensesHeader,s.createElement(Go,{role:"list","aria-label":"Suggestions","aria-live":"polite"},e.lensView))})),G_={display:"flex",alignItems:"center",gap:Qt.Ks.rem(ti.v$),justifyContent:"space-between"},W_=r.UI.Group.make({cardList:ju}),z_=r.UI.Union.make("kind",{successState:m_,uphookSuccessState:g_,cardList:W_}),q_=r.UI.Knot.make(Z_,{lensesHeader:a_,lensView:z_}),Q_=r.UI.Union.make("kind",{loadingState:C_,emptyState:p_,successState:m_,uphookSuccessState:g_,nonEmptyState:q_});const J_=e=>{var{style:t}=e,i=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(i[n[s]]=e[n[s]])}return i}(e,["style"]);return s.createElement(qa,Object.assign({},i,{style:t?(0,Se.b)(t).pipe(R.T((e=>Object.assign(Object.assign({},e),Y_)))):Y_}),i.children)},Y_={height:Qt.Ks.rem(10.25),minHeight:Qt.Ks.rem(10.25),boxSizing:"border-box",display:"flex",flexDirection:"column",justifyContent:"space-around"};function X_(e){return r.UI.Node.make((({state:t,notify:i})=>{const{onMount:n}=(0,po.y)(P.M(i({kind:"shortFormFeedEmptyMount"})));return s.createElement(ri.F.Fragment,null,t.pipe(R.T((({emptyStateContent:t,useVerticalLayout:i})=>{const r=t[e?"successState":"emptyState"],o=e?"short-form-feed-success":"short-form-feed-empty";return i?s.createElement(J_,{style:eb,"data-testid":o,"aria-live":"polite",mount:n},s.createElement("div",{className:ob},r.illustration),s.createElement("div",{className:ib},s.createElement("p",{className:sb},r.title),s.createElement("p",{className:rb},r.description))):s.createElement(qa,{style:tb,"data-testid":o,"aria-live":"polite",mount:n},s.createElement("div",{className:nb},s.createElement("p",{className:sb},r.title),s.createElement("p",{className:rb},r.description)),s.createElement("div",{className:ob},r.illustration))}))))}))}const eb={padding:`${Qt.Ks.rem(ti.Jj)}`,alignItems:"center"},tb={padding:`${Qt.Ks.rem(ti.Jj)}`,display:"flex",flexDirection:"row",justifyContent:"space-between"},ib=Qt.Ks.style({display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"}),nb=Qt.Ks.style({display:"flex",flexDirection:"column",marginRight:Qt.Ks.rem(2),justifyContent:"center"}),sb=Qt.Ks.style({margin:0,color:yi.A.TextBaseDefault,fontSize:Qt.Ks.rem(1),lineHeight:Qt.Ks.rem(1.5),fontWeight:700}),rb=Qt.Ks.style({margin:0,color:yi.A.TextBaseSubduedColor,fontSize:Qt.Ks.rem(.875),lineHeight:Qt.Ks.rem(1.3125),fontWeight:400}),ob=Qt.Ks.style({width:Qt.Ks.rem(4),height:Qt.Ks.rem(4),minWidth:Qt.Ks.rem(4),minHeight:Qt.Ks.rem(4)}),ab=r.UI.Node.make((()=>s.createElement(J_,{"aria-busy":"true",style:lb,"data-testid":"short-form-feed-loading"},s.createElement(pp,null),s.createElement("div",{className:cb},s.createElement("div",{className:db}),s.createElement("div",{className:ub})),s.createElement("div",{className:pb},s.createElement("div",{className:mb}),s.createElement("div",{className:hb})),s.createElement("div",{className:gb(!0)}),s.createElement("div",{className:fb},s.createElement("div",{className:vb}),s.createElement("div",{className:_b}))))),lb={padding:`${Qt.Ks.rem(ti.Jj)}`,position:"relative"},cb=Qt.Ks.style({display:"flex",flexDirection:"row",justifyContent:"space-between",gap:Qt.Ks.rem(ti.v$),alignItems:"center"}),db=Qt.Ks.style({width:Qt.Ks.rem(11.875),height:Qt.Ks.rem(1),borderRadius:Qt.Ks.rem(ni.M6),background:si.NeutralGray10}),ub=Qt.Ks.style({flex:1,maxWidth:Qt.Ks.rem(3.5),height:Qt.Ks.rem(.5),borderRadius:Qt.Ks.rem(ni.M6),background:si.NeutralGray10}),pb=Qt.Ks.style({display:"flex",flexDirection:"row",gap:Qt.Ks.rem(ti.or),alignItems:"center",marginTop:Qt.Ks.rem(6.5*ti.or)}),mb=Qt.Ks.style({width:Qt.Ks.rem(1.25),height:Qt.Ks.rem(1.25),borderRadius:"50%",background:si.NeutralGray10}),hb=Qt.Ks.style({flex:1,height:Qt.Ks.rem(.5),borderRadius:Qt.Ks.rem(ni.M6),background:si.NeutralGray10}),gb=e=>Qt.Ks.style({height:Qt.Ks.rem(.5),borderRadius:Qt.Ks.rem(ni.M6),background:si.NeutralGray10,marginTop:Qt.Ks.rem(e?2.5*ti.or:ti.Jj)}),fb=Qt.Ks.style({display:"flex",flexDirection:"row",gap:Qt.Ks.rem(ti.Jj),alignItems:"center",marginTop:Qt.Ks.rem(ti.Jj+ti.sp)}),vb=Qt.Ks.style({width:Qt.Ks.rem(4.125),height:Qt.Ks.rem(2),borderRadius:Qt.Ks.rem(ni.KD),background:si.NeutralGray10}),_b=Qt.Ks.style({width:Qt.Ks.rem(3.125),height:Qt.Ks.rem(.5),borderRadius:Qt.Ks.rem(ni.M6),background:si.NeutralGray10}),bb=(0,ra.yY)(Nv),yb=r.UI.Node.make((({state:e,view:t,notify:i})=>{const{onMount:n}=(0,po.y)((0,a.flow)(P.M(i({kind:"shortFormFeedMount"})),co.j(or.notifyFeedUnmount))),{onMount:r}=function(e,t){const{onMount:i,ref:n}=jt.R.useElWatcher();return jt.R.useSubscriptionTo(Ct.zV([n,t]).pipe(R.T((([e,t])=>(0,a.pipe)(e,L.Mi((e=>e.style.setProperty("--cardWidth",t)))))))),{onMount:i}}(0,u.of("400"));return s.createElement(qa,{"data-testid":"short-form-feed",style:{padding:`${Qt.Ks.rem(ti.v$)} 0 0 0`},mount:e=>{n(e),r(e)},"aria-live":"polite"},s.createElement(Yc,{style:Object.assign(Object.assign({},kb),{padding:`${Qt.Ks.rem(ti.v$)} ${Qt.Ks.rem(ti.Jj)}`})},s.createElement(bb,{count:t("suggestionCount"),pageRange:t("pageRange"),onPageRangeHeaderMount:a.constVoid}),t("canExpandToLongForm").pipe(R.T((0,j.Sw)(s.createElement(Kv,{feedForm:"shortForm",onClick:i({kind:"toggleLongFormFeed"})}),null)))),Li.h(e.pipe(h.s(1)),e.pipe(B.Z(50))).pipe(R.T((({item:e,isFirst:t,isLast:n,prevItem:r,transitions:l,isWaitingForAlertsToBeApplied:c})=>s.createElement(kd.R,{key:e.id,sduiRootId:e.id,content:e.content,designSystem:Su({buttonDesignSystemParams:{acceptButtonsLoading:c,cardPosition:{isFirst:t,isLast:n}}}),notify:Cd({item:e,kind:"shortFormCardSduiNotify",notify:i}),transitions:Array.from(l),prevContent:(0,a.pipe)(r,o.map((e=>e.content))),onAnimationEnd:i({kind:"shortFormFeedAnimationEnd"}),onMount:i({kind:"shortFormCardMount",item:e}),longFormCardState:{viewKind:"focused"}})))))})),kb={display:"flex",alignItems:"center",gap:Qt.Ks.rem(ti.v$),justifyContent:"space-between"},Sb=r.UI.Union.make("kind",{loadingState:ab,emptyState:X_(!1),successState:X_(!0),nonEmptyState:yb}),Cb=r.UI.Group.make({feed:Sb}),Eb=r.UI.Group.make({feed:Q_}),wb=r.UI.Union.make("kind",{none:r.UI.Node.empty,shortFormFeed:Cb,longFormFeed:Eb}),Ab=e=>s.createElement(li.hh,Object.assign({width:"24",height:"24",viewBox:"0 0 24 24",fill:"none"},e),s.createElement("path",{d:"M12 7L12 17",strokeLinecap:"round"}),s.createElement("path",{d:"M9 9L9 15",strokeLinecap:"round"}),s.createElement("path",{d:"M15 9L15 15",strokeLinecap:"round"}),s.createElement("path",{d:"M18 11L18 13",strokeLinecap:"round"}),s.createElement("path",{d:"M6 11L6 13",strokeLinecap:"round"})),Ib=r.UI.Node.make((({notify:e})=>s.createElement(qa,{style:Tb,"data-testid":"voice-banner"},s.createElement(Yc,null,"Set your voice"),s.createElement("div",{className:Fb},"Choose how you want your generated text to sound."),s.createElement(oi.$,{style:Kb,onClick:e({kind:ft.t.Kind.setVoiceButtonClick}),name:"bannerVoiceProfile",size:"small"},s.createElement(Ab,{className:Rb}),"Set voice")))),xb=r.UI.Union.asOption(Ib),Tb={gap:0,backgroundColor:"#D8F2EC",backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"right",backgroundImage:"url('https://d201kpdrh73vuz.cloudfront.net/text-generation/voice-banner.png')"},Fb=Qt.Ks.style({fontWeight:400,fontSize:Qt.Ks.rem(.75),lineHeight:Qt.Ks.rem(1.125),color:ii.Q.Text.Base.Subdued}),Rb=Qt.Ks.style({stroke:"white"}),Kb={default:{alignSelf:"flex-start",marginTop:Qt.Ks.rem(ti.v$),padding:`0 ${Qt.Ks.rem(ti.v$)} 0 ${Qt.Ks.rem(ti.or)}`,lineHeight:Qt.Ks.rem(1.125),gap:Qt.Ks.rem(ti.or)},icon:Object.assign({marginLeft:0},(0,bi.QD)(1.5))},Mb=r.UI.Grid.make((({slots:e})=>s.createElement(s.Fragment,null,e.suggestions,e.voiceBanner,e.documentOverview,e.intent,e.detectedReferences))),Ob=r.UI.Knot.make(Mb,{suggestions:wb,voiceBanner:xb,documentOverview:Yf,intent:mv,detectedReferences:Sv});var Nb=i(36735);function Bb(e,t=0){const i=function(e){return e.trim().replace(/\s+/g," ")}(e).split(" ").reduce(((e,i,n,s)=>Object.assign(Object.assign({},e),{head:n<s.length-t?e.head.concat(i):e.head,tail:n>=s.length-t?e.tail.concat(i):e.tail})),{head:[],tail:[]});return{head:i.head.join(" "),tail:i.tail.join(" ")}}const Pb=({children:e,maxTailWordsCount:t=0})=>{const i=Bb(e,t);return s.createElement("div",{className:Lb},s.createElement("span",{className:Ub},i.head,i.head.length&&i.tail.length?"":null),i.tail.length?i.tail:null)},Db=({children:e,maxTailWordsCount:t=0})=>{const[i,n]=s.useState(t),{onMount:r,rect:o}=jt.R.useRectWatcher(),a=s.useRef(null),c=s.useMemo((()=>Bb(e,i)),[i,e]),d=s.useMemo((()=>new l.B7),[]);jt.R.useSubscriptionTo(s.useMemo((()=>d.pipe(Nb.c(100),I.F(),P.M((e=>{n(e)})))),[]));const u=s.useMemo((()=>{return e=a.current,parseInt((null===(n=null===(i=null===(t=null==e?void 0:e.ownerDocument)||void 0===t?void 0:t.defaultView)||void 0===i?void 0:i.getComputedStyle(e))||void 0===n?void 0:n.fontSize)||(null===(r=null===(s=null==e?void 0:e.ownerDocument)||void 0===s?void 0:s.defaultView)||void 0===r?void 0:r.getComputedStyle(e.ownerDocument.body).fontSize)||jb,10);var e,t,i,n,s,r}),[a.current]);return jt.R.useSubscriptionTo(s.useMemo((()=>o.pipe(N.oE,I.F(),m.p((e=>Boolean(e.width&&e.height))),P.M((e=>{if(e.width<9*u)d.next(0);else if(a.current&&a.current.clientWidth<a.current.scrollWidth){const n=a.current.clientWidth/(e.width||1/0);i&&n<.4?d.next(i-1):n>.6&&i<t&&d.next(i+1)}})))),[o])),s.createElement("div",{className:Lb,ref:r},s.createElement("span",{className:Ub,ref:a},c.head,c.head.length&&c.tail.length?"":null),c.tail.length?c.tail:null)},Lb=Qt.Ks.style({display:"flex",flexDirection:"row",whiteSpace:"nowrap",maxWidth:"100%",minWidth:0}),Ub=Qt.Ks.style({display:"inline-block",overflow:"hidden",textOverflow:"ellipsis",flexShrink:10}),jb="16px",Vb=(0,ra.yY)((({dynamic:e=!1,maxTailWordsCount:t=0,children:i})=>e?s.createElement(Db,{maxTailWordsCount:t},i):s.createElement(Pb,{maxTailWordsCount:t},i))),$b=({active:e,className:t,prefix:i,style:n,children:r})=>s.createElement("h1",{id:"actions-panel-context",className:Qt.Ks.joinClasses([Gb(void 0!==i,n),t])},e?s.createElement("svg",{viewBox:"0 0 16 16",fill:"none",className:Zb,"aria-hidden":"true"},s.createElement("rect",{width:"16",height:"16",rx:"5",fill:"#018374"}),s.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.5 13.5C9.5 13.7761 9.72386 14 10 14H11C12.6569 14 14 12.6569 14 11V10C14 9.72386 13.7761 9.5 13.5 9.5C13.2239 9.5 13 9.72386 13 10V11C13 12.1046 12.1046 13 11 13H10C9.72386 13 9.5 13.2239 9.5 13.5ZM9.5 2.5C9.5 2.77614 9.72386 3 10 3H11C12.1046 3 13 3.89543 13 5V6C13 6.27614 13.2239 6.5 13.5 6.5C13.7761 6.5 14 6.27614 14 6V5C14 3.34315 12.6569 2 11 2H10C9.72386 2 9.5 2.22386 9.5 2.5ZM6 2C6.27614 2 6.5 2.22386 6.5 2.5C6.5 2.77614 6.27614 3 6 3H5C3.89543 3 3 3.89543 3 5V6C3 6.27614 2.77614 6.5 2.5 6.5C2.22386 6.5 2 6.27614 2 6V5C2 3.34315 3.34315 2 5 2H6ZM6 13C6.27614 13 6.5 13.2239 6.5 13.5C6.5 13.7761 6.27614 14 6 14H5C3.34315 14 2 12.6569 2 11V10C2 9.72386 2.22386 9.5 2.5 9.5C2.77614 9.5 3 9.72386 3 10V11C3 12.1046 3.89543 13 5 13H6ZM5.5 6.5C5.5 6.22386 5.72386 6 6 6H10C10.2761 6 10.5 6.22386 10.5 6.5C10.5 6.77614 10.2761 7 10 7H6C5.72386 7 5.5 6.77614 5.5 6.5ZM6 9C5.72386 9 5.5 9.22386 5.5 9.5C5.5 9.77614 5.72386 10 6 10H8.5C8.77614 10 9 9.77614 9 9.5C9 9.22386 8.77614 9 8.5 9H6Z",fill:"white"})):s.createElement("svg",{viewBox:"0 0 16 16",fill:"none",className:Zb,"aria-hidden":"true"},s.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.5 13.5C9.5 13.7761 9.72386 14 10 14H11C12.6569 14 14 12.6569 14 11V10C14 9.72386 13.7761 9.5 13.5 9.5C13.2239 9.5 13 9.72386 13 10V11C13 12.1046 12.1046 13 11 13H10C9.72386 13 9.5 13.2239 9.5 13.5ZM9.5 2.5C9.5 2.77614 9.72386 3 10 3H11C12.1046 3 13 3.89543 13 5V6C13 6.27614 13.2239 6.5 13.5 6.5C13.7761 6.5 14 6.27614 14 6V5C14 3.34315 12.6569 2 11 2H10C9.72386 2 9.5 2.22386 9.5 2.5ZM6 2C6.27614 2 6.5 2.22386 6.5 2.5C6.5 2.77614 6.27614 3 6 3H5C3.89543 3 3 3.89543 3 5V6C3 6.27614 2.77614 6.5 2.5 6.5C2.22386 6.5 2 6.27614 2 6V5C2 3.34315 3.34315 2 5 2H6ZM6 13C6.27614 13 6.5 13.2239 6.5 13.5C6.5 13.7761 6.27614 14 6 14H5C3.34315 14 2 12.6569 2 11V10C2 9.72386 2.22386 9.5 2.5 9.5C2.77614 9.5 3 9.72386 3 10V11C3 12.1046 3.89543 13 5 13H6ZM5.5 6.5C5.5 6.22386 5.72386 6 6 6H10C10.2761 6 10.5 6.22386 10.5 6.5C10.5 6.77614 10.2761 7 10 7H6C5.72386 7 5.5 6.77614 5.5 6.5ZM6 9C5.72386 9 5.5 9.22386 5.5 9.5C5.5 9.77614 5.72386 10 6 10H8.5C8.77614 10 9 9.77614 9 9.5C9 9.22386 8.77614 9 8.5 9H6Z",fill:"#646B81"})),i&&s.createElement("span",{className:Hb},i),s.createElement(Vb,{dynamic:!0,maxTailWordsCount:3},r)),Hb=Qt.Ks.style({fontSize:Qt.Ks.rem(.75),lineHeight:Qt.Ks.rem(1.125),color:yi.A.BrandGreen60}),Zb=Qt.Ks.style({width:Qt.Ks.rem(1),height:Qt.Ks.rem(1)}),Gb=(e,t)=>Qt.Ks.style(Object.assign({display:"grid",gridTemplateColumns:`${Qt.Ks.rem(1)} ${e?"min-content ":""}auto`,justifyItems:"start",alignItems:"center",gap:Qt.Ks.rem(ti.v$),color:ii.Q.Text.Base.Subdued,fontSize:Qt.Ks.rem(.75),lineHeight:Qt.Ks.rem(1.125),overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",fontWeight:"normal",margin:0,height:Qt.Ks.rem(1.5)},t)),Wb=r.UI.Node.make((({state:e,notify:t})=>s.createElement(ri.F.Fragment,null,e.pipe(R.T((({selectedRange:e,selectedText:i})=>e?s.createElement(oi.$,{"aria-label":"Show the text used for this response.","aria-describedby":"actions-panel-context",variant:"tertiary",title:"Show the text used for this response.",style:qb,onClick:t({kind:ft.t.Kind.selectionContextInteraction,range:e,visibility:"attention"}),onMouseEnter:t({kind:ft.t.Kind.selectionContextInteraction,range:e,visibility:"visible"}),onMouseLeave:t({kind:ft.t.Kind.selectionContextInteraction,range:e,visibility:"hidden"}),name:"resultContextHeaderButton"},s.createElement($b,null,i)):s.createElement("div",{className:Qb,"data-testid":"result-context-header"},s.createElement($b,null,i)))))))),zb=r.UI.Union.asOption(Wb),qb={default:{justifyContent:"flex-start",padding:`0 ${Qt.Ks.rem(ti.v$)}`,margin:`0 ${Qt.Ks.rem(-ti.v$)}`,height:Qt.Ks.rem(2.5)}},Qb=Qt.Ks.style({display:"flex",alignItems:"center",height:Qt.Ks.rem(2.5)}),Jb=e=>s.createElement(li.hh,Object.assign({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},e),s.createElement("rect",{width:"16",height:"16",rx:"2"}),s.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.7072 5.41421L6.50008 12.6213L2.29297 8.41421L3.70718 7L6.50008 9.79289L12.293 4L13.7072 5.41421Z",fill:"white"})),Yb=({isMyVoice:e,isAnimated:t=!1,isBadge:i=!1,label:n="Use my style",inactiveLabel:r=n,onClick:o})=>s.createElement(oi.$,{variant:"tertiary",name:"toggleVoice",onClick:o,size:"small",role:"checkbox","aria-checked":e,compact:!0,style:Xb(e,t,i)},s.createElement(Jb,Object.assign({width:16,height:16},(0,ra.Ly)(ey,e?ty:iy))),e?n:r);function Xb(e,t,i){return{default:{display:"flex",alignItems:"center",height:Qt.Ks.rem(1.25),lineHeight:Qt.Ks.rem(1.125),fontSize:Qt.Ks.rem(.75),color:e?si.Green80:si.NeutralGray60,backgroundColor:e?si.Green0:si.NeutralGray0,transition:t?Qt.Ks.seconds(.25):void 0,transitionProperty:t?"color, background-color":void 0},textPosRight:{padding:`0 ${Qt.Ks.rem(ti.or)}`},icon:{marginRight:Qt.Ks.rem(ti.v$),minWidth:Qt.Ks.rem(1),minHeight:Qt.Ks.rem(1)},hovered:{backgroundColor:e?Qt.Ks.color(yi.A.Green10).mix(Qt.Ks.color(yi.A.NeutralGray10)).toRGBA().toString():si.NeutralGray10,color:e?si.Green80:si.NeutralGray60},active:{backgroundColor:e?Qt.Ks.color(yi.A.Green10).mix(Qt.Ks.color(yi.A.NeutralGray10)).toRGBA().toString():si.NeutralGray10,color:e?si.Green80:si.NeutralGray60},disabled:i?{opacity:1,cursor:"default"}:void 0}}const ey=Qt.Ks.style({marginRight:Qt.Ks.rem(ti.v$),minWidth:Qt.Ks.rem(1),minHeight:Qt.Ks.rem(1),borderWidth:Qt.Ks.px(1),borderStyle:"solid",borderColor:ii.Q.Text.Base.Subdued,borderRadius:Qt.Ks.rem(ni.KD),overflow:"hidden",transitionProperty:"background border-color",transitionDuration:Qt.Ks.seconds(.25),$nest:{svg:{stroke:"none"}}}),ty=Qt.Ks.style({background:si.Green60,borderColor:si.Green60,$nest:{path:{fill:si.White}}}),iy=Qt.Ks.style({background:si.White,borderColor:ii.Q.Text.Base.Subdued,$nest:{path:{fill:"transparent"}}}),ny=Qt.Ks.style({whiteSpace:"break-spaces",overflowWrap:"anywhere",fontStyle:"normal",fontWeight:"normal",fontSize:Qt.Ks.rem(.875),fontFeatureSettings:"'ss03' on",lineHeight:Qt.Ks.rem(1.3125),color:ii.Q.Text.Base.Default}),sy=({children:e})=>s.createElement("div",{className:ny},e),ry=({text:e})=>""!==e.trim()?s.createElement(sy,null,e):null,oy=(0,ra.yY)(oi.$),ay=({header:e,onClick:t,disabled:i})=>s.createElement(oy,{variant:"tertiary",compact:!0,disabled:i,onClick:t,className:my,name:"editResultPrompt",size:"small",style:{hovered:{boxShadow:"none",backgroundColor:yi.A.ButtonBackgroundTertiaryHover},active:{boxShadow:"none",backgroundColor:yi.A.ButtonBackgroundTertiaryHover}}},s.createElement(Gm.m_,{title:"Edit"},s.createElement("div",{className:hy},s.createElement("div",Object.assign({className:fy},z(e))))));var ly;!function(e){e.FadeIn="FadeIn",e.FadeOut="FadeOut"}(ly||(ly={}));const cy=({iconUrl:e,loading:t,header:i})=>{const[n,r]=s.useState({text:i,animationState:ly.FadeIn});return s.useEffect((()=>{r((e=>Object.assign(Object.assign({},e),{animationState:e.text!==i?ly.FadeOut:e.animationState})));const e=setTimeout((()=>r({text:i,animationState:ly.FadeIn})),250);return()=>clearTimeout(e)}),[i]),s.createElement("div",{className:py},t?s.createElement(Nd,{className:gy}):(0,a.pipe)(e,o.fold(a.constNull,(e=>s.createElement("img",{src:e,style:{width:Qt.Ks.rem(1.3125),height:Qt.Ks.rem(1.3125)}})))),s.createElement("span",Object.assign({"aria-live":"assertive",className:Qt.Ks.joinClasses([fy,n.animationState===ly.FadeIn&&vy,n.animationState===ly.FadeOut&&_y])},z(n.text))))},dy="headerBtn",uy=(0,bi.T2)({height:Qt.Ks.rem(1.5),lineHeight:Qt.Ks.rem(1.125),padding:`0 ${Qt.Ks.rem(ti.or)}`,margin:`0 ${Qt.Ks.rem(-ti.or)}`,overflow:"hidden"},dy),py=Qt.Ks.style({display:"flex",alignItems:"center",gap:Qt.Ks.rem(ti.v$+ti.sp),height:Qt.Ks.rem(1.5),fontWeight:400,fontSize:Qt.Ks.rem(.875),lineHeight:Qt.Ks.rem(1.3125),color:si.NeutralGray60,overflow:"hidden"}),my=Qt.Ks.joinClasses([dy,Qt.Ks.style(uy)]),hy=Qt.Ks.style({display:"flex",justifyContent:"space-between",width:"100%",gap:Qt.Ks.rem(ti.or)}),gy=Qt.Ks.style({marginBottom:`-${Qt.Ks.rem(ti.sp)}`,display:"inline-flex",alignItems:"center",justifyContent:"center"}),fy=Qt.Ks.style({overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",textAlign:"left",transitionProperty:"opacity",transitionDuration:Qt.Ks.seconds(.25)}),vy=Qt.Ks.style({opacity:1}),_y=Qt.Ks.style({opacity:0}),by=r.UI.Grid.make((({slots:e,state:t})=>s.createElement(ri.F.Fragment,null,t.pipe(R.T((({resultText:t,statusText:i,isMyVoiceStatus:n,sourceLabel:r,sourceIconUrl:a})=>s.createElement(ol,{"data-testid":"my-voice-in-progress-result",header:s.createElement(s.Fragment,null,e.header,s.createElement(yy,null,s.createElement(cy,{header:t.length>0?r:i,iconUrl:t.length>0?a:o.none,loading:0===t.length}),s.createElement(Yb,{isBadge:!0,isAnimated:!0,isMyVoice:n,label:"Use my style"}))),body:t.length>0?s.createElement(s.Fragment,null,s.createElement(ry,{text:t}),s.createElement(Sy,null)):null,isActive:!0}))))))),yy=({children:e})=>s.createElement("div",{className:ky},e),ky=Qt.Ks.style({display:"grid",gridTemplateColumns:"1fr auto"}),Sy=()=>s.createElement("div",{className:Qt.Ks.style({position:"relative",overflow:"hidden",height:Qt.Ks.rem(.5),borderRadius:Qt.Ks.rem(ni.KD),background:si.NeutralGray10,flexGrow:1})},s.createElement(pp,null)),Cy=(0,ra.yY)(ry),Ey=r.UI.Grid.make((({slots:e,view:t})=>s.createElement(ol,{"aria-busy":"true","data-testid":"in-progress-result",body:s.createElement(Cy,{text:t("text")}),header:s.createElement(s.Fragment,null,e.header,s.createElement(cy,{header:"Working on it...",iconUrl:o.none,loading:!0})),isActive:!0}))),wy=(r.UI.Knot.make(by,{header:zb}),r.UI.Knot.make(Ey,{header:zb})),Ay=r.UI.Union.asOption(wy),Iy=(0,ra.yY)(Eo),xy=({placeholder:e,error:t,openAnswer:i,onOpenAnswerChange:n,onSubmitButtonClick:r,onCancelButtonClick:l,onKeypressShiftEnter:c})=>{const d=s.useContext(Io.D);return s.createElement("form",{className:Fy,onSubmit:e=>e.preventDefault()},s.createElement(Iy,{className:My,placeholder:null!=e?e:void 0,text:i,onChange:n,ariaLabel:"Open ended answer",fitContentHeight:!0,theme:{fontSize:Qt.Ks.rem(.75),lineHeightRems:1.125},useIframeWrapper:d.view((e=>e.useIframeTextfieldWrapper)),onKeyDownShiftEnter:c}),(0,a.pipe)(t,o.fold((()=>null),(e=>s.createElement("div",{className:Oy},e)))),s.createElement("div",{className:Ty},s.createElement("input",{type:"submit",value:"Submit",hidden:!0}),s.createElement(oi.$,{variant:"secondary",style:Ry,onClick:r},"Submit"),s.createElement(oi.$,{variant:"tertiary",style:Ky,onClick:l},"Dismiss")))},Ty=Qt.Ks.style({display:"flex",justifyContent:"flex-start",alignItems:"center"}),Fy=Qt.Ks.style({width:Qt.Ks.percent(100),display:"flex",flexDirection:"column",gap:Qt.Ks.rem(ti.v$)}),Ry={default:{fontSize:Qt.Ks.rem(.75),fontWeight:"bold",marginRight:Qt.Ks.rem(ti.v$),minHeight:Qt.Ks.rem(ti.v5),lineHeight:Qt.Ks.rem(ti.v5)}},Ky={default:{fontSize:Qt.Ks.rem(.75),minHeight:Qt.Ks.rem(ti.v5),lineHeight:Qt.Ks.rem(ti.v5)}},My=Qt.Ks.style({border:`1px solid ${si.NeutralGray10}`,minHeight:Qt.Ks.rem(7.5*ti.or),backgroundColor:si.White,borderRadius:Qt.Ks.rem(ti.v$),width:Qt.Ks.percent(100),padding:`${Qt.Ks.rem(1.25*ti.or)} ${Qt.Ks.rem(ti.v$)}`,boxSizing:"border-box"}),Oy=Qt.Ks.style({color:ii.Q.Background.Critical.Default,fontSize:Qt.Ks.rem(.75),marginBottom:Qt.Ks.rem(ti.or)});var Ny=i(90883);const By=e=>s.createElement(li.hh,Object.assign({width:"18",height:"17",viewBox:"0 0 18 17",fill:"none"},e),s.createElement("path",{d:"M9 1L11.069 6.15226L16.6085 6.52786L12.3477 10.0877L13.7023 15.4721L9 12.52L4.29772 15.4721L5.65228 10.0877L1.39155 6.52786L6.931 6.15226L9 1Z",fill:"transparent",stroke:si.NeutralGray40,strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})),Py=({rating:e,ratingLabels:t,maxScore:i})=>(0,a.pipe)(e,o.fold((()=>t.length>=i&&i>1?s.createElement("div",{className:Uy},s.createElement("span",{className:Ly},t[0]),s.createElement("span",{className:Ly},t[i-1])):null),(e=>e-1>=0&&t.length>=e?s.createElement("div",{className:Dy},s.createElement("span",null,t[e-1])):null))),Dy=Qt.Ks.style({display:"flex",justifyContent:"center",alignItems:"center",width:"100%",fontWeight:"bold",fontSize:Qt.Ks.rem(.75),lineHeight:Qt.Ks.rem(.875)}),Ly=Qt.Ks.style({color:si.NeutralGray40}),Uy=Qt.Ks.style({display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",fontSize:Qt.Ks.rem(.75),lineHeight:Qt.Ks.rem(.875)});const jy=({disabled:e,rating:t,ratingLabels:i,maxScore:n,onSelectionChange:r})=>{const[l,c]=s.useState(o.none),d=s.useMemo((()=>[]),[]),u=t=>{e||r(t+1)},p=t=>{e||c(o.some(t+1))},m=()=>{e||c(o.none)};return s.createElement(s.Fragment,null,s.createElement("div",{className:Vy,style:{gridTemplateColumns:`repeat(${n}, minmax(${Qt.Ks.rem(ti.OE)}, ${Qt.Ks.rem(ti.Ai)}))`},role:"slider","aria-valuemin":0,"aria-valuenow":(0,a.pipe)(t,o.getOrElse((()=>0))),"aria-valuemax":5,"aria-valuetext":(0,a.pipe)(t,o.fold((()=>"Not yet rated"),(e=>i[e-1])))},Array.from({length:n}).map(((r,c)=>s.createElement($y,{key:c,onClick:()=>u(c),isFilled:(0,a.pipe)(t,o.fold((()=>!1),(e=>c<e)))||(0,a.pipe)(l,o.fold((()=>!1),(e=>c<e))),onMouseEnter:()=>p(c),onMouseLeave:m,onFocus:()=>p(c),onBlur:m,isSelected:(0,a.pipe)(t,o.fold((()=>!1),(e=>c+1===e))),isFocusable:(0,a.pipe)(t,o.fold((()=>0===c),(e=>c+1===e))),ariaLabel:`Rate this generated output as ${i[c]}`,ref:e=>d.push(e),onKeyDown:t=>((t,i)=>{var s,r,c,p;e||("ArrowRight"!==t.key&&"ArrowUp"!==t.key||((0,a.pipe)(l,o.fold((()=>!1),(e=>e<n)))?null===(s=d[i+1])||void 0===s||s.focus():null===(r=d[0])||void 0===r||r.focus()),"ArrowLeft"!==t.key&&"ArrowDown"!==t.key||((0,a.pipe)(l,o.fold((()=>!1),(e=>e>1)))?null===(c=d[i-1])||void 0===c||c.focus():null===(p=d[4])||void 0===p||p.focus()),"Enter"!==t.key&&" "!==t.key||u(i))})(t,c),disabled:e})))),s.createElement(Py,{rating:(0,a.pipe)(t,o.fold((0,a.constant)(l),(0,a.constant)(t))),ratingLabels:i,maxScore:n}),s.createElement(Ny.h,{small:!0}))},Vy=Qt.Ks.style({display:"grid",width:Qt.Ks.percent(100),justifyContent:"center"}),$y=s.forwardRef(((e,t)=>{var{isFilled:i,ariaLabel:n,disabled:r,isSelected:o,isFocusable:a}=e,l=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(i[n[s]]=e[n[s]])}return i}(e,["isFilled","ariaLabel","disabled","isSelected","isFocusable"]);return s.createElement("button",Object.assign({className:Hy,role:"radio","aria-label":n,disabled:r,"aria-checked":o,tabIndex:a?0:-1,ref:t},l),s.createElement(By,{className:i?Zy:""}))}));$y.displayName="StarButton";const Hy=Qt.Ks.style({border:"none",background:"none",cursor:"pointer",padding:0,borderRadius:Qt.Ks.rem(ti.or),$nest:{"&:focus-visible":{outlineStyle:"none",boxShadow:`0 0 0 2px ${ii.Q.Text.Base.Subdued}`}}}),Zy=Qt.Ks.style({$nest:{"& path":{fill:si.Gold40,stroke:si.Gold40}}}),Gy=(0,Yt.w)("nocolor",(({title:e,titleId:t,desc:i,descId:n,...r})=>s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:32,height:32,fill:"none",viewBox:"0 0 32 32","aria-hidden":"true",stroke:"transparent","aria-labelledby":t,"aria-describedby":n,...r},i?s.createElement("desc",{id:n},i):null,e?s.createElement("title",{id:t},e):null,s.createElement("path",{fill:"#1C1C1C",d:"M0 16C0 7.163 7.162 0 16.001 0s16 7.163 16 16c0 7.732-5.482 14.183-12.773 15.676-1.042.213-2.121.324-3.222.324H0z"}),s.createElement("path",{fill:"#fff",d:"m19.876 14.484-1.788 2.94h6.02c-.93 5.116-6.62 8.599-12.304 5.653a6.7 6.7 0 0 1-2.861-2.834c-3.27-6.226 1.197-12.49 7.093-12.49a8.19 8.19 0 0 1 6.2 2.839l1.58-2.6a11.08 11.08 0 0 0-8.566-3.148c-5.562.384-10.071 4.994-10.342 10.56-.309 6.393 4.8 11.688 11.124 11.688s11.14-4.999 11.14-11.14c0-.5-.038-.989-.1-1.468z"}))));var Wy=i(43919);const zy=({stage:e,rating:t,initialTitle:i,acknowledgment:n,acknowledgmentTitle:r,onCloseButtonClick:o,className:a})=>s.createElement("div",{className:Qt.Ks.joinClasses([qy,a])},s.createElement(Gy,{className:Jy}),s.createElement(Yy,{stage:e,rating:t,initialTitle:i,acknowledgment:n,acknowledgmentTitle:r}),s.createElement(oi.$,{variant:"tertiary","aria-label":"Close survey",style:{default:{marginLeft:"auto",padding:0,minWidth:Qt.Ks.rem(ti.v5),minHeight:Qt.Ks.rem(ti.v5)},hovered:{backgroundColor:si.NeutralGray10},active:{backgroundColor:si.NeutralGray10}},onClick:o},s.createElement(Wy.A,null))),qy=Qt.Ks.style({display:"flex",alignItems:"center"}),Qy=Qt.Ks.style({fontSize:Qt.Ks.rem(.75)}),Jy=Qt.Ks.style({width:Qt.Ks.rem(1.25),height:Qt.Ks.rem(1.25),marginRight:Qt.Ks.rem(ti.CN)}),Yy=({stage:e,rating:t,initialTitle:i,acknowledgmentTitle:n,acknowledgment:r})=>{switch(e){case yr.Stage.Type.Rating:return s.createElement("span",{className:Qy},i);case yr.Stage.Type.Feedback:return s.createElement("span",{className:Qy},"Your rating:"," ",Array.from({length:t}).map((()=>"")).join(" "));case yr.Stage.Type.Completed:return s.createElement("span",{className:Qy},(0,a.pipe)(n,o.fold((()=>s.createElement("b",null,"Thank you!")),(e=>s.createElement("b",null,e))))," ",(0,a.pipe)(r,o.fold((()=>"Your feedback helps us improve."),(e=>e))));case yr.Stage.Type.Closed:return null;default:return(0,g.AS)(e)}},Xy=r.UI.Union.asOption(r.UI.Node.make((({notify:e,state:t})=>s.createElement(ri.F.Fragment,null,t.pipe(R.T((t=>s.createElement(ek,Object.assign({},t,{onRatingSelectionChange:t=>{e({kind:ft.t.Kind.surveyRatingSelectionChange,rating:t})()},onOpenAnswerChange:t=>e({kind:ft.t.Kind.surveyOpenAnswerChange,openAnswer:t})(),onSubmitButtonClick:e({kind:ft.t.Kind.surveySubmitButtonClick}),onKeypressShiftEnter:e({kind:ft.t.Kind.surveyKeyPressShiftEnter}),onCancelButtonClick:e({kind:ft.t.Kind.surveyCancelButtonClick}),onCloseButtonClick:e({kind:ft.t.Kind.surveyCloseButtonClick})}))))))))),ek=({survey:e,stage:t,transitionStage:i,rating:n,errors:r,openAnswer:l,onOpenAnswerChange:c,onRatingSelectionChange:d,onCloseButtonClick:u,onCancelButtonClick:p,onSubmitButtonClick:m,onKeypressShiftEnter:h})=>s.createElement(qa,{style:tk,"data-testid":`survey-${e.resultId}`},s.createElement(zy,{className:Qt.Ks.joinClasses([i===yr.Stage.Type.Feedback?sk:void 0,t===yr.Stage.Type.Feedback?rk:void 0]),stage:t,rating:(0,a.pipe)(n,o.getOrElse((0,a.constant)(1))),initialTitle:e.title,acknowledgment:e.acknowledgment,acknowledgmentTitle:e.acknowledgmentTitle,onCloseButtonClick:u}),t!==yr.Stage.Type.Completed&&s.createElement(s.Fragment,null,s.createElement("div",{className:Qt.Ks.joinClasses([ok,i===yr.Stage.Type.Feedback?sk:void 0,t===yr.Stage.Type.Feedback?rk:void 0])},s.createElement("div",{className:lk,hidden:t!==yr.Stage.Type.Rating},s.createElement(jy,{onSelectionChange:d,rating:n,disabled:o.isSome(n),maxScore:e.maxScore,ratingLabels:e.ratingLabels})),(0,a.pipe)(e.openAnswer,o.fold((0,a.constant)("(Optional) Please share your feedback to help us improve."),(e=>e.placeholder)),(e=>s.createElement("div",{className:ak,hidden:t!==yr.Stage.Type.Feedback},s.createElement(xy,{placeholder:e,onSubmitButtonClick:m,onKeypressShiftEnter:h,onCancelButtonClick:p,onOpenAnswerChange:c,openAnswer:l,error:(0,a.pipe)(r,o.chain((e=>e.openAnswerError)))}))))))),tk={backgroundColor:si.NeutralGray0,padding:`${Qt.Ks.rem(ti.v$)} ${Qt.Ks.rem(ti.Jj)}`},ik=Qt.Ks.keyframes({from:{opacity:1},to:{opacity:.3}}),nk=Qt.Ks.keyframes({from:{opacity:.3},to:{opacity:1}}),sk=Qt.Ks.style({animation:`${ik} 0.3s ease-in-out`}),rk=Qt.Ks.style({animation:`${nk} 0.3s ease-in-out`}),ok=Qt.Ks.style({display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",marginTop:Qt.Ks.rem(ti.sp)}),ak=Qt.Ks.style({width:Qt.Ks.percent(100)}),lk=Qt.Ks.style({maxWidth:Qt.Ks.percent(100),width:"fit-content",paddingTop:Qt.Ks.rem(ti.or)}),ck=(0,Yt.w)("color",(({title:e,titleId:t,desc:i,descId:n,...r})=>s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16","aria-hidden":"true",stroke:"transparent","aria-labelledby":t,"aria-describedby":n,...r},i?s.createElement("desc",{id:n},i):null,e?s.createElement("title",{id:t},e):null,s.createElement("path",{stroke:"#646B81",strokeLinecap:"round",strokeLinejoin:"round",d:"M7.053 10.842v1.908c0 .69.56 1.25 1.25 1.25h4.447c.69 0 1.25-.56 1.25-1.25V8.303c0-.69-.56-1.25-1.25-1.25h-1.908M8.947 3.25v4.447c0 .69-.56 1.25-1.25 1.25H3.25c-.69 0-1.25-.56-1.25-1.25V3.25C2 2.56 2.56 2 3.25 2h4.447c.69 0 1.25.56 1.25 1.25"}))));var dk=i(90718);const uk=(0,Yt.w)("color",(({title:e,titleId:t,desc:i,descId:n,...r})=>s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16","aria-hidden":"true",stroke:"transparent","aria-labelledby":t,"aria-describedby":n,...r},i?s.createElement("desc",{id:n},i):null,e?s.createElement("title",{id:t},e):null,s.createElement("path",{stroke:"#646B81",d:"M4.25 5.692h7.5M4.25 8h7.5M4 10.956V13l2.667-2.044h6.084c.69 0 1.249-.56 1.249-1.25V4.25C14 3.56 13.44 3 12.75 3h-9.5C2.56 3 2 3.56 2 4.25v5.456c0 .69.56 1.25 1.25 1.25z"})))),pk=(0,Yt.w)("color",(({title:e,titleId:t,desc:i,descId:n,...r})=>s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16","aria-hidden":"true",stroke:"transparent","aria-labelledby":t,"aria-describedby":n,...r},i?s.createElement("desc",{id:n},i):null,e?s.createElement("title",{id:t},e):null,s.createElement("path",{stroke:"#646B81",strokeLinecap:"round",strokeLinejoin:"round",d:"M3 2v1.161M3 14V9.355m0 0h10l-2.963-3.097L13 3.161H3m0 6.194V3.16"})))),mk=({reportMenuButtonClassName:e,onClickReportOffensive:t,onClickProvideFeedback:i,onOpenChange:n,onDismiss:r,promptResultLabel:o})=>s.createElement(av,{title:"Open more response options",name:"dismissReportMenu",label:s.createElement(vi,null,s.createElement(Jt.I,{icon:dk.$,accessibilityLabel:""})),buttonClass:e,onAction:e=>{switch(e){case"provideFeedback":return i();case"reportOffensive":return t();case"dismissResult":return r()}},onOpenChange:n},s.createElement(gu.q7,{key:"dismissResult","aria-label":`Delete ${o} output`,textValue:"dismissResult"},s.createElement(vi,{className:hk},s.createElement(Jt.I,{icon:Vf.C,accessibilityLabel:""})),s.createElement(ia.E,{as:"span",variant:"text-small"},"Delete")),s.createElement(gu.q7,{key:"provideFeedback","aria-label":`Give feedback on ${o} output`,textValue:"provideFeedback"},s.createElement(vi,{className:hk},s.createElement(Jt.I,{icon:uk,accessibilityLabel:""})),s.createElement(ia.E,{as:"span",variant:"text-small"},"Give feedback")),s.createElement(gu.q7,{key:"reportOffensive","aria-label":`Report offensive content for ${o} output`,textValue:"reportOffensive"},s.createElement(vi,{className:hk},s.createElement(Jt.I,{icon:pk,accessibilityLabel:""})),s.createElement(ia.E,{as:"span",variant:"text-small"},"Report offensive content"))),hk=Qt.Ks.style({height:Qt.Ks.rem(1.5),width:Qt.Ks.rem(1.5),margin:`0 ${Qt.Ks.rem(ti.v$)} 0 ${Qt.Ks.rem(-ti.or)}`}),gk=({onInsert:e,onRephrase:t,onDismiss:i,onCopy:n,onProvideFeedback:r,onReportOffensive:l,onReportMenuVisibilityChange:c,disabled:d,isActive:u,resultLabel:p})=>{const m=o.isSome(t)||o.isSome(e),h=s.createElement(mk,{reportMenuButtonClassName:yk,onClickProvideFeedback:r,onClickReportOffensive:l,onOpenChange:c,onDismiss:i,promptResultLabel:p});return s.createElement("div",{className:fk},s.createElement("div",{className:_k},(0,a.pipe)(e,o.map((e=>s.createElement(oi.$,{"aria-label":`Insert ${p} output into your document`,name:"insertResult",onClick:e,size:"large",key:"insert",variant:u?"primary":"secondary",textPosition:"everywhere"},s.createElement("div",{className:Qt.Ks.style({position:"relative"})},s.createElement("div",{className:Qt.Ks.style({fontWeight:"bold",visibility:"hidden"})},"Insert"),s.createElement("div",{className:Qt.Ks.style({position:"absolute",top:0,left:0,right:0})},"Insert"))))),o.toNullable),(0,a.pipe)(t,o.map((e=>s.createElement(oi.$,{"aria-label":`Retry ${p}`,variant:"tertiary",name:"rephraseResult",onClick:e,disabled:d,size:"large",key:"rephrase"},"Retry"))),o.toNullable),s.createElement(ri.F.Fragment,null,m?h:null)),s.createElement(ri.F.div,{className:bk},m?null:h,(0,a.pipe)(n,o.map((e=>s.createElement(oi.$,{"aria-label":`Copy ${p} output`,name:"copyResult",onClick:e,size:"large",variant:"tertiary",title:"Copy result"},s.createElement("div",{className:Qt.Ks.style({height:Qt.Ks.rem(1),width:Qt.Ks.rem(1),display:"flex",justifyContent:"center",alignItems:"center"})},s.createElement(ck,{width:"1rem",height:"1rem"}))))),o.toNullable)))},fk=Qt.Ks.style({gap:Qt.Ks.rem(ti.v$),display:"flex",alignItems:"center",justifyContent:"space-between"}),vk={display:"flex",alignItems:"center",gap:Qt.Ks.rem(ti.v$)},_k=Qt.Ks.style(vk),bk=Qt.Ks.style(vk),yk="reportBtn",kk=r.UI.Grid.make((({state:e,notify:t,slots:i})=>s.createElement(ri.F.Fragment,null,e.pipe(R.T((({disabled:e,result:n,originalAction:r})=>s.createElement(ol,{"data-testid":`ai-notification-${n.id}`,body:s.createElement(s.Fragment,null,s.createElement("div",{className:Qt.Ks.style({borderBottom:`0.5px solid ${si.NeutralGray10}`})},s.createElement(ry,{text:n.text}),s.createElement("div",{className:Qt.Ks.style({display:"flex",flexDirection:"row",flexWrap:"wrap",gap:Qt.Ks.rem(.5),marginTop:Qt.Ks.rem(.5),marginBottom:Qt.Ks.rem(.75)})},i.actions)),(0,a.pipe)(r,o.map((i=>s.createElement("div",null,s.createElement(ry,{text:"Continue with your original prompt:"}),s.createElement("div",{className:Qt.Ks.style({paddingTop:Qt.Ks.rem(.125)})},s.createElement(Sk,{disabled:e,action:i,onClick:t({kind:ft.t.Kind.userPromptSubmit,prompt:i})}))))),o.toNullable)),header:s.createElement("h2",{className:Qt.Ks.style({fontSize:Qt.Ks.rem(1),marginBottom:Qt.Ks.rem(.2),marginTop:0,lineHeight:Qt.Ks.rem(1.5)})},"Review your AI use"),isActive:!0,footer:s.createElement(gk,{isActive:!1,onRephrase:o.none,onInsert:o.none,onCopy:o.none,onDismiss:t({kind:ft.t.Kind.resultCardDismissButtonClick,result:n}),onProvideFeedback:t({kind:ft.t.Kind.openFeedbackFormButtonClick,source:Il.Source.resultCard}),onReportOffensive:t({kind:ft.t.Kind.reportOffensiveResultButtonClick,result:n}),onReportMenuVisibilityChange:e=>t({kind:ft.t.Kind.reportMenuVisibilityChange,trigger:Tr.card(n.id),visible:e})(),disabled:e,resultLabel:n.header.label}),style:{borderColor:si.Gold40,borderTopWidth:Qt.Ks.rem(.375)}}))))))),Sk=({action:e,onClick:t,disabled:i})=>s.createElement("button",{onClick:t,disabled:i,className:Qt.Ks.style({textDecoration:"underline",color:si.NeutralGray60,background:Qt.Ks.important("none"),border:"none",cursor:"pointer",lineHeight:Qt.Ks.rem(1.375),fontSize:Qt.Ks.rem(.875),overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",width:"100%",textAlign:"left"})},'"',e.arg.value,'"'),Ck=r.UI.List.make(C.QW,Ea),Ek=r.UI.Knot.make(kk,{actions:Ck}),wk=({title:e,url:t,contextText:i})=>{const n=s.useRef(null),r=_v(n,e),l=(0,a.pipe)(i,o.getOrElse((()=>r)));return(0,a.pipe)(t,o.fold((()=>s.createElement(xk,{tooltip:l},s.createElement("span",{className:Ak,ref:n},e))),(t=>s.createElement(xk,{tooltip:l},s.createElement("div",{className:Ik},s.createElement(vv.G,{href:t,className:Ak,ref:n},e))))))},Ak=Qt.Ks.style({display:"inline-block",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",textAlign:"left",maxWidth:"100%",$nest:{"&:visited":{color:"inherit"}}}),Ik=Qt.Ks.style({display:"flex",alignItems:"center",width:"100%",overflow:"hidden"}),xk=({children:e,tooltip:t})=>t?s.createElement(Gm.m_,{align:"topCenter",title:s.createElement("div",{className:Tk},t)},e):s.createElement(s.Fragment,null,e),Tk=Qt.Ks.style({maxWidth:Qt.Ks.rem(80*ti.or),textAlign:"left",whiteSpace:"normal",overflow:"hidden",display:"-webkit-box","-webkit-line-clamp":5,"-webkit-box-orient":"vertical"}),Fk=(0,Yt.w)("color",(({title:e,titleId:t,desc:i,descId:n,...r})=>s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16","aria-hidden":"true",stroke:"transparent","aria-labelledby":t,"aria-describedby":n,...r},i?s.createElement("desc",{id:n},i):null,e?s.createElement("title",{id:t},e):null,s.createElement("path",{stroke:"#646B81",d:"M5.818 2.429A5.92 5.92 0 0 0 2 8a6 6 0 0 0 3.857 5.606m4.286-11.177C12.398 3.29 14 5.44 14 8a5.97 5.97 0 0 1-3.824 5.606M2.546 2h3.272v3.273M13.455 14h-3.273v-3.273"})))),Rk={minWidth:Qt.Ks.rem(1.5),minHeight:Qt.Ks.rem(1.5),lineHeight:Qt.Ks.rem(1.5)},Kk=({onRegenerateWithoutReference:e})=>s.createElement(Qm,{name:"referenceMenu",title:"Reference menu","aria-label":"Reference menu",label:s.createElement(dk.$,null),theme:{buttonStyle:{default:Object.assign({padding:0},Rk),icon:Rk}},onAction:t=>{if("regenerateWithoutReference"===t)return e()}},s.createElement(gu.q7,{key:"regenerateWithoutReference",textValue:"regenerateWithoutReference"},s.createElement(Fk,{className:Mk}),"Regenerate without this reference")),Mk=Qt.Ks.style({marginRight:Qt.Ks.rem(ti.v$)}),Ok=({label:e,variant:t})=>s.createElement(ei.v,{variant:t,label:e}),Nk=({privacyLevel:e})=>{switch(e.kind){case"public":return s.createElement(Bk,null);case"restricted":return s.createElement(Pk,null);default:return(0,a.absurd)(e)}},Bk=()=>s.createElement(s.Fragment,null),Pk=()=>s.createElement(Gm.m_,{align:"topLeft",title:s.createElement("div",{className:Dk},"This item has restricted access and is only visible to those added to the file")},s.createElement(Ok,{variant:"neutral",label:"Private"})),Dk=Qt.Ks.style({width:Qt.Ks.rem(9),overflowWrap:"normal",whiteSpace:"normal",textAlign:"left"}),Lk=(0,ra.yY)(oi.$),Uk=({className:e,isOpen:t,references:i,onOpenChange:n,onRegenerateWithoutReference:r,onReferencesMount:o,onReferencesUnmount:l})=>{const{onMount:c}=(0,po.y)((0,a.flow)(P.M(o),co.j(l)));return s.createElement(ri.F.div,{className:e,mount:c},s.createElement(Lk,{variant:"tertiary",style:jk,onClick:()=>n(!t),name:"collapseReferencesList",size:"small"},s.createElement("span",{className:$k},i.length," ",gt.td(i.length,"reference","references")),s.createElement(Fv,null,t?s.createElement(Tv,null):s.createElement(xv,null))),s.createElement("ul",{className:Hk,hidden:!t,"aria-hidden":!t},i.map((({id:e,privacyLevel:t,title:i,iconUrl:n,url:o,contextText:a},l)=>s.createElement("li",{key:l,className:Zk},s.createElement("img",{src:n,className:Gk,alt:""}),s.createElement(wk,{title:i,url:o,contextText:a}),s.createElement("div",{className:Wk},s.createElement(Nk,{privacyLevel:t}),void 0!==r?s.createElement(Kk,{onRegenerateWithoutReference:()=>r(e)}):null))))))},jk={default:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",paddingLeft:Qt.Ks.rem(ti.v$),paddingRight:Qt.Ks.rem(ti.v$)}},Vk={fontSize:Qt.Ks.rem(ti.CN),lineHeight:Qt.Ks.rem(ti.Jj+ti.sp),color:ii.Q.Text.Base.Subdued,userSelect:"none"},$k=Qt.Ks.style(Vk),Hk=Qt.Ks.style({fontSize:Qt.Ks.rem(ti.CN),lineHeight:Qt.Ks.rem(ti.Jj+ti.sp),color:ii.Q.Text.Base.Default,margin:0,padding:0}),Zk=Qt.Ks.style({height:Qt.Ks.rem(ti.v5),display:"flex",alignItems:"center",borderRadius:Qt.Ks.rem(ni.KD)}),Gk=Qt.Ks.style({minWidth:Qt.Ks.rem(ti.Jj),height:Qt.Ks.rem(ti.Jj),marginRight:Qt.Ks.rem(ti.v$)}),Wk=Qt.Ks.style({display:"flex",alignItems:"center",justifyContent:"space-between",marginLeft:"auto"});var zk,qk=i(88105);!function(e){e.generatedText="generatedText",e.knowledgeHubTerm="knowledgeHubTerm",e.none="none"}(zk||(zk={}));const Qk=({insertOp:e})=>{const t=Jk(e.attributes),i=Yk(e.attributes);switch(t){case zk.generatedText:return s.createElement(nS,{style:i},e.insert);case zk.knowledgeHubTerm:return s.createElement(sS,{style:i},e.insert);case zk.none:return iS(e.attributes)?s.createElement(oS,{style:i,href:e.attributes.link},e.insert):s.createElement(rS,{style:i},e.insert);default:return(0,a.absurd)(t)}},Jk=e=>{switch(!0){case null==e?void 0:e[cS.knowledgeHubTerm]:return zk.knowledgeHubTerm;case null==e?void 0:e[cS.generatedText]:return zk.generatedText;default:return zk.none}},Yk=e=>{const t={};return Xk(e)&&(t.fontWeight="bold"),eS(e)&&(t.fontStyle="italic"),tS(e)&&(t.textDecoration="underline"),iS(e)&&(t.color=si.Blue60),t},Xk=e=>!0===(null==e?void 0:e.bold),eS=e=>!0===(null==e?void 0:e.italic),tS=e=>!0===(null==e?void 0:e.underline),iS=e=>"string"==typeof(null==e?void 0:e.link),nS=({children:e,style:t})=>s.createElement("span",{className:aS,style:t},e),sS=({children:e,style:t})=>s.createElement(Gm.m_,{title:"from Knowledge Share"},s.createElement("span",{className:lS,style:t},e)),rS=({children:e,style:t})=>s.createElement("span",{style:t},e),oS=({children:e,style:t,href:i})=>s.createElement("a",{style:t,href:i,target:"_blank",rel:"noreferrer"},e),aS=Qt.Ks.style({backgroundColor:si.Green0,borderRadius:Qt.Ks.rem(ni.M6)}),lS=Qt.Ks.style({backgroundColor:si.Blue0,borderRadius:Qt.Ks.rem(ni.M6)});var cS;!function(e){e.generatedText="generatedText",e.knowledgeHubTerm="knowledgeHubTerm"}(cS||(cS={}));const dS=({replacementDelta:e})=>s.createElement(sy,null,e.map(((e,t)=>qk.E.isInsert(e)?s.createElement(Qk,{key:t,insertOp:e}):null))),uS=({className:e,title:t,description:i})=>s.createElement("div",{className:Qt.Ks.joinClasses([pS,e])},s.createElement("div",{className:mS},s.createElement("span",{className:vS},t)),s.createElement("ul",{className:hS},i.map(((e,t)=>s.createElement("li",{className:gS,key:t},s.createElement(fm.l,{className:fS}),s.createElement("span",{className:_S},e)))))),pS=Qt.Ks.style({display:"flex",flexDirection:"column"}),mS=Qt.Ks.style({display:"flex"}),hS=Qt.Ks.style({display:"flex",flexDirection:"column",listStyle:"none",margin:0,padding:0,$nest:{"& li":{marginTop:Qt.Ks.rem(ti.or)}}}),gS=Qt.Ks.style({display:"flex",alignItems:"center"}),fS=Qt.Ks.style({marginRight:Qt.Ks.rem(ti.v$),width:Qt.Ks.rem(ti.Jj),maxHeight:Qt.Ks.rem(ti.Jj+ti.sp),$nest:{"& path:first-of-type":{stroke:si.Green60}}}),vS=Qt.Ks.style({fontSize:Qt.Ks.rem(ti.CN),lineHeight:Qt.Ks.rem(ti.Jj+ti.sp),fontWeight:700,color:ii.Q.Text.Base.Subdued}),_S=Qt.Ks.style({fontSize:Qt.Ks.rem(ti.CN),lineHeight:Qt.Ks.rem(ti.Jj+ti.sp),color:ii.Q.Text.Base.Subdued,flex:1});var bS;!function(e){e.searchLabel="searchLabel",e.clickableSearchLabel="clickableSearchLabel",e.knowledgeHub="knowledgeHub"}(bS||(bS={})),r.UI.Union.asOption(r.UI.Node.make((({notify:e,state:t})=>s.createElement(ri.F.Fragment,null,t.pipe(R.T((t=>s.createElement(Yb,{key:"voiceButton",isMyVoice:t.selectedVoice===le.Q.GeneratedTextVoice.user,onClick:e({kind:ft.t.Kind.resultCardToggleGenericVoiceButtonClick,resultId:t.resultId,voice:t.selectedVoice})}))))))));const yS=r.UI.Node.make((({notify:e,state:t})=>s.createElement(ri.F.div,{className:kS},t.pipe(R.T((t=>{switch(t.kind){case bS.clickableSearchLabel:return s.createElement(ay,{header:t.label,disabled:t.disabled,onClick:e({kind:ft.t.Kind.resultCardHeaderClick,prompt:t.copiablePrompt})});case bS.searchLabel:return s.createElement(cy,{header:t.label,iconUrl:t.iconUrl,loading:!1});case bS.knowledgeHub:return s.createElement(cy,{header:"Knowledge Share content was used.",iconUrl:o.none,loading:!1});default:return(0,g.AS)(t)}})))))),kS=Qt.Ks.style({display:"grid",gridTemplateColumns:"1fr auto",gap:Qt.Ks.rem(ti.v$)}),SS=r.UI.Grid.make((({slots:e,state:t,notify:i})=>{const{notifyUnmount:n}=s.useContext(mo);return s.createElement(ri.F.Fragment,null,t.pipe(R.T((({result:t,disabled:r,isActive:l,isReferencesOpen:c,isMyVoice:d})=>s.createElement(ol,{"data-testid":`result-${t.id}`,body:s.createElement(dS,{replacementDelta:(0,a.pipe)(t.replacementDelta,S.fold(a.identity,(e=>d?e.user:e.generic)))}),header:s.createElement(s.Fragment,null,e.contextHeader,e.header),footer:s.createElement(s.Fragment,null,s.createElement(gk,{isActive:l,onRephrase:(0,a.pipe)(t,o.fromPredicate(le.Q.isComplete),o.filter((e=>e.supportedActions.has(le.Q.SupportedAction.rephrase))),o.map((e=>i({kind:ft.t.Kind.resultCardRephraseButtonClick,result:e,selectedVoice:d?le.Q.GeneratedTextVoice.user:le.Q.GeneratedTextVoice.generic})))),onInsert:(0,a.pipe)(o.some(i({kind:ft.t.Kind.resultCardInsertButtonClick,result:t,selectedVoice:d?le.Q.GeneratedTextVoice.user:le.Q.GeneratedTextVoice.generic})),o.filter((()=>t.supportedActions.has(le.Q.SupportedAction.insert)))),onCopy:(0,a.pipe)(o.some(i({kind:ft.t.Kind.resultCardCopyButtonClick,result:t,selectedVoice:d?le.Q.GeneratedTextVoice.user:le.Q.GeneratedTextVoice.generic})),o.filter((()=>t.supportedActions.has(le.Q.SupportedAction.copy)))),onDismiss:i({kind:ft.t.Kind.resultCardDismissButtonClick,result:t}),onProvideFeedback:i({kind:ft.t.Kind.openFeedbackFormButtonClick,source:Il.Source.resultCard}),onReportOffensive:i({kind:ft.t.Kind.reportOffensiveResultButtonClick,result:t}),onReportMenuVisibilityChange:e=>i({kind:ft.t.Kind.reportMenuVisibilityChange,trigger:Tr.card(t.id),visible:e})(),disabled:r,resultLabel:t.header.label}),(0,a.pipe)(t.references,o.filter((e=>e.length>0)),o.map((e=>s.createElement(Uk,{className:wS,isOpen:c,references:e,onOpenChange:e=>i({kind:ft.t.Kind.referencesVisibilityChange,visible:e,resultId:t.id})(),onRegenerateWithoutReference:le.Q.isComplete(t)?e=>i({kind:ft.t.Kind.regenerateWithoutReferenceButtonClick,result:t,referenceId:e,selectedVoice:d?le.Q.GeneratedTextVoice.user:le.Q.GeneratedTextVoice.generic})():void 0,onReferencesMount:e=>i({kind:ft.t.Kind.mount,name:Et.e.referencesList,element:e})(),onReferencesUnmount:()=>n({kind:ft.t.Kind.unmount,name:Et.e.referencesList})}))),o.toNullable),(0,a.pipe)(le.Q.isComplete(t)?t.changesSummary:o.none,o.map((e=>s.createElement(uS,{title:e.title,description:e.description,className:ES}))),o.toNullable)),isActive:l,onHovered:e=>i({kind:ft.t.Kind.resultCardHoverChange,hovered:e,resultId:t.id})(),onFocused:e=>i({kind:ft.t.Kind.resultCardFocusChange,focused:e,resultId:t.id})(),onCopy:i({kind:ft.t.Kind.resultCardCopyToClipboard,result:t,selectedVoice:d?le.Q.GeneratedTextVoice.user:le.Q.GeneratedTextVoice.generic})})))))})),CS=r.UI.Knot.make(SS,{header:yS,contextHeader:zb}),ES=Qt.Ks.style({marginBottom:Qt.Ks.rem(ti.or)}),wS=Qt.Ks.style({marginTop:Qt.Ks.rem(ti.v$)}),AS=r.UI.Union.make("kind",{promptResultComplete:CS,aiUsageNotification:Ek}),IS=r.UI.List.make(C.QW,AS),xS=r.UI.Group.make({results:IS}),TS=r.UI.Union.make("kind",{none:r.UI.Node.empty,loading:r.UI.Knot.make(Ey,{header:r.UI.Node.empty}),loaded:xS}),FS=Qt.Ks.style({display:"grid",height:"100%",alignItems:"end"}),RS=r.UI.Grid.make((({slots:e})=>s.createElement("div",{className:FS},e.documentOverview,e.intent,e.resultList,e.lastResultSurvey,e.inProgressResult,e.generationError,e.detectedReferences))),KS=r.UI.Knot.make(RS,{documentOverview:Yf,intent:mv,resultList:TS,lastResultSurvey:Xy,inProgressResult:Ay,generationError:Zf,detectedReferences:Sv}),MS=r.UI.Group.make({toneReport:Ah}),OS=r.UI.Union.asOption(lm),NS=r.UI.Union.asOption(Lf),BS=r.UI.Union.make("kind",{home:Ob,thread:KS,error:Zf,followUpPrompt:gc,legacyVoiceProfile:Ag,voiceProfile:df,feedbackForm:rc,skill:Om,settings:gm,toneReport:MS,plagiarism:OS,writingExpert:NS,performanceScore:Qc,signedOut:ym}),PS=e=>s.createElement(li.hh,Object.assign({width:"17",height:"16",viewBox:"0 0 17 16"},e),s.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.5 8C2.5 4.41015 5.41015 1.5 9 1.5C12.5899 1.5 15.5 4.41015 15.5 8C15.5 11.5899 12.5899 14.5 9 14.5C7.85901 14.5 6.73812 14.1997 5.75 13.6292C5.51085 13.4911 5.42892 13.1853 5.56699 12.9462C5.70506 12.707 6.01085 12.6251 6.25 12.7631C7.08611 13.2459 8.03455 13.5 9 13.5C9.96545 13.5 10.9139 13.2459 11.75 12.7631C12.5861 12.2804 13.2804 11.5861 13.7631 10.75C14.2459 9.91389 14.5 8.96545 14.5 8C14.5 4.96243 12.0376 2.5 9 2.5C5.96243 2.5 3.5 4.96243 3.5 8V8.29289L4.64645 7.14645C4.84171 6.95118 5.15829 6.95118 5.35355 7.14645C5.54882 7.34171 5.54882 7.65829 5.35355 7.85355L3.35355 9.85355L3 10.2071L2.64645 9.85355L0.646447 7.85355C0.451184 7.65829 0.451184 7.34171 0.646447 7.14645C0.841709 6.95118 1.15829 6.95118 1.35355 7.14645L2.5 8.29289V8ZM9 4C9.27614 4 9.5 4.22386 9.5 4.5V7.5H11.5C11.7761 7.5 12 7.72386 12 8C12 8.27614 11.7761 8.5 11.5 8.5H9H8.5V8V4.5C8.5 4.22386 8.72386 4 9 4Z",stroke:"none"})),DS=r.UI.Node.make((({state:e,view:t,notify:i})=>{const{notifyUnmount:n}=s.useContext(mo),{onMount:r}=(0,po.y)((0,a.flow)(P.M((e=>i({kind:ft.t.Kind.mount,name:Et.e.historyButton,element:e})())),d.n((e=>t("state").pipe(R.T((e=>"enabled"===e)),ut.Z(!1),I.F(),Ht.J(),P.M((([t,n])=>{!t&&n?i({kind:ft.t.Kind.mount,name:Et.e.historyButtonActive,element:e})():t&&!n&&i({kind:ft.t.Kind.unmount,name:Et.e.historyButtonActive})()}))))),co.j((()=>{n({kind:ft.t.Kind.unmount,name:Et.e.historyButton}),n({kind:ft.t.Kind.unmount,name:Et.e.historyButtonActive})}))));return s.createElement("div",{className:US},s.createElement(oi.$,{"aria-label":"Open recent prompt history",variant:"tertiary",mount:r,onClick:i({kind:ft.t.Kind.restoreHistoryButtonClick}),disabled:t("state").pipe(R.T((e=>"disabled"===e||"loading"===e))),compact:!0,size:"small",name:"restoreHistory",title:e.pipe(R.T((({state:e})=>"disabled"===e?"No prior prompt to go back to.":"enabled"===e?"Pick up with your last prompt.":void 0)))},s.createElement(PS,null)),s.createElement(ri.F.Fragment,null,e.pipe(R.T((({state:e})=>"disabled"!==e?s.createElement("div",{key:"badge",role:"presentation",className:jS}):null)))))})),LS=r.UI.Union.asOption(DS),US=Qt.Ks.style({position:"relative"}),jS=Qt.Ks.style({width:Qt.Ks.rem(.375),height:Qt.Ks.rem(.375),borderRadius:Qt.Ks.rem(.375),background:yi.A.BrandGreen60,position:"absolute",top:Qt.Ks.rem(ti.sp),right:Qt.Ks.rem(-ti.sp)}),VS=2*qt.or,$S=2*qt.vW,HS="New!",ZS=()=>s.createElement(ei.v,{variant:"success",label:HS}),GS=s.forwardRef((function({icon:e,label:t,ariaLabel:i,ariaExpanded:n,badge:r,className:o,mount:l,onClick:c},d){return s.createElement(oi.$,{variant:"tertiary",onClick:c,name:"actionBrick",size:"small",style:zS,className:o,mount:l,"aria-label":i||t,"aria-expanded":n},(0,a.pipe)(e,S.fold((e=>"more"===e?s.createElement(ci,{"aria-hidden":!0}):"plagiarism"===e||"plagiarismDetected"===e?s.createElement(gi,{"aria-hidden":!0}):"plagiarismAndAiDetector"===e?s.createElement(mi,{"aria-hidden":!0}):"writingExpert"===e?s.createElement(fi,{"aria-hidden":!0}):"performanceScoreEmpty"===e?s.createElement(ui,{"aria-hidden":!0}):"performanceScoreSome"===e?s.createElement(di,{"aria-hidden":!0}):"performanceScoreSuccess"===e?s.createElement(pi,{"aria-hidden":!0}):"humanWritingReport"===e?s.createElement(vi,null,s.createElement(Jt.I,{icon:Xt,accessibilityLabel:""})):(0,g.AS)(e)),(e=>s.createElement("img",{src:e,style:{width:Qt.Ks.rem(WS.iconWidthRems),height:Qt.Ks.rem(1)},"aria-hidden":!0})))),s.createElement("div",{className:QS},s.createElement(ri.F.div,Object.assign({mount:d},z(t),{className:qS})),"new"===r&&s.createElement(ZS,null)))})),WS={gapRems:ti.or,badgeLeftMarginRems:ti.v$,paddingLeftRems:ti.or,paddingRightRems:ti.v$,fontSizeRems:.75,fontFamily:"Inter",fontWeight:"normal",iconWidthRems:1},zS={default:{fontSize:Qt.Ks.rem(WS.fontSizeRems),fontFamily:WS.fontFamily,fontWeight:WS.fontWeight,gap:Qt.Ks.rem(WS.gapRems),padding:`0 ${Qt.Ks.rem(WS.paddingRightRems)} 0 ${Qt.Ks.rem(WS.paddingLeftRems)}`},icon:(0,bi.QD)(WS.iconWidthRems)},qS=Qt.Ks.style({whiteSpace:"initial",textAlign:"left",lineHeight:Qt.Ks.rem(1.125)}),QS=Qt.Ks.style({display:"flex",alignItems:"center",gap:Qt.Ks.rem(WS.badgeLeftMarginRems)}),JS=({style:e,iconStyle:t,mode:i="standard"})=>{const n="standard"===i?1:.875;return s.createElement("div",{className:Qt.Ks.style({height:Qt.Ks.rem(2*n),display:"flex",alignItems:"center",gap:Qt.Ks.rem(ti.v$),padding:`0 ${Qt.Ks.rem(ti.v$)} 0 ${Qt.Ks.rem(ti.or)}`,borderRadius:Qt.Ks.rem(ti.or),border:`1px solid ${si.NeutralGray10}`,boxSizing:"border-box"},e)},s.createElement("div",{className:Qt.Ks.style({width:Qt.Ks.rem(1.5*n),height:Qt.Ks.rem(1.5*n),borderRadius:"50%",background:si.NeutralGray10},t)}),s.createElement("div",{className:Qt.Ks.style({height:Qt.Ks.rem(.5*n),borderRadius:Qt.Ks.rem(ti.vW),background:si.NeutralGray10,flexGrow:1})}))},YS=({widthRems:e})=>s.createElement(JS,{style:{width:Qt.Ks.rem(e),height:Qt.Ks.rem(1.5),border:0},iconStyle:{width:Qt.Ks.rem(1),height:Qt.Ks.rem(1)}}),XS=ti.Jj,eC=()=>s.createElement("div",{role:"separator",className:Qt.Ks.style({width:Qt.Ks.rem(XS),height:Qt.Ks.rem(1.5),position:"relative"})},s.createElement("div",{className:Qt.Ks.style({position:"absolute",top:0,bottom:0,left:"50%",borderLeft:`0.5px solid ${si.NeutralGray20}`})}));let tC=null;function iC(e,t){tC||(tC=document.createElement("canvas"));const i=tC.getContext("2d");return i?(i.font=t,i.measureText(e).width):null}const nC=({loading:e,actions:t,className:i,onShownActionsListLengthChange:n,onHasHiddenActionsChange:r,onActionClick:c,onActionMount:d,onActionsMount:u})=>{const{onMount:p,ref:h}=jt.R.useElWatcher(),f=Ya(h,!0),v=s.useContext(lo.q.Context),_=s.useMemo((()=>Ct.zV([f,v,t]).pipe(R.T((([e,t,i])=>({width:(0,a.pipe)(e,o.map((e=>Math.round(e.width)))),remSize:t,actions:i}))),M.skipBy(U.OW({width:o.getEq(U.US),remSize:U.US,actions:C.nZ(U.ee(((e,t)=>e.action.label===t.action.label)))})),R.T((({width:e,remSize:t,actions:i})=>(0,a.pipe)(e,o.map((e=>function(e,t,i){const n=[];let s=0;for(let r=0;r<e.length;++r){const l=(0,a.pipe)(o.toNullable(e[r].action.badge),(e=>null!==e?(0,a.pipe)(iC("new"===e?HS:(0,g.AS)(e),i.badgeFontStyle),(e=>e?e+i.badgeHorizontalPadding+i.badgeHorizontalBorderWidth+i.badgeLeftMargin:null)):0)),c=iC(e[r].action.label,i.labelFontStyle),d=null===c||null===l?null:c+l+i.horizontalPadding+(n.length>0?i.actionGap:0);null!==d&&s+d<=t&&(s+=d,n.push(e[r]))}return n}(i,e,{horizontalPadding:oC(t),actionGap:XS*t,labelFontStyle:aC(t),badgeHorizontalPadding:VS*t,badgeHorizontalBorderWidth:$S*t,badgeLeftMargin:WS.badgeLeftMarginRems*t,badgeFontStyle:aC(t)})))))),M.shareReplay({refCount:!0,bufferSize:1}))),[t,f,v]),b=s.useMemo((()=>Ct.zV([_,t,e]).pipe(m.p((([e,t,i])=>!1===i)),R.T((([e,t])=>(0,a.pipe)(e,o.fold((()=>0),(e=>e.length)),(e=>(n(e),e<t.length))))),I.F(),P.M((e=>r(e))))),[_,t]);jt.R.useSubscriptionTo(b);const y=s.useRef(new l.B7),k=s.useRef([]);return jt.R.useSubscriptionTo(y.current.pipe(Pi.QE(Qo.X),B.Z(0),P.M((()=>{u(),k.current.forEach((({a:e,idx:t})=>d(e,t)))})))),s.createElement(ri.F.div,{className:Qt.Ks.joinClasses([sC,i]),mount:p},Ct.zV([_,e]).pipe(P.M((()=>k.current=[])),R.T((([e,t])=>(0,a.pipe)(e,o.filter((()=>!t)),o.fold((()=>s.createElement(ri.F.Fragment,null,Ct.zV([f,v]).pipe(R.T((([e,t])=>(0,a.pipe)(e,o.map((e=>({width:Math.floor(e.width),remSize:t})))))),M.skipBy(o.getEq(U.OW({width:U.US,remSize:U.US}))),R.T(o.fold(a.constNull,(({width:e,remSize:t})=>{const i=15+XS,n=9/i,r=6/i,o=e/t-XS,a=Math.min(n*o,9),l=Math.min(r*o,6);return s.createElement(s.Fragment,null,s.createElement(YS,{widthRems:a}),s.createElement(eC,null),s.createElement(YS,{widthRems:l}))})))))),(e=>s.createElement("div",{className:rC},e.map(((e,t)=>s.createElement(s.Fragment,{key:e.action.id},t>0?s.createElement(eC,null):null,s.createElement(GS,{icon:e.action.icon,label:e.action.label,badge:o.toUndefined(e.action.badge),onClick:()=>c(e,t),ref:i=>{i&&(k.current.push({a:e,idx:t}),y.current.next())}}))))))))))))},sC=Qt.Ks.style({display:"flex",height:Qt.Ks.rem(1.5)}),rC=Qt.Ks.style({display:"flex",height:Qt.Ks.rem(1.5)});function oC(e){return(WS.paddingLeftRems+WS.iconWidthRems+WS.gapRems+WS.paddingRightRems)*e}function aC(e){return`${WS.fontWeight} ${WS.fontSizeRems*e}px ${WS.fontFamily}`}const lC=r.UI.Grid.make((({slots:e,view:t,notify:i})=>{const n=s.useMemo((()=>f.s.create(!1)),[]),r=s.useMemo((()=>f.s.create(0)),[]),{refCallback:o}=Jo(),{notifyUnmount:l}=s.useContext(mo),{onMount:c}=(0,po.y)((0,a.flow)(P.M((e=>i({kind:ft.t.Kind.mount,name:Et.e.actionsMoreButton,element:e})())),co.j((()=>{l({kind:ft.t.Kind.unmount,name:Et.e.actionsMoreButton})}))));return s.createElement("section",{className:uC,"data-testid":"actions-bar"},s.createElement("div",{className:dC},e.header),s.createElement(nC,{className:pC,loading:t("loading"),actions:t("actions"),onActionClick:(e,t)=>i({kind:ft.t.Kind.actionBrickClick,action:e,placement:"homeView",position:t})(),onActionMount:(e,t)=>{i({kind:ft.t.Kind.actionBrickMount,action:e,placement:"homeView",position:t})(),i({kind:ft.t.Kind.actionBrickShow,action:e,placement:"homeView",position:t})()},onShownActionsListLengthChange:p.H9(r),onHasHiddenActionsChange:p.H9(n),onActionsMount:i({kind:ft.t.Kind.actionsMount})}),s.createElement(ri.F.div,{className:cC},Ct.zV([t("hasMore"),t("expanded"),n,r]).pipe(R.T((([e,n,r,l])=>e||r?s.createElement(s.Fragment,null,s.createElement(GS,{icon:S.left("more"),label:"More",ariaLabel:"Explore or write your own idea",ariaExpanded:n,onClick:i({kind:ft.t.Kind.actionBrickClick,action:{kind:"allResults",filterPredicate:a.constTrue},placement:"homeView",position:l}),mount:c,ref:o(i({kind:ft.t.Kind.actionBrickMount,action:{kind:"allResults",filterPredicate:a.constTrue},placement:"homeView",position:l}),i({kind:ft.t.Kind.actionBrickShow,action:{kind:"allResults",filterPredicate:a.constTrue},placement:"homeView",position:l}))}),s.createElement(ri.F.Fragment,null,t("hasHistoryButton").pipe(R.T((0,j.Sw)(s.createElement(eC,null),null))))):null))),e.historyButton))})),cC=Qt.Ks.style({gridArea:"controls",display:"flex",flexDirection:"row"}),dC=Qt.Ks.style({gridArea:"header"}),uC=Qt.Ks.style({display:"grid",gridTemplateColumns:"1fr auto",gridTemplateRows:"auto auto",gridTemplateAreas:'"header header" "actions controls"',gridColumnGap:Qt.Ks.rem(ti.v$),alignItems:"center",padding:`${Qt.Ks.rem(ti.or)} ${Qt.Ks.rem(ti.Jj)}`,margin:`${Qt.Ks.rem(ti.v$)} 0`}),pC=Qt.Ks.style({gridArea:"actions",display:"flex",height:Qt.Ks.rem(1.5)}),mC=()=>s.createElement(JS,{style:{width:Qt.Ks.rem(7.75),height:Qt.Ks.rem(2.5),border:0,gap:Qt.Ks.rem(.875),marginLeft:Qt.Ks.rem(1)},iconStyle:{width:Qt.Ks.rem(1.25),height:Qt.Ks.rem(1.25)}}),hC=r.UI.Grid.make((({slots:e,state:t,notify:i})=>{const{refCallback:n}=Jo(),{onMount:r}=(0,po.y)(P.M(i({kind:ft.t.Kind.actionsMount}))),{notifyUnmount:l}=s.useContext(mo),{onMount:c}=(0,po.y)((0,a.flow)(P.M((e=>i({kind:ft.t.Kind.mount,name:Et.e.actionsMoreButton,element:e})())),co.j((()=>{l({kind:ft.t.Kind.unmount,name:Et.e.actionsMoreButton})}))));return s.createElement(ri.F.div,{className:gC,"data-testid":"actions-panel"},e.header,t.pipe(R.T((({loading:t,actions:l,hasMore:d,maxActionsCount:u})=>t?Array.from({length:u+1}).map(((e,t)=>s.createElement(s.Fragment,{key:t},0!==t?s.createElement(Yo,null):null,s.createElement(mC,null)))):s.createElement(s.Fragment,null,s.createElement("div",{ref:r,className:bC},l.map(((e,t)=>{const r=o.toUndefined(e.action.badge),a=e.action.label,l=r?`${a}, ${r}`:a;return s.createElement(s.Fragment,{key:e.action.id},0!==t&&s.createElement(Yo,null),s.createElement(Ci,{icon:e.action.icon,label:a,ariaLabel:l,badge:r,isUphook:e.action.isUphook,onClick:i({kind:ft.t.Kind.actionBrickClick,action:e,position:t,placement:"threadView"}),ref:n(i({kind:ft.t.Kind.actionBrickMount,action:e,position:t,placement:"threadView"}),i({kind:ft.t.Kind.actionBrickShow,action:e,position:t,placement:"threadView"}))}))}))),d?s.createElement(s.Fragment,null,s.createElement(Yo,null),s.createElement("div",{className:fC},s.createElement(Ci,{icon:S.left("more"),label:"More ideas",ariaLabel:"Explore or write your own idea",mount:c,onClick:i({kind:ft.t.Kind.actionBrickClick,action:{kind:"allResults",filterPredicate:a.constTrue},position:l.length,placement:"threadView"}),ref:n(i({kind:ft.t.Kind.actionBrickMount,action:{kind:"allResults",filterPredicate:a.constTrue},position:l.length,placement:"threadView"}),i({kind:ft.t.Kind.actionBrickShow,action:{kind:"allResults",filterPredicate:a.constTrue},position:l.length,placement:"threadView"})),style:vC}),s.createElement("div",{className:_C},e.historyButton))):null)))))})),gC=Qt.Ks.style({display:"flex",flexDirection:"column",marginTop:Qt.Ks.rem(ti.v$),marginBottom:Qt.Ks.rem(ti.v$)}),fC=Qt.Ks.style({position:"relative"}),vC={default:{width:"100%"}},_C=Qt.Ks.style({position:"absolute",right:Qt.Ks.rem(ti.Jj),bottom:"50%",transform:"translateY(50%)"}),bC=Qt.Ks.style({display:"flex",flexDirection:"column"}),yC=e=>s.createElement(li.hh,Object.assign({width:"20",height:"20",viewBox:"0 0 20 20",fill:"none"},e),s.createElement("circle",{cx:"10",cy:"10",r:"6",stroke:"#646B81"}),s.createElement("path",{d:"M7.5 10H12.5",stroke:"#646B81",strokeLinecap:"round"})),kC=r.UI.Node.make((({view:e,notify:t})=>s.createElement("div",{className:CC},s.createElement($b,{active:!0,style:EC,prefix:"Work with:"},e("selectedText")),s.createElement(oi.$,{variant:"tertiary",onClick:t({kind:ft.t.Kind.removeSelectionContextClick}),compact:!0,size:"small",name:"removeContext",title:"Remove","aria-label":"Remove the selected context for the prompt","aria-describedby":"actions-panel-context"},s.createElement(yC,null))))),SC=r.UI.Union.asOption(kC),CC=Qt.Ks.style({display:"flex",alignItems:"center",justifyContent:"space-between",gap:Qt.Ks.rem(ti.v$)}),EC={height:Qt.Ks.rem(2.5)},wC=r.UI.Node.make((({view:e})=>s.createElement(s.Fragment,null,s.createElement(ri.F.h1,{className:FC},e("title")),s.createElement(ri.F.Fragment,null,e("subtitle").pipe(R.T((e=>e?s.createElement("p",{className:RC},e):null))))))),AC=r.UI.Union.make("kind",{none:r.UI.Node.empty,title:wC,selectionContext:r.UI.Composite.make(r.UI.Grid.make((({slots:e})=>s.createElement("div",{className:KC},e.header))),kC)}),IC=r.UI.Knot.make(lC,{header:SC,historyButton:LS}),xC=r.UI.Knot.make(hC,{header:AC,historyButton:LS}),TC=r.UI.Union.make("kind",{none:r.UI.Node.empty,actionBar:IC,actionPanel:xC}),FC=Qt.Ks.style({padding:Qt.Ks.rem(ti.v$),paddingLeft:Qt.Ks.rem(ti.Jj),margin:0,fontWeight:700,fontSize:Qt.Ks.rem(1),lineHeight:"1.5em",color:ii.Q.Text.Base.Default}),RC=Qt.Ks.style({padding:`0 ${Qt.Ks.rem(ti.v$)} ${Qt.Ks.rem(ti.v$)} ${Qt.Ks.rem(ti.Jj)}`,margin:0,fontSize:Qt.Ks.rem(.875),lineHeight:"1.5em",color:ii.Q.Text.Base.Subdued}),KC=Qt.Ks.style({padding:`0 ${Qt.Ks.rem(ti.CN)} 0 ${Qt.Ks.rem(ti.Jj)}`}),MC=r.UI.Grid.make((({slots:e})=>s.createElement(ri.F.section,{className:NC},e.header,e.fieldContainer))),OC=r.UI.Knot.make(MC,{header:TC,fieldContainer:$a}),NC=Qt.Ks.style({backgroundColor:yi.A.BackgroundBaseSubdued,borderTop:`0.5px solid ${yi.A.BorderBaseSubduedColor}`,height:"100%",borderBottomLeftRadius:"inherit",borderBottomRightRadius:"inherit",boxSizing:"border-box"}),BC=r.UI.Union.make("kind",{none:r.UI.Node.empty,skill:Om,promptStudio:OC}),PC=(0,Yt.w)("color",(({title:e,titleId:t,desc:i,descId:n,...r})=>s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16","aria-hidden":"true",stroke:"transparent","aria-labelledby":t,"aria-describedby":n,...r},i?s.createElement("desc",{id:n},i):null,e?s.createElement("title",{id:t},e):null,s.createElement("path",{stroke:"#646B81",strokeLinecap:"round",d:"M2 8h12m0 0L9.448 3M14 8l-4.552 5"})))),DC=e=>e>0?`Return home to review ${e} ${gt.td(e,"suggestion","suggestions")}`:"Return home",LC=r.UI.Node.make((({state:e,notify:t})=>s.createElement(ri.F.Fragment,null,e.pipe(R.T((({disabled:e,label:i,count:n})=>s.createElement(oi.$,{"aria-label":DC(n),disabled:e,name:"suggestions-counter-button",onClick:t({kind:"suggestionCountButtonClick"}),size:"small",title:i,variant:"tertiary"},s.createElement(Fv,null,s.createElement(PC,{className:UC})),n>0?`${n} ${gt.td(n,"suggestion","suggestions")}`:null))))))),UC=Qt.Ks.style({$nest:{"& path":{transform:"rotate(180deg)",transformOrigin:"center"}}}),jC=e=>s.createElement(li.hh,Object.assign({width:"20",height:"20",viewBox:"0 0 20 20"},e),s.createElement("g",{id:"icon"},s.createElement("g",{id:"Vector"},s.createElement("path",{d:"M14.6429 3.92857L14.607 3.96447C13.3023 5.26917 11.0714 4.34512 11.0714 2.5H8.92857C8.92857 4.34512 6.69774 5.26917 5.39304 3.96447L5.35714 3.92857L3.92857 5.35714L3.96447 5.39304C5.26917 6.69774 4.34512 8.92857 2.5 8.92857V11.0714C4.34512 11.0714 5.26917 13.3023 3.96447 14.607L3.92857 14.6429L5.35714 16.0714L5.39304 16.0355C6.69774 14.7308 8.92857 15.6549 8.92857 17.5H11.0714C11.0714 15.6549 13.3023 14.7308 14.607 16.0355L14.6429 16.0714L16.0714 14.6429L16.0355 14.607C14.7308 13.3023 15.6549 11.0714 17.5 11.0714V8.92857C15.6549 8.92857 14.7308 6.69774 16.0355 5.39304L16.0714 5.35714L14.6429 3.92857Z",fill:"none",strokeLinejoin:"round"}),s.createElement("path",{d:"M12.5 10C12.5 11.3807 11.3807 12.5 10 12.5C8.61929 12.5 7.5 11.3807 7.5 10C7.5 8.61929 8.61929 7.5 10 7.5C11.3807 7.5 12.5 8.61929 12.5 10Z",fill:"none",strokeLinejoin:"round"})))),VC=r.UI.Node.make((({notify:e})=>s.createElement(oi.$,{variant:"tertiary",onClick:t=>{t&&G(t.currentTarget)&&e({kind:ft.t.Kind.settingsButtonClick,buttonRect:t.currentTarget.getBoundingClientRect()})()},compact:!0,size:"small",name:"settings","aria-label":"Open Settings",title:"Settings"},s.createElement(jC,null)))),$C=r.UI.Union.asOption(VC),HC=r.UI.Node.make((({notify:e})=>s.createElement(oi.$,{variant:"tertiary",style:GC,onClick:e({kind:ft.t.Kind.headerVoiceButtonClick}),name:"headerVoiceProfileButton",size:"small",title:"My voice","aria-label":"Open my voice profile"},s.createElement(Ab,null)))),ZC=r.UI.Union.asOption(HC),GC={default:{padding:0},icon:(0,bi.QD)(1.5)},WC=(0,ra.yY)(oi.$),zC=r.UI.Node.make((({notify:e,view:t})=>s.createElement("div",{className:QC},s.createElement(WC,{variant:"tertiary",compact:!0,onClick:t("activeView").pipe(R.T((t=>e({kind:ft.t.Kind.headerGoBackButtonClick,goBackFrom:t})))),size:"small",title:"Back to Home","aria-label":"Back to Home",name:"goBack"},s.createElement(Fv,null,s.createElement(PC,{className:qC}))),s.createElement(ri.F.div,{className:JC},t("activeViewIconUrl").pipe(R.T(o.fold(a.constNull,(e=>s.createElement("img",{src:e,style:{width:Qt.Ks.rem(1.25),height:Qt.Ks.rem(1.25)},alt:"","aria-hidden":"true"}))))))))),qC=Qt.Ks.style({$nest:{"& path":{transform:"rotate(180deg)",transformOrigin:"center"}}}),QC=Qt.Ks.style({display:"flex",alignItems:"center",gap:Qt.Ks.rem(ti.v$),color:si.NeutralGray60,fontWeight:400,fontSize:Qt.Ks.rem(.75),lineHeight:Qt.Ks.rem(1.125)}),JC=Qt.Ks.style({display:"flex",alignItems:"center",gap:Qt.Ks.rem(ti.v$)}),YC=e=>s.createElement(li.hh,Object.assign({width:"16",height:"16",viewBox:"0 0 16 16",fill:"none"},e),s.createElement("path",{d:"M4 4L8 8M12 12L8 8M8 8L12 4M8 8L4 12",stroke:"#646B81",strokeLinecap:"round"})),XC=r.UI.Node.make((({notify:e})=>s.createElement(oi.$,{variant:"tertiary",onClick:e({kind:ft.t.Kind.headerCloseButtonClick}),compact:!0,size:"small",name:"headerClose",title:"Close Grammarly Assistant","aria-label":"Close Grammarly Assistant"},s.createElement(YC,null))));var eE=i(82718);const tE=(0,Yt.w)("nocolor",(({title:e,titleId:t,desc:i,descId:n,...r})=>s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16","aria-hidden":"true",stroke:"transparent","aria-labelledby":t,"aria-describedby":n,...r},i?s.createElement("desc",{id:n},i):null,e?s.createElement("title",{id:t},e):null,s.createElement("path",{fill:"#D31332",fillRule:"evenodd",d:"M6.586 2.414a2 2 0 0 1 2.828 0l4.172 4.172a2 2 0 0 1 0 2.828l-4.172 4.172a2 2 0 0 1-2.828 0L2.414 9.414a2 2 0 0 1 0-2.828zM8 4.25a.75.75 0 0 1 .75.75v3.5a.75.75 0 1 1-1.5 0V5A.75.75 0 0 1 8 4.25m0 7.25A.75.75 0 1 0 8 10a.75.75 0 0 0 0 1.5",clipRule:"evenodd"}))));var iE=i(13991);const nE=e=>s.createElement(li.hh,Object.assign({width:"24",height:"24",viewBox:"0 0 24 24"},e),s.createElement("path",{d:"M14.256,7.346C15.403,7.699 16.301,8.597 16.654,9.744C16.759,10.085 17.241,10.085 17.346,9.744C17.699,8.597 18.597,7.699 19.744,7.346C20.085,7.241 20.085,6.759 19.744,6.654C18.597,6.301 17.699,5.403 17.346,4.256C17.241,3.915 16.759,3.915 16.654,4.256C16.301,5.403 15.403,6.301 14.256,6.654C13.915,6.759 13.915,7.241 14.256,7.346ZM17,5.339C17.392,6.034 17.967,6.608 18.661,7C17.967,7.392 17.392,7.966 17,8.661C16.608,7.967 16.034,7.392 15.339,7C16.034,6.608 16.608,6.034 17,5.339Z",fill:"inherit",stroke:"none"}),s.createElement("path",{d:"M6.426,13.577C8.338,14.165 9.835,15.662 10.423,17.574C10.598,18.142 11.402,18.142 11.577,17.574C12.165,15.662 13.662,14.165 15.574,13.577C16.142,13.402 16.142,12.598 15.574,12.423C13.662,11.835 12.165,10.338 11.577,8.426C11.402,7.858 10.598,7.858 10.423,8.426C9.835,10.338 8.338,11.835 6.426,12.423C5.858,12.598 5.858,13.402 6.426,13.577ZM11,9.69C11.693,11.138 12.862,12.307 14.31,13C12.862,13.693 11.693,14.862 11,16.31C10.307,14.862 9.138,13.693 7.69,13C9.138,12.307 10.307,11.138 11,9.69Z",fill:"inherit",stroke:"none"})),sE=e=>s.createElement(li.hh,Object.assign({width:"24",height:"24",viewBox:"0 0 24 24"},e),s.createElement("path",{d:"M6.426,13.577C8.338,14.165 9.835,15.662 10.423,17.574C10.598,18.142 11.402,18.142 11.577,17.574C12.165,15.662 13.662,14.165 15.574,13.577C16.142,13.402 16.142,12.598 15.574,12.423C13.662,11.835 12.165,10.338 11.577,8.426C11.402,7.858 10.598,7.858 10.423,8.426C9.835,10.338 8.338,11.835 6.426,12.423C5.858,12.598 5.858,13.402 6.426,13.577ZM11,9.69C11.693,11.138 12.862,12.307 14.31,13C12.862,13.693 11.693,14.862 11,16.31C10.307,14.862 9.138,13.693 7.69,13C9.138,12.307 10.307,11.138 11,9.69Z",fill:"inherit",stroke:"none"})),rE=r.UI.Node.make((({state:e,notify:t})=>{const{ref:i,onMount:n}=jt.R.useElWatcher(),r=s.useMemo((()=>i.pipe(N.oE,d.n((e=>Zt.R(e,"mouseenter").pipe(eE.K(u.of(null).pipe(yd.c(500),_n.Q(Zt.R(e,"mouseleave"))))))),P.M(t({kind:ft.t.Kind.creditsInfoHover})))),[i]);jt.R.useSubscriptionTo(r);const{onMount:o}=(0,po.y)(P.M((e=>t({kind:ft.t.Kind.mount,name:Et.e.creditsInfoButton,element:e})())));return s.createElement(ri.F.Fragment,null,e.pipe(R.T((({user:e,genAIAvailability:i,isGrammarlyPro:r})=>{let a;const l=r?"Pro":"Premium";if(v.y.isActive(i)){const[t,n]=function(e){const t=`${Number(e.promptsRemaining).toLocaleString()}/${Number(e.promptsAllocated).toLocaleString()} prompts left. `,i=v.y.Active.daysUntilRefillDate(e.refillDate),n=v.y.Active.hoursUntilRefillDate(e.refillDate);return i>0?[t,`Next refill in ${i} ${gt.td(i,"day","days")}.`]:n>0?[t,`Next refill in ${n} ${gt.td(n,"hour","hours")}.`]:[t,"Next refill in less than an hour."]}(i);a=v.y.isActive(i)?s.createElement(s.Fragment,null,t,s.createElement("br",null),n):fe(e)?"To get more prompts, contact support.":`To get more prompts, upgrade to ${l}.`}else a=fe(e)?"To get more prompts, contact support.":`To get more prompts, upgrade to ${l}.`;const c=s.createElement(oE,{promptsRemaining:i.promptsRemaining});return fe(e)&&v.y.isActive(i)?s.createElement(s.Fragment,null,v.y.isActiveUnlimited(i)?null:s.createElement(Gm.m_,{title:a},s.createElement("div",{ref:n,className:lE},c))):s.createElement("div",{ref:n},s.createElement(oi.$,{variant:"tertiary",compact:!0,onClick:t({kind:ft.t.Kind.creditsInfoClick}),size:"small",title:a,name:"creditsInfo",mount:o,textPosition:"everywhere"},c))}))))})),oE=({promptsRemaining:e})=>e<50?s.createElement("div",{className:cE},s.createElement(sE,{className:pE}),0===e?s.createElement(tE,{className:mE}):s.createElement(iE.M,{className:mE})):s.createElement(nE,{className:pE}),aE=r.UI.Union.asOption(rE),lE=Qt.Ks.style({cursor:"help"}),cE=Qt.Ks.style({position:"relative"}),dE=(0,bi.QD)(1.5),uE=(0,bi.QD)(.75),pE=Qt.Ks.style(dE),mE=Qt.Ks.style(Object.assign(Object.assign({},uE),{top:Qt.Ks.rem(1/16),right:0,position:"absolute"})),hE=e=>s.createElement(li.hh,{className:e.className,viewBox:"0 0 20 20",width:22,height:22},s.createElement("path",{d:"M0 10C0 4.478 4.459 0 9.96 0c5.502 0 9.96 4.477 9.96 10 0 4.833-3.412 8.864-7.95 9.797A9.937 9.937 0 0 1 9.962 20H0V10Z",fill:"#027E6F",stroke:"none"}),s.createElement("path",{d:"M16.853 9.053h-4.489l-1.057 1.838h3.701c-.58 3.197-4.12 5.374-7.66 3.533a4.175 4.175 0 0 1-1.78-1.771c-2.036-3.892.745-7.807 4.415-7.807 1.513 0 2.875.665 3.811 1.72l.949-1.65a6.881 6.881 0 0 0-5.25-1.888c-3.462.24-6.269 3.121-6.438 6.6-.192 3.996 2.989 7.305 6.925 7.305 3.937 0 6.935-3.124 6.935-6.963 0-.312-.024-.618-.063-.917Z",fill:"#fff",stroke:"none"})),gE=({className:e})=>s.createElement(hE,{className:Qt.Ks.joinClasses([fE,e])}),fE=Qt.Ks.style(Object.assign({display:"flex",alignItems:"center",justifyContent:"center"},(0,bi.QD)(1.375))),vE=r.UI.Node.make((({view:e})=>s.createElement(ri.F.Fragment,null,e("version").pipe(R.T(o.fold((()=>s.createElement(gE,null)),(e=>s.createElement("div",{className:_E},s.createElement(gE,null),s.createElement("small",null,`v${e}`))))))))),_E=Qt.Ks.style({display:"flex",alignItems:"center",gap:Qt.Ks.rem(.5)}),bE=r.UI.Node.make((({state:e})=>s.createElement(ri.F.h2,{className:kE},e))),yE=r.UI.Union.asOption(bE),kE=Qt.Ks.style({textAlign:"center",fontSize:Qt.Ks.rem(.75),fontWeight:700,lineHeight:Qt.Ks.rem(1.125)}),SE=r.UI.Knot.make(r.UI.Grid.make((({slots:e})=>s.createElement("div",{className:FE},e.button))),{button:LC}),CE=r.UI.Union.make("kind",{logoOnly:vE,suggestionCount:SE,backButton:zC}),EE=r.UI.Grid.make((({slots:e})=>s.createElement("div",{className:xE},e.credits,e.voiceButton,e.settingsButton,e.closeButton))),wE=r.UI.Knot.make(EE,{voiceButton:ZC,credits:aE,settingsButton:$C,closeButton:XC}),AE=r.UI.Grid.make((({slots:e})=>s.createElement(s.Fragment,null,e.left,s.createElement("div",{className:TE},e.pageTitle),e.right))),IE=r.UI.Knot.make(AE,{left:CE,pageTitle:yE,right:wE}),xE=Qt.Ks.style(Object.assign(Object.assign({},{display:"flex",alignItems:"center"}),{gap:Qt.Ks.rem(ti.or)})),TE=Qt.Ks.style({flexGrow:1}),FE=Qt.Ks.style({marginLeft:Qt.Ks.rem(-ti.or)}),RE=r.UI.Knot.make(Al,{a11yNotification:$r,header:IE,content:BS,footer:BC,notifications:no,onboarding:ao});function KE(e){return()=>e.a11y.state.view()}function ME(e){return r.n.composeKnot({content:(t=e.notifications,r.n.composeList(C.Q1,(()=>t.state.view(C.BE)),(e=>function(e,t){return r.n.fromSideEffect((e=>{switch(e.kind){case"dismissNotification":return t.dismiss(e.id);case"mouseOver":return t.hover(!0);case"mouseOut":return t.hover(!1);default:(0,g.AS)(e)}}),e)}(e,t))))});var t}var OE=i(11298);function NE(e){return(0,a.flow)(OE.u(),(t=>{return Li.h(t.pipe((i=e.logger,n=e.lifecycle,(0,a.flow)(m.p(Cl),P.M((e=>{n.onVisuallyReady({content:e.element})})),R.T((e=>o.some(e.element))),jt.R.FocusTrap.dynamicFocusTrap(jt.R.FocusTrap.InitialFocus.none,Wt,zt(i)),Qn.w()))),t.pipe(function(e){return(0,a.flow)(m.p(El),h.s(1),P.M((t=>{e.onReadyToDrag({dragHandle:t.element})})),Qn.w())}(e.lifecycle)),t.pipe(function(e){return(0,a.flow)(m.p(Sl),P.M((t=>e.onFocusStateChange({isFocused:t.focused}))),Qn.w())}(e.lifecycle)),t.pipe(function(e){return(0,a.flow)(m.p(wl),P.M((t=>e.onSizeChange({width:t.rect.width,height:t.rect.height}))),Qn.w())}(e.lifecycle)),f.s.combine(e.assistant.state.view("canScroll"),function(e){return f.s.combine(e.assistant.state.view("genAISession"),e.promptActions.state.view("contextualActions"),e.userSurvey.state,e.routing.activeView,((e,t,i,n)=>(0,a.pipe)(e,o.chain(oe.toStarted),o.filter((()=>"thread"===n.kind)),o.map((e=>{const n=(0,a.pipe)(e.inProgressResult,o.fold((()=>""),(e=>e.text))),s=`${e.results.length}`,r=o.isSome(i.activeSurvey),l=(0,a.pipe)(t,o.fold((()=>""),(0,a.flow)((e=>e.actions),C.$M(5),C.Tj((e=>e.id)),(e=>e.join("-")))));return`${n}_${s}_${r}_${l}`})))))}(e),e.promptMenu.state,f.s.combine(e.lifecycle.heightBehavior,e.textEditor.state.view("hasBeenNonEmpty"),e.routing.activeView.view("kind"),(0,a.pipe)(e.revision,o.fold((()=>f.s.create(null).view()),(e=>e.feedForm.state.view("feedForm")))),((t,i,n,s)=>"fitContent"===t.kind?Object.assign(Object.assign({},t),{height:BE(t,n,s,i,e.experience)}):t)),e.lifecycle.widthBehavior,e.lifecycle.dragBehavior,((e,t,i,n,s,r)=>({canScrollContent:e,menuRef:(0,a.pipe)(i,o.chain((e=>e.promptMenuContainer))),scrollContentToBottomToken:t,heightBehavior:n,widthBehavior:s,dragBehavior:r}))));var i,n}))}function BE(e,t,i,n,s){return void 0!==e.height?e.height:"plagiarism"===t||"writingExpert"===t||"home"===t&&"longForm"===i&&("genAIAndRevision"===s&&(0,a.pipe)(n,o.exists(a.identity))||"revision"===s)?e.maxHeight:e.height}function PE(e){return r.n.fromSideEffect((t=>e.notify(t)),f.s.combine(e.feedbackForm.stagingFeedbackFormData,e.feedbackForm.domain,((e,t)=>{var i;return{formData:e,domain:t,source:null!==(i=null==e?void 0:e.source)&&void 0!==i?i:Il.Source.resultCard}})))}function DE(e){return r.n.composeOption(function(e){return r.n.fromSideEffect((t=>e.notify(t)),e.assistant.state.view("selectedAction").view(o.chain((e=>(0,a.pipe)(e.args[0].hints,o.map((t=>({header:e.label,iconUrl:e.icon.right,hintsHeader:t.header,hintsItems:t.items,radioOptions:Q.match({string:()=>o.none,radio:e=>o.some(e.radioOptions)})(e.args[0])}))))))).pipe(N.oE))}(e),(()=>e.assistant.state.view("selectedAction").view(o.chain((e=>e.args[0].hints)))))}const LE=()=>u.of(null);function UE({revision:e,textEditor:t,user:i}){return r.n.composeOption((0,a.pipe)(e,o.fold((()=>LE),(e=>{return n={performanceScore:e.performanceScore.performanceScore.pipe(N.oE),isTextEmpty:t.state.view("textLength").view(o.exists((e=>e<=0))),userInstitutionInfo:i.institutionInfo,onPerformanceScoreReportMount:t=>e.performanceScore.onPerformanceScoreReportMount(t)},r.n.composeKnot({root:r.n.fromSideEffect((e=>n.onPerformanceScoreReportMount(e.score)),n.performanceScore),overallScore:()=>Ct.zV([n.performanceScore,n.isTextEmpty]).pipe(R.T((([e,t])=>t?{status:"tooSmall"}:e))),outcomeScores:()=>Ct.zV([n.performanceScore,n.isTextEmpty,n.userInstitutionInfo]).pipe(R.T((([e,t,i])=>({score:e,isTextEmpty:t,styleGuideEnabled:(0,a.pipe)(i,o.exists((e=>!!e.styleGuideEnabled))),institutionLogoUrl:(0,a.pipe)(i,o.chain((e=>o.fromNullable(e.logoUrl))))}))))});var n}))),(()=>(0,a.pipe)(e,o.fold((()=>u.of(o.none)),(e=>e.performanceScore.performanceScore)))))}function jE(e){return void 0!==e.find((e=>"applyAlerts"===e.type||"removeAlerts"===e.type))}function VE(e,t){return i=>(0,a.pipe)(e||t?dn.cK.map(i,(i=>"button"!==i.type?i:e&&i.name.value===String(Nn.A7.ButtonPrev)||t&&i.name.value===String(Nn.A7.ButtonNext)?Object.assign(Object.assign({},i),{state:Nn.w.Disabled}):i)):o.some(i),o.getOrElse((()=>i)))}const $E=e=>(0,a.pipe)(dn.cK.map(e,(e=>"button"!==e.type?e:e.name.value===String(Nn.A7.ButtonPrev)||e.name.value===String(Nn.A7.ButtonNext)?Object.assign(Object.assign({},e),{state:Nn.w.Hidden}):e)),o.getOrElse((()=>e)));function HE(e,t,i,n,s){return r.n.fromSideEffect((i=>{switch(i.kind){case"longFormCardSduiNotify":return jE(i.actions)&&t.onSuggestionAddressed(),e.processActions(i.actions,i.item,i.scope,i.sourceId);case"longFormCardMount":return e.onItemMount(i.isFocused,i.item);case ft.t.Kind.actionsMenuMuteClick:case ft.t.Kind.actionsMenuReportIncorrectClick:case ft.t.Kind.actionsMenuReportOffensiveClick:case ft.t.Kind.addToDictionaryClick:case ft.t.Kind.suggestionAcceptClick:case ft.t.Kind.suggestionDismissClick:return s&&s(i);default:(0,g.AS)(i)}}),Ct.zV([i.pipe(R.T(o.chain((e=>(0,a.pipe)(o.fromNullable(e.items[n]),o.map((t=>({feedState:e,item:t}))))))),N.oE),e.isWaitingForAlertsToBeApplied]).pipe(R.T((([{feedState:e,item:t},i])=>{const s=(0,a.pipe)(e.focusedItemId,o.exists((e=>t.id===e)));return{item:s?Object.assign(Object.assign({},t),{content:(0,a.pipe)(t.content,VE(0===n,n===e.items.length-1),$E)}):t,prevFocusedItemPosition:(0,a.pipe)(e.prevFocusedItemPosition,o.filter((()=>s))),isFirst:0===n,isLast:n===e.items.length-1,isFocused:s,isWaitingForAlertsToBeApplied:i}})),M.skipBy(Cu)))}function ZE(e,t){return i=>t.pipe(R.T(o.fold((()=>[]),(e=>e.items))),Or.w("length"),d.n((n=>Ct.zV(n.map(((n,s)=>(i=>n=>function(e,t,i,n,s){return r.n.composeKnot({root:()=>i.pipe(R.T(o.chain((e=>(0,a.pipe)(o.fromNullable(e.items[n]),o.map((t=>({itemId:t.id,isFocused:(0,a.pipe)(e.focusedItemId,o.exists((e=>t.id===e)))}))))))),N.oE,M.skipBy(Pu)),content:r.n.animatingFlow(HE(e,t,i,n,s),((e,t)=>(0,a.pipe)(e,o.filter((e=>!e.isFocused&&t.isFocused)),o.chain((()=>(0,a.pipe)(t.prevFocusedItemPosition,o.map((e=>e<0?gs.WP("collapseForward","expandForward"):gs.WP("collapseBackward","expandBackward")))))))))})}(e.feed,e.suggestionCount,t,n,e.notify)(i.pipe(m.p((e=>e.key===n)),R.T((e=>e.action)))))(i)(s)))))))}function GE(e){return e.pipe(Xn.S(((e,t)=>(0,a.pipe)(t,o.map((t=>({items:En(t.collection),focusedItemId:(0,a.pipe)(wn(t.collection),o.map((e=>e.id))),focusedItemIndex:An(t.collection),prevFocusedItemPosition:(0,a.pipe)(e,o.chain((e=>(0,a.pipe)(k.Jq(o.option)({prevIdx:e.focusedItemIndex,currIdx:An(t.collection)}),o.chain((e=>e.prevIdx===e.currIdx?o.none:e.prevIdx<e.currIdx?o.some(-1):o.some(1))),o.alt((()=>e.prevFocusedItemPosition))))))}))))),o.none))}function WE(e,t,i){return r.n.fromSideEffect((n=>{switch(n.kind){case"uphookShow":e.uphook.onUphookShow(t,i);break;case"uphookClick":e.uphook.onUphookClick(t,i);break;default:(0,g.AS)(n)}}),u.of({isGrammarlyPro:e.uphook.isGrammarlyPro,isEligibleForFreeTrial:e.uphook.isEligibleForFreeTrial,isInProductDiscounts:e.uphook.isInProductDiscounts}))}function zE(e){return r.n.fromSideEffect((e=>(0,g.AS)(e)),e.plagiarism.state.view((e=>({aiDetectorEnabled:"plagiarismAndAiDetector"===e.kind}))))}function qE(e){return r.n.fromSideEffect((t=>{switch(t.kind){case"seeAllSuggestions":return e.plagiarism.seeAllSuggestions();case"plagiarismFeedSuccessMountAction":return e.feed.onSuccessStateMount();default:(0,g.AS)(t)}}),e.plagiarism.state.view((e=>({aiDetectorScore:"plagiarismAndAiDetector"===e.kind?(0,a.pipe)(e.state,o.chain((e=>e.aiDetectorScore))):o.none}))))}function QE(e){const t=GE(e.feed.feed).pipe(M.shareReplay({bufferSize:1,refCount:!0}));return r.n.composeKnot({root:r.n.fromSideEffect((t=>{switch(t.kind){case"plagiarismFeedMount":return e.feed.onFeedMount();case"sduiCitationDropdownSelect":return e.plagiarism.onCitationDropdownSelect(t.actions,t.sourceId);case"sduiCitationDropdownOpen":return e.plagiarism.onCitationDropdownOpen(t.currentSourceId);default:(0,g.AS)(t)}}),f.s.combine(e.plagiarism.state.view((e=>({citationDropdown:(0,a.pipe)(e.state,o.chain((e=>e.citationDropdown))),aiDetectorEnabled:"plagiarismAndAiDetector"===e.kind}))),e.pageRange.pageRange,(({citationDropdown:e,aiDetectorEnabled:t},i)=>({citationDropdown:e,aiDetectorEnabled:t,pageRange:i})))),cardList:ZE(e,t),footer:()=>e.plagiarism.state.view((e=>"plagiarismAndAiDetector"===e.kind?(0,a.pipe)(e.state,o.chain((e=>(0,a.pipe)(e.originality,o.map((t=>({originality:t,sourceCount:e.sourceCount,aiDetectorScore:e.aiDetectorScore}))))))):(0,a.pipe)(e.state,o.chain((e=>(0,a.pipe)(e.originality,o.map((t=>({originality:t,sourceCount:e.sourceCount,aiDetectorScore:o.none})))))))))})}function JE(e){const t=GE(e.feed.feed).pipe(M.shareReplay({bufferSize:1,refCount:!0}));return r.n.composeKnot({root:r.n.fromSideEffect((t=>{"plagiarismFeedMount"===t.kind?e.feed.onFeedMount():(0,g.AS)(t.kind)}),e.plagiarism.state.view((e=>({citationDropdown:(0,a.pipe)(e.state,o.chain((e=>e.citationDropdown))),originality:(0,a.pipe)(e.state,o.chain((e=>e.originality)),o.getOrElse((()=>1))),sourceCount:(0,a.pipe)(e.state,o.chain((e=>e.sourceCount)))})))),cardList:ZE(e,t),uphookPrompt:XE(e,"Upgrade to view matching text in your document and get citations in APA, MLA, or Chicago style.")})}function YE(e){return r.n.composeKnot({root:r.n.fromSideEffect((t=>{"plagiarismFeedSuccessMountAction"===t.kind?e.feed.onFeedMount():(0,g.AS)(t.kind)}),u.of(void 0)),uphookPrompt:XE(e,"Prevent accidental plagiarism and feel confident every time you write.")})}function XE(e,t){return r.n.composeKnot({root:r.n.fromSideEffect((t=>{"plagiarismUphookDismiss"===t.kind?(e.uphook.onUphookDismiss("plagiarism","plagiarismView"),e.plagiarism.seeAllSuggestions()):(0,g.AS)(t.kind)}),u.of({promptText:t})),uphook:WE(e,"plagiarism","plagiarismView")})}function ew(e){return r.n.composeKnot({root:r.n.fromSideEffect((t=>{"plagiarismUphookDismiss"===t.kind?(e.uphook.onUphookDismiss("plagiarism","plagiarismView"),e.plagiarism.seeAllSuggestions()):(0,g.AS)(t.kind)}),e.plagiarism.state.view((e=>({aiDetectorEnabled:"plagiarismAndAiDetector"===e.kind})))),uphook:WE(e,"plagiarism","plagiarismView")})}function tw(e){return()=>u.of((0,a.pipe)(e.settings,o.chain((e=>e.getView())),o.fold((()=>({content:null})),(e=>({content:e})))))}function iw(e){return r.n.composeKnot({content:r.n.composeUnion({free:()=>u.of(null),premium:()=>u.of(null),business:()=>u.of(null)},(()=>e.assistant.state.view("user").view((e=>ge(e)?{kind:"institution"===e.type?"business"===e.institutionType?"business":"premium":"premium"===e.type?"premium":"free"}:{kind:"free"})))),signIn:r.n.composeOption(r.n.fromSideEffect((t=>{e.notify(t)}),u.of(null)),(()=>e.assistant.state.view("userCanSignIn").view((e=>e?o.some(null):o.none))))})}function nw(e,t){const i=f.s.combine(e.skill.state,e.lifecycle.heightBehavior,((e,i)=>(0,a.pipe)(e,o.filter((()=>"fitContainer"===i.kind?!t:t)),o.map((e=>({displayName:e.skill.displayName,status:e.status,srcUrl:e.skill.srcUrl,size:{width:e.size.width,height:"fitContainer"===i.kind?"100%":e.size.height}}))))));return r.n.composeOption(function(e,t){return r.n.fromSideEffect((t=>e.notify(t)),t)}(e,i.pipe(N.oE)),(()=>i))}function sw(e){return r.n.composeUnion({loading:()=>u.of(null),loadedEmpty:r.n.fromSideEffect((t=>e.notify(t)),u.of(null)),loadedNonEmpty:r.n.composeKnot({root:r.n.fromSideEffect((t=>e.notify(t)),(0,a.pipe)(e.toneDetector,o.fold((()=>u.of(null)),(e=>e.state.pipe(m.p(Dt.isLoadedNonEmpty),R.T((({tones:e,brandToneInfo:t,uphookInfo:i})=>({tones:e,onBrandTitleEnabled:o.isSome(t),uphookInfo:i})))))))),uphook:WE(e,"toneDetector","emogenieReport")})},(()=>(0,a.pipe)(e.toneDetector,o.fold((()=>u.of({kind:"loading"})),(e=>e.state.view((({kind:e})=>({kind:e}))))))))}function rw(e){const t=f.s.create("");return r.n.fromSideEffect((i=>{"updateRoleTypeaheadText"===i.kind?(t.set(i.text),""===i.text&&e.notify({kind:ft.t.Kind.roleTypeaheadSelectionChange,role:o.none})):(i.kind===ft.t.Kind.roleTypeaheadSelectionChange&&t.set((0,a.pipe)(i.role,o.fold((()=>""),(e=>e.label)))),e.notify(i))}),f.s.combine(e.assistant.state.view("genAISession"),e.voiceProfile.state.view("stagingVoiceProfile"),t,((e,t,i)=>(0,a.pipe)(k.Jq(o.Applicative)({voiceProfile:(0,a.pipe)(e,o.chain(oe.toStarted),o.map((e=>e.voiceProfile)),o.chain(Ae.toLegacyVoiceProfile)),stagingVoiceProfile:t}),o.fold((()=>({tones:[],styles:[],roles:[],maxSelectableTones:0,applyButtonEnabled:!1,description:"",roleTypeaheadText:"",dialects:Ae.Dialect.all(),selectedDialect:Ae.Dialect.american})),(({stagingVoiceProfile:e,voiceProfile:t})=>(0,a.pipe)(t.styles,C.i8((t=>t.id===e.selectedStyle)),(n=>({styles:(0,a.pipe)(t.styles,C.Tj((t=>Object.assign(Object.assign({},t),{kind:t.id===e.selectedStyle?"selected":"unselected"})))),tones:(0,a.pipe)(n,o.fold((()=>[]),(t=>(0,a.pipe)(t.tones,C.Tj((i=>Object.assign(Object.assign({},i),{kind:(0,a.pipe)(o.fromNullable(e.selectedTonesPerStyle.get(e.selectedStyle)),o.getOrElse((()=>new Set)),(e=>e.has(i.id)?"selected":e.size>=t.maxTones?"disabled":"unselected"))}))))))),roles:t.roles,maxSelectableTones:(0,a.pipe)(n,o.fold((()=>3),(e=>e.maxTones))),applyButtonEnabled:!Ae.Selections.eq.equals(e,t),description:"These voice settings will apply to any text you generate.",roleTypeaheadText:(0,a.pipe)(e.selectedRole,o.filter((()=>""===i)),o.chain((e=>o.fromNullable(t.roles.find((t=>t.id===e))))),o.fold((()=>i),(e=>e.label))),dialects:t.dialects,selectedDialect:t.dialects.find((t=>Ae.Dialect.Id.eq.equals(t.id,e.selectedDialect)))||Ae.Dialect.american})))))))))}function ow(e){return r.n.fromSideEffect((t=>e.notify(t)),f.s.combine(e.assistant.state.view("genAISession"),e.voiceProfile.state.view("stagingNewVoiceProfile"),((e,t)=>(0,a.pipe)(k.Jq(o.Applicative)({sessionVoiceProfile:(0,a.pipe)(e,o.chain(oe.toStarted),o.map((e=>e.voiceProfile)),o.chain(Ae.toNewVoiceProfile)),stagingVoiceProfile:t}),o.fold((()=>({userName:"",title:"",subTitle:"",roles:[],dialects:Ae.Dialect.all(),selectedDialect:Ae.Dialect.american,isEnabledByDefault:!0,isEnabledByDefaultLabel:"",profiles:[],activeProfileName:o.none,activeTagId:o.none,isEditing:!1,selectedRole:o.none})),(({sessionVoiceProfile:e,stagingVoiceProfile:t})=>({userName:e.userName,title:e.title,subTitle:e.subTitle,isEnabledByDefault:t.isEnabledByDefault,isEnabledByDefaultLabel:e.isEnabledByDefaultLabel,profiles:t.profiles,roles:(0,a.pipe)(aw(t,e),o.fold((()=>e.roles),(t=>e.roles.filter((e=>e.id!==t.id))))),dialects:(0,a.pipe)(lw(t,e),(t=>e.dialects.filter((e=>e.id!==t.id)))),selectedRole:aw(t,e),selectedDialect:lw(t,e),activeProfileName:t.activeProfileName,activeTagId:t.activeTagId,isEditing:o.isSome(t.stagingSelections)})))))))}function aw(e,t){return(0,a.pipe)(e.stagingSelections,o.chain((e=>e.selectedRole)),o.alt((()=>e.selectedRole)),o.chain((e=>o.fromNullable(t.roles.find((t=>Ae.Role.Id.eq.equals(t.id,e)))))))}function lw(e,t){return(0,a.pipe)(e.stagingSelections,o.fold((()=>e.selectedDialect),(e=>e.selectedDialect)),(e=>t.dialects.find((t=>Ae.Dialect.Id.eq.equals(t.id,e)))||Ae.Dialect.american))}const cw=e=>t=>{switch(t.kind){case"seeAllSuggestions":return void e.writingExpert.seeAllSuggestions();case"tryAgain":return void e.writingExpert.tryAgain();case"longFormCardSduiNotify":return e.feed.processActions(t.actions,t.item,t.scope,t.sourceId);case ft.t.Kind.actionsMenuMuteClick:case ft.t.Kind.actionsMenuReportIncorrectClick:case ft.t.Kind.actionsMenuReportOffensiveClick:case ft.t.Kind.suggestionAcceptClick:case ft.t.Kind.suggestionDismissClick:return e.notify&&e.notify(t);default:(0,g.AS)(t)}};var dw=i(17644);function uw(e,t=u.of(!0)){const i=t.pipe(m.p(dw.D),h.s(1)).pipe(d.n((()=>e.assistant.state.view("genAISession").view(o.chain((e=>e.error))))),ut.Z(o.none));return r.n.composeOption(function(e,t){const i=e.routing.activeView.view((e=>"error"!==e.kind));return r.n.fromSideEffect((t=>e.notify(t)),t.pipe(Ot.E(i),R.T((([e,t])=>({error:e,showDismissButton:t})))))}(e,i.pipe(N.oE)),(()=>i))}function pw(e){const t=e.assistant.state.view("genAISession").view((0,a.flow)(o.chain(oe.toStarted),o.chain((e=>e.activeContext.documentOverview))));return r.n.composeOption((()=>(0,a.pipe)(t,N.oE)),(()=>t))}function mw(e){const t=e.assistant.state.view("genAISession").view((e=>(0,a.pipe)(e,o.filter((e=>ce.Y.isQuickReply(e.mode))),o.chain((e=>(0,a.pipe)("started"===e.kind?(0,a.pipe)(e.activeContext.intent,o.map((e=>({kind:"loaded",text:e})))):o.some({kind:"loading"}),o.map((e=>Object.assign(Object.assign({},e),{header:"Senders intent"})))))))));return r.n.composeOption(r.n.composeUnion({loading:()=>t.pipe(N.oE),loaded:r.n.fromSideEffect((t=>e.notify(t)),t.pipe(R.T(o.chain((e=>"loaded"===e.kind?o.some({text:e.text,header:e.header}):o.none))),N.oE))},(()=>t.pipe(N.oE))),(()=>t))}function hw(e){const t=e.assistant.state.view("detectedReferences");return r.n.composeOption(function(e){return()=>e.assistant.state.view("detectedReferences").pipe(R.T(o.getOrElse((0,a.constant)([]))),R.T((e=>({detectedReferences:e}))))}(e),(()=>t))}const gw=[{emptyState:{title:"Rooting for you.",description:"Suggestions will appear here.",illustration:s.createElement((()=>s.createElement("svg",{fill:"none",viewBox:"0 0 66 64",role:"img","aria-hidden":!0,focusable:!1},s.createElement("path",{fill:"#C6CBDE",d:"M33.4 64c9.4 0 17.02-1.45 17.02-3.24 0-1.79-7.62-3.24-17.01-3.24-9.4 0-17.02 1.45-17.02 3.24 0 1.79 7.62 3.24 17.02 3.24Z"}),s.createElement("path",{fill:"#F6DF6C",stroke:"#27282E",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M36.65 61.36H28.8c-6.03 0-10.92-4.43-10.92-9.89V40.5c0-.4 30.22-.4 30.22 0v10.5c0 5.72-5.13 10.37-11.46 10.37Z"}),s.createElement("path",{fill:"#C7EEFB",stroke:"#27282E",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M33 44.13c8.35 0 15.11-1.56 15.11-3.47 0-1.92-6.76-3.48-15.1-3.48-8.36 0-15.12 1.56-15.12 3.48 0 1.91 6.76 3.47 15.11 3.47Z"}),s.createElement("path",{fill:"#27282E",d:"M45.56 42.15c-2.5.96-7.19 1.6-12.56 1.6s-10.06-.64-12.56-1.6c.7-1.38 6.05-2.45 12.56-2.45 6.5 0 11.87 1.07 12.56 2.45Z"}),s.createElement("path",{stroke:"#27282E",strokeLinecap:"round",strokeLinejoin:"round",d:"m22.87 33.14 2.26-.62-1.98-1.25M25.35 27.2l2.18.85-.83-2.18M22.93 37.44l2.33.2-1.71 1.59M43.7 33.14l-2.26-.62 1.98-1.25M41.22 27.2l-2.17.85.82-2.18M43.64 37.44l-2.33.2 1.71 1.59"}),s.createElement("path",{fill:"#16AC9A",stroke:"#27282E",strokeLinecap:"round",strokeLinejoin:"round",d:"M41.34 31.15c-.97-3.31-4.13-5.63-8.06-5.63v0h0v0c-3.93 0-7.09 2.32-8.06 5.63-1.39 4.76.83 9.86 1.86 10.8 1.76.38 3.05.69 6.2.69 3.13 0 4.98-.4 6.2-.7 1.04-.93 3.25-6.03 1.86-10.8h0Z"}),s.createElement("path",{stroke:"#27282E",strokeLinecap:"round",strokeLinejoin:"round",d:"M34.7 42.44c.7-1.36 2.15-4.86 2.19-8.36.03-3.36-1.46-6.84-3.38-8.46M39.03 35.02l-2.14-.94 2.14-.95"}),s.createElement("path",{stroke:"#27282E",strokeLinecap:"round",strokeLinejoin:"round",d:"m38.56 30.08-2.33-.14 1.68-1.63M38.56 38.46l-2.33.2 1.71 1.58M31.87 42.44a20.66 20.66 0 0 1-2.2-8.36c-.03-3.4 1.5-6.91 3.45-8.52"}),s.createElement("path",{stroke:"#27282E",strokeLinecap:"round",strokeLinejoin:"round",d:"m27.54 35.02 2.14-.94-2.14-.95M28 30.08l2.33-.14-1.67-1.63M28 38.46l2.33.2-1.71 1.58"}),s.createElement("path",{fill:"#fff",stroke:"#27282E",strokeMiterlimit:"10",d:"M6.9 54.28c-.07 0-.12-.06-.12-.14.11-4.3-1.36-5.85-5.66-5.97-.07 0-.12-.07-.12-.14s.06-.12.13-.12c4.3.11 5.86-1.36 5.98-5.66 0-.07.06-.12.14-.12.07 0 .12.06.12.13-.11 4.3 1.36 5.86 5.66 5.97.07 0 .12.06.12.13s-.06.12-.13.12c-4.3-.1-5.86 1.37-5.98 5.66-.01.09-.06.14-.13.14ZM59.17 37.27c-.07 0-.11-.06-.11-.13.1-4.01-1.28-5.47-5.29-5.58-.07 0-.11-.06-.11-.12 0-.07.06-.12.12-.12 4.01.1 5.47-1.27 5.58-5.28 0-.07.06-.12.13-.12s.11.06.11.13c-.1 4.01 1.27 5.47 5.29 5.57.06 0 .11.05.11.12 0 .07-.06.12-.13.12-4-.1-5.46 1.27-5.58 5.28 0 .08-.05.13-.12.13ZM46.14 22.68c-.1 0-.16-.08-.16-.18.14-5.73-1.82-7.8-7.55-7.97-.1 0-.16-.08-.16-.18 0-.1.08-.16.17-.16 5.74.15 7.81-1.82 7.98-7.55 0-.1.08-.16.17-.16.1 0 .17.08.17.18-.15 5.73 1.82 7.8 7.55 7.95.1 0 .16.09.16.18 0 .1-.08.17-.18.17-5.73-.15-7.8 1.81-7.97 7.54-.02.12-.08.18-.18.18Z"}))),null)},successState:{title:"You're on point!",description:"There are no more suggestions.",illustration:s.createElement((()=>s.createElement("svg",{fill:"none",viewBox:"0 0 64 64",role:"img","aria-hidden":!0,focusable:!1},s.createElement("g",{clipPath:"url(#SuccessA_a)"},s.createElement("path",{fill:"#C6CBDE",d:"M32 64c9.28 0 16.8-1.43 16.8-3.2 0-1.77-7.52-3.2-16.8-3.2-9.28 0-16.8 1.43-16.8 3.2 0 1.77 7.52 3.2 16.8 3.2Z"}),s.createElement("path",{stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",d:"M44.08 7.6h-3.24L43 5.2M42.93 36.13l-2.59-1.95 3.2-.6M46.3 17.13l-3.13-.84 2.73-1.75M45.14 26.65l-2.73-1.74 3.13-.85M19.12 7.6h3.24L20.2 5.2M20.27 36.13l2.59-1.95-3.19-.6M16.9 17.13l3.13-.84-2.73-1.75M18.06 26.65l2.73-1.74-3.13-.85"}),s.createElement("path",{fill:"#F6DF6C",stroke:"#0E101A",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M35.2 61.4h-7.73c-5.96 0-10.8-4.38-10.8-9.77V40.78c0-.4 29.86-.4 29.86 0v10.36c0 5.66-5.07 10.25-11.33 10.25Z"}),s.createElement("path",{fill:"#C7EEFB",stroke:"#0E101A",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M31.6 44.38c8.24 0 14.93-1.54 14.93-3.43 0-1.9-6.69-3.43-14.93-3.43-8.24 0-14.92 1.53-14.92 3.43 0 1.9 6.68 3.43 14.92 3.43Z"}),s.createElement("path",{fill:"#0E101A",d:"M44 42.43c-2.47.94-7.1 1.57-12.4 1.57-5.3 0-9.93-.63-12.4-1.57.68-1.37 5.98-2.43 12.4-2.43s11.72 1.06 12.4 2.43Z"}),s.createElement("path",{fill:"#15C39A",stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",d:"M31.6 2.41v.01h0c-22.5 0-6.52 39.78-6.52 39.78s2.2.86 6.52.86c4.32 0 6.52-.86 6.52-.86S54.1 2.41 31.6 2.41h0Z"}),s.createElement("path",{fill:"#F18AB2",stroke:"#0E101A",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M12 7.25s2.8-1.38 5.22-.87c-1.36-2.06-1.11-5.1-1.11-5.1 5.32 2.17 4.15 7.14 4.15 7.14s-5.76 2.26-3.56.81A6.82 6.82 0 0 1 12 7.25Z"}),s.createElement("path",{fill:"#F18AB2",stroke:"#0E101A",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M13.79 4.5s2.6-.32 4.67 1.02A7.77 7.77 0 0 1 19.17.8c4.17 3.95 1.56 7.99 1.56 7.99s-2.34 4.21-7.8 2.4c0 0 1.6-2.38 4.18-2.93A6.92 6.92 0 0 1 13.8 4.5Z"}),s.createElement("path",{stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",d:"M33.26 42.98s8.41-38.16-1.68-40.57"}),s.createElement("path",{stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",d:"m39.15 28.43-2.81-1.6 3.08-1M37.54 37.9l-2.56-2 3.2-.54M39.48 9.37l-3.2-.56 2.57-1.98M40.03 18.9l-3.11-.91 2.77-1.7M29.94 42.98S21.53 4.82 31.63 2.41"}),s.createElement("path",{stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",d:"m24.05 28.43 2.82-1.6-3.09-1M25.66 37.9l2.56-2-3.2-.54M23.72 9.37l3.2-.56-2.57-1.98M23.17 18.9l3.11-.91-2.77-1.7"}),s.createElement("path",{fill:"#fff",stroke:"#0E101A",strokeMiterlimit:"10",d:"M56.62 39.2c-.08 0-.13-.06-.13-.14.12-4.53-1.43-6.17-5.96-6.3-.08 0-.13-.06-.13-.14 0-.08.06-.13.14-.13 4.53.12 6.17-1.43 6.3-5.96 0-.08.06-.13.14-.13.08 0 .13.06.13.14-.12 4.53 1.43 6.17 5.96 6.29.08 0 .13.06.13.14 0 .07-.06.12-.14.12-4.53-.11-6.17 1.44-6.3 5.97-.01.09-.06.14-.14.14ZM6.24 24c-.06 0-.1-.06-.1-.12.1-3.96-1.27-5.4-5.23-5.51-.07 0-.11-.06-.11-.13 0-.06.06-.1.12-.1 3.97.1 5.4-1.27 5.51-5.23 0-.07.06-.11.13-.11.06 0 .1.06.1.12-.1 3.97 1.27 5.4 5.23 5.5.07 0 .11.06.11.13 0 .06-.06.1-.12.1-3.96-.1-5.4 1.27-5.51 5.23-.01.08-.06.12-.13.12Z"})),s.createElement("defs",null,s.createElement("clipPath",{id:"SuccessA_a"},s.createElement("path",{fill:"#fff",d:"M0 0h64v64H0z"}))))),null)}},{emptyState:{title:"You got this.",description:"Suggestions will appear here.",illustration:s.createElement((()=>s.createElement("svg",{fill:"none",viewBox:"0 0 64 64",role:"img","aria-hidden":!0,focusable:!1},s.createElement("path",{fill:"#AAF2E1",stroke:"#0E101A",strokeLinejoin:"round",d:"M12.8 46.4 32.8.8l20 45.6V62h-40V46.4Z"}),s.createElement("path",{stroke:"#0E101A",strokeLinejoin:"round",d:"m12.8 46.4 20-13.2 20 13.2"}),s.createElement("path",{fill:"#0E101A",fillRule:"evenodd",d:"M32.4 4.76V1.6h.8v3.16h-.8Zm0 6.31V7.92h.8v3.15h-.8Zm0 6.32v-3.16h.8v3.16h-.8Zm0 6.32v-3.16h.8v3.16h-.8Zm0 6.31v-3.16h.8v3.16h-.8Zm0 6.32v-3.16h.8v3.16h-.8Zm0 6.31V39.5h.8v3.16h-.8Zm0 6.32V45.8h.8v3.16h-.8Zm0 6.31v-3.15h.8v3.15h-.8Zm0 6.32v-3.16h.8v3.16h-.8Z",clipRule:"evenodd"}),s.createElement("path",{stroke:"#000",strokeLinecap:"round",d:"M10 33.6C5.2 34.8-2.4 42 2.8 48.8c5.2 6.8 16.8 4.5 21.2.89"}),s.createElement("path",{fill:"#000",fillRule:"evenodd",d:"M10.4 33.05c.21.08.31.3.23.51l-1.3 3.36a.4.4 0 0 1-.75-.3l1.16-2.97-2.98-1.17a.4.4 0 0 1 .29-.74l3.35 1.3Z",clipRule:"evenodd"}))),null)},successState:{title:"Well, this is shaping up!",description:"There are no more suggestions.",illustration:s.createElement((()=>s.createElement("svg",{fill:"none",viewBox:"0 0 64 64",role:"img","aria-hidden":!0,focusable:!1},s.createElement("g",{clipPath:"url(#SuccessB_a)"},s.createElement("path",{fill:"#87E8D1",stroke:"#0E101A",strokeLinejoin:"round",d:"m18 34-3.4-10.67L59.41 1.49 18 34Z"}),s.createElement("path",{fill:"#D7F7F0",stroke:"#0E101A",strokeLinejoin:"round",d:"M24.25 24.7 60.8.8l-20.23 40-16.32-16.1ZM2.4 19.42 60.8.8 14.6 23.33l-12.2-3.9Z"}),s.createElement("path",{fill:"#15C39A",stroke:"#0E101A",strokeLinejoin:"round",d:"m28.62 29.08-4.37-4.37L18 34l10.62-4.92Z"}),s.createElement("path",{fill:"#FBEFB7",stroke:"#0E101A",strokeMiterlimit:"10",d:"M25.4 52c-.09 0-.15-.07-.15-.16.13-5.1-1.61-6.94-6.7-7.08-.1 0-.15-.08-.15-.16 0-.09.07-.15.16-.15 5.1.13 6.94-1.61 7.08-6.7 0-.1.08-.15.16-.15.09 0 .15.07.15.16-.13 5.1 1.61 6.94 6.7 7.07.1 0 .15.07.15.16 0 .08-.07.14-.16.14-5.1-.13-6.94 1.62-7.08 6.71-.02.1-.08.16-.16.16ZM57.44 39.2c-.06 0-.1-.06-.1-.12.1-3.96-1.27-5.4-5.23-5.51-.07 0-.11-.06-.11-.13 0-.06.06-.1.12-.1 3.97.1 5.4-1.27 5.51-5.23 0-.07.06-.11.13-.11.06 0 .1.06.1.12-.1 3.96 1.27 5.4 5.23 5.5.07 0 .11.06.11.13 0 .06-.06.1-.12.1-3.96-.1-5.4 1.27-5.51 5.23-.01.08-.06.12-.13.12ZM11.45 11.2c-.06 0-.1-.05-.1-.11.1-3.68-1.17-5.02-4.85-5.12-.06 0-.1-.05-.1-.12 0-.06.05-.1.11-.1 3.68.1 5.02-1.17 5.12-4.85 0-.06.05-.1.12-.1.06 0 .1.05.1.11-.1 3.68 1.17 5.02 4.85 5.11.06 0 .1.05.1.12 0 .06-.05.1-.11.1-3.68-.1-5.02 1.17-5.12 4.85-.01.07-.05.11-.12.11Z"}),s.createElement("path",{stroke:"#000",strokeDasharray:"4 5",strokeLinecap:"square",d:"M10.4 31.2c-4.8 2-14.64 14.4-6 23.2 8.64 8.8 44.8-2 58 8.8"})),s.createElement("defs",null,s.createElement("clipPath",{id:"SuccessB_a"},s.createElement("path",{fill:"#fff",d:"M0 0h64v64H0z"}))))),null)}},{emptyState:{title:"Nothing to see yet.",description:"Suggestions will appear here.",illustration:s.createElement(mp,null)},successState:{title:"Look at that!",description:"There are no more suggestions.",illustration:s.createElement((()=>s.createElement("svg",{fill:"none",viewBox:"0 0 64 64",role:"img","aria-hidden":!0,focusable:!1},s.createElement("path",{fill:"#F28C8C",fillRule:"evenodd",d:"M1.78 43.26a1.94 1.94 0 0 0 1.5 2.9l35.87 3.6-15.29 7.45a1.43 1.43 0 0 0 1 2.65l30.56-8.46 7.78.79V41.83l-59.74.45c-.7 0-1.33.38-1.68.98Z",clipRule:"evenodd"}),s.createElement("path",{fill:"#0E101A",d:"m3.28 46.15.05-.5-.05.5Zm-1.5-2.89-.43-.24.43.24Zm37.37 6.5.22.45 1.59-.77-1.76-.17-.05.5Zm-15.29 7.45.22.45-.22-.45Zm1 2.65-.13-.48.14.48Zm30.56-8.46.05-.5h-.09l-.1.02.14.48Zm7.78.79-.05.5.55.05v-.55h-.5Zm0-10.36h.5v-.5h-.5v.5Zm-59.74.45v-.5.5Zm-.13 3.37a1.44 1.44 0 0 1-1.11-2.14l-.87-.5a2.44 2.44 0 0 0 1.88 3.64l.1-1Zm35.87 3.62L3.33 45.65l-.1 1 35.87 3.61.1-1Zm-15.12 8.39 15.3-7.45-.45-.9-15.29 7.45.44.9Zm-.52.83c0-.36.2-.68.52-.83l-.44-.9c-.66.32-1.08 1-1.08 1.73h1Zm1.17.9a.93.93 0 0 1-1.17-.9h-1c0 1.27 1.21 2.2 2.44 1.85l-.27-.96Zm30.56-8.47-30.56 8.46.27.96 30.56-8.46-.27-.96Zm7.96.77-7.78-.78-.1.99 7.78.78.1-1Zm-.55-9.86v10.36h1V41.83h-1Zm-59.24.95 59.74-.45v-1l-59.74.45v1Zm-1.24.73c.25-.45.73-.73 1.24-.73v-1c-.88 0-1.68.48-2.11 1.24l.87.49Z"}),s.createElement("path",{fill:"#87E8D1",fillRule:"evenodd",d:"M19.9 46.88a3.14 3.14 0 1 1 .97 5.86 3.67 3.67 0 0 1-7.05-.92 3.3 3.3 0 0 1-4.75-2.94 3.3 3.3 0 0 1 5.2-2.75 2.93 2.93 0 0 1 5.63.75Z",clipRule:"evenodd"}),s.createElement("path",{fill:"#0E101A",d:"m19.9 46.88-.5.06a.5.5 0 0 0 .74.38l-.24-.44Zm1.44-.36v-.5.5Zm3.17 3.1.5-.01h-.5Zm-3.1 3.17.01.5v-.5Zm-.54-.04.08-.5a.5.5 0 0 0-.54.3l.46.2Zm-3.36 2.28v.5-.5Zm-3.69-3.21.5-.06a.5.5 0 0 0-.72-.4l.22.46Zm-1.4.33-.01-.5v.5Zm-3.35-3.27h.5-.5Zm3.26-3.35v-.5.5Zm1.94.6-.28.41a.5.5 0 0 0 .75-.22l-.47-.19Zm2.69-1.85v.5-.5Zm3.18 3.04c.36-.19.77-.3 1.2-.3v-1c-.6 0-1.18.16-1.67.42l.47.88Zm1.2-.3a2.64 2.64 0 0 1 2.67 2.6l1-.01a3.64 3.64 0 0 0-3.68-3.6l.01 1Zm2.67 2.6a2.64 2.64 0 0 1-2.6 2.67l.01 1c2.01-.03 3.62-1.68 3.6-3.68h-1Zm-2.6 2.67c-.16 0-.31-.01-.46-.04l-.16.99c.2.03.42.05.63.05l-.01-1Zm-1 .27a3.17 3.17 0 0 1-2.9 1.97v1a4.17 4.17 0 0 0 3.82-2.6l-.92-.37Zm-2.9 1.97c-1.64.02-3-1.2-3.2-2.77l-.98.12a4.17 4.17 0 0 0 4.19 3.65l-.01-1Zm-3.9-3.16a2.8 2.8 0 0 1-1.2.28l.01 1a3.8 3.8 0 0 0 1.62-.38l-.44-.9Zm-1.2.28a2.8 2.8 0 0 1-2.84-2.77h-1a3.8 3.8 0 0 0 3.85 3.77l-.01-1Zm-2.84-2.77a2.8 2.8 0 0 1 2.77-2.85l-.01-1a3.8 3.8 0 0 0-3.76 3.86l1-.01Zm2.77-2.85c.61 0 1.18.18 1.65.51l.57-.82a3.8 3.8 0 0 0-2.23-.69l.01 1Zm2.4.29a2.43 2.43 0 0 1 2.23-1.54l-.02-1a3.43 3.43 0 0 0-3.14 2.17l.93.37Zm2.23-1.54c1.25-.02 2.3.93 2.44 2.16l.99-.11a3.42 3.42 0 0 0-3.45-3.05l.02 1Z"}),s.createElement("path",{fill:"#87E8D1",fillRule:"evenodd",d:"M56 53.2a3.6 3.6 0 0 1-2.36 3.38 3.6 3.6 0 1 1-5.84 4.2 3.6 3.6 0 0 1-6.96-.62 3.6 3.6 0 1 1 .05-5.9 4.8 4.8 0 0 1 8.16-2.4A3.6 3.6 0 0 1 56 53.2Z",clipRule:"evenodd"}),s.createElement("path",{fill:"#0E101A",d:"m53.64 56.58-.18-.47a.5.5 0 0 0-.22.78l.4-.3Zm-5.84 4.2.42-.27a.5.5 0 0 0-.9.11l.48.17Zm-6.96-.62.5-.07a.5.5 0 0 0-.78-.34l.28.41Zm.05-5.9-.29.42a.5.5 0 0 0 .78-.31l-.49-.1Zm8.16-2.4-.36.35a.5.5 0 0 0 .83-.16l-.47-.18Zm4.76 5.2a4.1 4.1 0 0 0 2.69-3.86h-1a3.1 3.1 0 0 1-2.04 2.91l.35.94Zm1.09 1.74c0-.95-.33-1.83-.87-2.53l-.79.62c.41.53.66 1.19.66 1.91h1Zm-4.1 4.1a4.1 4.1 0 0 0 4.1-4.1h-1a3.1 3.1 0 0 1-3.1 3.1v1Zm-3.42-1.83a4.1 4.1 0 0 0 3.42 1.83v-1a3.1 3.1 0 0 1-2.58-1.39l-.84.56Zm-.05-.45a3.1 3.1 0 0 1-2.93 2.08v1a4.1 4.1 0 0 0 3.87-2.75l-.94-.33ZM44.4 62.7a3.1 3.1 0 0 1-3.06-2.61l-.99.15a4.1 4.1 0 0 0 4.05 3.46v-1Zm-5.6-1.4c.86 0 1.67-.27 2.33-.72l-.57-.83c-.5.35-1.1.55-1.76.55v1Zm-4.1-4.1a4.1 4.1 0 0 0 4.1 4.1v-1a3.1 3.1 0 0 1-3.1-3.1h-1Zm4.1-4.1a4.1 4.1 0 0 0-4.1 4.1h1a3.1 3.1 0 0 1 3.1-3.1v-1Zm2.38.76a4.08 4.08 0 0 0-2.38-.76v1c.67 0 1.3.21 1.8.58l.58-.82Zm4.42-3.96a5.3 5.3 0 0 0-5.2 4.27l.98.2a4.3 4.3 0 0 1 4.22-3.47v-1Zm3.81 1.62a5.29 5.29 0 0 0-3.81-1.62v1c1.22 0 2.31.5 3.1 1.31l.71-.69Zm2.99-2.42a4.1 4.1 0 0 0-3.81 2.58l.93.37a3.1 3.1 0 0 1 2.88-1.95v-1Zm4.1 4.1a4.1 4.1 0 0 0-4.1-4.1v1a3.1 3.1 0 0 1 3.1 3.1h1Z"}),s.createElement("path",{fill:"url(#SuccessC_a)",stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",d:"M25.88 3.04a7.45 7.45 0 0 0-12.77 5.2v13.8c0 7.54 6.84 13.23 14.25 11.86l15.29-2.83 4.37 4.37H57.6L25.88 3.04Z"}),s.createElement("path",{fill:"url(#SuccessC_b)",fillRule:"evenodd",d:"M13.1 16.86v5.16c0 7.54 6.87 13.23 14.28 11.83l.45-.08c.44-.73.68-1.6.66-2.64a9.05 9.05 0 0 0-2.66-6.23l-5.92-5.92a7.65 7.65 0 0 0-6.8-2.12Z",clipRule:"evenodd"}),s.createElement("path",{fill:"#0E101A",d:"M13.1 16.86h-.5c0-.2.13-.37.3-.45l.2.45Zm14.28 17 .1.48-.1-.49Zm.45-.1.43.27a.5.5 0 0 1-.34.23l-.1-.5Zm.66-2.63h.5-.5Zm-2.66-6.23-.36.35.36-.35Zm-5.92-5.92.36-.35-.36.35Zm-6.8-2.12-.2-.45a.5.5 0 0 1 .11-.04l.09.5Zm.5 0v5.16h-1v-5.16h1Zm0 5.16c0 7.23 6.57 12.68 13.68 11.34l.18.98a12.54 12.54 0 0 1-14.86-12.32h1Zm13.68 11.34.45-.08.18.98-.45.08-.18-.98Zm.11.15c.39-.64.6-1.42.59-2.37l1-.02a5.3 5.3 0 0 1-.73 2.9l-.86-.51Zm.59-2.37a8.55 8.55 0 0 0-2.52-5.89l.71-.7a9.55 9.55 0 0 1 2.8 6.57l-1 .02Zm-2.52-5.89-5.91-5.92.7-.7 5.92 5.91-.7.71Zm-5.91-5.92a7.15 7.15 0 0 0-6.36-1.98l-.18-.98a8.15 8.15 0 0 1 7.25 2.26l-.71.7Zm-6.25-2.01-.4-.91.4.91Z"}),s.createElement("path",{stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",d:"M23.86 41.85 28 33.62M29.96 41.85l4.88-9.35M24.41 13.1c0 7.65 7.19 13.26 14.6 11.4l5.83-1.82"}),s.createElement("path",{fill:"#F28C8C",stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",d:"m13.11 6.93-5.84 3.72 5.84 3.71V6.93Z"}),s.createElement("circle",{cx:"1.09",cy:"1.09",r:"1.09",fill:"#0E101A",transform:"matrix(-1 0 0 1 19.67 6.27)"}),s.createElement("defs",null,s.createElement("radialGradient",{id:"SuccessC_b",cx:"0",cy:"0",r:"1",gradientTransform:"matrix(8 -9 8 7 13.6 32.4)",gradientUnits:"userSpaceOnUse"},s.createElement("stop",{stopColor:"#F3F8E5"}),s.createElement("stop",{offset:"1",stopColor:"#D7E8A9"})),s.createElement("linearGradient",{id:"SuccessC_a",x1:"16.14",x2:"55.97",y1:".8",y2:"36.57",gradientUnits:"userSpaceOnUse"},s.createElement("stop",{stopColor:"#D7E8A9"}),s.createElement("stop",{offset:".38",stopColor:"#87E8D1"}),s.createElement("stop",{offset:".89",stopColor:"#79A8F2"}))))),null)}},{emptyState:{title:"The first word is the hardest.",description:"Suggestions will appear here.",illustration:s.createElement((()=>s.createElement("svg",{fill:"none",viewBox:"0 0 79 64",role:"img","aria-hidden":!0,focusable:!1},s.createElement("path",{fill:"#C6CBDE",d:"M28.4 63.2c8.62 0 15.6-1.8 15.6-4s-6.98-4-15.6-4-15.6 1.8-15.6 4 6.98 4 15.6 4Z"}),s.createElement("path",{fill:"#638EEB",stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M41.19 56.6a.58.58 0 0 0 0-.25v-3.53h-2.67c-2.3-.84-5.78 0-9.72 0-3.94 0-7.45-.86-9.72 0H16.4v4.7c.43 1.9 5.83 3.4 12.4 3.4s11.95-1.5 12.39-3.4v-.93Z"}),s.createElement("path",{fill:"#8ECBDE",stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M28.8 56.25c6.85 0 12.4-1.63 12.4-3.64 0-2-5.55-3.64-12.4-3.64-6.85 0-12.4 1.63-12.4 3.64 0 2.01 5.55 3.64 12.4 3.64Z"}),s.createElement("path",{fill:"#8ECBDE",d:"M41.17 52.74v-1.5a2.25 2.25 0 0 0-2.23-2.3h-.09a.98.98 0 0 1-.95-.98v-.35H19.7v.35a.98.98 0 0 1-.96.98h-.07a2.25 2.25 0 0 0-2.24 2.3v1.5"}),s.createElement("path",{stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M41.17 52.74v-1.5a2.25 2.25 0 0 0-2.23-2.3h-.09a.98.98 0 0 1-.95-.98v-.35H19.7v.35a.98.98 0 0 1-.96.98h-.07a2.25 2.25 0 0 0-2.24 2.3v1.5"}),s.createElement("path",{fill:"#99C2FF",stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M38.1 47.22V44.4h-2.01c-1.7-.63-4.34 0-7.29 0s-5.59-.65-7.3 0H19.5v2.94h.02c.32 1.43 4.35 2.55 9.28 2.55 4.92 0 8.95-1.12 9.27-2.55l.03-.1Z"}),s.createElement("path",{fill:"#DBEBFF",stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",d:"M28.8 46.97c5.14 0 9.3-1.22 9.3-2.73s-4.16-2.74-9.3-2.74c-5.14 0-9.3 1.23-9.3 2.74 0 1.5 4.16 2.73 9.3 2.73Z"}),s.createElement("path",{fill:"#0E101A",d:"M28.8 45.64c3.85 0 6.97-.66 6.97-1.48s-3.12-1.48-6.97-1.48c-3.85 0-6.97.66-6.97 1.48s3.12 1.48 6.97 1.48Z"}),s.createElement("path",{fill:"#FBEFB7",stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",d:"M65.02 4.06c-1.83.69-3.5 1.34-5.03 2l-3.54 5.07.7-3.8c-7.41 3.5-11.69 7.17-17.58 13.7-5.5 6.11-6.19 14.68-6.19 14.68l10.55-2.27-2.86-1.36 4.46.1a159.72 159.72 0 0 1 17.7-13.15l-4.18-1.93 7.18.04 4.55-2.75L77.83 5l-12.81-.94Z"}),s.createElement("path",{fill:"#41D9B5",stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",d:"M67.85 8.92s-29.05 9.2-40.25 36h2c3.52-7.49 12.8-24.4 38.25-36Z"}),s.createElement("path",{stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"m46.5 14.03-.83 4.67M59.58 21.57l-5.11-1.43M50.56 28.2l-5.11-1.45M39.6 20.91l-.71 4.2"}))),null)},successState:{title:"You did it!",description:"There are no more suggestions.",illustration:s.createElement($u,null)}},{emptyState:{title:"Start writing to make the magic happen.",description:"Suggestions will appear here.",illustration:s.createElement((()=>s.createElement("svg",{fill:"none",viewBox:"0 0 64 65",role:"img","aria-hidden":!0,focusable:!1},s.createElement("g",{clipPath:"url(#EmptyE_a)"},s.createElement("path",{fill:"#fff",stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M47.87 26.1c-.06 0-.1-.05-.1-.1.09-3.4-1.08-4.63-4.47-4.73-.06 0-.1-.05-.1-.1 0-.06.05-.1.1-.1 3.4.09 4.63-1.08 4.73-4.47 0-.06.05-.1.1-.1.06 0 .1.05.1.1-.09 3.4 1.08 4.63 4.47 4.72.06 0 .1.05.1.1 0 .06-.05.1-.1.1-3.4-.09-4.63 1.08-4.73 4.47 0 .07-.05.11-.1.11ZM10.68 28.5c-.06 0-.1-.04-.1-.1.09-3.11-.98-4.24-4.1-4.33-.04 0-.08-.04-.08-.1 0-.05.04-.08.1-.08 3.11.08 4.24-.99 4.33-4.1 0-.05.04-.09.1-.09.05 0 .08.04.08.1-.08 3.11.99 4.24 4.1 4.32.05 0 .09.04.09.1 0 .05-.04.08-.1.08-3.11-.08-4.24.99-4.33 4.1 0 .06-.04.1-.1.1ZM35.84 12.5c-.06 0-.1-.06-.1-.12.1-3.96-1.27-5.4-5.23-5.51-.07 0-.11-.06-.11-.13 0-.06.06-.1.12-.1 3.96.1 5.4-1.27 5.51-5.23 0-.07.06-.11.13-.11.06 0 .1.06.1.12-.1 3.97 1.27 5.4 5.23 5.5.07 0 .11.06.11.13 0 .06-.06.1-.12.1-3.96-.1-5.4 1.27-5.51 5.23-.01.08-.06.12-.13.12Z"}),s.createElement("path",{fill:"#0E101A",stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M2.19 6.8a2.53 2.53 0 1 1 2.74-4.24l30.2 19.54-2.74 4.24L2.19 6.81Z"}),s.createElement("path",{fill:"#fff",stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M24.3 21.1a2.52 2.52 0 1 1 2.74-4.23l8.75 5.65-2.74 4.24-8.75-5.66Z"}),s.createElement("circle",{cx:"34.41",cy:"24.67",r:"2.55",fill:"#fff",stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",transform:"rotate(-57 34.4 24.67)"}),s.createElement("path",{fill:"#C6CBDE",d:"M32 64.5c10.6 0 19.2-1.61 19.2-3.6s-8.6-3.6-19.2-3.6-19.2 1.61-19.2 3.6 8.6 3.6 19.2 3.6Z"}),s.createElement("path",{fill:"#6E66DE",stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M42.84 34.42H21.16l-3.23 23.34c-.2 1.49.5 2.9 1.94 3.3 2.13.6 6 1.27 12.62 1.27 6.77 0 10.35-.7 12.17-1.3 1.17-.4 1.64-1.56 1.47-2.78l-3.29-23.83Z"}),s.createElement("path",{fill:"#F8C6DA",stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"m43.74 41.35-.9-6.93H21.16l-.9 6.93h23.48Z"}),s.createElement("path",{fill:"#6E66DE",stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M50.08 33.3H13.92a1.12 1.12 0 0 0 0 2.24h36.16a1.12 1.12 0 1 0 0-2.24Z"})),s.createElement("defs",null,s.createElement("clipPath",{id:"EmptyE_a"},s.createElement("path",{fill:"#fff",d:"M0 .5h64v64H0z"}))))),null)},successState:{title:"It's like magic!",description:"There are no more suggestions.",illustration:s.createElement((()=>s.createElement("svg",{fill:"none",viewBox:"0 0 64 64",role:"img","aria-hidden":!0,focusable:!1},s.createElement("g",{clipPath:"url(#SuccessE_a)"},s.createElement("path",{fill:"#C6CBDE",d:"M32 64c11.49 0 20.8-1.8 20.8-4s-9.31-4-20.8-4-20.8 1.8-20.8 4 9.31 4 20.8 4Z"}),s.createElement("path",{fill:"#F28C8C",d:"M38.73 32.98s9.04-12.87 11.57-18.56c3.5-7.97 1.49-11.86-.22-12.62-1.7-.76-5.96.4-9.46 8.36-2.59 5.85-6.54 21.03-6.54 21.03"}),s.createElement("path",{stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M38.73 32.98s9.04-12.87 11.57-18.56c3.5-7.97 1.49-11.86-.22-12.62-1.7-.76-5.96.4-9.46 8.36-2.59 5.85-6.54 21.03-6.54 21.03"}),s.createElement("path",{fill:"#F8C6DA",stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M37.12 30.94a.95.95 0 0 1-.6-1.21c1.12-3.6 5.26-16.7 6.53-19.63 2.04-4.62 4.69-5.75 5.7-5.32 1 .46 1.97 3.16-.07 7.79-1.28 2.89-8.55 14.94-10.37 17.95-.25.4-.73.58-1.19.42Z"}),s.createElement("path",{fill:"#F28C8C",stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"m32.68 31.55-4.56 2.04s-.58-.97-1.46-2.55a348.24 348.24 0 0 1-5.63-10.29 1.31 1.31 0 0 1 .33-1.61 6.2 6.2 0 0 1 9.13 1.25 285.72 285.72 0 0 1 2.19 11.16Z"}),s.createElement("path",{fill:"#6E66DE",stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M44.05 31.22H19.95l-3.6 25.59c-.22 1.5.49 2.93 1.95 3.35 2.31.66 6.65 1.44 14.25 1.44 7.73 0 11.71-.8 13.68-1.48 1.18-.4 1.67-1.58 1.5-2.82l-3.68-26.08Z"}),s.createElement("path",{fill:"#F8C6DA",stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"m45.04 38.76-1-7.54H19.96l-1 7.54h26.1Z"}),s.createElement("path",{fill:"#6E66DE",stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M51.58 30H12.42a1.22 1.22 0 0 0 0 2.44h39.16a1.22 1.22 0 0 0 0-2.44Z"}),s.createElement("path",{fill:"#F28C8C",stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M30.49 20.42c-1 3.4-2.07 6.72-2.98 8.82-.28.64-.55 1.25-.85 1.8-3.26 6.38-6.94 7.33-8.55 6.63-1.74-.73-3.78-4.63-.34-12.63.52-1.18 1.31-2.68 2.22-4.32a6.2 6.2 0 0 1 10.5-.3Z"}),s.createElement("path",{fill:"#fff",stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M6.63 21.6c-.07 0-.12-.06-.12-.13.11-4.25-1.35-5.79-5.59-5.9-.07 0-.12-.07-.12-.14s.06-.12.13-.12c4.25.11 5.79-1.35 5.9-5.59 0-.07.07-.12.14-.12s.12.06.12.13c-.11 4.25 1.35 5.79 5.59 5.9.07 0 .12.05.12.13 0 .07-.06.12-.13.12-4.25-.11-5.79 1.34-5.9 5.59-.02.08-.07.13-.14.13ZM19.87 10.4c-.06 0-.1-.05-.1-.1.09-3.4-1.08-4.63-4.47-4.73-.06 0-.1-.05-.1-.1 0-.06.05-.1.1-.1 3.4.09 4.63-1.08 4.73-4.47 0-.06.05-.1.1-.1.06 0 .1.05.1.1-.09 3.4 1.08 4.63 4.47 4.72.06 0 .1.05.1.1 0 .06-.05.1-.1.1-3.4-.09-4.63 1.08-4.73 4.47 0 .07-.05.11-.1.11ZM57.03 52c-.07 0-.12-.06-.12-.13.11-4.25-1.35-5.79-5.59-5.9-.07 0-.12-.07-.12-.14s.06-.12.13-.12c4.25.11 5.79-1.35 5.9-5.59 0-.07.07-.12.14-.12s.12.06.12.13c-.11 4.25 1.35 5.79 5.59 5.9.07 0 .12.05.12.13 0 .07-.06.12-.13.12-4.25-.11-5.79 1.34-5.9 5.59-.02.08-.07.13-.14.13Z"})),s.createElement("defs",null,s.createElement("clipPath",{id:"SuccessE_a"},s.createElement("path",{fill:"#fff",d:"M0 0h64v64H0z"}))))),null)}},{emptyState:{title:"No pressure.",description:"Suggestions will appear here.",illustration:s.createElement((()=>s.createElement("svg",{fill:"none",viewBox:"0 0 64 64",role:"img","aria-hidden":!0,focusable:!1},s.createElement("g",{clipPath:"url(#EmptyF_a)"},s.createElement("path",{fill:"#F28C8C",stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M28.8.8h6.4v72.8h-6.4zM4.8 71.09l5.54 3.2 12.8-22.18-5.54-3.2zM59.2 71.08l-5.54 3.2-12.8-22.17 5.54-3.2z"}),s.createElement("path",{fill:"#fff",stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M6.4 6.4h51.2v51.2H6.4V6.4Z"}),s.createElement("path",{fill:"#DBEBFF",fillRule:"evenodd",d:"M57.6 40.12V57.6H6.4V19.47a13.4 13.4 0 0 1 2.28-1.84 6.48 6.48 0 0 1 5.52-.75 6.37 6.37 0 0 1 3.83 3.57c.75 1.75.67 3.54.56 4.45-.26 2.04-.98 3.65-1.79 5.47l-.1.24.38-.3c-.04.03.99-.79 1.91-1.33.5-.3 1.32-.72 2.33-.98a6.66 6.66 0 0 1 4.86.56c3.66 2 4.18 5.65 4.03 7.75-.1 1.36-.46 2.6-.82 3.56.84-.82 1.72-1.62 2.65-2.39 1.07-.87 2.81-1.96 4.78-2.53 1.67-.48 6.19-1.2 8.97 2.87a7.8 7.8 0 0 1 1.4 4.16c.79-.57 1.64-1.1 2.58-1.55l.05-.03c.36-.17 1.66-.8 3.1-1.05a7.1 7.1 0 0 1 4.68.77Z",clipRule:"evenodd"}),s.createElement("path",{stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M6.4 6.4h51.2v51.2H6.4V6.4Z"}),s.createElement("path",{fill:"#F28C8C",stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M3.2 51.2h57.6v6.4H3.2z"}),s.createElement("path",{fill:"#FEFAE9",stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",d:"M27.97 32.23a5.23 5.23 0 0 1 7.71-2.94c2.9 1.72 3.77 5.06.55 8.71-3.22 3.65-9.8 3.1-11.7 2.32 2.37-3.14 2.3-4.74 3.44-8.1Z"}),s.createElement("path",{fill:"#638EEB",stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M43.6 14.18a3.48 3.48 0 1 1 5.53 4.18L37.7 31.46l-3.58-2.7 9.48-14.58Z"}),s.createElement("path",{fill:"#15C39A",fillRule:"evenodd",d:"M36.94 37.12c-.21.3-.45.59-.7.88-3.23 3.65-9.8 3.1-11.7 2.32 1.75-2.32 2.17-3.8 2.72-5.77.1-.36.2-.73.33-1.13 1.3.08 2.16.22 3.76 2.6 1.34 1.98 3.54 1.66 5.59 1.1Z",clipRule:"evenodd"}),s.createElement("path",{fill:"#0E101A",d:"m36.94 37.12.4.3a.5.5 0 0 0-.54-.78l.14.48Zm-.7.88.37.33-.38-.33Zm-11.7 2.32-.4-.3a.5.5 0 0 0 .2.76l.2-.46Zm2.72-5.77-.48-.14.48.14Zm.33-1.13.03-.5a.5.5 0 0 0-.51.36l.48.14Zm3.76 2.6.42-.29-.42.28Zm5.18.8c-.2.29-.42.57-.67.85l.75.66c.27-.3.51-.61.73-.92l-.81-.58Zm-.67.85c-1.5 1.69-3.8 2.43-6.02 2.65-2.23.21-4.26-.12-5.11-.47l-.38.93c1.04.43 3.25.76 5.58.53 2.35-.22 4.95-1.02 6.68-2.98l-.75-.66Zm-10.92 2.95a15.1 15.1 0 0 0 2.8-5.94l-.96-.27c-.55 1.95-.95 3.36-2.64 5.6l.8.6Zm2.8-5.94c.1-.35.2-.72.33-1.11l-.96-.3-.33 1.14.96.27Zm4.03 1.05a7.25 7.25 0 0 0-2.16-2.3 4.13 4.13 0 0 0-2-.5l-.05 1c.64.03 1.08.08 1.55.36.48.28 1.04.84 1.83 2l.83-.56Zm5.03.9c-1.01.28-2 .48-2.87.4a2.79 2.79 0 0 1-2.16-1.3l-.83.56a3.79 3.79 0 0 0 2.89 1.73 9.2 9.2 0 0 0 3.24-.42l-.27-.96Z"})),s.createElement("defs",null,s.createElement("clipPath",{id:"EmptyF_a"},s.createElement("path",{fill:"#fff",d:"M0 0h64v64H0z"}))))),null)},successState:{title:"Bravo!",description:"There are no more suggestions.",illustration:s.createElement((()=>s.createElement("svg",{fill:"none",viewBox:"0 0 64 64",role:"img","aria-hidden":!0,focusable:!1},s.createElement("g",{clipPath:"url(#SuccessF_a)"},s.createElement("path",{fill:"#41D9B5",stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M.8 5.8a5 5 0 0 1 5-5h52.4a5 5 0 0 1 5 5v52.4a5 5 0 0 1-5 5H5.8a5 5 0 0 1-5-5V5.8Z"}),s.createElement("path",{fill:"#DBEBFF",stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M4.8 6.8c0-1.1.9-2 2-2h50.4a2 2 0 0 1 2 2v50.4a2 2 0 0 1-2 2H6.8a2 2 0 0 1-2-2V6.8Z"}),s.createElement("g",{clipPath:"url(#SuccessF_b)"},s.createElement("path",{fill:"#99C2FF",d:"M55.66 73.05c-.76.9-1.51 1.8-1.66 2.02H-2.94c.61-2.7.03-5.61-2.37-7.42-2.44-1.83-4.9-3.64-7.27-5.56V37.05l.12.1c1.98 1.79 5.03-.78 7.15.9 11.3 17 27.6 18.48 41.09 9.82 3.86-2.48 6.83-14.07 4.07-18.06-2.48-3.58-8.15-5.66-12.29-3a58.1 58.1 0 0 1-7.42 4.1c-.27.13-.77.28-1.11.38l.92-.25c-.47.13-.94.35-1.4.51-1.22.41-2.47.76-3.73 1.02-.61.13-1.25.2-1.86.33l.89-.2a7.2 7.2 0 0 1-.8.1c-.63.03-1.25 0-1.87-.04h-.07c.44 0 .53-.03-.61-.05a19.27 19.27 0 0 1-2.23-.55h-.01c-.5-.27-1-.5-1.49-.77-.4-.23-.82-.61-1.25-.83l-.42-.34c-1.12-.97-2.1-2.05-3.09-3.13C.7 25.66-3.16 16.37-4.78 15.2 1.27 17.47 10.8 16.8 15.6 14c4.8-2.8 9.6-7.31 11.42-13.73 0 0 8.38.75 14.05 4.15 5.66 3.4 6.8 8.31 9.44 14.74 2.65 6.42 9.07 8.68 15.12 6.38l.37.05-1.13 16.61c-8.38-6-17 .89-19.27 6.04-2.22 5.05 11.37 22.27 10.06 24.81 1.5-1.77 3.06-3.53-.04.07a.52.52 0 0 1-.07.08l.07-.08a.58.58 0 0 0 .04-.07Z",opacity:".7"}),s.createElement("path",{fill:"#FCE5E5",d:"m30.37 12.1 1.17-2.18c.6-1.12 1.3-1.53 2.49-1.97a3.36 3.36 0 0 1 2.64.27c.81.42 1.47.27 2.06.97a15.46 15.46 0 0 1 2.87 13.86c-.11.4-.25.82-.22 1.25.02.34.14.66.19 1 .07.6-.1 1.19-.24 1.77-.56 2.19-.85 4.58.06 6.65.25.56.58 1.1.69 1.7.09.46.04.93 0 1.4-.26 3.04-.13 6.12.4 9.13-7.1.5-14.29-.28-21.12-2.27a1.27 1.27 0 0 1-.52-.24c-.26-.25-.27-.67-.19-1.02.21-.93.86-1.7 1.5-2.42 2.2-2.55 4.42-5.09 6.64-7.63"}),s.createElement("path",{fill:"#F28C8C",fillRule:"evenodd",d:"M24.77 36.29s-15.01-.79-6.79-7.93l-5.65-5.65S9.72 26.48 7.5 32.4c-1.04 2.75 1.39 5.17 4.43 8.21 3.5 3.5 7.82 7.81 8.64 14.39.14 1.11.3 1.87.45 2.33.17 1.1.34 2.26.5 3.5.43 3.31.49 14.3.49 14.3l34.4-.27.05-29.5c0-4.2-2.56-7.97-6.47-9.5l-9.8 7.7c-16.84 3.76-14.9-7.14-14.9-7.14s-.22.21-.57.59l.06-.72Z",clipRule:"evenodd"}),s.createElement("path",{fill:"#FFC940",fillRule:"evenodd",d:"m22.98 37.83 1.2.1 1.2.11a2.27 2.27 0 0 0 0 .32 5.82 5.82 0 0 0 1.34 3.7c1.44 1.72 4.83 3.52 13.04 1.68l.53 2.36c-8.61 1.93-13.15.24-15.43-2.48a8.24 8.24 0 0 1-1.88-5.77v-.02Z",clipRule:"evenodd"}),s.createElement("path",{fill:"#0E101A",d:"m17.98 28.36.33.38a.5.5 0 0 0 .02-.73l-.35.35Zm6.36 7.93.5.05a.5.5 0 0 0-.47-.55l-.03.5Zm-12-13.58.34-.35a.5.5 0 0 0-.75.05l.4.3Zm-4.92 9.45.47.17-.47-.17Zm4.78 8.56.36-.35-.36.35Zm8.48 13.62.5-.06-.5.06Zm.07.61.5-.04-.5.04Zm.06 1.26h.5-.5Zm.1 2.46.5.01a.5.5 0 0 0 0-.1l-.5.1Zm-.1 1.98.5.04-.5-.04ZM22 75.12l-.5.07a.5.5 0 0 0 .5.43v-.5Zm34.39-.26v.5a.5.5 0 0 0 .5-.5h-.5Zm.06-29.1h-.5.5Zm-6.9-9.9.18-.47a.5.5 0 0 0-.5.09l.32.38Zm-9.37 7.7.1.48a.5.5 0 0 0 .21-.1l-.31-.39Zm-14.9-7.14.49.1a.5.5 0 0 0-.84-.46l.35.36Zm-1.08 1.15-.5-.05a.5.5 0 0 0 .88.38l-.38-.33Zm-6.55-9.59c-2.07 1.8-2.9 3.36-2.63 4.73.26 1.35 1.54 2.2 2.87 2.75 1.36.57 2.98.9 4.23 1.09a28.35 28.35 0 0 0 2.15.24h.04l.03-.5.03-.5h-.04l-.11-.01a20.5 20.5 0 0 1-1.95-.22c-1.23-.18-2.75-.5-4-1.02-1.29-.54-2.11-1.22-2.27-2.02-.16-.8.27-2.01 2.3-3.78l-.65-.76Zm-5.67-4.92 5.65 5.65.7-.7-5.65-5.65-.7.7Zm-4.1 9.27a45.35 45.35 0 0 1 4.41-8.7 19.79 19.79 0 0 1 .44-.62l-.4-.3-.4-.3v.01a8.3 8.3 0 0 0-.47.65 46.35 46.35 0 0 0-4.51 8.9l.94.36Zm4.68 8.04a33.1 33.1 0 0 1-3.9-4.42c-.89-1.35-1.2-2.5-.77-3.62l-.94-.35c-.58 1.55-.09 3.06.88 4.52.95 1.45 2.44 2.96 4.02 4.57l.71-.7Zm8.62 13.9c-.8-5.95-5.13-10.35-8.62-13.9l-.71.7c3.53 3.6 7.6 7.77 8.34 13.34l.99-.14Zm.07.63-.07-.62-1 .12.07.6 1-.1Zm.06 1.3c0-.43-.02-.87-.06-1.29l-1 .09c.04.4.06.8.06 1.2h1Zm.1 2.39c-.06-.35-.1-1.1-.1-2.38h-1c0 1.27.03 2.1.11 2.55l.99-.17Zm-.1 2.1c.06-.71.09-1.38.1-2l-1-.03c0 .6-.04 1.25-.1 1.94l1 .09ZM22 75.12l.5-.07-.01-.03-.01-.09a178.11 178.11 0 0 1-.69-5.85c-.33-3.22-.62-6.79-.49-8.4l-1-.08c-.14 1.72.17 5.4.5 8.58a242.97 242.97 0 0 0 .69 5.88v.1l.01.02.5-.06Zm34.39-.76-34.4.26.01 1 34.4-.26-.01-1Zm-.44-28.6-.06 29.1h1l.06-29.1h-1Zm-6.57-9.43a10.02 10.02 0 0 1 6.57 9.43h1c0-4.63-2.88-8.77-7.22-10.37l-.35.94Zm-8.89 7.61 9.38-7.7-.63-.76-9.38 7.69.63.77Zm-15.21-7.52a28.07 28.07 0 0 0-.5-.08 1.23 1.23 0 0 0-.02.14l-.03.37A7.16 7.16 0 0 0 26 41.69c1.8 2.5 5.79 4.25 14.28 2.35l-.22-.97c-8.35 1.86-11.8.05-13.25-1.96a6.16 6.16 0 0 1-1.08-3.09 7.29 7.29 0 0 1 .03-1.51l-.5-.09Zm-.7 1.48a20.66 20.66 0 0 1 1.02-1.1l.02-.01-.34-.37-.35-.36-.02.02-.06.06a14.31 14.31 0 0 0-1.03 1.1l.76.66Zm-.24-1.61-.5-.06v.09l-.03.25-.1.95.99.1a525.27 525.27 0 0 0 .14-1.27l-.5-.06Z"}),s.createElement("path",{stroke:"#0E101A",strokeLinejoin:"round",d:"M48 55.39v11.85L35.83 74.8"}),s.createElement("path",{fill:"#0E101A",d:"m35.6 7.62-3.88 4.16s1.11 19.1-.24 23.23c-1.35 4.13-3.94 11.76-6.08 12.72-2.14.96-5.04.48-5.04-2.4 0-2.87 4.03-7.9 1.64-9.33.4 0 4.66-.98 3.63-6.47-1.03-5.48-2.85-13.96-.23-17.75 2.62-3.8 5.6-4.64 10.2-4.16Z"}),s.createElement("path",{fill:"#FCE5E5",d:"M32.7 11.5c-2.44-.09-6.13 1.14-6.3 3.94-.16 2.8.4 3.8.33 4.5-.08.7-1.21 3.58.24 5.9 1.45 2.34 3.78 3.89 4.59 4.12.8.24 4.51-1.16 6.6-3.18"}),s.createElement("path",{fill:"#0E101A",d:"M32.67 12a.5.5 0 0 0 .04-1l-.04 1Zm-6.27 3.44.5.03-.5-.03Zm5.16 14.52-.14.48.14-.48Zm1.15-18.95a8.94 8.94 0 0 0-4.24.93c-1.33.7-2.47 1.82-2.56 3.47l1 .06c.06-1.16.85-2.04 2.02-2.64 1.16-.6 2.6-.87 3.74-.82l.04-1Zm-6.8 4.4a14.04 14.04 0 0 0 .22 3.63l.06.38c.04.23.05.36.04.47l1 .11c.02-.25 0-.5-.05-.74l-.07-.4-.08-.46c-.1-.66-.2-1.58-.13-2.93l-1-.06Zm.32 4.48-.06.3-.13.53c-.1.41-.2.93-.26 1.51a6.08 6.08 0 0 0 .76 3.88l.85-.53a5.09 5.09 0 0 1-.62-3.25c.05-.52.15-.99.24-1.38l.13-.53c.04-.15.07-.3.08-.42l-.99-.11Zm.31 6.22a12.39 12.39 0 0 0 2.65 2.97 7.58 7.58 0 0 0 2.23 1.36l.28-.96a6.82 6.82 0 0 1-1.88-1.18 11.4 11.4 0 0 1-2.43-2.72l-.85.53Zm4.88 4.33c.2.06.42.06.62.03.22-.02.46-.07.72-.14a14.15 14.15 0 0 0 5.75-3.2l-.7-.71a13.16 13.16 0 0 1-5.88 3.06h-.23l-.28.96Z"}),s.createElement("path",{stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",d:"M31.57 19.2s-.7 3.52-.48 3.95c.21.43 1.4.43 1.99.06"}),s.createElement("path",{fill:"#0E101A",d:"M28.8 20.11c.44 0 .8-.48.8-1.07 0-.6-.36-1.08-.8-1.08-.44 0-.8.48-.8 1.08 0 .59.36 1.07.8 1.07Z"}),s.createElement("path",{stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",d:"m36.34 19.7-2.51-.93 2.43-.88M30.25 26.1s3.6 1.1 4-.9"}),s.createElement("path",{fill:"#F9EA9E",stroke:"#0E101A",strokeLinejoin:"round",d:"M48.27 35s-4.7 12.38-13.47 17.8c-5.76 3.56-13.2 3.6-14 3.2-3 12.82 1.59 16.32 4.38 15.39 2.8-.93 9.17-3.93 15.4-11.59C46.8 52.15 50.97 39.12 54 39.2c-1.2-2.4-5.73-4.2-5.73-4.2Z"}),s.createElement("path",{fill:"#0E101A",d:"M31.23 12c1.46 0 4.71-.06 6.32 2.42 1.61 2.49 4.49 9.96 1.74 19.87-2.74 9.9-3.36 15.25 1.72 15.25 5.07 0 5.98-2.57 5.98-7.7 0-5.12 3.42-5.55 4.27-5.55-2.42-2.02-4.84-.86-5.6-12.98C44.88 11.2 39.38 7.62 35.6 7.62c-.26 0-5.83 4.37-4.38 4.37Z"}),s.createElement("path",{fill:"#FCE5E5",d:"M22.5 23.5c5.14-2.01 5.47-2.87 4.3-3.5-1.17-.63-3.7.79-3.7.79s.28-.46 2.43-1.75c2.14-1.3-.15-2.43-1.8-1.79-.8.31-2.17.88-1.94 1.73 0 0-2-2.98-5.13.25-1.83 1.88-1.74 3.36-1.4 4.22h-.17l-4.92 6.15 4.49 1 3.5-4.79c.99.76 4.99.52 4.32-1.62-.21-.66-.5-1.37-.84-2.01l.01-.02-.16-.26"}),s.createElement("path",{stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",d:"M15.74 24.2s-2.06-2 .9-5.05c3.12-3.22 5.3 0 5.3 0s.24 4.88-2.38 3.95c-1.25-.44.05-3.85.05-3.85"}),s.createElement("path",{stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",d:"M21.77 18.56s.71-.68 2.36-1.33c1.65-.64 3.05.69.9 1.98-2.14 1.3-1.96 1.5-1.96 1.5s3.17-1.56 4.02-.79c.84.77-.31 2.04-4.63 3.5M17.52 19.5s-1.34 2.18-.26 2.85c1.07.67 1.36-.65 1.36-.65"}),s.createElement("path",{fill:"#FCE5E5",d:"M21.98 22.99c-.14-.22-.63-1.35-.77-1.57a.51.51 0 0 0-.17-.2c-.09-.04-.67-1-.77-.98-.24.04-1.02-.23-1.18-.04-.65.77.03 2.18.05 2.52 0 .08.74 1.58.88 1.57.2 0 1.12-.26 1.2-.46"}),s.createElement("path",{stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",d:"M19.56 23.1s-1.48-2.16-.41-2.98c1.06-.82 2.63 1.84 3.3 4 .67 2.14-3.33 2.38-4.32 1.62l-3.87 4.88-2.96-2.69 3.8-5.02"}),s.createElement("path",{fill:"#F28C8C",d:"M12.73 23.92s.4 3.63 4.44 4.44c0 0-2.82 2.02-3.22 4.84-.4 2.83-5.65-.37-5.65-.37l1.61-4.87"}),s.createElement("path",{stroke:"#0E101A",strokeLinejoin:"round",d:"M12.33 23.11s1.62 4.85 5.25 5.25"})),s.createElement("path",{stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M4.8 6.8c0-1.1.9-2 2-2h50.4a2 2 0 0 1 2 2v50.4a2 2 0 0 1-2 2H6.8a2 2 0 0 1-2-2V6.8Z"})),s.createElement("defs",null,s.createElement("clipPath",{id:"SuccessF_a"},s.createElement("path",{fill:"#fff",d:"M0 0h64v64H0z"})),s.createElement("clipPath",{id:"SuccessF_b"},s.createElement("path",{fill:"#fff",d:"M4.8 4.8h54.4v54.4H4.8z"}))))),null)}},{emptyState:{title:"Time to dig in.",description:"Suggestions will appear here.",illustration:s.createElement((()=>s.createElement("svg",{fill:"none",viewBox:"0 0 64 64",role:"img","aria-hidden":!0,focusable:!1},s.createElement("g",{clipPath:"url(#EmptyG_a)"},s.createElement("path",{fill:"#DBEBFF",stroke:"#0E101A",d:"m51.15 10.56-3.71-1.48-5.32 13.38 3.71 1.48z"}),s.createElement("path",{fill:"#4A6EE0",stroke:"#0E101A",d:"m49.29 31.5-14.87-5.9 1.48-3.75a6 6 0 0 1 7.8-3.36l3.71 1.48a6 6 0 0 1 3.36 7.8L49.3 31.5Z"}),s.createElement("path",{fill:"#4A6EE0",fillRule:"evenodd",stroke:"#0E101A",d:"M56.36 7.08a2.47 2.47 0 0 0-1.17-3.63l-5.8-2.31a2.47 2.47 0 0 0-3.35 1.83l-.94 4.95a2.47 2.47 0 0 0 1.51 2.77l4.04 1.6c1.1.44 2.36.03 3-.97l2.71-4.24Zm-2.8-1.16-2.1 3.57-3.52-1.4.93-4.03 4.69 1.86Z",clipRule:"evenodd"}),s.createElement("path",{fill:"#FFF0D4",stroke:"#0E101A",strokeLinecap:"round",d:"M2.96 54.7C-4.82 51.48 7.2 28.34 27.6 22 48 15.65 67.98 49.1 61.9 54c-6.09 4.92-20.72 5.5-32.72 5.1-12-.4-18.44-1.2-26.22-4.4Z"}),s.createElement("path",{fill:"#AAF2E1",stroke:"#0E101A",d:"m11.5 24.49 3.38-2.12 7.63 12.21-3.39 2.12z"}),s.createElement("path",{fill:"#15C39A",stroke:"#0E101A",d:"m17.08 44.75 13.57-8.48-2.13-3.4a6 6 0 0 0-8.27-1.91l-3.4 2.12a6 6 0 0 0-1.9 8.26l2.13 3.41Z"}),s.createElement("path",{fill:"#15C39A",fillRule:"evenodd",stroke:"#0E101A",d:"M5.74 22a2.47 2.47 0 0 1 .5-3.79l5.3-3.31a2.47 2.47 0 0 1 3.62 1.2l1.82 4.7c.43 1.12 0 2.37-1 3l-3.68 2.3c-1.01.63-2.32.46-3.13-.41l-3.43-3.7Zm2.55-1.65L11 23.5l3.22-2-1.64-3.81-4.28 2.67Z",clipRule:"evenodd"}),s.createElement("path",{fill:"#FFF0D4",d:"M19.35 39.37a12.57 12.57 0 0 0-4.97 7.32l9.6 2 14.8-10-6.8-6.8c-4.26 5.53-8.47 4.55-12.63 7.48Z"}),s.createElement("path",{stroke:"#0E101A",strokeLinecap:"round",d:"M14.8 44.4s.76-2.61 4.38-4.9c3.62-2.3 7.62-1.9 12.02-6.3"}),s.createElement("ellipse",{cx:"42.75",cy:"42.11",fill:"#EF6E6E",stroke:"#0E101A",strokeLinejoin:"round",rx:"10.49",ry:"3.82"}),s.createElement("path",{fill:"#FFF0D4",stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",d:"M38.63 40.85c-3.34.38-5.22 2.5-5.01 3.79.2 1.28 2.92 4.16 2.92 4.16h9.61S52 48.05 52 45.77c0-2.27-1.67-3.31-3.76-3.78-2.09-.48-4.24.41-4.24.41s-2.03-1.93-5.37-1.55Z"}),s.createElement("path",{fill:"#F28C8C",fillRule:"evenodd",d:"m32.3 42.45 2.18 18.16c0 1.37 3.7 2.48 8.27 2.48C47.3 63.1 51 62 51 60.61l2.19-18.16c-.47 1.95-4.97 3.47-10.45 3.47-5.48 0-9.98-1.52-10.45-3.47Z",clipRule:"evenodd"}),s.createElement("path",{fill:"#0E101A",d:"m32.3 42.45.48-.12a.5.5 0 0 0-.98.18l.5-.06Zm2.18 18.16h.5a.5.5 0 0 0 0-.06l-.5.06Zm16.53 0-.5-.06a.5.5 0 0 0 0 .06h.5Zm2.19-18.16.5.06a.5.5 0 0 0-.99-.18l.49.12Zm-21.4.06 2.18 18.16 1-.12-2.19-18.16-.99.12Zm2.18 18.1c0 .59.4 1.04.86 1.38.48.34 1.14.62 1.92.86 1.55.46 3.67.74 5.99.74v-1c-2.25 0-4.27-.27-5.7-.7a5.76 5.76 0 0 1-1.63-.72c-.37-.26-.44-.46-.44-.56h-1Zm8.77 2.98c2.32 0 4.43-.28 5.99-.74a6.71 6.71 0 0 0 1.91-.86c.47-.34.86-.8.86-1.38h-1c0 .1-.07.3-.43.56-.36.25-.9.5-1.63.72-1.44.43-3.45.7-5.7.7v1Zm8.76-2.92 2.19-18.16-1-.12-2.18 18.16 1 .12Zm1.2-18.34c-.08.33-.34.7-.87 1.08-.51.38-1.24.73-2.15 1.03-1.8.6-4.24.98-6.94.98v1c2.78 0 5.33-.38 7.26-1.03.97-.32 1.8-.72 2.42-1.17.62-.46 1.1-1 1.26-1.66l-.98-.23Zm-9.96 3.1c-2.7 0-5.14-.38-6.95-.99-.9-.3-1.63-.65-2.15-1.03s-.79-.75-.87-1.08l-.97.23c.16.65.63 1.2 1.25 1.66.63.45 1.46.85 2.42 1.17 1.94.65 4.49 1.03 7.27 1.03v-1Z"}),s.createElement("path",{stroke:"#0E101A",strokeLinejoin:"round",d:"M41.81 47.08c.4.63.84 1.27 1.33 1.9 3.81 5 8.67 7.7 10.86 6.03 1.83-1.4 1.22-5.38-1.25-9.56"}),s.createElement("circle",{cx:"41.79",cy:"47.04",r:"1.91",fill:"#F9C7C7",stroke:"#0E101A",strokeLinejoin:"round"})),s.createElement("defs",null,s.createElement("clipPath",{id:"EmptyG_a"},s.createElement("path",{fill:"#fff",d:"M0 0h64v64H0z"}))))),null)},successState:{title:"Looking good!",description:"There are no more suggestions.",illustration:s.createElement((()=>s.createElement("svg",{fill:"none",viewBox:"0 0 64 64",role:"img","aria-hidden":!0,focusable:!1},s.createElement("g",{clipPath:"url(#SuccessG_a)"},s.createElement("path",{stroke:"#0E101A",strokeLinejoin:"round",d:"M32 12V.8"}),s.createElement("path",{fill:"#41D9B5",stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",d:"m32 .8 10.4 2-10.4 2v-4Z"}),s.createElement("path",{fill:"#FFF0D4",fillRule:"evenodd",d:"M4.19 57.54c-11.68-1.65 9.45-9.48 23.8-11.66 14.34-2.19 41.86 7.56 33.74 11.33-1.66.77-14.7 2.23-24.14 2.87a6.31 6.31 0 0 0-2.96 1.21c-1.76 1.17-4.44 1.91-7.43 1.91-2.26 0-4.34-.42-5.98-1.13a7.64 7.64 0 0 0-4-.58c-.53.07-1.07.11-1.62.11-2.4 0-4.53-.7-5.93-1.8-1.06-.83-2.18-1.77-3.52-1.97l-.64-.1-1.32-.19Z",clipRule:"evenodd"}),s.createElement("path",{fill:"#0E101A",d:"m27.98 45.88.08.5-.08-.5ZM4.2 57.54l-.07.5.07-.5Zm57.54-.33.21.45-.2-.45Zm-56.22.53.07-.5-.07.5Zm22.4-12.36C20.7 46.48 11.79 49 6.13 51.45a27.57 27.57 0 0 0-3.6 1.83 5.88 5.88 0 0 0-2 1.8 1.5 1.5 0 0 0-.2 1.07c.08.37.32.68.64.91.62.46 1.68.77 3.15.98l.14-1c-1.45-.2-2.29-.49-2.7-.78-.19-.14-.24-.26-.25-.32-.02-.07-.01-.18.09-.36.21-.39.76-.88 1.67-1.45.89-.56 2.06-1.16 3.45-1.76 5.58-2.42 14.4-4.91 21.54-6l-.15-.99Zm34.03 12.28c1.08-.5 1.77-1.2 1.76-2.11 0-.86-.63-1.67-1.48-2.4-1.73-1.46-4.94-3-8.78-4.31-7.69-2.65-18.25-4.57-25.53-3.46l.15 1c7.06-1.08 17.43.78 25.06 3.4 3.81 1.32 6.87 2.8 8.46 4.14.8.7 1.12 1.24 1.12 1.63 0 .33-.22.76-1.18 1.2l.42.91Zm-24.31 2.92c4.72-.32 10.35-.85 15-1.39 2.33-.27 4.42-.55 6.03-.8.8-.13 1.5-.26 2.05-.38a6.6 6.6 0 0 0 1.23-.35l-.42-.9a5.9 5.9 0 0 1-1.02.28c-.52.11-1.2.23-2 .36-1.59.25-3.66.53-5.98.8-4.64.54-10.25 1.07-14.96 1.39l.07 1ZM27.2 63.7c3.07 0 5.84-.76 7.7-1.99l-.55-.83c-1.66 1.1-4.23 1.82-7.15 1.82v1Zm-6.17-1.17c1.7.74 3.85 1.17 6.17 1.17v-1c-2.2 0-4.2-.41-5.78-1.09l-.4.92ZM17.14 61c-.5.06-1 .1-1.54.1v1c.58 0 1.14-.04 1.68-.11l-.14-1Zm-1.54.1c-2.3 0-4.33-.68-5.62-1.69l-.61.79c1.5 1.18 3.75 1.9 6.23 1.9v-1ZM5.44 58.23l.64.1.14-1-.64-.09-.14 1Zm-1.32-.2 1.32.2.14-.99-1.32-.2-.14 1Zm5.86 1.38c-1.02-.8-2.26-1.85-3.76-2.07l-.14.98c1.18.18 2.18 1.01 3.29 1.88l.61-.79Zm11.44 2.2a8.13 8.13 0 0 0-4.28-.61l.14.99a7.14 7.14 0 0 1 3.75.54l.4-.92Zm16.14-2.02c-1.22.08-2.3.68-3.2 1.29l.54.83a5.83 5.83 0 0 1 2.73-1.13l-.07-1Z"}),s.createElement("path",{fill:"#FFF0D4",stroke:"#0E101A",strokeLinecap:"round",d:"M36.4 21.6h-8.8a2 2 0 0 1-2-2v-4.37a2 2 0 0 1 .59-1.42l4.4-4.4a2 2 0 0 1 2.82 0l4.4 4.4a2 2 0 0 1 .59 1.42v4.37a2 2 0 0 1-2 2Z"}),s.createElement("path",{fill:"#F28C8C",stroke:"#0E101A",d:"M30.4 13.6a1.6 1.6 0 0 1 3.2 0v3.2h-3.2v-3.2Z"}),s.createElement("path",{fill:"#FFF0D4",stroke:"#0E101A",strokeLinecap:"round",d:"M39.6 20H24.4a2 2 0 0 0-2 2v21.6c0 1.1.9 2 2 2h15.2a2 2 0 0 0 2-2V22a2 2 0 0 0-2-2Z"}),s.createElement("path",{fill:"#F28C8C",stroke:"#0E101A",d:"M30.4 24.8a1.6 1.6 0 0 1 3.2 0V28h-3.2v-3.2Z"}),s.createElement("path",{fill:"#FFF0D4",stroke:"#0E101A",strokeLinecap:"round",d:"M26 28h-7.2a2 2 0 0 0-2 2v17.6c0 1.1.9 2 2 2H26a2 2 0 0 0 2-2V30a2 2 0 0 0-2-2Z"}),s.createElement("path",{fill:"#F28C8C",stroke:"#0E101A",d:"M20.8 32.8a1.6 1.6 0 0 1 3.2 0V36h-3.2v-3.2Z"}),s.createElement("path",{fill:"#FFF0D4",stroke:"#0E101A",strokeLinecap:"round",d:"M45.2 28H38a2 2 0 0 0-2 2v17.6c0 1.1.9 2 2 2h7.2a2 2 0 0 0 2-2V30a2 2 0 0 0-2-2Z"}),s.createElement("path",{fill:"#F28C8C",stroke:"#0E101A",d:"M40 32.8a1.6 1.6 0 1 1 3.2 0V36H40v-3.2Z"}),s.createElement("path",{fill:"#FFF0D4",fillRule:"evenodd",d:"M12.8 41.2c0-1.1.9-2 2-2h2.54a2 2 0 0 1 2 2v2h4.08v-2c0-1.1.9-2 2-2h2.54a2 2 0 0 1 2 2v2h4.08v-2c0-1.1.9-2 2-2h2.54a2 2 0 0 1 2 2v2h4.08v-2c0-1.1.9-2 2-2h2.54a2 2 0 0 1 2 2v4a2 2 0 0 1-.05.45c.03.18.05.36.05.55v7.4H12.8v-7.4c0-.19.02-.37.05-.55a2 2 0 0 1-.05-.45v-4Z",clipRule:"evenodd"}),s.createElement("path",{fill:"#0E101A",d:"M19.34 43.2h-.5v.5h.5v-.5Zm4.08 0v.5h.5v-.5h-.5Zm6.54 0h-.5v.5h.5v-.5Zm4.08 0v.5h.5v-.5h-.5Zm6.54 0h-.5v.5h.5v-.5Zm4.08 0v.5h.5v-.5h-.5Zm6.49 2.45-.49-.11-.02.1.02.1.49-.1Zm.05 7.95v.5h.5v-.5h-.5Zm-38.4 0h-.5v.5h.5v-.5Zm.05-7.95.5.09.01-.1-.02-.1-.49.1Zm1.95-6.95a2.5 2.5 0 0 0-2.5 2.5h1c0-.83.67-1.5 1.5-1.5v-1Zm2.54 0H14.8v1h2.54v-1Zm2.5 2.5a2.5 2.5 0 0 0-2.5-2.5v1c.82 0 1.5.67 1.5 1.5h1Zm0 2v-2h-1v2h1Zm3.58-.5h-4.08v1h4.08v-1Zm-.5-1.5v2h1v-2h-1Zm2.5-2.5a2.5 2.5 0 0 0-2.5 2.5h1c0-.83.67-1.5 1.5-1.5v-1Zm2.54 0h-2.54v1h2.54v-1Zm2.5 2.5a2.5 2.5 0 0 0-2.5-2.5v1c.83 0 1.5.67 1.5 1.5h1Zm0 2v-2h-1v2h1Zm3.58-.5h-4.08v1h4.08v-1Zm-.5-1.5v2h1v-2h-1Zm2.5-2.5a2.5 2.5 0 0 0-2.5 2.5h1c0-.83.67-1.5 1.5-1.5v-1Zm2.54 0h-2.54v1h2.54v-1Zm2.5 2.5a2.5 2.5 0 0 0-2.5-2.5v1c.83 0 1.5.67 1.5 1.5h1Zm0 2v-2h-1v2h1Zm3.58-.5h-4.08v1h4.08v-1Zm.5.5v-2h-1v2h1Zm0-2c0-.83.68-1.5 1.5-1.5v-1a2.5 2.5 0 0 0-2.5 2.5h1Zm1.5-1.5h2.54v-1h-2.54v1Zm2.54 0c.83 0 1.5.67 1.5 1.5h1a2.5 2.5 0 0 0-2.5-2.5v1Zm1.5 1.5v4h1v-4h-1Zm0 4c0 .12-.01.23-.04.34l.98.22c.04-.18.06-.37.06-.56h-1Zm1 1c0-.22-.02-.43-.06-.64l-.98.18c.03.15.04.3.04.46h1Zm0 7.4v-7.4h-1v7.4h1Zm-19.7.5h19.2v-1H32v1Zm-19.2 0H32v-1H12.8v1Zm-.5-7.9v7.4h1v-7.4h-1Zm.06-.64c-.04.2-.06.42-.06.64h1c0-.16.01-.31.04-.46l-.98-.18Zm-.06-.36c0 .2.02.38.06.56l.98-.22a1.5 1.5 0 0 1-.04-.34h-1Zm0-4v4h1v-4h-1Z"}),s.createElement("path",{fill:"#FFF0D4",d:"M13.2 50.4h37.6v6.4H13.2v-6.4Z"}),s.createElement("circle",{cx:"7.2",cy:"7.2",r:"6.4",fill:"#F8E485",stroke:"#0E101A"}),s.createElement("path",{stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",d:"M3.2 21.6c2.18 0 4 4 4 4s1.82-4 4-4M12.8 16c1.75 0 3.2 3.2 3.2 3.2s1.45-3.2 3.2-3.2"})),s.createElement("defs",null,s.createElement("clipPath",{id:"SuccessG_a"},s.createElement("path",{fill:"#fff",d:"M0 0h64v64H0z"}))))),null)}},{emptyState:{title:"All the world's a page.",description:"Suggestions will appear here.",illustration:s.createElement(Vu,null)},successState:{title:"You deserve a break.",description:"There are no more suggestions.",illustration:s.createElement((()=>s.createElement("svg",{fill:"none",viewBox:"0 0 64 64",role:"img","aria-hidden":!0,focusable:!1},s.createElement("path",{stroke:"#0E101A",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M28.64 24s2.56-1.62 2.56-4.86c0-4.92-6.4-5.8-6.4-10.67 0-3.36 3.84-6.07 3.84-6.07M36.64 21.6s2.56-1.56 2.56-4.68c0-4.8-6.4-5.52-6.4-10.28C32.8 3.41 36.64.8 36.64.8"}),s.createElement("path",{fill:"#C6CBDE",d:"M32.8 64c11.05 0 20-1.43 20-3.2 0-1.77-8.95-3.2-20-3.2s-20 1.43-20 3.2c0 1.77 8.95 3.2 20 3.2Z"}),s.createElement("path",{fill:"#1995BB",fillRule:"evenodd",stroke:"#0E101A",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M49.6 35.2h5.39c2.82 0 5.01 2.47 5.01 5.36v6.08c0 2.89-2.2 5.36-5.01 5.36H49.6v-3.5h5.39c.85 0 1.66-.78 1.66-1.86v-6.08c0-1.08-.81-1.86-1.66-1.86H49.6v-3.5Z",clipRule:"evenodd"}),s.createElement("path",{fill:"#15C39A",stroke:"#0E101A",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M31 60.8a19 19 0 0 1-19-19V31.2h40v10.6a19 19 0 0 1-19 19h-2Z"}),s.createElement("path",{fill:"#F7E68B",d:"M49.66 32.63c1.5-.44 2.34-.94 2.34-1.48C52 29.41 43.04 28 32 28s-20 1.4-20 3.15c0 .6 1.08 1.17 2.95 1.65 3.37-1 10-1.67 17.65-1.67 7.22 0 13.54.6 17.06 1.5Z"}),s.createElement("path",{fill:"#1F243C",stroke:"#0E101A",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M49.6 32.71c-3.49-.9-9.75-1.51-16.9-1.51-7.58 0-14.16.68-17.5 1.69 3.49.9 9.75 1.51 16.9 1.51 7.58 0 14.16-.68 17.5-1.69Z"}),s.createElement("path",{stroke:"#0E101A",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M32 34.4c11.05 0 20-1.43 20-3.2 0-1.77-8.95-3.2-20-3.2s-20 1.43-20 3.2c0 1.77 8.95 3.2 20 3.2ZM23.2 34v7.6"}),s.createElement("path",{fill:"#FAC0D6",stroke:"#0E101A",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M25.98 48.64H20.6a.77.77 0 0 1-.77-.76V42.5c0-.42.35-.77.77-.77h5.37c.42 0 .77.35.77.77v5.37c0 .42-.35.76-.77.76Z"}))),null)}},{emptyState:{title:"So far, so good.",description:"Suggestions will appear here.",illustration:s.createElement((()=>s.createElement("svg",{fill:"none",viewBox:"0 0 64 64",role:"img","aria-hidden":!0,focusable:!1},s.createElement("g",{clipPath:"url(#EmptyI_a)"},s.createElement("path",{fill:"#C6CBDE",d:"M35.6 64c14.8 0 18.8-3.04 18.8-6.8s-4-6.8-18.8-6.8-26.8 3.04-26.8 6.8 12 6.8 26.8 6.8Z"}),s.createElement("ellipse",{cx:"32",cy:"26.8",fill:"#15C39A",stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",rx:"31.2",ry:"6"}),s.createElement("mask",{id:"EmptyI_b",width:"64",height:"14",x:"0",y:"20",maskUnits:"userSpaceOnUse",style:{maskType:"alpha"}},s.createElement("ellipse",{cx:"32",cy:"26.8",fill:"#15C39A",stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",rx:"31.2",ry:"6"})),s.createElement("g",{mask:"url(#EmptyI_b)"},s.createElement("path",{fill:"#FFF0D4",fillRule:"evenodd",d:"M20.9 25.03a15.38 15.38 0 0 1 6.83-2.51 14.38 14.38 0 0 1 11.68 3.73s4.67-2.14 9.22-1c4.54 1.13 8.17 3.63 8.17 9.08S44.08 41.6 44.08 41.6H24.71a12.9 12.9 0 0 1-6.31 1.6c-6.19 0-11.2-4.12-11.2-9.2 0-5.08 5.01-9.2 11.2-9.2.86 0 1.7.08 2.5.23Z",clipRule:"evenodd"}),s.createElement("path",{fill:"#0E101A",d:"m27.73 22.52.07.5-.07-.5Zm-6.83 2.51-.09.5a.5.5 0 0 0 .38-.09l-.29-.41Zm18.5 1.22-.35.34c.14.16.37.2.57.11l-.21-.45Zm9.23-1-.13.48.13-.49ZM44.08 41.6v.5a.5.5 0 0 0 .07 0l-.07-.5Zm-19.37 0v-.5a.5.5 0 0 0-.24.06l.24.44Zm2.96-19.58a15.88 15.88 0 0 0-7.05 2.6l.56.82c1.7-1.17 3.93-2.09 6.62-2.43l-.13-.99Zm11.74 4.23.36-.35-.02-.02a4.06 4.06 0 0 0-.2-.2l-.63-.53a14.96 14.96 0 0 0-11.25-3.12l.13.98a13.96 13.96 0 0 1 11.25 3.58l.36-.34Zm9.34-1.5c-2.38-.59-4.77-.32-6.55.08a18.63 18.63 0 0 0-2.98.96h-.01l.2.46.2.45h.02l.03-.02a8.13 8.13 0 0 1 .72-.28c.5-.18 1.2-.4 2.04-.6 1.7-.38 3.92-.61 6.08-.07l.25-.97Zm8.55 9.58c0-2.85-.96-4.97-2.53-6.52-1.57-1.53-3.7-2.47-6.02-3.05l-.25.97c2.23.56 4.18 1.43 5.57 2.8 1.37 1.34 2.23 3.2 2.23 5.8h1ZM44.08 41.6l.07.5h.02l.02-.01a9.58 9.58 0 0 0 .53-.09 38.05 38.05 0 0 0 5.89-1.52 16.35 16.35 0 0 0 4.51-2.32c1.25-.98 2.18-2.25 2.18-3.83h-1c0 1.15-.66 2.15-1.8 3.04-1.13.9-2.66 1.6-4.23 2.17a34.72 34.72 0 0 1-6.22 1.56h-.03l.06.5Zm-19.37.5h19.37v-1H24.71v1Zm-.24-.94a12.4 12.4 0 0 1-6.07 1.54v1c2.43 0 4.68-.61 6.56-1.66l-.5-.88ZM18.4 42.7c-6 0-10.7-3.98-10.7-8.7h-1c0 5.44 5.33 9.7 11.7 9.7v-1ZM7.7 34c0-4.72 4.7-8.7 10.7-8.7v-1c-6.37 0-11.7 4.26-11.7 9.7h1Zm10.7-8.7c.83 0 1.64.08 2.41.22l.18-.98c-.83-.16-1.7-.24-2.59-.24v1Z"}),s.createElement("ellipse",{cx:"32",cy:"26.8",stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",rx:"31.2",ry:"6"})),s.createElement("path",{fill:"#F28C8C",fillRule:"evenodd",d:"M55 1a2.4 2.4 0 0 0-3.29.88l-7.45 12.9c-1.96 3.41-6.37 4.73-9.6 6.97a7.97 7.97 0 0 0-2.37 2.57l-2 3.46a8 8 0 0 0 13.86 8l2-3.46c.61-1.06.95-2.2 1.05-3.34.32-3.91-.75-8.39 1.22-11.8l7.45-12.9A2.4 2.4 0 0 0 55 1Z",clipRule:"evenodd"}),s.createElement("path",{fill:"#0E101A",d:"m32.3 24.32-.44-.25.43.25Zm-2 3.46.43.25-.44-.25Zm13.85 8-.43-.25.43.25Zm2-3.46.43.25-.43-.25Zm6-30.19a1.9 1.9 0 0 1 2.6-.7l.5-.86a2.9 2.9 0 0 0-3.97 1.06l.87.5Zm-7.45 12.9 7.45-12.9-.87-.5-7.45 12.9.87.5Zm-11.97 9.54c.57-1 1.33-1.8 2.21-2.41l-.57-.82c-1 .69-1.86 1.6-2.51 2.73l.87.5Zm-2 3.46 2-3.46-.87-.5-2 3.46.87.5Zm2.74 10.25a7.5 7.5 0 0 1-2.74-10.25l-.87-.5a8.5 8.5 0 0 0 3.11 11.61l.5-.86Zm10.25-2.75a7.5 7.5 0 0 1-10.25 2.75l-.5.86a8.5 8.5 0 0 0 11.61-3.1l-.86-.5Zm2-3.46-2 3.46.86.5 2-3.46-.86-.5Zm.98-3.13a7.47 7.47 0 0 1-.98 3.13l.86.5a8.47 8.47 0 0 0 1.11-3.54l-1-.09Zm8.74-24.9-7.45 12.9.86.5 7.45-12.9-.86-.5Zm-.7-2.6a1.9 1.9 0 0 1 .7 2.6l.86.5A2.9 2.9 0 0 0 55.24.56l-.5.87ZM47.7 29.03c.09-1.01.08-2.05.06-3.07-.03-1.04-.07-2.06-.06-3.06.02-2.01.25-3.88 1.16-5.46l-.86-.5c-1.05 1.81-1.28 3.9-1.3 5.95 0 1.03.03 2.08.06 3.09.02 1.02.03 2.01-.05 2.96l1 .09Zm-3.86-14.5c-.92 1.6-2.42 2.72-4.15 3.74-.87.51-1.77.99-2.67 1.48-.9.5-1.8 1-2.64 1.59l.57.82c.79-.55 1.65-1.04 2.55-1.53.88-.48 1.81-.97 2.7-1.5 1.77-1.04 3.46-2.28 4.5-4.1l-.86-.5Z"}),s.createElement("path",{stroke:"#0E101A",strokeLinecap:"round",d:"m32.89 31.17 1.96-3.84a8.6 8.6 0 0 1 5.93-4.51"}),s.createElement("path",{fill:"#FFF0D4",d:"M49.6 28.8H27.2v10h22.4v-10Z"}),s.createElement("path",{stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",d:"M27.2 28.8h22.4"}),s.createElement("path",{fill:"#87E8D1",fillRule:"evenodd",d:"M.83 27.07H.8V28a31.2 31.2 0 0 0 62.4 0v-.93h-.03c-.73 3.19-14.4 5.73-31.17 5.73-16.76 0-30.44-2.54-31.17-5.73Z",clipRule:"evenodd"}),s.createElement("path",{fill:"#0E101A",d:"M.8 27.07v-.5a.5.5 0 0 0-.5.5h.5Zm.03 0 .49-.11a.5.5 0 0 0-.49-.4v.5Zm62.37 0h.5a.5.5 0 0 0-.5-.5v.5Zm-.03 0v-.5a.5.5 0 0 0-.49.39l.49.1Zm-62.37.5h.03v-1H.8v1Zm.5.43v-.93h-1V28h1ZM32 58.7A30.7 30.7 0 0 1 1.3 28h-1A31.7 31.7 0 0 0 32 59.7v-1ZM62.7 28A30.7 30.7 0 0 1 32 58.7v1A31.7 31.7 0 0 0 63.7 28h-1Zm0-.93V28h1v-.93h-1Zm.47.5h.03v-1h-.03v1Zm-.49-.61c-.05.24-.25.54-.68.88-.43.33-1.04.67-1.85 1-1.6.68-3.86 1.28-6.65 1.8-5.56 1.03-13.14 1.66-21.5 1.66v1c8.4 0 16.04-.64 21.69-1.68a35.17 35.17 0 0 0 6.85-1.85 9.01 9.01 0 0 0 2.08-1.15c.52-.4.9-.88 1.04-1.44l-.98-.22ZM32 32.3c-8.36 0-15.94-.63-21.5-1.66a34.23 34.23 0 0 1-6.65-1.8 8.05 8.05 0 0 1-1.85-1c-.43-.34-.63-.64-.68-.88l-.98.22c.13.56.52 1.04 1.04 1.44.53.42 1.23.8 2.08 1.15 1.7.7 4.04 1.33 6.85 1.85C15.96 32.66 23.6 33.3 32 33.3v-1Z"}),s.createElement("g",{opacity:".15",style:{mixBlendMode:"multiply"}},s.createElement("path",{fill:"#0E101A",d:"M32 43.6h17.93c.52 8.29 4.76 12.75 10.47 19.2H43.2C36.34 59.6 32 53.6 32 43.6Z"}),s.createElement("path",{stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M32 43.6h17.93c.52 8.29 4.76 12.75 10.47 19.2H43.2C36.34 59.6 32 53.6 32 43.6Z"})),s.createElement("path",{fill:"#fff",stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M35.2 41.6h18.73a34.2 34.2 0 0 0 8.98 21.6H44.56c-5.36-3.65-8.84-13.31-9.36-21.6Z"}),s.createElement("path",{stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",d:"M50.5 47.2h-9.7M52.1 52h-9.7M54.5 56.8h-9.7"})),s.createElement("defs",null,s.createElement("clipPath",{id:"EmptyI_a"},s.createElement("path",{fill:"#fff",d:"M0 0h64v64H0z"}))))),null)},successState:{title:"Nice work! Have a cookie.",description:"There are no more suggestions.",illustration:s.createElement((()=>s.createElement("svg",{fill:"none",viewBox:"0 0 64 64",role:"img","aria-hidden":!0,focusable:!1},s.createElement("g",{clipPath:"url(#SuccessI_a)"},s.createElement("path",{fill:"#C6CBDE",d:"M22.4 60c8.84 0 16-2.69 16-6s-7.16-6-16-6-16 2.69-16 6 7.16 6 16 6Z"}),s.createElement("path",{fill:"#C6CBDE",d:"M41.6 64c11.05 0 20-2.5 20-5.6 0-3.1-8.95-5.6-20-5.6s-20 2.5-20 5.6c0 3.1 8.95 5.6 20 5.6Z"}),s.createElement("path",{fill:"#DDEFF5",fillRule:"evenodd",d:"M36.8 6.75H.8l5.27 46.61c0 1.46 5.7 2.64 12.73 2.64s12.73-1.18 12.73-2.63L36.8 6.75Z",clipRule:"evenodd"}),s.createElement("path",{fill:"#000",d:"M.8 6.75v-.5a.5.5 0 0 0-.5.56l.5-.06Zm36 0 .5.06a.5.5 0 0 0-.5-.56v.5ZM6.07 53.36h.5a.5.5 0 0 0 0-.05l-.5.05Zm25.46 0-.01-.5a.5.5 0 0 0-.49.5h.5Zm0 0 .02.5a.5.5 0 0 0 .48-.44l-.5-.05ZM.8 7.27h36v-1H.8v1ZM6.57 53.3 1.3 6.7l-1 .1 5.27 46.62 1-.11Zm0 .06h-1 1ZM18.8 55.5c-3.5 0-6.64-.3-8.9-.76a11.6 11.6 0 0 1-2.61-.8c-.3-.14-.5-.28-.6-.4-.12-.1-.12-.17-.12-.17h-1c0 .35.18.65.4.88.23.23.53.42.88.59.7.34 1.68.64 2.85.88 2.34.48 5.56.78 9.1.78v-1Zm12.23-2.13s0 .06-.11.18c-.12.11-.31.25-.6.4-.6.28-1.48.55-2.62.79-2.26.47-5.4.76-8.9.76v1c3.54 0 6.76-.3 9.1-.78 1.17-.24 2.15-.54 2.85-.88.35-.17.65-.36.88-.6.22-.22.4-.52.4-.87h-1Zm.49-.5.03 1-.03-1ZM36.3 6.7 31.03 53.3l1 .11L37.3 6.81l-1-.11Z"}),s.createElement("ellipse",{cx:"18.8",cy:"6.39",fill:"#DDEFF5",stroke:"#000",strokeLinejoin:"round",rx:"18",ry:"3.95"}),s.createElement("path",{fill:"#fff",fillRule:"evenodd",d:"M35.2 20.83H2.4l3.67 32.53c0 1.46 5.7 2.64 12.73 2.64s12.73-1.18 12.73-2.63l3.67-32.54Z",clipRule:"evenodd"}),s.createElement("path",{fill:"#000",d:"M2.4 20.83v-.5a.5.5 0 0 0-.5.56l.5-.06Zm32.8 0 .5.06a.5.5 0 0 0-.5-.56v.5ZM6.07 53.36h.5a.5.5 0 0 0 0-.05l-.5.05Zm25.46 0-.03-.5a.5.5 0 0 0-.47.5h.5Zm0 0 .04.5a.5.5 0 0 0 .46-.44l-.5-.05ZM2.4 21.34h32.8v-1H2.4v1ZM6.56 53.3 2.9 20.77l-1 .12 3.67 32.53 1-.11Zm0 .06-1-.01h1ZM18.8 55.5c-3.5 0-6.64-.3-8.9-.76a11.6 11.6 0 0 1-2.61-.8c-.3-.14-.5-.28-.6-.4-.12-.11-.12-.17-.12-.17h-1c0 .35.18.65.4.88.23.23.53.42.88.59.7.34 1.68.64 2.85.88 2.34.48 5.56.78 9.1.78v-1Zm12.23-2.13s0 .06-.11.18c-.12.11-.31.25-.6.4-.6.28-1.48.55-2.62.79-2.26.47-5.4.76-8.9.76v1c3.54 0 6.76-.3 9.1-.78 1.17-.24 2.15-.54 2.85-.88.35-.17.65-.37.88-.6.22-.22.4-.52.4-.87h-1Zm.47-.5.07 1-.07-1Zm3.2-32.1-3.67 32.54 1 .11L35.7 20.9l-1-.12Z"}),s.createElement("ellipse",{cx:"18.8",cy:"20.8",fill:"#fff",stroke:"#000",strokeLinejoin:"round",rx:"16.4",ry:"3.2"}),s.createElement("path",{fill:"#FFF0D4",stroke:"#000",d:"M59.66 53.9c-.15 4.95-9.28 6.9-20.4 6.56-11.1-.33-20-2.8-19.85-7.75.15-4.94 9.28-8.67 20.39-8.34 11.11.33 20 4.6 19.86 9.54Z"}),s.createElement("rect",{width:"5.86",height:"2.45",x:"22.77",y:"51.3",fill:"#4A6EE0",rx:"1.23",transform:"rotate(-4 22.77 51.3)"}),s.createElement("rect",{width:"5.86",height:"2.45",x:"32.42",y:"51.83",fill:"#F18AB2",rx:"1.23",transform:"rotate(41 32.42 51.83)"}),s.createElement("rect",{width:"5.86",height:"2.45",x:"43.02",y:"50.37",fill:"#8780E4",rx:"1.23",transform:"rotate(120 43.02 50.37)"}),s.createElement("rect",{width:"5.86",height:"2.45",x:"30.1",y:"47.89",fill:"#15C39A",rx:"1.23",transform:"rotate(4 30.1 47.89)"}),s.createElement("rect",{width:"5.86",height:"2.45",x:"49.73",y:"51.29",fill:"#F18AB2",rx:"1.23",transform:"rotate(29 49.73 51.3)"}),s.createElement("rect",{width:"5.86",height:"2.45",x:"42.44",y:"56.4",fill:"#15C39A",rx:"1.23",transform:"rotate(-19 42.44 56.4)"}),s.createElement("path",{fill:"#7D6455",fillRule:"evenodd",d:"M21.92 48.56c3.48-2.71 10.2-4.42 17.88-4.2 10 .3 18.2 3.8 19.64 8.1-8.37 4.82-33.76 2.81-37.52-3.9Z",clipRule:"evenodd",opacity:".3",style:{mixBlendMode:"multiply"}}),s.createElement("path",{fill:"#FFF0D4",stroke:"#000",d:"M62.13 49.5c-1.4 4.73-10.77 5.36-21.43 2.2-10.66-3.17-18.57-8.93-17.16-13.67 1.4-4.74 11.46-6.87 22.12-3.7S63.54 44.76 62.13 49.5Z"}),s.createElement("rect",{width:"5.86",height:"2.45",x:"27.2",y:"36.55",fill:"#15C39A",rx:"1.23",transform:"rotate(-13 27.2 36.55)"}),s.createElement("rect",{width:"5.86",height:"2.45",x:"33.87",y:"39.22",fill:"#EE6C9F",rx:"1.23",transform:"rotate(62 33.87 39.22)"}),s.createElement("rect",{width:"5.86",height:"2.45",x:"38.18",y:"34.85",fill:"#4A6EE0",rx:"1.23",transform:"rotate(5 38.18 34.85)"}),s.createElement("rect",{width:"5.86",height:"2.45",x:"41.76",y:"45.57",fill:"#4A6EE0",rx:"1.23",transform:"rotate(5 41.76 45.57)"}),s.createElement("rect",{width:"5.86",height:"2.45",x:"39.05",y:"39.32",fill:"#8780E4",rx:"1.23",transform:"rotate(26 39.05 39.32)"}),s.createElement("rect",{width:"5.86",height:"2.45",x:"49.66",y:"43.71",fill:"#EE6C9F",rx:"1.23",transform:"rotate(-10 49.66 43.71)"}),s.createElement("rect",{width:"5.86",height:"2.45",x:"47.8",y:"36.64",fill:"#15C39A",rx:"1.23",transform:"rotate(47 47.8 36.64)"}),s.createElement("rect",{width:"5.86",height:"2.45",x:"53.16",y:"48.35",fill:"#4A6EE0",rx:"1.23",transform:"rotate(-28 53.16 48.35)"})),s.createElement("defs",null,s.createElement("clipPath",{id:"SuccessI_a"},s.createElement("path",{fill:"#fff",d:"M0 0h64v64H0z"}))))),null)}},{emptyState:{title:"Let's get to work.",description:"Suggestions will appear here.",illustration:s.createElement((()=>s.createElement("svg",{fill:"none",viewBox:"0 0 64 64",role:"img","aria-hidden":!0,focusable:!1},s.createElement("g",{clipPath:"url(#EmptyJ_a)"},s.createElement("ellipse",{cx:"32",cy:"57.6",fill:"#C6CBDE",rx:"32",ry:"5.6"}),s.createElement("path",{fill:"#F28C8C",fillRule:"evenodd",stroke:"#0E101A",strokeLinejoin:"round",d:"M26.4 5.6A2.4 2.4 0 0 0 24 8v8.8a2.4 2.4 0 0 0 2.4 2.4h12.8a2.4 2.4 0 0 0 2.4-2.4V8a2.4 2.4 0 0 0-2.4-2.4H26.4ZM19.2 8A7.2 7.2 0 0 1 26.4.8h12.8A7.2 7.2 0 0 1 46.4 8v8.8a7.2 7.2 0 0 1-7.2 7.2H26.4a7.2 7.2 0 0 1-7.2-7.2V8Z",clipRule:"evenodd"}),s.createElement("rect",{width:"62.4",height:"46.4",x:".8",y:"11.2",fill:"#41D9B5",stroke:"#000",strokeLinejoin:"round",rx:"10"}),s.createElement("path",{stroke:"#000",strokeLinejoin:"round",d:"M15.2 21.2v7.2a10 10 0 0 0 10 10h28a10 10 0 0 0 10-10v-7.2"}),s.createElement("rect",{width:"14.4",height:"46.4",x:".8",y:"11.2",fill:"#11A683",stroke:"#000",strokeLinejoin:"round",rx:"7.2"}),s.createElement("path",{fill:"#F9EA9E",stroke:"#0E101A",d:"M23.2 32.4c0-1.1.9-2 2-2h5.6a2 2 0 0 1 2 2v10a4.8 4.8 0 0 1-9.6 0v-10Z"}),s.createElement("circle",{cx:"28",cy:"42.4",r:"2.4",fill:"#4D536E",stroke:"#0E101A"}),s.createElement("path",{fill:"#F9EA9E",stroke:"#0E101A",d:"M46.4 32.4c0-1.1.9-2 2-2H54a2 2 0 0 1 2 2v10a4.8 4.8 0 1 1-9.6 0v-10Z"}),s.createElement("circle",{cx:"51.2",cy:"42.4",r:"2.4",fill:"#4D536E",stroke:"#0E101A"})),s.createElement("defs",null,s.createElement("clipPath",{id:"EmptyJ_a"},s.createElement("path",{fill:"#fff",d:"M0 0h64v64H0z"}))))),null)},successState:{title:"Great job!",description:"There are no more suggestions.",illustration:s.createElement((()=>s.createElement("svg",{fill:"none",viewBox:"0 0 64 64",role:"img","aria-hidden":!0,focusable:!1},s.createElement("path",{fill:"#FBEFB7",stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M15.32 25.44c-1.2-2.02-3.23-.8-2.74.98-1.07-1.63-.47-2.98-1.04-4.04-.66-1.26-2.4-.82-2.33.65-.47-1.33.12-2.9-.09-3.74-.33-1.45-2.05-1.14-1.93.21a14.38 14.38 0 0 1-2.07-7.45c0-3.7 1.62-6.76 3.88-6.76 1.86 0 2.82 1.82 2.18 3.39-.3-.83-.83-1.27-1.69-1.27-1 0-1.63.98-1.63 2.2 0 1.75 1.45 2.75 3.23 2.77 2.05 0 3.4-2 3.4-4.32 0-3.09-2.28-6.14-5.91-5.65 1-.8-.16-2.26-1.39-1.28C4.26 3.43 2.4 7.36 2.4 11.82c0 11.26 10.86 23.53 21.75 20.76l-1.87-3.25c-3.15 0-5.33-1.14-6.96-3.9ZM56.94 1.13c-1.23-.98-2.39.47-1.39 1.28-3.63-.5-5.91 2.54-5.91 5.63 0 2.32 1.33 4.32 3.4 4.32 1.76 0 3.23-1 3.23-2.75 0-1.22-.63-2.2-1.63-2.2-.86 0-1.39.44-1.69 1.27-.65-1.57.32-3.37 2.18-3.37 2.26 0 3.88 3.05 3.88 6.75 0 2.65-.74 5.23-2.06 7.48.1-1.35-1.6-1.67-1.93-.21-.19.84.39 2.4-.08 3.74.07-1.48-1.69-1.92-2.34-.65-.56 1.05.02 2.4-1.03 4.03.49-1.75-1.53-2.98-2.74-.98-1.65 2.74-3.81 3.9-6.97 3.88L40 32.6c10.88 2.77 21.76-9.48 21.76-20.75-.05-4.46-1.9-8.39-4.82-10.72Z"}),s.createElement("path",{fill:"#C6CBDE",d:"M32 63.2c12.81 0 23.2-1.61 23.2-3.6S44.81 56 32 56c-12.81 0-23.2 1.61-23.2 3.6s10.39 3.6 23.2 3.6Z"}),s.createElement("path",{fill:"#F6DF6C",stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M47.2 55.2H16.8a2.4 2.4 0 1 0 0 4.8h30.4a2.4 2.4 0 0 0 0-4.8Z"}),s.createElement("path",{fill:"#F6DF6C",fillRule:"evenodd",d:"M32 4.64H14.77c-1.64 14.28 2.98 25.28 9.5 30.84.37.33.77.64 1.16.96 1.9 1.5 3.8 3.03 3.77 5.4-.05 3.19-.51 4.8-.51 4.8-.82 3.1-3.62 4.07-6.1 4.93-2.28.78-4.3 1.48-4.3 3.63H45.7c0-2.15-2.01-2.85-4.28-3.63-2.5-.86-5.3-1.83-6.1-4.93 0 0-.47-1.61-.52-4.8-.04-2.37 1.87-3.9 3.77-5.4.4-.32.8-.63 1.17-.96 6.51-5.56 11.13-16.56 9.49-30.84H32Z",clipRule:"evenodd"}),s.createElement("path",{fill:"#0E101A",d:"M14.77 4.64v-.5a.5.5 0 0 0-.5.44l.5.06Zm9.5 30.84.32-.38-.33.38Zm1.16.96.32-.4-.32.4Zm3.77 5.4h.5-.5Zm-.51 4.8-.48-.13.48.13Zm-6.1 4.93-.17-.48.16.48Zm-4.3 3.63h-.5c0 .28.23.5.5.5v-.5Zm27.41 0v.5a.5.5 0 0 0 .5-.5h-.5Zm-4.28-3.63.16-.48-.16.48Zm-6.1-4.93.48-.12v-.01l-.49.13Zm-.52-4.8h-.5.5Zm3.77-5.4.3.4-.3-.4Zm1.17-.96.32.38-.32-.38Zm9.49-30.84.5-.06a.5.5 0 0 0-.5-.44v.5Zm-34.46.5H32v-1H14.77v1ZM24.6 35.1c-6.36-5.43-10.95-16.25-9.32-30.4l-1-.12c-1.65 14.41 3 25.59 9.67 31.28l.65-.76Zm1.16.95c-.4-.32-.8-.63-1.16-.95l-.65.76c.38.33.79.66 1.18.97l.63-.78Zm3.95 5.8a5.03 5.03 0 0 0-1.27-3.35c-.75-.91-1.75-1.7-2.68-2.45l-.63.78c.96.76 1.87 1.49 2.54 2.3.65.8 1.06 1.67 1.04 2.7l1 .01Zm-1.01 4.8.48.13v-.03a5.33 5.33 0 0 0 .08-.3l.17-.94c.12-.82.25-2.05.28-3.67l-1-.01a26.8 26.8 0 0 1-.43 4.4 7.18 7.18 0 0 1-.06.27l.48.14Zm-5.94 5.39c2.44-.84 5.53-1.87 6.42-5.27l-.97-.25c-.73 2.8-3.24 3.7-5.78 4.57l.33.95ZM18.8 55.2c0-.88.39-1.45 1.07-1.92.72-.5 1.72-.84 2.88-1.24l-.33-.95c-1.12.39-2.26.78-3.12 1.37-.89.61-1.5 1.46-1.5 2.74h1Zm13.2-.5H18.3v1H32v-1Zm0 1h13.7v-1H32v1Zm14.2-.5c0-1.28-.61-2.13-1.5-2.74-.86-.59-2-.98-3.12-1.37l-.33.95c1.16.4 2.16.75 2.88 1.24.68.47 1.07 1.04 1.07 1.92h1Zm-4.62-4.1c-2.54-.88-5.05-1.78-5.78-4.58l-.97.25c.9 3.4 3.98 4.43 6.42 5.27l.33-.95Zm-6.27-4.46.48-.13v-.01a5.92 5.92 0 0 1-.06-.26c-.04-.2-.1-.49-.16-.88a26.8 26.8 0 0 1-.27-3.53l-1 .01a27.78 27.78 0 0 0 .45 4.6 8.12 8.12 0 0 0 .07.31l.01.02v.01l.48-.14Zm-.01-4.81a4.04 4.04 0 0 1 1.04-2.7c.67-.81 1.58-1.54 2.54-2.3l-.63-.78c-.93.74-1.93 1.54-2.68 2.45-.76.92-1.3 2-1.27 3.34l1-.01Zm3.58-5c.4-.31.8-.64 1.18-.97l-.65-.76c-.37.32-.76.63-1.16.95l.63.78Zm1.18-.97c6.67-5.7 11.32-16.87 9.66-31.28l-.99.12c1.63 14.15-2.96 24.97-9.32 30.4l.65.76Zm9.17-31.72H32v1h17.23v-1Z"}),s.createElement("path",{stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M30.8 40h2.4"}),s.createElement("path",{fill:"#FBEFB7",stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M49.18 4.8H14.8c-.2 1.52-.33 3.25-.39 4.62.63.45 1.46.79 2.43.94 1.71.27 3.36-.15 4.3-.99.49 1.06 1.72 1.86 3.25 1.96 1.42.08 2.7-.44 3.43-1.29.6 1.14 2.23 1.96 4.2 1.96 1.95 0 3.6-.82 4.2-1.96.74.85 2.01 1.4 3.43 1.29 1.53-.1 2.79-.9 3.25-1.96.94.84 2.57 1.26 4.28.99a5.78 5.78 0 0 0 2.43-.94 79.1 79.1 0 0 0-.42-4.62Z"}),s.createElement("path",{fill:"#0E101A",stroke:"#0E101A",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10",d:"M32 4.8H15.2C18.85 6.74 25.01 8 32 8s13.15-1.26 16.8-3.2H32Z"}),s.createElement("path",{fill:"#fff",stroke:"#0E101A",strokeMiterlimit:"10",d:"M8.96 52c-.1 0-.16-.08-.16-.19.15-5.94-1.89-8.1-7.83-8.26-.1 0-.17-.08-.17-.19 0-.1.08-.16.19-.16 5.94.15 8.1-1.89 8.26-7.83 0-.1.08-.17.19-.17.1 0 .16.08.16.19-.15 5.94 1.89 8.1 7.83 8.24.1 0 .17.09.17.19s-.08.17-.19.17c-5.94-.15-8.1 1.88-8.26 7.82-.02.12-.08.19-.19.19ZM56.25 54.4c-.06 0-.1-.05-.1-.11.1-3.68-1.17-5.02-4.85-5.12-.06 0-.1-.05-.1-.12 0-.06.05-.1.11-.1 3.68.1 5.02-1.17 5.12-4.85 0-.06.05-.1.12-.1.06 0 .1.05.1.11-.1 3.68 1.17 5.02 4.85 5.11.06 0 .1.05.1.12 0 .06-.05.1-.11.1-3.68-.1-5.02 1.17-5.12 4.85-.01.07-.05.11-.12.11ZM39.84 26.4c-.06 0-.1-.06-.1-.12.1-3.96-1.27-5.4-5.23-5.51-.07 0-.11-.06-.11-.13 0-.06.06-.1.12-.1 3.96.1 5.4-1.27 5.51-5.23 0-.07.06-.11.13-.11.06 0 .1.06.1.12-.1 3.96 1.27 5.4 5.23 5.5.07 0 .11.06.11.13 0 .06-.06.1-.12.1-3.96-.1-5.4 1.27-5.51 5.23-.01.08-.06.12-.13.12Z"}))),null)}}];function fw(e=Math.random){return Math.floor(e()*gw.length)}function vw(e,t){const i={title:"Nothing to see yet",description:`No unresolved suggestions for pages ${t.startPage}-${t.endPage}.`};return{emptyState:Object.assign(Object.assign({},e.emptyState),i),successState:Object.assign(Object.assign({},e.emptyState),i)}}function _w(e,t){const i=f.s.create(o.none),n=i.pipe(d.n(o.fold((()=>u.of(0)),(t=>e.suggestionCount.getFeedSuggestionCount(t)))));return r.n.fromSideEffect((t=>{switch(t.kind){case"lensesHeaderToggle":return e.feedLens.onToggleLens(t.lensId);case"lensesHeaderFocus":i.set(o.some(t.lensId));break;case"lensesHeaderBlur":i.set(o.none);break;default:(0,g.AS)(t)}}),Ct.zV([t,e.feedLens.lenses,i,n]).pipe(R.T((([e,t,i,n])=>(0,a.pipe)(e,o.map((e=>({activeLensId:e,lenses:(0,a.pipe)([$i.lensCorrectnessFeed,$i.lensClarityFeed,$i.lensEngagementFeed,$i.lensDeliveryFeed,$i.lensStyleGuideFeed,$i.lensPremiumFeed],C.Tj((e=>o.fromNullable(t.get(e)))),C.oE),focusedLensId:i,focusedLensSuggestionCount:n})))))),N.oE))}function bw(e,t=Math.random){const i=fw(t),n=(0,a.pipe)(e.pageRange.pageRange.get(),o.fold((()=>gw[i]),(e=>vw(gw[i],e)))),s=GE(e.feed.feed).pipe(M.shareReplay({bufferSize:1,refCount:!0})),l=e.feed.feed.view(o.chain((e=>Wi(e.id))));return r.n.composeUnion({loadingState:()=>e.feedForm.state.view("supportedForms").view((e=>e.has("shortForm"))).view((e=>({supportsShortForm:e}))),emptyState:r.n.fromSideEffect((t=>{"longFormFeedEmptyMount"!==t.kind?(0,g.AS)(t.kind):e.feed.onEmptyStateMount(e.checkingState.firstCheckingFinishedAndSduiEventsSettledTimedOut.get())}),u.of({content:n.emptyState})),successState:()=>u.of({content:n.successState,goBackFrom:o.none}),uphookSuccessState:yw(e,n.successState),nonEmptyState:r.n.composeKnot({root:Sw(e),lensesHeader:_w(e,l),lensView:r.n.composeUnion({successState:r.n.fromSideEffect((t=>{switch(t.kind){case"goBack":return e.feedLens.onToggleLens(t.goBackFrom);case"longFormFeedSuccessMount":return e.feed.onSuccessStateMount();default:return(0,g.AS)(t)}}),Ct.zV([l,e.feedLens.lenses]).pipe(R.T((([e,t])=>({content:Object.assign(Object.assign({},n.successState),(0,a.pipe)(e,o.fold(a.constNull,(e=>({description:(0,a.pipe)(o.fromNullable(t.get(e)),o.fold((()=>n.successState.description),(e=>`There are no more ${e.label.toLowerCase()} suggestions.`)))}))))),goBackFrom:e}))))),uphookSuccessState:yw(e,n.successState),cardList:r.n.composeKnot({cardList:ZE(e,s)})},(()=>Ct.zV([s,l]).pipe(R.T((([e,t])=>(0,a.pipe)(e,o.exists((e=>e.items.length>0)))?"cardList":(0,a.pipe)(t,o.fold((()=>"successState"),(e=>e===$i.lensPremiumFeed?"uphookSuccessState":"successState"))))),I.F(),R.T((e=>({kind:e}))))))})},(()=>kw(e).view((e=>({kind:e})))))}function yw(e,t){return r.n.composeKnot({root:()=>Ct.zV([e.feedLens.premiumCounter,e.uphook.isGrammarlyPro]).pipe(R.T((([e,i])=>({content:t,premiumSuggestionCount:e,isGrammarlyPro:i})))),uphook:WE(e,"successState","longFormAssistant")})}function kw(e){return f.s.combine(e.feed.feed,e.feed.feedReset,e.checkingState.firstCheckingFinishedAndSduiEventsSettled,e.checkingState.firstCheckingFinishedAndSduiEventsSettledTimedOut,e.suggestionCount.state,e.feed.isPremiumFeedEnabled,e.feedLens.premiumCounter,((e,t,i,n,{allSuggestionsEmpty:s,someSuggestionsAddressed:r},a,l)=>{const c=!i&&!n;return o.isNone(e)||0===Cn(e.value.collection)&&(c||t)?"loadingState":s?a?r||l>0?"uphookSuccessState":"emptyState":r?"successState":"emptyState":"nonEmptyState"}))}function Sw(e){return r.n.fromSideEffect((t=>{switch(t.kind){case"longFormFeedMount":return e.feed.onFeedMount();case"toggleShortFormFeed":return e.feedForm.onToggleFeedForm("shortForm");case"partialPageRangeHeaderMount":return e.pageRange.partialPageRangeHeaderMount();default:(0,g.AS)(t)}}),f.s.combine(e.suggestionCount.state.view("activeFeedSuggestionCount"),e.feedForm.state.view("supportedForms").view((e=>e.has("shortForm"))),e.pageRange.pageRange.view(),((e,t,i)=>({suggestionCount:e,canCollapseToShortForm:t,pageRange:i}))))}var Cw=i(55365);function Ew(e,t=Math.random){const i=fw(t),n=(0,a.pipe)(e.revision.pageRange.pageRange.get(),o.fold((()=>gw[i]),(e=>vw(gw[i],e))));return r.n.composeUnion({loadingState:()=>u.of(null),emptyState:r.n.fromSideEffect((t=>{"shortFormFeedEmptyMount"!==t.kind?(0,g.AS)(t.kind):e.revision.feed.onEmptyStateMount(e.revision.checkingState.firstCheckingFinishedAndSduiEventsSettledTimedOut.get())}),u.of({emptyStateContent:n,useVerticalLayout:"standard"===e.revision.shortFormFeedMode})),successState:r.n.fromSideEffect((t=>{"shortFormFeedEmptyMount"!==t.kind?(0,g.AS)(t.kind):e.revision.feed.onSuccessStateMount()}),u.of({emptyStateContent:n,useVerticalLayout:"standard"===e.revision.shortFormFeedMode})),nonEmptyState:ww(e)},(()=>Aw(e).view((e=>({kind:e})))))}function ww(e){const t=f.s.create([]);return r.n.fromSideEffect((i=>{switch(i.kind){case"shortFormCardSduiNotify":return i.actions.find((e=>"prevCard"===e.type||"nextCard"===e.type))&&t.set(i.actions.filter(Cw.$n.Action.isTransitionAction)),jE(i.actions)&&e.revision.suggestionCount.onSuggestionAddressed(),e.revision.feed.processActions(i.actions,i.item,i.scope,i.sourceId);case"shortFormCardMount":return e.revision.feed.onItemMount(!0,i.item);case"shortFormFeedAnimationEnd":return t.set([]);case"shortFormFeedMount":return t.set([]),e.revision.feed.onFeedMount();case"toggleLongFormFeed":return e.revision.feedForm.onToggleFeedForm("longForm");case ft.t.Kind.actionsMenuMuteClick:case ft.t.Kind.actionsMenuReportIncorrectClick:case ft.t.Kind.actionsMenuReportOffensiveClick:case ft.t.Kind.addToDictionaryClick:case ft.t.Kind.suggestionAcceptClick:case ft.t.Kind.suggestionDismissClick:return e.notify(i);default:(0,g.AS)(i)}}),Ct.zV([(i=e.revision.feed.feed,i.pipe(Xn.S(((e,t)=>(0,a.pipe)(t,o.chain((e=>k.Jq(o.option)({feedId:o.some(e.id),item:wn(e.collection),index:An(e.collection),size:o.some(Cn(e.collection))}))),o.map((({feedId:t,item:i,index:n,size:s})=>({feedId:t,item:i,isFirst:0===n,isLast:n===s-1,prevItem:(0,a.pipe)(e,o.chain((e=>e.item.id===i.id?e.prevItem:o.some(e.item))))}))))),o.none))).pipe(N.oE),e.revision.suggestionCount.state.view("activeFeedSuggestionCount"),e.revision.feedForm.state.view("supportedForms").view((e=>e.has("longForm"))),t,e.revision.feed.isWaitingForAlertsToBeApplied,e.revision.pageRange.pageRange]).pipe(R.T((([{item:e,prevItem:t,isFirst:i,isLast:n},s,r,o,l,c])=>({item:Object.assign(Object.assign({},e),{content:(0,a.pipe)(e.content,VE(i,n))}),isFirst:i,isLast:n,prevItem:t,transitions:o,suggestionCount:s,canExpandToLongForm:r&&s>1,isWaitingForAlertsToBeApplied:l,pageRange:c})))));var i}function Aw(e){return f.s.combine(e.revision.feed.feed,e.revision.feed.feedReset,e.revision.checkingState.firstCheckingFinishedAndSduiEventsSettled,e.revision.checkingState.firstCheckingFinishedAndSduiEventsSettledTimedOut,e.revision.suggestionCount.state.view("someSuggestionsAddressed"),((e,t,i,n,s)=>(0,a.pipe)(e,o.fold((()=>"loadingState"),(e=>(0,a.pipe)(wn(e.collection),o.fold((()=>t?"loadingState":i||n?s?"successState":"emptyState":"loadingState"),(()=>"nonEmptyState"))))))))}const Iw=()=>u.of(null);function xw(e){return r.n.composeUnion({none:Iw,shortFormFeed:r.n.composeKnot({feed:(0,a.pipe)(e.revision,o.map((t=>({revision:t,notify:e.notify}))),o.fold((()=>Iw),Ew))}),longFormFeed:r.n.composeKnot({feed:(0,a.pipe)(e.revision,o.map((t=>Object.assign(Object.assign({},t),{uphook:e.uphook}))),o.fold((()=>Iw),bw))})},(()=>Tw(e).view((e=>({kind:e})))))}function Tw(e){return f.s.combine(e.routing.activeView,e.textEditor.state.view("hasBeenNonEmpty"),e.lifecycle.heightBehavior.view("kind"),(0,a.pipe)(e.revision,o.fold((()=>f.s.create(null).view()),(e=>f.s.combine(e.feed.isAllSuggestionsFeedEnabled,e.feedForm.state.view("feedForm"),e.suggestionCount.state.view("allSuggestionsCount"),((e,t,i)=>({isAllSuggestionsFeedEnabled:e,feedForm:t,allSuggestionsCount:i})))))),((t,i,n,s)=>"home"===t.kind&&null!==s&&s.isAllSuggestionsFeedEnabled&&((0,a.pipe)(i,o.exists(a.identity))||"revision"===e.experience||s.allSuggestionsCount>0||"longForm"===s.feedForm&&"fitContainer"===n)?"shortForm"===s.feedForm?"shortFormFeed":"longForm"===s.feedForm?"longFormFeed":(0,g.AS)(s.feedForm):"none"))}function Fw(e){const t=e.assistant.state.view("genAISession").view((t=>(0,a.pipe)(t,o.chain(oe.toStarted),o.filter((()=>o.isNone(e.revision))),o.exists((e=>e.voiceProfile.needsSetup)))));return r.n.composeOption(r.n.fromSideEffect((t=>e.notify(t)),null),(()=>t.view((e=>e?o.some(null):o.none))))}function Rw(e){return r.n.composeKnot({suggestions:xw(e),voiceBanner:Fw(e),documentOverview:pw(e),intent:mw(e),detectedReferences:hw(e)})}function Kw(e,t,i){const n=e.assistant.state.view("genAISession").view((0,a.flow)(o.chain(oe.toStarted),o.chain((e=>o.fromNullable(e.results[i+1]))),o.filter(le.Q.isComplete),o.chain((e=>e.boundaryContextId)))),s=t.pipe(Ot.E(n),R.T((([e,t])=>(0,a.pipe)(e,o.filter((0,j.Ub)(le.Q.isComplete,le.Q.isInProgress)),o.chain((e=>e.boundaryContextId)),o.filter((e=>!!o.isNone(t)||e!==t.value)))))),l=s.pipe(R.T(o.chain((t=>e.assistant.getContextById(t))))),c=l.pipe(R.T((e=>(0,a.pipe)(e,o.chain((e=>e.selection))))));return r.n.composeOption(r.n.fromSideEffect((t=>e.notify(t)),Ct.zV([l,e.assistant.state.view("genAISession").view((0,a.flow)(o.chain(oe.toStarted),o.map((({textRevision:e})=>e)))),e.assistant.state.view("genAISession").view((0,a.flow)(o.chain(oe.toStarted),o.map((({selectionContextStatus:e})=>e))))]).pipe(R.T((([e,t,i])=>k.Jq(o.option)({selection:(0,a.pipe)(e,o.chain((({selection:e})=>e))),currentTextRevision:t,contextTextRevision:(0,a.pipe)(e,o.map((({textRevision:e})=>e))),selectionContextStatus:i}))),N.oE,R.T((({selection:e,currentTextRevision:t,contextTextRevision:i,selectionContextStatus:n})=>({selectedText:e.text,selectedRange:n===oe.SelectionContextStatus.dynamic&&o.isSome(i)&&t===i.value?e.range:void 0}))))),(()=>c))}function Mw(e){return()=>e.assistant.state.view("genAISession").view(o.chain(oe.toStarted)).view((0,a.flow)(o.chain((e=>e.inProgressResult)),o.fold((()=>({text:""})),(e=>({text:e.text})))))}function Ow(e){return Kw(e,e.assistant.state.view("genAISession").view(o.chain(oe.toStarted)).view(o.chain((e=>e.inProgressResult))),-1)}function Nw(e){const t=f.s.combine(e.assistant.state.view("genAISession"),e.routing.activeView,((e,t)=>(0,a.pipe)(e,o.chain(oe.toStarted),o.chain((e=>e.inProgressResult)),o.filter((()=>"thread"===t.kind)),o.map((e=>({result:e}))))));return r.n.composeOption(function(e){return r.n.composeKnot({root:Mw(e),header:Ow(e)})}(e),(()=>t))}function Bw(e,t){return r.n.composeOption(r.n.fromSideEffect((t=>e.notify(t)),e.userSurvey.state.pipe(R.T((e=>(0,a.pipe)(e.activeSurvey,o.map((t=>({survey:t,state:e})))))),N.oE,R.T((({survey:e,state:t})=>({survey:e,stage:t.stage,transitionStage:t.transitionStage,rating:t.rating,openAnswer:(0,a.pipe)(t.openAnswer,o.getOrElse((0,a.constant)(""))),ratingLabels:(0,a.pipe)(t.activeSurvey,o.fold((0,a.constant)([]),(e=>e.ratingLabels))),errors:t.errors}))))),(()=>f.s.combine(e.userSurvey.state,t,e.routing.activeView,(({activeSurvey:e,stage:t},i,n)=>(0,a.pipe)(e,o.filter((e=>"thread"===n.kind&&(0,a.pipe)(i,L.gR(e.resultId))&&t!==yr.Stage.Type.Closed)))))))}var Pw=i(13110);function Dw(e,t,i,n){return r.n.fromSideEffect((t=>e.notify(t)),Ct.zV([t,e.assistant.state.view("textBox")]).pipe(R.T((([e,t])=>({icon:"regularAction"===e.kind?e.action.icon:S.left(e.kind),label:"regularAction"===e.kind?e.action.label:"go"===e.kind?`${t.trim()}`:(0,g.AS)(e),action:e,placement:i,position:n})))))}function Lw(e,t){return r.n.fromSideEffect((t=>e.notify(t)),t)}function Uw(e,t,i){return r.n.composeList(C.Q1,(()=>t.pipe(R.T((0,a.flow)(o.map(C.rO(((e,t)=>({action:t,index:e})))),o.getOrElse((()=>[])))))),(({action:t,index:n})=>Dw(e,u.of(t),i,n)))}function jw(e,t){const i=function(e,t){return e.assistant.state.view((({genAIAvailability:e,genAISession:i})=>(0,a.pipe)(i,o.chain(oe.toStarted),o.map((i=>{const n=v.y.isPassive(e)||v.y.isUnavailable(e),s=(0,a.pipe)(i.activeContext.userPromptAction,o.chain((e=>(0,a.pipe)(t.header.copiablePrompt,o.map((t=>J.UserPromptActionValue.fromInput(e,t,o.none,o.none)))))));return{actions:(0,a.pipe)(Pw.ci(i.activeContext.availableActions.filter((0,j.Ub)(J.isFollowUpQuestionActionInput,J.isQuickActionInput))),o.filter((()=>!n)),o.map(Pw.Tj(Rr.RegularAction.make))),originalAction:s,disabled:n,result:t}}))))).pipe(N.oE)}(e,t),n=i.pipe(Fr.E("actions"));return r.n.composeKnot({root:Lw(e,i),actions:Uw(e,n,"threadView")})}function Vw(e,t){return r.n.fromSideEffect((t=>e.notify(t)),e.assistant.state.pipe(d.n((e=>{const i=(0,a.pipe)(t.header.copiablePrompt,o.fold((()=>({kind:bS.searchLabel,label:t.header.label,iconUrl:t.header.iconUrl})),(i=>({kind:bS.clickableSearchLabel,label:t.header.label,disabled:v.y.isUnavailable(e.genAIAvailability),copiablePrompt:i}))));return le.Q.isComplete(t)&&function(e){return(0,a.pipe)(e.replacementDelta,S.fold(a.identity,(e=>e.generic)),(e=>e.ops.some((e=>{var t;return qk.E.isInsert(e)&&!!(null===(t=e.attributes)||void 0===t?void 0:t[cS.knowledgeHubTerm])}))))}(t)&&t.timestamp+3e3>Date.now()?M.timer(t.timestamp+3e3-Date.now()).pipe(ct.u(i),ut.Z({kind:bS.knowledgeHub})):u.of(i)}))))}function $w(e,t,i,n){return r.n.composeKnot({root:r.n.fromSideEffect((t=>e.notify(t)),e.assistant.state.view((({genAIAvailability:e,activeCards:n,genAISession:s,referencesVisibility:r,overrideCardVoice:l})=>{var c,d,u;return{disabled:v.y.isUnavailable(e),result:t,isActive:(0,a.pipe)(!!n.has(t.id)||0===n.size&&i&&(u=(0,a.pipe)(s,o.chain(oe.toStarted)),!(0,a.pipe)(u,o.fold(a.constFalse,(e=>o.isSome(e.inProgressResult)||o.isSome(e.error)))))),isReferencesOpen:null!==(c=r.get(t.id))&&void 0!==c&&c,isMyVoice:(null!==(d=l.get(t.id))&&void 0!==d?d:(0,a.pipe)(t.replacementDelta,S.fold((()=>le.Q.GeneratedTextVoice.generic),(e=>e.preferVoice))))===le.Q.GeneratedTextVoice.user}}))),header:Vw(e,t),contextHeader:Kw(e,u.of(o.some(t)),n)})}function Hw(e,t){return r.n.composeList(C.Q1,(()=>t.pipe(R.T((0,a.flow)(C.$M(50),C.rO(((e,t)=>({result:t,isLast:0===e,index:e}))),C.BE)))),(({result:t,isLast:i,index:n})=>function(e,t,i,n){return r.n.composeUnion({promptResultComplete:$w(e,t,i,n),aiUsageNotification:jw(e,t)},(()=>u.of(le.Q.isAIUsageNotification(t)?{kind:"aiUsageNotification"}:{kind:"promptResultComplete"})))}(e,t,i,n)))}function Zw(e,t){return r.n.composeUnion({none:()=>u.of(null),loading:()=>u.of({root:{text:""}}),loaded:r.n.composeKnot({results:Hw(e,t.view(o.getOrElse((()=>[]))))})},(()=>f.s.combine(t,e.assistant.state.view("genAISession").view(o.fold((()=>null),(e=>e.kind))),e.routing.activeView,((e,t,i)=>"thread"===i.kind?{kind:"starting"===t?"loading":o.isSome(e)?"loaded":"none"}:{kind:"none"}))))}function Gw(e){const t=e.assistant.state.view("genAISession").view((0,a.flow)(o.chain(oe.toStarted),o.map((e=>e.results)),o.chain(E._S)));return r.n.composeKnot({documentOverview:pw(e),intent:mw(e),resultList:Zw(e,t),lastResultSurvey:Bw(e,t.view(o.map((0,a.flow)(E.d5,(e=>e.id))))),inProgressResult:Nw(e),generationError:uw(e),detectedReferences:hw(e)})}const Ww=()=>u.of(null);function zw(e){return r.n.composeUnion({home:Rw(e),thread:Gw(e),error:uw(e),followUpPrompt:DE(e),legacyVoiceProfile:rw(e),voiceProfile:ow(e),feedbackForm:PE(e),skill:nw(e,!1),toneReport:r.n.composeKnot({toneReport:sw(e)}),settings:tw(e),signedOut:iw(e),performanceScore:UE(e),plagiarism:r.n.composeOption((0,a.pipe)(e.revision,o.fold((()=>Ww),(t=>function(e){return r.n.composeUnion({loadingState:zE(e),emptyState:qE(e),nonEmptyState:QE(e),uphookState:ew(e),smartUphookState:JE(e),smartUphookEmptyState:YE(e)},(()=>function(e){return f.s.combine(e.user.isPremium,e.feed.feed,e.feed.feedReset,e.plagiarism.state,e.plagiarism.smartUphookEnabled,((e,t,i,n,s)=>(0,a.pipe)(k.CO(o.option)(t,n.state),o.fold((()=>e||s?"loadingState":"uphookState"),(([t,{checking:n}])=>e||s?Cn(t.collection)>0?s?"smartUphookState":"nonEmptyState":n||i?"loadingState":s?"smartUphookEmptyState":"emptyState":"uphookState")))))}(e).view((e=>({kind:e})))))}({plagiarism:t.plagiarism,lifecycle:e.lifecycle,user:e.user,feed:t.feed,suggestionCount:t.suggestionCount,pageRange:t.pageRange,uphook:e.uphook})))),(()=>u.of(e.revision))),writingExpert:r.n.composeOption((0,a.pipe)(e.revision,o.fold((()=>Ww),(t=>function(e){const t=GE(e.feed.feed).pipe(M.shareReplay({bufferSize:1,refCount:!0}));return r.n.composeUnion({[Ln.Kind.loadingEvaluationAndSuggestions]:()=>e.writingExpert.state.pipe(m.p(Ln.isLoadingEvaluationAndSuggestions)),[Ln.Kind.nonEmpty]:r.n.composeKnot({root:r.n.fromSideEffect((({kind:t})=>{if("writingExpertFeedMount"===t)return e.feed.onFeedMount();(0,a.absurd)(t)}),e.writingExpert.state.pipe(m.p(Ln.isNonEmpty))),cardList:ZE(e,t)}),[Ln.Kind.nonEmptyLoadingEvaluation]:r.n.composeKnot({root:r.n.fromSideEffect((({kind:t})=>{if("writingExpertFeedMount"===t)return e.feed.onFeedMount();(0,a.absurd)(t)}),e.writingExpert.state.pipe(m.p(Ln.isNonEmptyLoadingEvaluation))),cardList:ZE(e,t)}),[Ln.Kind.empty]:r.n.fromSideEffect(cw(e),e.writingExpert.state.pipe(m.p(Ln.isEmpty),R.T((e=>({sduiItem:e.sduiItem}))))),[Ln.Kind.error]:r.n.fromSideEffect(cw(e),e.writingExpert.state.pipe(m.p(Ln.isError),R.T((e=>({sduiItem:e.sduiItem}))))),[Ln.Kind.evaluationFinishedLoadingSuggestions]:()=>e.writingExpert.state.pipe(m.p(Ln.isEvaluationFinishedLoadingSuggestions))},(()=>e.writingExpert.state.pipe(R.T((e=>({kind:e.kind}))))))}(Object.assign(Object.assign({},t),{lifecycle:e.lifecycle}))))),(()=>u.of(e.revision)))},(()=>e.routing.activeView))}const qw=new ed.C(999999);var Qw;function Jw(e){const t=e.promptMenu.state.pipe(R.T((e=>(0,a.pipe)(e,o.fold((()=>"closed"),(e=>e.kind)))),0)),i=e.promptMenu.state.pipe(R.T((e=>(0,a.pipe)(e,o.map((e=>{switch(e.kind){case"actionStore":return"prompt-studio-action-store";case"searchResults":case"emptySearchResults":return"prompt-studio-search-results";default:(0,g.AS)(e)}})),o.toUndefined)),0));return r.n.fromSideEffect((t=>e.notify(t)),Ct.zV([e.assistant.state,t,e.routing.activeView,i]).pipe(R.T((([e,t,i,n])=>{return{kind:(0,a.pipe)(e.genAISession,o.chain(oe.toStarted),o.fold((()=>"loading"),(e=>(0,a.pipe)(e.inProgressResult,o.fold((()=>"ready"),(()=>"waitingForResult")))))),genAIAvailability:e.genAIAvailability,placeholder:(s=e,(0,a.pipe)(s.selectedAction,o.chain((e=>""!==e.args[0].label.trim()?o.some(e.args[0].label):o.none)),o.alt((()=>(0,a.pipe)(s.userPromptAction,o.map((e=>e.arg.label))))))),text:e.textBox,autofocusToken:(0,a.pipe)(e.genAISession,o.chain((e=>e.error)),o.fold((()=>Qw.create(`${i.kind}_${(0,a.pipe)(e.genAISession,o.chain(oe.toStarted),o.chain((e=>e.inProgressResult)),o.fold((()=>"done"),(()=>"inProgress")))}_${(0,a.pipe)(e.selectedAction,o.fold((()=>"no-selected-action"),(()=>"selected-action")))}_${e.promptAutofocusToken}_promptMenuState:${t}`)),(()=>{}))),ariaControls:n,ariaExpanded:Boolean(n)};var s})),I.F()))}function Yw(e){return r.n.fromSideEffect((t=>e.notify(t)),e.promptMenu.state.view((0,a.flow)(o.filter(Ni.isActionStore),o.map((e=>e.actions)),tA)))}function Xw(e){const t=(0,a.pipe)(e,E.pb((e=>e.group.id!==J.knownGroup.apps)));if(o.isNone(t))return Number.MAX_SAFE_INTEGER;const i=(0,a.pipe)(t.value,E.Tj((e=>e.group.rank)),E.T9($.ordNumber)),n=(0,a.pipe)(t.value,C.pb((e=>e.group.id===J.knownGroup.moreIdeas)),C.Tj((e=>e.group.rank)),E._S,o.map(E.T9($.ordNumber)));return(0,a.pipe)(n,o.filter((e=>e===i)),o.map((e=>e-1)),o.getOrElse((()=>i+1)))}function eA(e){return(0,a.pipe)(e,E.Tj((t=>{var i,n;return Object.assign(Object.assign({},t),{group:Object.assign(Object.assign({},t.group),{rank:t.group.id===J.knownGroup.apps?Xw(e):null!==(i=J.knownGroupRank[t.group.id])&&void 0!==i?i:t.group.rank,label:null!==(n=J.knowGroupLabels[t.group.id])&&void 0!==n?n:t.group.label})})})))}function tA(e){return(0,a.pipe)(e,o.map(eA),o.chain(E.pb((e=>e.group.label.trim().length>0))),o.map(E._w(J.ListableActionInput.ordByGroup)),o.fold((()=>({actionGroups:[]})),(e=>({actionGroups:e.map((e=>({label:e[0].group.label,actions:(0,a.pipe)(e,E.Tj((e=>({action:Rr.RegularAction.make(e),label:e.label,icon:e.icon}))))})))}))))}function iA(e){return r.n.composeKnot({root:r.n.fromSideEffect((t=>{e.notify(t)}),e.promptMenu.state.view((0,a.flow)(o.filter(Ni.isSearchResults),nA))),goAction:r.n.composeOption(Dw(e,u.of({kind:"go"}),"search",0),(()=>e.assistant.state.pipe(R.T((e=>v.y.isUnavailable(e.genAIAvailability)?o.none:o.some(null))))))})}function nA(e){return(0,a.pipe)(e,o.fold((()=>({actions:[],query:""})),(({actions:e,query:t})=>({actions:e.map((e=>({action:Rr.RegularAction.make(e),label:e.label,icon:e.icon}))),query:t}))))}function sA(e){return r.n.fromSideEffect((t=>e.notify(t)),e.promptMenu.state.view((0,a.flow)(o.filter(Ni.isEmptySearchResults),o.fold((()=>({query:""})),(({query:e})=>({query:e}))))))}function rA(e){return r.n.composeKnot({root:r.n.fromSideEffect((t=>e.notify(t)),u.of(null)),content:r.n.composeUnion({none:()=>u.of(null),emptySearchResults:()=>u.of(null),searchResults:iA(e),actionStore:Yw(e)},(()=>e.promptMenu.state.view((t=>(0,a.pipe)(t,o.fold((()=>"none"),(t=>Ni.isEmptySearchResults(t)&&"revision"===e.experience?"emptySearchResults":Ni.isNonEmptyState(t)?t.kind:"none")),(e=>({kind:e})))))))})}function oA(e){return r.n.composeOption(r.n.composeUnion({none:()=>u.of(null),emptySearchResults:sA(e),popup:rA(e)},(()=>e.promptMenu.state.view((t=>(0,a.pipe)(t,o.fold((()=>"none"),(t=>Ni.isNonEmptyState(t)||"revision"===e.experience?"popup":"emptySearchResults")),(e=>({kind:e}))))))),(()=>e.promptMenu.state))}function aA(e){const t=f.s.combine(e.assistant.state.view("genAIAvailability"),e.promptMenu.state,((e,t)=>v.y.isUnavailable(e)&&o.isNone(t)));return r.n.composeOption(function(e){return r.n.composeKnot({root:r.n.fromSideEffect((t=>e.notify(t)),e.promptMenu.state.pipe(R.T((t=>({menuExpanded:(0,a.pipe)(t,o.exists((0,j.Ub)(Ni.isNonEmptyState,(()=>"revision"===e.experience))))}))))),promptField:Jw(e),promptStudioMenu:oA(e)})}(e),(()=>t.view((0,j.Sw)(o.none,o.some(null)))))}function lA(e,t=f.s.create(!1)){return r.n.fromSideEffect((t=>e.notify(t.action.action)),f.s.combine(e.assistant.state.view("genAISession"),e.assistant.state.view("genAIAvailability"),e.routing.activeView,t,((e,t,i,n)=>{if(o.isNone(e))return o.none;const s=e.value,r="started"!==s.kind||s.historyStatus!==oe.HistoryStatus.hasHistory&&0===s.results.length?"disabled":s.historyStatus===oe.HistoryStatus.historyRequested?"loading":"enabled";return"home"!==i.kind||v.y.isUnavailable(t)||n?o.none:o.some({state:r})})))}!function(e){e.create=function(e){return null!=e?e:qw.newId()}}(Qw||(Qw={}));const cA=["writingExpertAction","quickAction","followUpQuestion","toneAction","plagiarismAction","performanceScoreAction","humanWritingReportAction","skillAction"],dA={writingExpertAction:new Set(cA.slice(1)),quickAction:new Set(cA.slice(2)),followUpQuestion:new Set(cA.slice(3)),toneAction:new Set(cA.slice(4)),plagiarismAction:new Set(cA.slice(5)),performanceScoreAction:new Set(cA.slice(6)),humanWritingReportAction:new Set(cA.slice(7)),skillAction:new Set(cA.slice(8))},uA=$.fromCompare(((e,t)=>e.kind===t.kind?0:dA[e.kind].has(t.kind)?-1:1));function pA(e){return r.n.fromSideEffect((t=>e.notify(t)),f.s.combine(e.promptActions.state,e.assistant.state.view("genAIAvailability"),e.assistant.state.view("genAISession"),e.routing.activeView,e.promptMenu.state,(({contextualActions:e,toneAction:t,performanceScoreAction:i,plagiarismAction:n,skillActions:s,writingExpertAction:r,humanWritingReportAction:l},c,d,u,p)=>{const m=C.oE(["home"===u.kind?r:o.none,t,n,i,l]).concat(s),h=(0,a.pipe)(e,o.fold((()=>[]),(e=>e.actions))),g=(0,a.pipe)(h.concat(m).map(Rr.RegularAction.make),C.di($.contramap((e=>e.action))(uA)));return{loading:(0,a.pipe)(e,o.fold((()=>(0,a.pipe)(d,o.fold((()=>!1),oe.isStartingWithoutError))),(e=>e.loading))),actions:g,hasMore:h.length>g.length,hasHistoryButton:!v.y.isUnavailable(c),expanded:o.isSome(p)}})))}function mA(e){return r.n.fromSideEffect((t=>e.notify(t)),f.s.combine(e.promptActions.state,e.routing.activeView,e.lifecycle.size,e.assistant.state,(0,a.pipe)(e.revision,o.fold((()=>f.s.create(null).view()),(e=>e.feedForm.state.view("feedForm")))),e.skill.translationDiscoverabilityTreatmentEnabled,(({contextualActions:t,toneAction:i,performanceScoreAction:n,plagiarismAction:s,skillActions:r,writingExpertAction:l,humanWritingReportAction:c},d,u,{genAISession:p},m,h)=>{var g;const f="quickReply"===(null===(g=o.toNullable(p))||void 0===g?void 0:g.mode)||"longForm"===m&&!hA(e.revision,o.isSome(p),d,u)?3:2,v=(0,a.pipe)(t,o.fold((()=>[]),(e=>e.actions))),_=C.oE(["home"===d.kind?l:o.none,i,s,n,c]).concat(r),b=(0,a.pipe)(v.concat(_).map(Rr.RegularAction.make),C.di($.contramap((e=>e.action))(uA)),(e=>{if(h){const t=e.find((e=>"Translate with Grammarly"===e.action.searchLabel));if(void 0!==t){const i=e.filter((e=>"Translate with Grammarly"!==e.action.searchLabel));return[...i.slice(0,1),t,...i.slice(1)]}}return e})),y=(0,a.pipe)(b,C.$M(f));return{loading:(0,a.pipe)(t,o.fold((()=>(0,a.pipe)(p,o.fold((()=>!1),oe.isStartingWithoutError))),(e=>e.loading))),maxActionsCount:f,actions:y,hasMore:b.length>y.length}})))}function hA(e,t,i,n){return(0,a.pipe)(e,o.filter((e=>"home"===i.kind&&n&&n.width<350&&n.height>600||"home"===i.kind&&C.nZ(U.kK).equals(e.feedForm.requestedSupportedForms,["longForm"])&&!t)),o.isSome)}function gA(e){return r.n.composeUnion({none:()=>u.of(null),actionBar:fA(e),actionPanel:vA(e)},(()=>function(e){return f.s.combine(e.routing.activeView,e.assistant.state.view("genAISession"),e.lifecycle.size,function(e){return(0,a.pipe)(e.revision,o.fold((()=>f.s.create(!0)),(t=>f.s.combine(Tw(e),Aw({revision:t,notify:e.notify}),kw(Object.assign(Object.assign({},t),{uphook:e.uphook})),((e,t,i)=>"none"===e||"shortFormFeed"===e&&("emptyState"===t||"successState"===t)||"longFormFeed"===e&&("emptyState"===i||"successState"===i))))))}(e),((t,i,n,s)=>{var r,l;return!It(t)||"thread"===t.kind&&"starting"===(null===(r=o.toNullable(i))||void 0===r?void 0:r.kind)?"none":"revision"===e.experience?hA(e.revision,o.isSome(i),t,n)?"actionPanel":"actionBar":o.isSome(e.revision)&&"home"===t.kind?"quickReply"===(null===(l=o.toNullable(i))||void 0===l?void 0:l.mode)||hA(e.revision,o.isSome(i),t,n)||s?"actionPanel":"actionBar":(0,a.pipe)(i,o.chain(oe.toStarted),o.chain((e=>e.inProgressResult)),o.isSome)?"none":"actionPanel"}))}(e).view((e=>({kind:e}))).pipe(B.Z(0),ut.Z({kind:"none"}))))}function fA(e){return r.n.composeKnot({root:pA(e),header:r.n.fromSideEffect((t=>e.notify(t.action.action)),f.s.combine(e.assistant.state.view("genAISession").view(o.chain((e=>e.selectedText))),e.promptActions.state.view("contextualActions"),((e,t)=>(0,a.pipe)(k.CO(o.option)(e,t),o.filter((([e,t])=>"pending"===t.context.kind)),o.map((([e])=>e)),o.alt((()=>(0,a.pipe)(t,o.chain((e=>e.context.selection)),o.map((e=>e.text))))),o.map((e=>({selectedText:e}))))))),historyButton:lA(e)})}function vA(e){return r.n.composeKnot({root:mA(e),header:_A(e),historyButton:lA(e)})}function _A(e){return r.n.fromSideEffect((t=>e.notify(t.action)),f.s.combine(e.routing.activeView,e.promptActions.state.view("contextualActions"),e.assistant.state.view("genAISession").view(o.isSome),e.assistant.state.view("genAISession").view(o.fold((()=>null),(e=>e.mode))),e.textEditor.state.view("textLength"),(t=e.revision,(0,a.pipe)(t,o.fold((()=>f.s.create({allSuggestionsCount:0,someSuggestionsAddressed:!1,firstCheckingFinishedAndSduiEventsSettled:!0,firstCheckingFinishedAndSduiEventsSettledTimedOut:!1}).view()),(e=>f.s.combine(e.checkingState.firstCheckingFinishedAndSduiEventsSettled,e.checkingState.firstCheckingFinishedAndSduiEventsSettledTimedOut,e.suggestionCount.state,((e,t,{allSuggestionsCount:i,someSuggestionsAddressed:n})=>({firstCheckingFinishedAndSduiEventsSettled:e,firstCheckingFinishedAndSduiEventsSettledTimedOut:t,allSuggestionsCount:i,someSuggestionsAddressed:n}))))))),((e,t,i,n,s,{allSuggestionsCount:r,someSuggestionsAddressed:l,firstCheckingFinishedAndSduiEventsSettled:c,firstCheckingFinishedAndSduiEventsSettledTimedOut:d})=>{if(It(e)&&i){const i=(0,a.pipe)(s,o.exists((e=>0===e)));return(0,a.pipe)(t,o.map((({context:e})=>e)),o.filter((e=>e.isBoundary&&o.isSome(e.textRevision))),o.chain((({selection:e})=>e)),o.map((e=>e.text)),o.fold((()=>"home"===e.kind&&(i||0===r&&(c||d)||"quickReply"===n)?{kind:"title",title:bA(n,i,r,l),subtitle:"Here are some ideas"}:{kind:"none"}),(e=>({kind:"selectionContext",selectedText:e}))))}return{kind:"none"}})));var t}function bA(e,t,i,n){return"quickReply"===e?"How do you want to reply?":0===i&&n?"What do you want to do next?":t||0!==i||n?"How do you want to get started?":"What do you want to do?"}function yA(e){return r.n.composeKnot({header:gA(e),fieldContainer:aA(e)})}function kA(e){return r.n.composeUnion({none:()=>u.of(null),skill:nw(e,!0),promptStudio:yA(e)},(()=>e.routing.activeView.view((e=>"skill"===e.kind?{kind:"skill"}:It(e)||"followUpPrompt"===e.kind&&"string"===e.inputType?{kind:"promptStudio"}:{kind:"none"}))))}function SA(e){return r.n.fromSideEffect((t=>{if("suggestionCountButtonClick"===t.kind)return e.routing.pop();(0,g.AS)(t.kind)}),f.s.combine(e.assistant.state.view("genAISession").view((0,a.flow)(o.chain(oe.toStarted),o.chain((e=>e.inProgressResult)),o.isSome)),function(e){return(0,a.pipe)(e.revision,o.fold((()=>f.s.create(o.none)),(e=>e.suggestionCount.state.view("allSuggestionsCount").view(o.some))))}(e),((e,t)=>(0,a.pipe)(t,o.getOrElse((()=>0)),(t=>({count:t,disabled:e,label:t>0?`Review ${gt.td(t,"suggestion","suggestions")}`:"Back to Home"}))))))}function CA(e){return r.n.fromSideEffect((t=>e.notify(t.action.action)),e.routing.activeView.view("kind").view((t=>o.isSome(e.settings)&&"settings"!==t?o.some(null):o.none)))}function EA(e){return()=>f.s.combine(e.routing.activeView,e.skill.state,(0,a.pipe)(e.toneDetector,o.fold((()=>f.s.create(o.none)),(e=>e.state.view(o.some)))),((e,t,i)=>wA(e,t,i).label))}function wA(e,t,i){switch(e.kind){case"home":case"thread":case"error":case"followUpPrompt":case"signedOut":case"plagiarism":return{label:o.none,iconUrl:o.none};case"legacyVoiceProfile":case"voiceProfile":return{label:o.some("My voice"),iconUrl:o.none};case"feedbackForm":return{label:o.some("Share your thoughts"),iconUrl:o.none};case"skill":return{label:(0,a.pipe)(t,o.map((e=>e.skill.displayName))),iconUrl:(0,a.pipe)(t,o.map((e=>e.skill.iconUrl)))};case"toneReport":return{label:(0,a.pipe)(i,o.filter(Dt.isLoaded),o.chain((e=>e.brandToneInfo)),o.chain((({institutionName:e})=>e)),o.map((e=>`${e} Tone Detector`)),o.alt((()=>o.some("Tone insights")))),iconUrl:(0,a.pipe)(i,o.filter(Dt.isLoaded),o.chain((e=>e.brandToneInfo)),o.chain((e=>e.institutionLogo)))};case"settings":return{label:o.some("Settings"),iconUrl:o.none};case"writingExpert":return{label:o.some("Increase your impact"),iconUrl:o.none};case"performanceScore":return{label:o.some("Performance"),iconUrl:o.none};default:(0,g.AS)(e)}}function AA(e){return r.n.fromSideEffect((t=>e.notify(t)),f.s.combine(e.routing.activeView,e.skill.state,(0,a.pipe)(e.toneDetector,o.fold((()=>f.s.create(o.none)),(e=>e.state.view(o.some)))),((e,t,i)=>(0,a.pipe)(wA(e,t,i),(({iconUrl:t})=>({activeViewIconUrl:t,activeView:e}))))))}function IA(e){return r.n.fromSideEffect((t=>e.notify(t)),u.of(null))}function xA(e){const t=e.assistant.state.view((e=>(0,a.pipe)(e.genAIAvailability,o.fromPredicate(v.y.isActiveOrPassive),o.filter((()=>o.isSome((0,a.pipe)(e.genAISession,o.chain(oe.toStarted))))))));return r.n.composeOption(function(e,t,i){return r.n.fromSideEffect((t=>e.notify(t)),(0,a.pipe)(Ct.zV([t,i,e.uphook.isGrammarlyPro]),R.T((([e,t,i])=>({user:e,genAIAvailability:t,isGrammarlyPro:i})))))}(e,e.assistant.state.view("user").pipe(m.p(he)),t.pipe(N.oE)),(()=>f.s.combine(e.assistant.state.view("user"),t,e.routing.activeView.view("kind"),((e,t,i)=>(0,a.pipe)(t,o.filter((()=>he(e)&&"voiceProfile"!==i&&"legacyVoiceProfile"!==i&&"feedbackForm"!==i&&"skill"!==i&&"settings"!==i&&"toneReport"!==i)))))))}function TA(e){return()=>e.user.isGrammarlyInstitutionMember.view((e=>({version:e?o.some(st.version):o.none})))}function FA(e){return r.n.composeKnot({left:RA(e),right:r.n.composeKnot({credits:xA(e),voiceButton:KA(e),settingsButton:CA(e),closeButton:IA(e)}),pageTitle:EA(e)})}function RA(e){const t=f.s.combine(e.assistant.state.view("genAISession"),e.routing.activeView,((t,i)=>(0,a.pipe)(t,o.chain(oe.toStarted),o.fold((()=>Tt(i)?"backButton":"logoOnly"),(()=>{if("error"===i.kind)return"logoOnly";if("signedOut"===i.kind)return"logoOnly";if("home"===i.kind||"thread"===i.kind){if("home"===i.kind)return"logoOnly";if("thread"===i.kind)return o.isSome(e.revision)?"suggestionCount":"logoOnly";(0,g.AS)(i)}else{if("followUpPrompt"===i.kind)return"backButton";if(Tt(i))return"backButton";(0,g.AS)(i)}})))));return r.n.composeUnion({logoOnly:TA(e),suggestionCount:r.n.composeKnot({button:SA(e)}),backButton:AA(e)},(()=>t.pipe(ut.Z("logoOnly"),R.T((e=>({kind:e}))))))}function KA(e){return r.n.fromSideEffect((t=>e.notify(t.action.action)),f.s.combine(e.assistant.state.view("user"),e.assistant.state.view("genAISession"),e.assistant.state.view("genAIAvailability"),e.routing.activeView,((e,t,i,n)=>(0,a.pipe)(t,o.chain(oe.toStarted),o.filter((()=>he(e)&&!v.y.isUnavailable(i)&&It(n))),o.map((()=>null))))))}function MA(e){performance.mark(n.assistantGetStart);const t=s.memo((function(){performance.mark(n.assistantComponentStart);const t=s.useRef(Vr(e));performance.mark(n.assistantViewModelsCreated),s.useEffect((()=>()=>t.current.dispose()));const i=r.UI.mount((o=t.current,r.UI.Knot.make(r.UI.Grid.make((({slots:e})=>s.createElement(mo.Provider,{value:{notifyUnmount:e=>o.notify(e)}},s.createElement(Io.D.Provider,{value:o.theme.theme},e.assistant)))),{assistant:RE})),function(e){return r.n.composeKnot({assistant:r.n.composeKnot({root:NE(e),content:zw(e),header:FA(e),footer:kA(e),notifications:ME(e),onboarding:(t=e.onboarding,r.n.fromSideEffect((e=>t.notify(e)),t.onboardingStep.view((e=>({step:e}))))),a11yNotification:KE(e)})});var t}(t.current));var o;return performance.mark(n.assistantComponentEnd),i}));return performance.mark(n.assistantGetEnd),t}},4187:(e,t,i)=>{i.d(t,{y:()=>s});var n=i(64458);class s{constructor(e){this._theme=e,this.theme=this._theme.view((e=>Object.assign(Object.assign({},n.z),e)))}}},91605:(e,t,i)=>{i.d(t,{K:()=>L});var n,s=i(65390),r=i(84647),o=i(9619),a=i(78339),l=i(60269),c=i(80074),d=i(96659),u=i(64458),p=i(4187),m=i(38260),h=i(89769),g=i(65621),f=i(15491),v=i(90405),_=i(21662),b=i(6987),y=i(10540),k=i(48209),S=i(95168),C=i(62822),E=i(54988),w=i(36840),A=i(86562),I=i(58193),x=i(97782),T=i(28081),F=i(29577),R=i(45413);function K(e,t,i,n,s=1e3){return e.pipe(a.p(R.K.is(R.K.Kind.mount)),a.p((e=>i(e.step))),b.n((({step:e})=>t.pipe(f.T(I.gR(e)),b.n((e=>e?n.pipe(C.u(Date.now())):E.w)),a.p((e=>Date.now()-e>=s)),C.u(e)))))}!function(e){e.completeInitialOrRewriteStepOnSessionInit=({session:e,stepsSeenOnThisSession:t})=>e.pipe(h.Z(s.none),g.J(),f.T((([e,t])=>s.isNone(e)&&s.isSome(t)?s.some(t):s.none)),v.oE,_.E(t),b.n((([e,t])=>(0,r.pipe)([t.has(F.M.StepName.initial)?s.some(F.M.StepName.initial):s.none,t.has(F.M.StepName.initialBTS)?s.some(F.M.StepName.initialBTS):s.none,T.Y.isRewriteOrQuickRewrite(e.value.mode)?s.some(F.M.StepName.rewrite):s.none],m.oE)))),e.completeReviewStepOnSecondResultReceived=({session:e,activeStep:t})=>e.pipe(f.T((0,r.flow)(s.filter((e=>"started"===e.kind)),s.fold((()=>0),(e=>e.resultCount)))),g.J(),a.p((([e,t])=>1===e&&2===t)),_.E(t),f.T((([e,t])=>(0,r.pipe)(t,s.filter((e=>e===F.M.StepName.review))))),v.oE),e.completeActiveAssistantStepOnSessionEnd=({session:e,activeStep:t,visibleForMs:i,onboardingUIActions:n})=>K(n,t.pipe(y.QE(k.$)),F.M.StepName.isAssistantOnboardingStep,e.pipe(g.J(),a.p((([e,t])=>s.isSome(e)&&s.isNone(t)))),i),e.completeStepOnCloseClick=({onboardingUIActions:e,trackingService:t})=>e.pipe(a.p(R.K.is(R.K.Kind.close)),f.T((e=>(e.step===F.M.StepName.initial&&t.trackOnboardingPopupSkip(),e.step===F.M.StepName.initialBTS&&t.trackBTSOnboardingPopupSkip(),e.step)))),e.completeInitialStepOnTryItOutClick=({onboardingUIActions:e,trackingService:t})=>e.pipe(a.p(R.K.is(R.K.Kind.tryItOut)),f.T((e=>(e.step===F.M.StepName.initial&&t.trackOnboardingPopupNext(),e.step===F.M.StepName.initialBTS&&t.trackBTSOnboardingPopupNext(),e.step)))),e.completeReviewStepOnResultInteraction=({assistantUIActions:e})=>e.pipe(a.p(d.t.isResultAction),a.p((e=>x.Q.isStandardCompletedResult(e.result))),f.T((()=>F.M.StepName.review))),e.completeHistoryStepOnHistoryRestore=({assistantUIActions:e})=>e.pipe(a.p(d.t.is(d.t.Kind.restoreHistoryButtonClick)),f.T((()=>F.M.StepName.history))),e.completeAssistantStepsOnUserActions=({assistantUIActions:e,activeStep:t})=>e.pipe(a.p((0,w.Ub)(d.t.is(d.t.Kind.actionBrickClick),d.t.is(d.t.Kind.promptSubmitButtonClick),d.t.is(d.t.Kind.promptFieldKeyPressEnter),d.t.is(d.t.Kind.headerVoiceButtonClick),d.t.is(d.t.Kind.setVoiceButtonClick),d.t.is(d.t.Kind.openFeedbackFormButtonClick))),_.E(t),f.T((([e,t])=>(0,r.pipe)(t,s.filter(F.M.StepName.isAssistantOnboardingStep)))),v.oE),e.completeInitialStepOnDispose=({onboardingUIActions:e,activeStep:t,disposed:i,visibleForMs:n})=>K(e,t,(e=>e===F.M.StepName.initial||e===F.M.StepName.initialBTS),i,n);const t=e=>t=>i=>t(i).pipe(S.M((t=>{var n;return null===(n=i.logger)||void 0===n?void 0:n.debug(`Onboarding - ${e} - step to complete: ${t}.`)})));e.defaultCompletionSources=[t("session init")(e.completeInitialOrRewriteStepOnSessionInit),t("second result received")(e.completeReviewStepOnSecondResultReceived),t("session end")(e.completeActiveAssistantStepOnSessionEnd),t("user closed step")(e.completeStepOnCloseClick),t("user clicked try-it-out")(e.completeInitialStepOnTryItOutClick),t("user interacted with results")(e.completeReviewStepOnResultInteraction),t("user interacted with assistant")(e.completeAssistantStepsOnUserActions),t("user restored history")(e.completeHistoryStepOnHistoryRestore),t("feature disposed")(e.completeInitialStepOnDispose)]}(n||(n={}));var M=i(22548),O=i(87642);class N{constructor(e,t){this._capiService=e,this._logger=t}trackOnboardingPopupView(){var e;null===(e=this._logger)||void 0===e||e.debug("Tracking onboarding pop-up view."),this._trackUxInteraction({kind:"onboardingPopup",userAction:M._.Onboarding.UserAction.view})}trackOnboardingPopupSkip(){var e;null===(e=this._logger)||void 0===e||e.debug("Tracking onboarding pop-up skip."),this._trackUxInteraction({kind:"onboardingPopup",userAction:M._.Onboarding.UserAction.skip})}trackOnboardingPopupNext(){var e;null===(e=this._logger)||void 0===e||e.debug("Tracking onboarding pop-up next."),this._trackUxInteraction({kind:"onboardingPopup",userAction:M._.Onboarding.UserAction.next})}trackBTSOnboardingPopupView(){var e;null===(e=this._logger)||void 0===e||e.debug("Tracking BTS onboarding pop-up view."),this._trackUxInteraction({kind:"BTSonboardingPopup",userAction:M._.Onboarding.UserAction.view})}trackBTSOnboardingPopupSkip(){var e;null===(e=this._logger)||void 0===e||e.debug("Tracking BTS onboarding pop-up skip."),this._trackUxInteraction({kind:"BTSonboardingPopup",userAction:M._.Onboarding.UserAction.skip})}trackBTSOnboardingPopupNext(){var e;null===(e=this._logger)||void 0===e||e.debug("Tracking BTS onboarding pop-up next."),this._trackUxInteraction({kind:"BTSonboardingPopup",userAction:M._.Onboarding.UserAction.next})}trackOnboardingPromptsTooltipView(){var e;null===(e=this._logger)||void 0===e||e.debug("Tracking onboarding prompts tooltip view."),this._trackUxInteraction({kind:"onboardingPromptsTooltip",userAction:M._.Onboarding.UserAction.view})}trackOnboardingReviewTooltipView(){var e;null===(e=this._logger)||void 0===e||e.debug("Tracking onboarding review tooltip view."),this._trackUxInteraction({kind:"onboardingReviewTooltip",userAction:M._.Onboarding.UserAction.view})}trackOnboardingRewriteTooltipView(){var e;null===(e=this._logger)||void 0===e||e.debug("Tracking onboarding rewrite tooltip view."),this._trackUxInteraction({kind:"onboardingRewriteTooltip",userAction:M._.Onboarding.UserAction.view})}trackOnboardingKnowledgeHubTooltipView(){var e;null===(e=this._logger)||void 0===e||e.debug("Tracking onboarding knowledge-hub tooltip view."),this._trackUxInteraction({kind:"onboardingKnowledgeHubTooltip",userAction:M._.Onboarding.UserAction.view})}trackOnboardingReferencesTooltipView(){var e;null===(e=this._logger)||void 0===e||e.debug("Tracking onboarding references tooltip view."),this._trackUxInteraction({kind:"onboardingReferencesTooltip",userAction:M._.Onboarding.UserAction.view})}trackOnboardingHistoryTooltipView(){var e;null===(e=this._logger)||void 0===e||e.debug("Tracking onboarding history tooltip view."),this._trackUxInteraction({kind:"onboardingHistoryTooltip",userAction:M._.Onboarding.UserAction.view})}_trackUxInteraction(e,t,i,n={}){var s;const r=M._.getComponentId(e,t,i,n),o=M._.getUserAction(e);null===(s=this._logger)||void 0===s||s.debug("Sending `user_action` to CAPI.",{componentId:r,userAction:o,uxInteraction:e,contextId:t}),(0,O.s)("sendUserAction",this._capiService.user_action({componentId:r,userAction:o}),this._logger)}}var B=i(68232),P=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(i[n[s]]=e[n[s]])}return i};class D extends B.a{constructor(e,t){super(e),this._onDispose=t}dispose(){super.dispose(),this._onDispose()}}function L(e){var{assistantUIActions:t,capiService:i,completeOnboardingStep:m,stepCompletionSources:h,disposed:g,theme:f,logger:v}=e,_=P(e,["assistantUIActions","capiService","completeOnboardingStep","stepCompletionSources","disposed","theme","logger"]);const b=new o.y,y=new N(i,v),k=new D(Object.assign(Object.assign({},_),{assistantMountActions:t.pipe(a.p(d.t.is(d.t.Kind.mount))),assistantUnmountActions:t.pipe(a.p(d.t.is(d.t.Kind.unmount)))}),(()=>b.unsubscribe())),C=l.h(...(null!=h?h:n.defaultCompletionSources).map((e=>e({onboardingUIActions:k.uiActions,assistantUIActions:t,activeStep:k.activeStep.view(s.map((e=>e.name))),stepsSeenOnThisSession:k.stepsSeenOnThisSession,session:_.session,trackingService:y,disposed:g,logger:v}))));return b.add(C.subscribe((e=>{(0,r.pipe)(k.activeStep.get(),s.exists((t=>t.name===e)))&&m(e),k.hideStepIfActive(e)}))),b.add(function(e,t){return e.pipe(a.p(R.K.is(R.K.Kind.mount)),S.M((e=>{switch(e.step){case F.M.StepName.initial:return t.trackOnboardingPopupView();case F.M.StepName.initialBTS:return t.trackBTSOnboardingPopupView();case F.M.StepName.prompts:return t.trackOnboardingPromptsTooltipView();case F.M.StepName.review:return t.trackOnboardingReviewTooltipView();case F.M.StepName.rewrite:return t.trackOnboardingRewriteTooltipView();case F.M.StepName.knowledgeHub:return t.trackOnboardingKnowledgeHubTooltipView();case F.M.StepName.references:return t.trackOnboardingReferencesTooltipView();case F.M.StepName.history:return t.trackOnboardingHistoryTooltipView();default:return(0,A.AS)(e.step)}})))}(k.uiActions,y).subscribe()),{onboarding:k,theme:new p.y(null!=f?f:c.s.create(u.z))}}},66995:(e,t,i)=>{i.d(t,{O:()=>n});var n,s=i(65390);!function(e){let t;!function(e){e.create=e=>e}(t=e.Id||(e.Id={})),e.create=function(t){return Object.assign(Object.assign({},t),{id:e.Id.create(t.id),url:s.fromNullable(t.url),contextText:s.none})}}(n||(n={}))},71195:(e,t,i)=>{function n(e){return"alertAdded"===e.kind}function s(e){return{kind:"alertAdded",alertId:e}}function r(e){return"alertRemoved"===e.kind}function o(e,t){return{kind:"alertRemoved",alertId:e,reason:t}}i.d(t,{BG:()=>s,L1:()=>n,rc:()=>o,x9:()=>r})},27180:(e,t,i)=>{function n(e){return"sduiItemAdd"===e.kind}function s(e,t){return{kind:"sduiItemAdd",sduiRootId:e,sdui:t}}function r(e){return"sduiItemUpdate"===e.kind}function o(e,t){return{kind:"sduiItemUpdate",sduiRootId:e,sdui:t}}function a(e){return"sduiItemRemove"===e.kind}function l(e){return{kind:"sduiItemRemove",sduiRootId:e}}function c(e){return"sduiReset"===e.kind}function d(){return{kind:"sduiReset"}}i.d(t,{Cv:()=>n,Jd:()=>a,av:()=>r,hp:()=>d,jw:()=>l,pp:()=>c,wq:()=>o,ws:()=>s}),(0,i(36840).Ub)(n,r,a,c)},12704:(e,t,i)=>{i.d(t,{Q:()=>n,T:()=>a});var n,s=i(19147),r=i(23988);!function(e){var t;(t=e.Result||(e.Result={}))[t.CONTINUE_HANDLING=0]="CONTINUE_HANDLING",t[t.STOP_HANDLING=1]="STOP_HANDLING"}(n||(n={}));var o=function(){},a=function e(){(0,s._)(this,e),(0,r._)(this,"onSessionStarted",o),(0,r._)(this,"onWaitForOT",o),(0,r._)(this,"onReady",o),(0,r._)(this,"onSessionInbound",o),(0,r._)(this,"beforeAlert",o),(0,r._)(this,"onAlert",o),(0,r._)(this,"onRemove",o),(0,r._)(this,"onChange",o),(0,r._)(this,"onSynonyms",o),(0,r._)(this,"onSnippets",o),(0,r._)(this,"onPlagiarism",o),(0,r._)(this,"onBeforeAsyncCheckFinish",o),(0,r._)(this,"onAsyncCheckFinish",o),(0,r._)(this,"onError",o),(0,r._)(this,"onBeforeFinish",o),(0,r._)(this,"onFinish",o),(0,r._)(this,"onStats",o),(0,r._)(this,"onTextMaps",o),(0,r._)(this,"onTextInfo",o),(0,r._)(this,"onEmotions",o),(0,r._)(this,"onPong",o),(0,r._)(this,"onDebugInfo",o),(0,r._)(this,"onConnect",o),(0,r._)(this,"onDisconnect",o),(0,r._)(this,"onClose",o),(0,r._)(this,"onQueueMsgAccepted",o),(0,r._)(this,"onQueueMsgDropped",o),(0,r._)(this,"onAck",o),(0,r._)(this,"onMessageReceived",o),(0,r._)(this,"onMessageSent",o),(0,r._)(this,"onAutoComplete",o),(0,r._)(this,"onAttentionHeatmap",o),(0,r._)(this,"onAttentionInfo",o),(0,r._)(this,"onProofitAvailability",o),(0,r._)(this,"onProofitCancelled",o),(0,r._)(this,"onProofitCompleted",o),(0,r._)(this,"onProofitProgress",o),(0,r._)(this,"onProofitProgressProblem",o),(0,r._)(this,"onProofitSubmit",o),(0,r._)(this,"onShortenItFinished",o),(0,r._)(this,"onSDUI",o),(0,r._)(this,"onPublishedAck",o),(0,r._)(this,"onGbRuleCreated",o),(0,r._)(this,"onReconnectInfo",o),(0,r._)(this,"onCheetahSetContext",o),(0,r._)(this,"onCheetahChunk",o),(0,r._)(this,"onCheetahResult",o),(0,r._)(this,"onCheetahSearchReferencesResult",o),(0,r._)(this,"onCheetahError",o),(0,r._)(this,"onCheetahUpdateState",o),(0,r._)(this,"onShowSurvey",o),(0,r._)(this,"onAsyncCheckProgress",o),(0,r._)(this,"onTouchTypistTriggerResponse",o)}},71883:(e,t,i)=>{i.d(t,{E:()=>S});var n=i(83531),s=i(19147),r=i(6922),o=i(23988),a=i(10334),l=i(17171),c=i(69384),d=i(91817),u=i(1059),p=i(84647),m=i(60575),h=i(58193),g=i(86562),f=i(66202),v=i(65390),_=i(36840),b=i(52138),y=i(12704),k=i(79622),S=function(){function e(t,i,n){var r=this;(0,s._)(this,e);var u=t.handler,S=t.reconnectHandler,C=void 0===S?b.C.getDefaultReconnect(b.C.ClientType.capi):S,E=t.maxReconnectDelay,w=t.baseReconnectDelay,A=(0,c._)(t,["handler","reconnectHandler","maxReconnectDelay","baseReconnectDelay"]);(0,o._)(this,"_connect",void 0),(0,o._)(this,"_ws",void 0),(0,o._)(this,"_log",void 0),(0,o._)(this,"_contentSource",void 0),(0,o._)(this,"_onConnectionFailed",void 0),(0,o._)(this,"_onConnectionSuccess",void 0),(0,o._)(this,"_capi",void 0),(0,o._)(this,"_conn",void 0),(0,o._)(this,"_isIdle",void 0),(0,o._)(this,"_isStarted",void 0),(0,o._)(this,"_currentSessionId",void 0),(0,o._)(this,"_maxWsMessageSize",void 0),(0,o._)(this,"_handler",void 0),(0,o._)(this,"_getSessionId",void 0),this._connect=i,this._ws=n,this._log=m.Bx.Logging.getLogger("coreclients.capi.connection"),this._isIdle=!1,this._isStarted=!1,this._currentSessionId=h.Ie(),this._maxWsMessageSize=h.Ie(),this._getSessionId=function(){return r._currentSessionId};var I=(0,l._)((0,a._)({},u||{}),{onError:function(e){var t,i,n,s;null===(t=(i=r)._onConnectionFailed)||void 0===t||t.call(i,new Error("Server Error during session start: code(".concat(e.error,") severity(").concat(e.severity,")"))),null===(s=u)||void 0===s||null===(n=s.onError)||void 0===n||n.call(s,e)},onWaitForOT:function(e){var t,i;(0,g.V1)(void 0!==r._onConnectionSuccess&&void 0!==r._onConnectionFailed,"expected initial connect promise to be initialized at this stage"),r._log.trace("sending initial reset Delta to CAPI"),r._capi.pushChanges(r._contentSource())().then(f.fold((function(e){r._onConnectionFailed(e),r._onConnectionFailed=void 0}),v.fold(_.Yi,(function(e){r._onConnectionSuccess(e),r._onConnectionSuccess=void 0})))),null===(i=u)||void 0===i||null===(t=i.onWaitForOT)||void 0===t||t.call(i,e)},onSessionStarted:function(e){var t,i;e.isNewSession||(r._onConnectionSuccess(),r._onConnectionSuccess=void 0),r._currentSessionId=v.some(e.sessionUuid),r._maxWsMessageSize=v.some(e.maxWsMessageSize),null===(i=u)||void 0===i||null===(t=i.onSessionStarted)||void 0===t||t.call(i,e)}});this._handler=Object.assign(new y.T,I),this._ws.onMessage((function(e,t){r._capi.isStable(t)&&x.reset()})).onConnecting((function(){r._isIdle=!1})).onConnect((function(){return r._handler.onConnect({kind:"connect"})})).onDisconnect((function(e){if(r._currentSessionId=v.none,!r._capi.isClosed()){var t={canGoIdle:r._capi.canGoIdle(),isStable:r._capi.isStable()};r._log.debug("calling reconnect handler:",t),(0,p.pipe)(C(e,x,t),(function(t){return r._handler.onDisconnect({kind:"disconnect",reason:e,reconnectCounter:x.retryStatus.iterNumber,reconnectResult:t}),t}),f.fold((function(e){r._log.warn("error reconnecting, closing CAPI:",e.message),r._capi.close("error reconnecting:"+e.message)}),(function(e){"idle"===e.kind&&(r._isIdle=!0)})))}}));var x=new b.C.ReconnectSchedulerImpl((function(){return r.connect(r._contentSource).then((function(e){var t=(0,d._)(e,2),i=t[0];return t[1],i}))}),[b.C.defaultRetryPolicy(w,E)]);this._capi=new k.n0(A,this._handler,this._ws,{getSessionId:this._getSessionId,getMaxWsMessageSize:function(){return r._maxWsMessageSize}})}return(0,r._)(e,[{key:"connect",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this;return(0,n._)((function(){var n;return(0,u.YH)(this,(function(s){switch(s.label){case 0:return(0,g.V1)(!i._capi.isClosed(),"cannot connect when CAPI is closed"),t||i._capi.resetReconnectInfo(),i._isIdle=!1,i._isStarted=!0,i._contentSource=e,i._log.trace("connect: initializing new ws connection"),[4,i._connect(i._ws)];case 1:return n=s.sent(),i._conn=n,[2,new Promise((function(e,t){i._onConnectionFailed=t,i._onConnectionSuccess=function(t){return e(t?[n,t]:[n])},setTimeout((function(){return t("failed to reconnect or connect to new CAPI session")}),5e3)}))]}}))}))()}},{key:"close",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b.C.WsCodes.NORMAL_CLOSURE,t=arguments.length>1?arguments[1]:void 0,i=this;return(0,n._)((function(){var n;return(0,u.YH)(this,(function(s){switch(s.label){case 0:return n=Boolean(t)?t:"CAPI WS Close called",i._log.trace("close: closing CAPI because: ".concat(n)),[4,i._capi.close(n)];case 1:return s.sent(),i._conn?(i._log.debug("close: closing connection because: ".concat(n)),[4,i._conn.close({code:e,reason:n})]):[3,3];case 2:s.sent(),s.label=3;case 3:return[2]}}))}))()}},{key:"isIdle",get:function(){return this._isIdle}},{key:"isDisconnected",get:function(){return this._ws.isDisconnected()}},{key:"wasStarted",get:function(){return this._isStarted}},{key:"client",get:function(){return this._capi}},{key:"maxWsMessageSize",get:function(){return this._maxWsMessageSize}}]),e}()},79622:(e,t,i)=>{i.d(t,{n0:()=>H,z7:()=>$});var n,s=i(83531),r=i(19147),o=i(6922),a=i(23988),l=i(10334),c=i(17171),d=i(91817),u=i(1059),p=i(84647),m=i(60575),h=i(66202),g=i(94855),f=i(65390),v=i(36840),_=i(86562),b=i(22835),y=i(77396),k=i(30720),S=i(69545),C=i(78044),E=i(49004),w=i(91242),A=i(12704),I=i(66799),x=i(54463),T=i(62228),F=i(9899),R=i(38886),K=i(88105);function M(e,t){var i=e.charCodeAt(t),n=e.charCodeAt(t+1);return i>=55296&&i<57344&&n>=56320&&n<57344}function O(e){return function(e){for(var t,i,n=0,s=e.length,r=0;r<s;r++)(t=e.charCodeAt(r))>=55296&&t<57344&&t<56320&&r+1<s&&(i=e.charCodeAt(r+1))>=56320&&i<57344?(n+=4,r++):n+=t<128?1:t<2048?2:3;return n}(e)/1e3}!function(e){var t=e.transformPosition=function(e,t){var i=I.tI.Position.rebase(e,t);return(!0===e.updatable?I.tI.Position.isSquashed(i):!I.tI.Position.hasEqualLength(e,i))?f.none:f.some(b.yo(e,i))};e.transformAlertChanged=function(e,t){if(0===t.delta.ops.length)return f.some(b.yo(e,{rev:t.revision}));if(void 0!==e.transformJson){var i=I.r5.rebase(e.transformJson,t.delta);return I.r5.isSquashed(i)?f.none:f.some(b.yo(e,{transformJson:i,rev:t.revision}))}return f.some(e)},e.transformAlert=function(e,i){if(0===i.delta.ops.length)return f.some(b.yo(e,{rev:i.revision}));var n=(0,p.pipe)(I.tI.hasPosition(e)?t(e,i.delta):f.some(e),f.map((function(e){return b.yo(e,{rev:i.revision})})));return(0,p.pipe)(n,f.chain(I.tI.matchBy(f.some,(function(e){var t=I.r5.rebase(e.transformJson,i.delta);return(!0===e.updatable?I.r5.isSquashed(t):!0!==I.r5.isValidAfterTransform(e.transformJson,t))?f.none:f.some(b.yo(e,{transformJson:t}))}),(function(e){var t=I.r5.rebase(e.subalerts,i.delta);return I.r5.isSquashed(t)?f.none:f.some(b.yo(e,{subalerts:t}))}))))},e.transformAttentionHeatmap=function(e,t){var i=function(e){return e.map((function(e){return I.J5.Range.rebase(e,t.delta)}))},n=i(e.update),s=n.filter(I.J5.Range.isSquashed).map((function(e){return e.id}));return b.yo(e,{rev:t.revision,add:i(e.add).filter((0,p.not)(I.J5.Range.isSquashed)),update:n.filter((0,p.not)(I.J5.Range.isSquashed)),remove:(0,F._)(e.remove).concat((0,F._)(s))})}}(n||(n={}));var N;!function(e){var t=function(e){return"change"===e.kind},i=function(e){return"change_chunked"===e.kind};e.isChange=(0,v.Ub)(t,i),e.isFullChange=t,e.isChunkedChange=i,e.isCmd=function(e){return"cmd"===e.kind},e.isExternalCmd=function(e){return"externalCmd"===e.kind},e.isCmdIncRevision=function(e){return"cmdIncRevision"===e.kind}}(N||(N={}));var B,P=function(){function e(t,i,s,o,l){var c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:100,d=arguments.length>6&&void 0!==arguments[6]?arguments[6]:.1,u=this;(0,r._)(this,e),(0,a._)(this,"_shouldIncreaseRevision",void 0),(0,a._)(this,"_acceptHandler",void 0),(0,a._)(this,"_dropHandler",void 0),(0,a._)(this,"_stateChangeHandler",void 0),(0,a._)(this,"_idGenerator",void 0),(0,a._)(this,"_maxMessageSizeKb",void 0),(0,a._)(this,"_messagePaddingKb",void 0),(0,a._)(this,"_log",void 0),(0,a._)(this,"_changes",void 0),(0,a._)(this,"_staged",void 0),(0,a._)(this,"_stagedOperationId",void 0),(0,a._)(this,"_ackedRevisions",void 0),(0,a._)(this,"_revision",void 0),(0,a._)(this,"_stagedAmount",void 0),(0,a._)(this,"transformChangeAgainstQueue",void 0),(0,a._)(this,"_split",void 0),(0,a._)(this,"_incRevision",void 0),(0,a._)(this,"_acceptMessage",void 0),(0,a._)(this,"_dropMessages",void 0),(0,a._)(this,"_updateCheckedTextSize",void 0),this._shouldIncreaseRevision=t,this._acceptHandler=i,this._dropHandler=s,this._stateChangeHandler=o,this._idGenerator=l,this._maxMessageSizeKb=c,this._messagePaddingKb=d,this._log=m.Bx.Logging.getLogger("coreclients.capi.queue",m.y7.$.DEBUG),this._changes=[],this._staged=[],this._stagedOperationId=null,this._stagedAmount=0,this.transformChangeAgainstQueue=function(e){var t=u._getQueuedDeltaAndLatestRevision(e.rev);return n.transformAlertChanged(e,t)},this._split=function(e){var t=JSON.stringify([e.delta]);return u._log.trace("change delta string",{deltasStr:t,size:O(t)}),function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if((0,_.V1)(i<t,"padding must be less than the max message size"),3*e.length/1e3+i<t)return[e];if(O(e)<t-i)return[e];for(var n=Math.max(2,Math.floor(function(e){return 1e3*e}(t-i)/3)),s=Math.ceil(e.length/n),r=new Array(s),o=0,a=0;o<e.length;){var l=M(e,o+n-1)?n-1:n;r[a++]=e.substr(o,l),o+=l}return r}(t,u._maxMessageSizeKb,u._messagePaddingKb)},this._incRevision=function(){return void 0===u._revision?u._revision=0:u._revision+=1},this._acceptMessage=function(e){u._updateCheckedTextSize(e),u._acceptHandler(e)},this._dropMessages=function(e,t){e.forEach(u._updateCheckedTextSize),u._dropHandler(e,t)},this._updateCheckedTextSize=function(e){N.isChange(e)?u._changeStagedAmount(-e.change.amount):("externalCmd"!==e.kind&&u._shouldIncreaseRevision(e.cmd)||"externalCmd"===e.kind&&e.incrementsRevision)&&u._changeStagedAmount(-I.$A)},this._log.debug("capi queue created",{maxMessageSizeKb:this._maxMessageSizeKb,messagePaddingKb:this._messagePaddingKb}),this.clear("init")}return(0,o._)(e,[{key:"pushChanges",value:function(e){var t=this,i=(0,p.pipe)(this._tail(),f.filter(N.isChange));return(0,p.pipe)(i,f.fold((function(){return t._log.trace("pushChanges() adding new change to queue"),t._enqueueChange(e,t._split(e))}),(function(i){t._log.trace("pushChanges() composing with latest change");var n=i.change.compose(e),s=t._split(n);if(t._replaceChange(t._changes.length-1,n,s),!0===n.isEmpty){var r=t._changes.pop();t._stateChangeHandler(t.isEmpty,t.isStaging),setTimeout((function(){return t._acceptMessage(r)}),0)}return i.id})))}},{key:"pushCommand",value:function(e){var t=this._idGenerator();return this._shouldIncreaseRevision(e)?(this._changeStagedAmount(I.$A),this._changes.push({kind:"cmdIncRevision",cmd:e,id:t,rev:this._incRevision()})):this._changes.push({kind:"cmd",cmd:e,id:t,rev:this.localRevision}),this._stateChangeHandler(this.isEmpty,this.isStaging),t}},{key:"pushExternalCommand",value:function(e,t){var i=this,n=this._idGenerator(),s=!1,r=t({id:n,sessionId:e,currentRevision:this.localRevision,nextRevision:function(){return s=!0,i._incRevision()}});s&&this._changeStagedAmount(I.$A);var o=this.localRevision;return this._changes.push({kind:"externalCmd",cmd:r,id:n,rev:o,incrementsRevision:s}),this._stateChangeHandler(this.isEmpty,this.isStaging),n}},{key:"isStaging",get:function(){return this._staged.length>0}},{key:"isEmpty",get:function(){return 0===this._changes.length}},{key:"hasCommitedChanges",get:function(){return this._changes.length>0}},{key:"localRevision",get:function(){return void 0!==this._revision?this._revision:0}},{key:"stagedAmount",get:function(){return this._stagedAmount}},{key:"hasChanges",get:function(){return this._changes.some(N.isChange)}},{key:"size",get:function(){return this._changes.length}},{key:"poll",value:function(){var e=this;return(0,_.V1)(null===this._stagedOperationId,"Should not be in staging mode"),(0,p.pipe)(f.fromNullable(this._changes.shift()),f.map((function(t){return N.isCmd(t)||N.isExternalCmd(t)&&!t.incrementsRevision||e._staged.push(t),e._stagedOperationId=t.id,e._stateChangeHandler(e.isEmpty,e.isStaging),t})))}},{key:"shift",value:function(){var e=f.fromNullable(this._changes.shift());return this._stateChangeHandler(this.isEmpty,this.isStaging),e}},{key:"peek",value:function(){return this.isEmpty?f.none:f.fromNullable(this._changes[0])}},{key:"ackOperation",value:function(e){(0,_.V1)(!!this._stagedOperationId&&e===this._stagedOperationId,"Cannot ack operation by wrong id. Expected: '".concat(this._stagedOperationId,", got: '").concat(e,"'")),this._stagedOperationId=null}},{key:"ackRevision",value:function(e){this._ackedRevisions.add(e),this._cleanStaged()}},{key:"transformAlertAgainstQueue",value:function(e){var t=this._getQueuedDeltaAndLatestRevision(e.rev);return n.transformAlert(e,t)}},{key:"transformAttentionHeatmapAgainstQueue",value:function(e){var t=this._getQueuedDeltaAndLatestRevision(e.rev);return n.transformAttentionHeatmap(e,t)}},{key:"clear",value:function(e){var t=(0,F._)(this._changes).concat((0,F._)(this._staged));this._changes=[],this._staged=[],this._stagedOperationId=null,this._ackedRevisions=new Set,this._revision=void 0,t.length>0&&this._dropMessages(t,e),this._stateChangeHandler(this.isEmpty,this.isStaging)}},{key:"_tail",value:function(){return this.isEmpty?f.none:f.fromNullable(this._changes[this._changes.length-1])}},{key:"_enqueueChange",value:function(e,t){var i,n=this,s=this._incRevision();if(this._changeStagedAmount(e.amount),1===t.length)i=this._idGenerator(),this._changes.push({kind:"change",change:e,id:i,rev:s,deltasString:t[0]});else{this._log.trace("change is larger than maximum allowed size, splitting to chunks",t.length);var r=t.map((function(e){return{id:n._idGenerator(),chunk:e}}));i=this._idGenerator(),this._changes.push({kind:"change_chunked",change:e,id:i,rev:s,chunks:r})}return this._stateChangeHandler(this.isEmpty,this.isStaging),i}},{key:"_replaceChange",value:function(e,t,i){var n=this,s=this._changes[e];(0,_.V1)(N.isChange(s),"queued change should exist");var r=s;this._changeStagedAmount(-r.change.amount+t.amount),i.length>1?this._changes[e]=(0,c._)((0,l._)({},r),{kind:"change_chunked",chunks:i.map((function(e){return{id:n._idGenerator(),chunk:e}}))}):this._changes[e]=(0,c._)((0,l._)({},r),{kind:"change",change:t,deltasString:i[0]})}},{key:"_cleanStaged",value:function(){for(;void 0!==this._staged[0]&&this._ackedRevisions.has(this._staged[0].rev);){var e=this._staged.shift();this._ackedRevisions.delete(e.rev),this._stateChangeHandler(this.isEmpty,this.isStaging),this._acceptMessage(e)}}},{key:"_changeStagedAmount",value:function(e){this._stagedAmount+=e}},{key:"_getQueuedDeltaAndLatestRevision",value:function(e){var t=this._staged.filter((function(t){return t.rev>e})).concat(this._changes).filter(N.isChange);return{delta:K.E.squash(t.map((function(e){return e.change.delta}))),revision:(0,p.pipe)(R.HV(t),f.map((function(e){return e.rev})),f.getOrElse((function(){return e})))}}},{key:"toJSON",value:function(){return{isEmpty:this.isEmpty,isStaging:this.isStaging,changes:this._changes.map((function(e){return N.isChange(e)?{kind:"change",prevLen:e.change.prevLen,changeDiff:e.change.length,changeAmount:e.change.amount}:e}))}}}]),e}();!function(e){e.fromRaw=function(e){return(0,c._)((0,l._)({},e),{suggestionsCard:(0,p.pipe)(f.fromNullable(e.suggestionsCard),f.map((function(e){return{title:e.title,miniTitle:f.fromNullable(e.miniTitle)}}))),successCard:(0,p.pipe)(f.fromNullable(e.successCard),f.map((function(e){return{title:e.title,miniTitle:f.fromNullable(e.miniTitle)}}))),defaultCard:(0,c._)((0,l._)({},e.defaultCard),{miniTitle:f.fromNullable(e.defaultCard.miniTitle),details:f.fromNullable(e.defaultCard.details)})})}}(B||(B={}));var D,L,U,j=i(78216);!function(e){e[e.DISCONNECTED=0]="DISCONNECTED",e[e.CONNECTING=1]="CONNECTING",e[e.CONNECTED=2]="CONNECTED",e[e.WAITING_FOR_OT=3]="WAITING_FOR_OT",e[e.WAITING_FOR_ACK=4]="WAITING_FOR_ACK",e[e.SESSION_INBOUND=5]="SESSION_INBOUND",e[e.ANY=6]="ANY",e[e.CLOSED=7]="CLOSED"}(D||(D={})),function(e){e[e.CONNECT=0]="CONNECT",e[e.CONNECTED=1]="CONNECTED",e[e.DISCONNECT=2]="DISCONNECT",e[e.WAIT=3]="WAIT",e[e.READY=4]="READY",e[e.SEND=5]="SEND",e[e.ACK=6]="ACK",e[e.CLOSE=7]="CLOSE"}(L||(L={})),function(e){e.getUnsafe=function(){return(0,p.flow)(p.unsafeCoerce,h.right)}}(U||(U={}));var V,$=function(e){if("string"==typeof e)return e;if("submit_ot"===e.action&&"deltasString"in e){var t=(0,c._)((0,l._)({},e),{deltasString:void 0,deltas:void 0}),i=JSON.stringify(t);return i.substring(0,i.length-1)+',"deltas": '.concat(e.deltasString,"}")}return JSON.stringify(e)},H=function(){function e(t,i,n,o){var d=t.context,_=void 0===d?void 0:d,b=t.dialect,y=void 0===b?"undefined":b,A=t.client,x=t.clientVersion,F=void 0===x?"":x,R=t.extDomain,K=void 0===R?void 0:R,M=t.sendDelay,O=void 0===M?50:M,B=t.docid,U=void 0===B?"":B,j=t.docIdIsTransient,$=void 0===j?void 0:j,H=t.clientSupports,G=void 0===H?[]:H,W=t.clientConfigs,z=void 0===W?void 0:W,q=t.isDemoDoc,Q=void 0!==q&&q,J=t.maxMessageSizeKb,Y=t.messagePaddingKb,X=t.startSessionOptions,ee=void 0===X?{}:X,te=t.idGenerator,ie=void 0===te?new C.C(T.to,0,!1):te,ne=t.shouldSendFeedback,se=void 0===ne?p.constTrue:ne,re=this;(0,r._)(this,e),(0,a._)(this,"_connectionOptions",void 0),(0,a._)(this,"_log",void 0),(0,a._)(this,"_fsm",void 0),(0,a._)(this,"_idGenerator",void 0),(0,a._)(this,"_shouldSendFeedback",void 0),(0,a._)(this,"_queueIdGenerator",void 0),(0,a._)(this,"_changesQueue",void 0),(0,a._)(this,"_conn",void 0),(0,a._)(this,"_timeout",void 0),(0,a._)(this,"_textSize",void 0),(0,a._)(this,"_handler",void 0),(0,a._)(this,"_context",void 0),(0,a._)(this,"_dialect",void 0),(0,a._)(this,"_client",void 0),(0,a._)(this,"_clientVersion",void 0),(0,a._)(this,"_extDomain",void 0),(0,a._)(this,"_sendDelay",void 0),(0,a._)(this,"_docid",void 0),(0,a._)(this,"_docIdIsTransient",void 0),(0,a._)(this,"_asyncChecksManager",void 0),(0,a._)(this,"_clientSupports",void 0),(0,a._)(this,"_clientConfigs",void 0),(0,a._)(this,"_isDemoDoc",void 0),(0,a._)(this,"_startSessionOptions",void 0),(0,a._)(this,"_reconnectInfo",void 0),(0,a._)(this,"_lastPublishedReconnectInfo",void 0),(0,a._)(this,"_cachedSessionUuid",void 0),(0,a._)(this,"_pingsMap",void 0),(0,a._)(this,"_validateAlert",void 0),(0,a._)(this,"_externalHandlers",void 0),(0,a._)(this,"_statsRequester",void 0),(0,a._)(this,"_synonymsRequester",void 0),(0,a._)(this,"_snippetsRequester",void 0),(0,a._)(this,"_getTextRequester",void 0),(0,a._)(this,"_commandsRequester",void 0),(0,a._)(this,"_externalCommandsRequester",void 0),(0,a._)(this,"_otChunksNotifier",void 0),(0,a._)(this,"resetReconnectInfo",void 0),(0,a._)(this,"reportLensFeedback",void 0),(0,a._)(this,"reportSystemFeedback",void 0),(0,a._)(this,"reportEmotionFeedback",void 0),(0,a._)(this,"reportWritingExpertFeedback",void 0),(0,a._)(this,"reportG2UxInteractionFeedback",void 0),(0,a._)(this,"reportEmotionSentenceFeedback",void 0),(0,a._)(this,"reportMuteFeedback",void 0),(0,a._)(this,"reportAutocorrectFeedback",void 0),(0,a._)(this,"reportAutocompleteFeedback",void 0),(0,a._)(this,"reportAutocompleteRejectedFeedback",void 0),(0,a._)(this,"reportSnippetFeedback",void 0),(0,a._)(this,"requestSynonyms",void 0),(0,a._)(this,"requestSnippets",void 0),(0,a._)(this,"shortenItSubmit",void 0),(0,a._)(this,"requestDocStats",void 0),(0,a._)(this,"enablePlagiarismSearch",void 0),(0,a._)(this,"disablePlagiarismSearch",void 0),(0,a._)(this,"enableWritingExpert",void 0),(0,a._)(this,"disableWritingExpert",void 0),(0,a._)(this,"realtimeProofitSubmit",void 0),(0,a._)(this,"realtimeProofitCancel",void 0),(0,a._)(this,"submitRecipients",void 0),(0,a._)(this,"submitScoreSurveyResult",void 0),(0,a._)(this,"submitSurvey",void 0),(0,a._)(this,"ping",void 0),(0,a._)(this,"canGoIdle",void 0),(0,a._)(this,"isStable",void 0),(0,a._)(this,"updateContextInfo",void 0),(0,a._)(this,"published",void 0),(0,a._)(this,"registerExternalMessageHandler",void 0),(0,a._)(this,"enqueueExternalCommand",void 0),(0,a._)(this,"_handleReconnectInfo",void 0),(0,a._)(this,"_setReconnectInfo",void 0),(0,a._)(this,"_setReconnecInfoForNewSession",void 0),(0,a._)(this,"_resetIdGenerators",void 0),(0,a._)(this,"_cleanupOldSession",void 0),(0,a._)(this,"_supportsReconnect",void 0),(0,a._)(this,"_initReconnection",void 0),(0,a._)(this,"_startSession",void 0),(0,a._)(this,"_handleNewSession",void 0),(0,a._)(this,"_handleExistingSession",void 0),(0,a._)(this,"_handleStart",void 0),(0,a._)(this,"_waitForSubmitOt",void 0),(0,a._)(this,"_sessionInbound",void 0),(0,a._)(this,"_canSend",void 0),(0,a._)(this,"_send",void 0),(0,a._)(this,"_processQueueMessage",void 0),(0,a._)(this,"_resetTimer",void 0),(0,a._)(this,"_onQueueMsgAccepted",void 0),(0,a._)(this,"_onQueueStateChanged",void 0),(0,a._)(this,"_onQueueMsgDropped",void 0),this._connectionOptions=o,this._log=m.Bx.Logging.getLogger("coreclients.capi",m.y7.$.TRACE),this._queueIdGenerator=new C.C(T.to,0,!1),this._textSize=0,this._asyncChecksManager=new Z,this._cachedSessionUuid=null,this._pingsMap=new Map,this._validateAlert=V.validate,this._externalHandlers=[],this._statsRequester=new w.Wo(15e3,"CAPI.DocStats"),this._synonymsRequester=new w.Wo(15e3,"CAPI.Synonyms"),this._snippetsRequester=new w.Wo(15e3,"CAPI.Snippets"),this._getTextRequester=new w.Wo(15e3,"CAPI.Text"),this._commandsRequester=new w.Wo(15e3,"CAPI.Commands"),this._externalCommandsRequester=new w.Wo(5e3,"CAPI.ExternalCommands"),this._otChunksNotifier=new w.gT(15e3,"CAPI.OT.Chunks"),this.resetReconnectInfo=function(){re._reconnectInfo=void 0,re._handleReconnectInfo()},this.reportLensFeedback=function(e,t){return re._sendInbandCommand({id:re._idGenerator.newId(),action:"feedback",type:t,lens:e},re._commandsRequester)},this.reportSystemFeedback=function(e){return re._sendInbandCommand({id:re._idGenerator.newId(),action:"feedback",type:e},re._commandsRequester)},this.reportEmotionFeedback=function(e,t,i){return re._sendInbandCommand({id:re._idGenerator.newId(),action:"feedback",type:t,emotion:e,subtype:i},re._commandsRequester)},this.reportWritingExpertFeedback=function(e,t){return re._sendInbandCommand({id:re._idGenerator.newId(),action:"feedback",type:e,weStage:t},re._commandsRequester)},this.reportG2UxInteractionFeedback=function(e,t,i){return re._sendInbandCommand({id:re._idGenerator.newId(),action:"feedback",type:e,userAction:i,vbarId:t},re._commandsRequester)},this.reportEmotionSentenceFeedback=function(e,t){return re._sendInbandCommand({id:re._idGenerator.newId(),action:"feedback",type:t,alertId:e},re._commandsRequester)},this.reportMuteFeedback=function(e,t,i){return re._sendInbandCommand({id:re._idGenerator.newId(),action:"feedback",type:i,userMuteScope:t,userMuteCategories:e},re._commandsRequester)},this.reportAutocorrectFeedback=function(e,t){return re._sendInbandCommand({id:re._idGenerator.newId(),action:"feedback",type:e,before:t.before,after:t.after,context:t.context,expected:t.expected},re._commandsRequester)},this.reportAutocompleteFeedback=function(e,t){return re._sendInbandCommand({id:re._idGenerator.newId(),action:"feedback",type:e,alertId:t.alertId,begin:t.begin,end:t.end,context:t.context,before:t.before,after:t.after,text:t.text,pname:t.pname},re._commandsRequester)},this.reportAutocompleteRejectedFeedback=function(e){return re._sendInbandCommand({id:re._idGenerator.newId(),action:"feedback",type:I.Sl.COMPLETION_REJECTED,alertId:e.alertId,begin:e.begin,end:e.end,context:e.context,before:e.before,after:e.after,text:e.text,pname:e.pname,subtype:e.subtype},re._commandsRequester)},this.reportSnippetFeedback=function(e,t){return re._sendInbandCommand({id:re._idGenerator.newId(),action:"feedback",type:e,snippetUuid:t},re._commandsRequester)},this.requestSynonyms=function(e,t){return re._sendInbandCommand({id:re._idGenerator.newId(),action:"synonyms",begin:e,token:t},re._synonymsRequester)},this.requestSnippets=function(e){return re._sendInbandCommand({id:re._idGenerator.newId(),action:"get_snippets_list",institutionId:e},re._snippetsRequester)},this.shortenItSubmit=function(e){return(0,p.pipe)(g.BK((function(){re._log.trace("shorten-it submit")})),g.cy((function(){return re._sendInbandCommand({id:re._idGenerator.newId(),action:"shorten_it_submit",alertId:e},re._commandsRequester)})))},this.requestDocStats=this._sendLazyInbandCommand((function(){return{id:re._idGenerator.newId(),action:"get_text_stats"}}),this._statsRequester),this.enablePlagiarismSearch=(0,p.pipe)(g.BK((function(){re._log.trace("Enable plagiarism search"),re._asyncChecksManager.resetCheck("plagiarism")})),g.cy((function(){return re._sendInbandCommand({id:re._idGenerator.newId(),action:"toggle_checks",checks:{plagiarism:!0}},re._commandsRequester)}))),this.disablePlagiarismSearch=this._sendLazyInbandCommand((function(){return{id:re._idGenerator.newId(),action:"toggle_checks",checks:{plagiarism:!1}}}),this._commandsRequester),this.enableWritingExpert=(0,p.pipe)(g.BK((function(){re._log.trace("Enable writing expert"),re._asyncChecksManager.resetCheck("writing_expert_check")})),g.cy((function(){return re._sendInbandCommand({id:re._idGenerator.newId(),action:"toggle_checks",checks:{writing_expert_check:!0}},re._commandsRequester)}))),this.disableWritingExpert=this._sendLazyInbandCommand((function(){return{id:re._idGenerator.newId(),action:"toggle_checks",checks:{writing_expert_check:!1}}}),this._commandsRequester),this.realtimeProofitSubmit=function(e){return re._log.trace("Submit real-time Proofit job"),re._sendInbandCommand({id:re._idGenerator.newId(),action:"realtime_proofit_submit",reconnect:e},re._commandsRequester)},this.realtimeProofitCancel=(0,p.pipe)(g.BK((function(){re._log.trace("Cancel real-time Proofit job")})),g.cy((function(){return re._sendInbandCommand({id:re._idGenerator.newId(),action:"realtime_proofit_cancel"},re._commandsRequester)}))),this.submitRecipients=function(e){return re._log.trace("Submit recipients for better suggestions!"),re._sendInbandCommand({id:re._idGenerator.newId(),action:"submit_recipients",recipients:e},re._commandsRequester)},this.submitScoreSurveyResult=function(e,t,i){return re._log.trace("Submit score survey result:",{placement:e,score:t,detailed_placement:i}),re._sendInbandCommand({id:re._idGenerator.newId(),action:"submit_survey_result",type:T.QB.Survey.Data.ScoreSurvey.type,placement:e,score:t,detailed_placement:i},re._commandsRequester)},this.submitSurvey=function(e){return re._log.trace("Submit survey result:",(0,l._)({},e)),re._sendInbandCommand((0,l._)({id:re._idGenerator.newId(),action:"submit_survey_result"},e),re._commandsRequester)},this.ping=this._sendLazyInbandCommand((function(){return{id:re._idGenerator.newId(),action:"ping"}}),this._commandsRequester),this.canGoIdle=function(){return re._changesQueue.isEmpty&&!re._changesQueue.isStaging},this.isStable=function(e){var t=void 0===e?re._idGenerator.id:re._idGenerator.id+1;return(void 0===e||"error"!==e.action)&&t>5},this.updateContextInfo=function(e){return re._log.trace("Update thread context info"),re._sendInbandCommand({id:re._idGenerator.newId(),action:"update_context_info",docContext:e},re._commandsRequester)},this.published=function(){return re._log.trace("Send published event"),re._sendInbandCommand({id:re._idGenerator.newId(),action:"published"},re._commandsRequester)},this.registerExternalMessageHandler=function(e){re._externalHandlers.push(e)};var oe=this;this.enqueueExternalCommand=function(e){return(0,s._)((function(){var t,i,n,s;return(0,u.YH)(this,(function(r){switch(r.label){case 0:return t=oe._connectionOptions.getSessionId(),oe._canSend()?[3,1]:[2,h.left(new w.Xb("Cannot send commands as WS connection is down"))];case 1:return f.isNone(t)?[2,h.left(new w.Xb("Unexpected empty sessionId, while WS connection is up"))]:[3,2];case 2:return i=oe._changesQueue.isEmpty,n=oe._changesQueue.pushExternalCommand(t.value,e),s=oe._externalCommandsRequester.watchRequest(n),i?(oe._log.trace("enqueueExternalCommand: Q.isEmpty, sending command immediately"),oe._send()):(oe._log.trace("enqueueExternalCommand: Q.notEmpty, delaying sending command"),oe._trySend(oe._fsm.current)),[4,s.then(h.map((function(){return n})))];case 3:return[2,r.sent()];case 4:return[2]}}))}))},this._handleReconnectInfo=function(){var e,t;!(null===(e=re._changesQueue)||void 0===e?void 0:e.isEmpty)||(null===(t=re._changesQueue)||void 0===t?void 0:t.isStaging)?void 0!==re._lastPublishedReconnectInfo&&(re._lastPublishedReconnectInfo=void 0,re._handler.onReconnectInfo({kind:"reconnect_info_updated"})):re._lastPublishedReconnectInfo!==re._reconnectInfo&&(re._handler.onReconnectInfo({kind:"reconnect_info_updated",reconnectInfo:re._reconnectInfo}),re._lastPublishedReconnectInfo=re._reconnectInfo)},this._setReconnectInfo=function(e){re._reconnectInfo=e,re._handleReconnectInfo()},this._setReconnecInfoForNewSession=function(){null!==re._cachedSessionUuid?re._setReconnectInfo({sessionUuid:re._cachedSessionUuid}):re.resetReconnectInfo()},this._resetIdGenerators=function(){re._idGenerator.reset(),re._queueIdGenerator.reset(),re._queueIdGenerator.newId()},this._cleanupOldSession=function(e){re._clear(e),re._commandsRequester.clear(e),re._externalCommandsRequester.clear(e),re._statsRequester.clear(e),re._synonymsRequester.clear(e),re._getTextRequester.clear(e)},this._supportsReconnect=function(){return re._clientSupports.includes(T.k9.reconnect)};var ae=this;this._initReconnection=(0,s._)((function(){var e,t;return(0,u.YH)(this,(function(i){switch(i.label){case 0:return ae._supportsReconnect()?[3,1]:(ae._resetIdGenerators(),null!==ae._cachedSessionUuid?[2,{sessionUuid:ae._cachedSessionUuid}]:[2,void 0]);case 1:return ae._reconnectInfo?[3,7]:null===ae._cachedSessionUuid?[3,2]:(ae._setReconnectInfo({sessionUuid:ae._cachedSessionUuid}),[3,6]);case 2:return"function"!=typeof ae._startSessionOptions?[3,4]:[4,ae._startSessionOptions()];case 3:return t=i.sent(),[3,5];case 4:t=ae._startSessionOptions,i.label=5;case 5:(e=t).reconnectInfo&&ae._setReconnectInfo(e.reconnectInfo),i.label=6;case 6:return ae._resetIdGenerators(),[3,8];case 7:ae._changesQueue.isEmpty&&!ae._changesQueue.isStaging||(ae._setReconnecInfoForNewSession(),ae._resetIdGenerators()),i.label=8;case 8:return[2,ae._reconnectInfo]}}))}));var le=this;this._startSession=(0,s._)((function(){var e,t,i,n;return(0,u.YH)(this,(function(s){switch(s.label){case 0:return le._log.trace("_startSession"),"function"!=typeof le._startSessionOptions?[3,2]:[4,le._startSessionOptions()];case 1:return t=s.sent(),[3,3];case 2:t=le._startSessionOptions,s.label=3;case 3:return e=t,[4,le._initReconnection()];case 4:return i=s.sent(),n=(0,l._)((0,c._)((0,l._)({id:le._idGenerator.newId(),action:"start",client:le._client.type,clientSubtype:le._client.sub,clientVersion:le._clientVersion,dialect:le._dialect,docid:le._docid,docIdIsTransient:le._docIdIsTransient,extDomain:le._extDomain,documentContext:le._context&&k.T0.serialize(le._context),clientSupports:le._clientSupports,isDemoDoc:le._isDemoDoc},null!==i?{reconnectInfo:i}:{}),{clientConfigs:le._clientConfigs}),e),[4,le._fsm.event(L.SEND)];case 5:return s.sent(),le._sendMessage(n),[2]}}))})),this._handleNewSession=function(e){void 0!==re._reconnectInfo&&re._log.debug("Exited old session: ".concat(re._reconnectInfo.sessionUuid)),re._log.debug("Starting new session: ".concat(e)),re._fsm.is(D.CONNECTED)&&(re._cleanupOldSession("new session"),re._fsm.event(L.WAIT)),re._setReconnectInfo({sessionUuid:e,messagesReceived:1,messagesSent:1})},this._handleExistingSession=function(e){re._log.debug("Continuing session: ".concat(e)),re._fsm.is(D.CONNECTED)?(re._fsm.event(L.READY),re._handler.onReady({kind:"ready"})):re._fsm.event(L.ACK)},this._handleStart=function(e){re._log.trace("_handleStart"),re._fsm.event(L.ACK);var t=e.userMutedCategories,i=e.allowedFeatures,n=e.domainCategory,s=e.domainName,r=e.isEnterprise,o=e.defaultDocumentContext,a=e.sessionUuid,l=e.reconnectedInfo,c=e.cheetahState,d=void 0===re._reconnectInfo||a!==re._reconnectInfo.sessionUuid;(null===re._cachedSessionUuid||re._supportsReconnect())&&(re._cachedSessionUuid=a),d?re._handleNewSession(a):re._handleExistingSession(a),re._handler.onSessionStarted({kind:"session_started",userMutedCategories:t,allowedFeatures:i,domainCategory:n,domainName:s,isEnterprise:r,cheetahState:c,defaultDocumentContext:(0,p.pipe)(o,f.fromNullable,f.chain(k.T0.parseDefault)),sessionUuid:a,reconnectedInfo:l,isNewSession:d,maxWsMessageSize:e.maxWsMessageSize})},this._waitForSubmitOt=function(){re._handler.onWaitForOT({kind:"wait_for_ot"})},this._sessionInbound=function(e){re._handler.onSessionInbound({kind:"session_inbound"}),re._trySend(e)},this._canSend=function(){return!re._fsm.is(D.DISCONNECTED,D.CONNECTING,D.CLOSED)};var ce=this;this._send=(0,s._)((function(){var e,t;return(0,u.YH)(this,(function(i){switch(i.label){case 0:return ce._resetTimer(),ce._fsm.is(D.SESSION_INBOUND)&&ce._changesQueue.hasCommitedChanges?[4,ce._fsm.event(L.SEND)]:[3,6];case 1:i.sent(),i.label=2;case 2:return i.trys.push([2,4,,5]),e=ce._changesQueue.poll(),[4,(0,p.pipe)(e,f.map((n=(0,s._)((function(e){var t;return(0,u.YH)(this,(function(i){switch(i.label){case 0:return t=N.isChange(e),[4,ce._sendMessage(ce._processQueueMessage(e))];case 1:return i.sent(),t?[3,3]:(ce._log.trace("message sent is not Change, firing CAPI FSM ACK immediately"),[4,ce._fsm.event(L.ACK)]);case 2:i.sent()?(ce._changesQueue.ackOperation(e.id),"externalCmd"===e.kind&&ce._externalCommandsRequester.onValue(e.id)):ce._log.debug("can not do ack for non change msg because we are in unexpected state",{state:D[ce._fsm.current]}),i.label=3;case 3:return[2]}}))})),function(e){return n.apply(this,arguments)})),f.getOrElse((function(){return Promise.resolve()})))];case 3:return i.sent(),[3,5];case 4:return t=i.sent(),ce._log.error("unexpected error on sending",t),[3,5];case 5:return[3,7];case 6:ce._trySend(ce._fsm.current),i.label=7;case 7:return[2]}var n}))})),this._processQueueMessage=function(e){return N.isChange(e)?re._processSubmitOTMessage(e):"externalCmd"===e.kind?e.cmd:"rev"in e.cmd?(0,c._)((0,l._)({},e.cmd),{rev:e.rev,id:e.id}):(0,c._)((0,l._)({},e.cmd),{id:e.id})},this._resetTimer=function(){void 0!==re._timeout&&(clearTimeout(re._timeout),re._timeout=void 0)},this._onQueueMsgAccepted=function(e){re._handler.onQueueMsgAccepted({kind:"queue_msg_accepted",message:e})},this._onQueueStateChanged=function(){re._handleReconnectInfo()},this._onQueueMsgDropped=function(e,t){e.filter(N.isCmd).forEach((function(e){var i=new w.zN("message dropped from queue:"+t);switch(e.cmd.action){case"ping":case"option":case"toggle_checks":case"set_context":case"feedback":re._commandsRequester.onError(e.id,i);break;case"get_text_stats":re._statsRequester.onError(e.id,i);break;case"synonyms":re._synonymsRequester.onError(e.id,i);break;case"get_debug_info":re._getTextRequester.onError(e.id,i)}})),re._handler.onQueueMsgDropped({kind:"queue_msgs_dropped",messages:e,reason:t})},this._handler=i,this._context=_,this._dialect=y,this._client=A,this._clientVersion=F,this._extDomain=K,this._sendDelay=O,this._docid=U,this._docIdIsTransient=$,this._clientSupports=G,this._clientConfigs=z,this._isDemoDoc=Q,this._startSessionOptions=ee,this._idGenerator=ie,this._shouldSendFeedback=se,this._changesQueue=new P(this._shouldHaveSeparateRevision,this._onQueueMsgAccepted,this._onQueueMsgDropped,this._onQueueStateChanged,(function(){return re._queueIdGenerator.newId()}),J,Y),this._fsm=new S.Z3("capi",D.DISCONNECTED,D.CLOSED).with(D.ANY).parentOf(D.CONNECTED,D.CONNECTING,D.DISCONNECTED,D.WAITING_FOR_OT,D.WAITING_FOR_ACK,D.SESSION_INBOUND).from(D.ANY).to(D.CLOSED).on(L.CLOSE).from(D.DISCONNECTED).to(D.CONNECTING).on(L.CONNECT).from(D.CONNECTING).to(D.CONNECTING).on(L.CONNECT).from(D.CONNECTING).to(D.CONNECTED).on(L.CONNECTED).from(D.CONNECTED,D.WAITING_FOR_OT,D.WAITING_FOR_ACK,D.SESSION_INBOUND,D.CONNECTING).to(D.DISCONNECTED).on(L.DISCONNECT).from(D.CONNECTED).to(D.WAITING_FOR_OT).on(L.WAIT).from(D.CONNECTED,D.WAITING_FOR_OT).to(D.SESSION_INBOUND).on(L.READY).from(D.SESSION_INBOUND).to(D.WAITING_FOR_ACK).on(L.SEND).from(D.WAITING_FOR_ACK).to(D.SESSION_INBOUND).on(L.ACK).on(D.CONNECTED,this._startSession).on(D.WAITING_FOR_OT,this._waitForSubmitOt).on(D.SESSION_INBOUND,(function(e){return re._sessionInbound(e.to)})),this._log.isEnabled(m.y7.$.TRACE)&&this._fsm.verbose(D,L),n.onConnecting((function(){return re._handleConnecting()})).onConnect((function(e){return re._handleConnect(e)})).onDisconnect((function(e){return re._handleDisconnect(e)})).onMessage((function(e,t){return re._handleMessage(t)})),(0,v.hJ)("closeCapiSocket",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3,t=arguments.length>1?arguments[1]:void 0;null!==re._conn&&re._conn._ws.close(e,t)})),(0,v.hJ)("capiState",this),(0,v.hJ)("capiReadyToReceive",(function(){return re._fsm.is(D.SESSION_INBOUND)&&re._changesQueue.isEmpty})),(0,v.hJ)("capiRuntimeError",(function(){var e=E.lY.ins(0,"test",100500);re.pushChanges(e)}))}return(0,o._)(e,[{key:"pushChanges",value:function(e){return this._pushChangesTask(e)}},{key:"checkingState",get:function(){return 0===this._checkedTextSize||1===this._textSize?"idle":this._checkedTextSize>I.$A&&this._textSize>I.$A/3?"full":"checking"}},{key:"asyncChecksState",get:function(){return this._asyncChecksManager.getState()}},{key:"setSessionOption",value:function(e){switch(e.kind){case I.XM.Context:return this.setContext(e.context);case I.XM.GnarContainerId:return this.setOption(e.kind,e.id);default:return(0,_.xb)(e)}}},{key:"setContext",value:function(e){return this._log.debug("setContext(...)"),this._context=e,this._sendInbandCommand({action:"set_context",id:this._idGenerator.newId(),rev:-1,documentContext:k.T0.serialize(e)},this._commandsRequester)}},{key:"setOption",value:function(e,t){return this._log.trace("Set option "+t),this._sendInbandCommand({id:this._idGenerator.newId(),action:"option",name:e,value:t},this._commandsRequester)}},{key:"sendUserAction",value:function(e,t){var i=this;return this._log.debug("sendUserAction",{componentId:e,userAction:t}),this._canSend()?(0,p.pipe)(this._connectionOptions.getSessionId(),h.fromOption((function(){return new Error("Can not sendUserAction because sessionId is empty")})),g.Mr,g.cy((function(n){return(0,p.pipe)(i._sendTrackedInbandCommand({id:i._idGenerator.newId(),action:"user_action",sessionId:n,componentId:e,userAction:t},i._commandsRequester),g.Tj(b.Up("queuedId")))}))):g.kb(new w.Xb("Can not sendUserAction because connection is down"))}},{key:"sendDebugReport",value:function(e,t){return this._log.debug("sendDebugReport",{componentId:e,errorMessage:t}),this._sendInbandCommand({id:this._idGenerator.newId(),action:"debug_report",type:"sdui_decode_error",componentId:e,errorMessage:t},this._commandsRequester)}},{key:"sendFeedback",value:function(e){if(this._log.debug("sendFeedback",e.kind),!this._shouldSendFeedback(e))return this._log.debug("Skip sending ".concat(e.kind," based on CAPI Client configured, see 'shouldSendFeedback'")),g.of(void 0);switch(e.kind){case I.yp.ACCEPTED:return this._sendAlertAcceptedFeedback(e);case I.yp.IGNORE:return this.reportIgnoreFeedback(e.id,e.reason,e.subtype,e.pnameQualifier,e.drilldownSuggestionIds);case I.yp.ACKNOWLEDGED:return this.reportAcknowledgeFeedback(e.id,e.subtype,e.text,e.pnameQualifier);case I.yp.ADD_TO_DICTIONARY:case I.yp.RENDERED:case I.yp.LOOKED:case I.yp.CLOSED:case I.yp.LIKE:case I.yp.DISLIKE:case I.yp.WRONG_SUGGESTION:case I.yp.OFFENSIVE_CONTENT:case I.yp.EXPANDED:case I.yp.IGNORE_BULK_ACCEPTED:case I.yp.HIDE:return this.reportAlertFeedback(e.id,e.kind,e.subtype);case I.yp.USER_SATISFACTION_FEEDBACK:return this.reportAlertSatisfactionFeedback(e.id,e.kind,e.userSatisfactionDescription,e.subtype);case I.ZI.DRILLDOWN:return this._reportDrilldownFeedback(e.id,e.alternativeIndex,e.drilldownSuggestionIds,e.subtype);case I.Fc.SYNONYM_ACCEPTED:return this.reportSynonymFeedback(e.id,e.kind,e.replacementText,e.subtype);case I.Fc.SYNONYM_DISMISSED:return this.reportSynonymFeedback(e.id,e.kind,e.subtype);case I.Zq.EMOTION_LIKE:case I.Zq.EMOTION_DISLIKE:case I.Zq.EMOTION_OFFENSIVE:return this.reportEmotionFeedback(e.emotionName,e.kind,e.subtype);case I.uG.EMOTION_SENTENCE_LIKE:case I.uG.EMOTION_SENTENCE_DISLIKE:return this.reportEmotionSentenceFeedback(e.id,e.kind);case I.DG.MUTE:case I.DG.UNMUTE:return this.reportMuteFeedback(e.userMuteCategories,e.userMuteScope,e.kind);case I.hN.RECHECK_SHOWN:return this.reportSystemFeedback(e.kind);case I.yj.LENS_CLOSE:case I.yj.LENS_OPEN:case I.yj.DISMISS_BY_LENS:return this.reportLensFeedback(e.lensName,e.kind);case I.t5.AUTOCORRECT_ACCEPT:case I.t5.AUTOCORRECT_DISMISS:case I.t5.AUTOCORRECT_REPLACE:return this.reportAutocorrectFeedback(e.kind,e);case I.Sl.COMPLETION_REJECTED:return this.reportAutocompleteRejectedFeedback(e);case I.Sl.COMPLETION_ACCEPTED:case I.Sl.COMPLETION_IGNORED:case I.Sl.COMPLETION_SHOWN:return this.reportAutocompleteFeedback(e.kind,e);case I.l.BULK_ACCEPTED:return this.reportAlertsBatchFeedback(e.alertIds,e.kind,e.subtype);case I.ch.SNIPPET_ACCEPTED:return this.reportSnippetFeedback(e.kind,e.snippetUuid);case I.mq.ASSISTANT_OPENED:return this._reportAssistantFeedback(e.kind);case I.rP.AUTOAPPLY_TRIGGERED:case I.rP.AUTOAPPLY_LOOKED:case I.rP.AUTOAPPLY_REVERTED:case I.rP.AUTOAPPLY_ACCEPT:case I.rP.AUTOAPPLY_AFFECTED_BY_TEXTCHANGE:return this._reportAutoapplyFeedback(e.alertId,e.kind,e.subtype);case I.Sm.WritingExpert:return this.reportWritingExpertFeedback(e.kind,e.weStage);case I.lH.G2_UI:return this.reportG2UxInteractionFeedback(e.kind,e.vbarId,e.userAction);default:return(0,_.xb)(e)}}},{key:"requestWritingExpert",value:function(){return this._sendInbandCommand({id:this._idGenerator.newId(),correlationId:"QWEQWEQWE",action:"disposable_cheetah:invokeCommand",generationMode:"rewrite",textScope:{start:0,end:100},command:{kind:"predefinedAction",actionIdentifier:{kind:"label",value:"Improve it"}}},this._commandsRequester)}},{key:"triggerTouchTypist",value:function(e){return this._sendInbandCommand(e,this._commandsRequester)}},{key:"_reportDrilldownFeedback",value:function(e,t,i,n){return this._sendInbandCommand({id:this._idGenerator.newId(),action:"feedback",type:I.ZI.DRILLDOWN,alertId:e,alternativeIndex:t,drilldownSuggestionIds:i,subtype:n},this._commandsRequester)}},{key:"_reportAssistantFeedback",value:function(e){return this._sendInbandCommand({id:this._idGenerator.newId(),action:"feedback",type:e},this._commandsRequester)}},{key:"_sendAlertAcceptedFeedback",value:function(e){return"replacementText"in e?this._reportTextAlertAcceptedFeedback(e.id,e.replacementText,e.subtype,e.reason,e.gbPrompt):"alternativeIndex"in e?this._reportTransformJsonAlertAcceptedFeedback(e.id,e.alternativeIndex,e.gapValue,e.subtype,e.drilldownSuggestionIds,e.dismissedTransformGroups,e.reason,e.gbPrompt):(0,_.xb)(e)}},{key:"reportIgnoreFeedback",value:function(e,t,i,n,s){return this._sendInbandCommand({id:this._idGenerator.newId(),action:"feedback",type:I.yp.IGNORE,alertId:e,userReason:t,subtype:i,pnameQualifier:n,drilldownSuggestionIds:s},this._commandsRequester)}},{key:"reportAcknowledgeFeedback",value:function(e,t,i,n){return this._sendInbandCommand({id:this._idGenerator.newId(),action:"feedback",type:I.yp.ACKNOWLEDGED,alertId:e,subtype:t,pnameQualifier:n,text:i},this._commandsRequester)}},{key:"reportAlertFeedback",value:function(e,t,i){return this._sendInbandCommand({id:this._idGenerator.newId(),action:"feedback",type:t,alertId:e,subtype:i},this._commandsRequester)}},{key:"reportAlertSatisfactionFeedback",value:function(e,t,i,n){return this._sendInbandCommand({id:this._idGenerator.newId(),action:"feedback",type:t,alertId:e,userSatisfactionDescription:i,subtype:n},this._commandsRequester)}},{key:"reportAlertsBatchFeedback",value:function(e,t,i){return this._sendInbandCommand({id:this._idGenerator.newId(),action:"feedback",type:t,alertIds:e,subtype:i},this._commandsRequester)}},{key:"_reportTextAlertAcceptedFeedback",value:function(e,t,i,n,s){return this._sendInbandCommand({id:this._idGenerator.newId(),action:"feedback",type:I.yp.ACCEPTED,alertId:e,text:t,subtype:i,userReason:n,gbPrompt:s},this._commandsRequester)}},{key:"_reportTransformJsonAlertAcceptedFeedback",value:function(e,t,i,n,s,r,o,a){return this._sendInbandCommand({id:this._idGenerator.newId(),action:"feedback",type:I.yp.ACCEPTED,alertId:e,alternativeIndex:t,gapValue:i,subtype:n,drilldownSuggestionIds:s,dismissedTransformGroups:r,userReason:o,gbPrompt:a},this._commandsRequester)}},{key:"reportSynonymFeedback",value:function(e,t,i,n){switch(t){case I.Fc.SYNONYM_ACCEPTED:var s={id:this._idGenerator.newId(),action:"feedback",type:I.Fc.SYNONYM_ACCEPTED,text:i,alertId:e,subtype:n};return this._sendInbandCommand(s,this._commandsRequester);case I.Fc.SYNONYM_DISMISSED:return this._sendInbandCommand({id:this._idGenerator.newId(),action:"feedback",type:I.Fc.SYNONYM_DISMISSED,alertId:e,subtype:n},this._commandsRequester);default:return(0,_.xb)(t)}}},{key:"_reportAutoapplyFeedback",value:function(e,t,i){return this._sendInbandCommand({id:this._idGenerator.newId(),action:"feedback",type:t,alertId:e,subtype:i},this._commandsRequester)}},{key:"isClosed",value:function(){return this._fsm.is(D.CLOSED)}},{key:"close",value:function(e){var t=this;return(0,s._)((function(){return(0,u.YH)(this,(function(i){switch(i.label){case 0:return t.isClosed()?(t._log.trace("close: CAPI already closed, skipping"),[2]):(t._log.trace("close: closing CAPI"),[4,t._fsm.event(L.CLOSE,e)]);case 1:return i.sent()?t._clear(e):t._log.error("Cannot go to CLOSED state"),[2]}}))}))()}},{key:"getText",value:function(){return y.hq(this._sendInbandCommand({id:this._idGenerator.newId(),action:"get_debug_info"},this._getTextRequester))}},{key:"_handleConnecting",value:function(){var e=this;return(0,s._)((function(){return(0,u.YH)(this,(function(t){switch(t.label){case 0:return[4,e._fsm.event(L.CONNECT)];case 1:return t.sent()||e._log.error("Can not enter CONNECTING state",{fsmState:D[e._fsm.current]}),[2]}}))}))()}},{key:"_handleConnect",value:function(e){var t=this;return(0,s._)((function(){var i,n;return(0,u.YH)(this,(function(s){switch(s.label){case 0:t._log.trace("_handleConnect(".concat(D[t._fsm.current],"): received new ws connection")),t._conn=e,i=void 0,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,t._fsm.event(L.CONNECTED)];case 2:return s.sent()||(i="failed to switch to CONNECTED state"),[3,4];case 3:return n=s.sent(),i=n,[3,4];case 4:if(Boolean(i))throw t._log.warn("Connection cannot be finalized.",i),i;return[2]}}))}))()}},{key:"_handleDisconnect",value:function(e){var t=this;return(0,s._)((function(){var i,n;return(0,u.YH)(this,(function(s){switch(s.label){case 0:return t._log.trace("_handleDisconnect(".concat(D[t._fsm.current],")"),e),[4,t._fsm.event(L.DISCONNECT,e.reason)];case 1:return i=s.sent(),n=t._fsm.is(D.CLOSED)?m.y7.$.WARN:m.y7.$.ERROR,i||t._log.log(n,"Can not enter DISCONNECTED state",{reason:e,fsmState:D[t._fsm.current]}),[2]}}))}))()}},{key:"_handleMessage",value:function(e){var t,i,n=null===(i=this._clientConfigs)||void 0===i||null===(t=i.sdui)||void 0===t?void 0:t.config;if(void 0!==this._reconnectInfo){var s,r=null!==(s=this._reconnectInfo.messagesReceived)&&void 0!==s?s:0;this._setReconnectInfo((0,c._)((0,l._)({},this._reconnectInfo),{messagesReceived:r+1}))}if(this._handler.onMessageReceived({kind:"message_received",message:e}),this._log.isEnabled(m.y7.$.TRACE)&&this._log.trace("Message <<< "+JSON.stringify(e).replace("\n"," ").substring(0,300)),this._externalHandlers.some((function(t){return t(e)===A.Q.Result.STOP_HANDLING})))this._log.trace("Message was handled by external handler",e.action);else switch(e.action){case"start":this._handleStart(e);break;case"alert":this._handleAlert(e);break;case"remove":this._handler.onRemove({kind:"alert_removed",alertId:I.tI.Id.create(e.id),hint:(0,p.pipe)(f.fromNullable(e.hint),f.filter((function(e){return e===x.QN.NotFixed}))),mergedIn:(0,p.pipe)(f.fromNullable(e.mergedIn),f.map((function(e){return I.tI.Id.create(e)})))});break;case"alert_changes":this._handleAlertChange(e);break;case"finished":this._handleFinish(e);break;case"async_check_finished":this._handleAsyncCheckFinished(e);break;case"async_check_progress":this._handleAsyncCheckProgress(e);break;case"complete":this._handleComplete(e);break;case"heatmap":this._handleAttentionHeatmap(e);break;case"attention_widget":this._handleAttentionInfo(e);break;case"submit_ot":this._handleSubmitOtAck(e);break;case"submit_ot_chunk":this._handleSubmitOtChunkAck(e);break;case"feedback":case"option":case"toggle_checks":case"set_context":case"submit_recipients":case"user_action":case"debug_report":case"shorten_it_submit":case"update_context_info":case"submit_survey_result":this._handleCommandAck(e);break;case"perfstats":this._handleAck(e);break;case"error":this._handleError(e);break;case"pong":this._handlePong(e);break;case"synonyms":this._handleSynonyms(e);break;case"get_snippets_list_response":this._handleSnippets(e);break;case"text_stats":this._handleTextStats(e);break;case"text_maps":this._handleTextMaps(e);break;case"text_info":this._handleTextInfo(e);break;case"emotions":this._handleEmotions(e);break;case"debug_info":this._handler.onDebugInfo({kind:"debug_info",info:e}),this._getTextRequester.onValue(e.id,e.text);break;case"realtime_proofit_availability":this._handleProofitAvailability(e);break;case"realtime_proofit_submit_resp":this._handleProofitSubmit(e);break;case"realtime_proofit_progress":this._handleProofitProgress(e);break;case"realtime_proofit_cancel_resp":this._handleProofitCancelled(e);break;case"shorten_it_finished":this._handleShortenItFinished(e);break;case"published":this._handlePublishedAck(e);break;case"sdui:add":var o,a,d,u;null!=(null===(a=n)||void 0===a||null===(o=a[e.viewId])||void 0===o?void 0:o.dslParser)?this._handleSDUIAdd(e,null===(u=n)||void 0===u||null===(d=u[e.viewId])||void 0===d?void 0:d.dslParser):this._handleUnexpectedSDUIMessage(e);break;case"sdui:update":var h,g,v,b;null!=(null===(g=n)||void 0===g||null===(h=g[e.viewId])||void 0===h?void 0:h.dslParser)?this._handleSDUIUpdate(e,null===(b=n)||void 0===b||null===(v=b[e.viewId])||void 0===v?void 0:v.dslParser):this._handleUnexpectedSDUIMessage(e);break;case"sdui:remove":var y,k;null!=(null===(k=n)||void 0===k||null===(y=k[e.viewId])||void 0===y?void 0:y.dslParser)?this._handleSDUIRemove(e):this._handleUnexpectedSDUIMessage(e);break;case"gb_rule_created":this._handler.onGbRuleCreated({kind:"gb_rule_created",categoryTitle:e.categoryTitle,styleGuideId:e.styleGuideId,descriptionLength:e.descriptionLength});break;case"show_survey":this._handleShowSurvey(e);break;case"g_debug_event":this._log.debug("g_debug_event",{message:e});break;case"trigger_touch_typist":this._handleTouchTypistTriggerResponse(e);break;default:this._log.error("Unknown message",{message:e}),(0,_.xb)(e)}}},{key:"_handleAlert",value:function(e){var t=this;this._handler.beforeAlert({kind:"before_alert"});var i=I.tI.fromAlertMessage(e);this._log.trace("_handleAlert",e.id);var n=this._changesQueue.transformAlertAgainstQueue(i);(0,p.pipe)(n,h.fromOption((function(){return new Error("alert ".concat(i.id," position overlap: ").concat(JSON.stringify(i).substring(0,200)))})),h.chain(this._validateAlert),h.fold((function(e){t._log.isEnabled(m.y7.$.TRACE)&&t._log.trace("OT ALERT: discarding alert due to error",e)}),(function(e){t._handler.onAlert({kind:"alert_received",alert:e})})))}},{key:"_handleAlertChange",value:function(e){return(0,p.pipe)({kind:"alert_changed",alertId:I.tI.Id.create(e.id),rev:e.rev,extraProperties:e.extra_properties&&I.tI.parseExtraProperties(e.extra_properties),transformJson:e.transformJson&&I.EK.toAbs(e.transformJson),muted:e.muted},this._changesQueue.transformChangeAgainstQueue,f.fold(p.constVoid,this._handler.onChange))}},{key:"_handleComplete",value:function(e){this._handler.onAutoComplete({kind:"autocomplete_received",complete:e})}},{key:"_handleAttentionHeatmap",value:function(e){var t=I.J5.fromAttentionHeatmapMessage(e);this._handler.onAttentionHeatmap({kind:"attention_heatmap_received",heatmap:this._changesQueue.transformAttentionHeatmapAgainstQueue(t)})}},{key:"_handleAttentionInfo",value:function(e){var t;2===e.version?this._handler.onAttentionInfo({kind:"attention_info_received",rev:e.rev,wordsCount:e.wordsCount,checklist:e.checklist.map(B.fromRaw),headerMessage:e.headerMessage,predictionMessage:e.predictionMessage,hidden:null!==(t=e.hidden)&&void 0!==t&&t}):this._log.error("Got an unsupported attention_widget message version",e)}},{key:"_handleTextMaps",value:function(e){var t={score:e.score,generalScore:e.generalScore,textMaps:e.textMaps};this._handler.onTextMaps({kind:"text_maps",data:t})}},{key:"_handleTextInfo",value:function(e){var t={wordsCount:e.wordsCount,charsCount:e.charsCount-1,readingTime:j.R.calculateReadingTime(e.wordsCount),speakingTime:j.R.calculateSpeakingTime(e.wordsCount),readabilityScore:e.readabilityScore,messages:f.fromNullable(e.messages),sessionStats:e.sessionStats};this._handler.onTextInfo({kind:"text_info",data:t})}},{key:"_handleEmotions",value:function(e){this._handler.onEmotions({kind:"emotions",emotions:e.emotions,institutionLogo:e.institutionLogo,brandTonesEnabled:e.brandTonesEnabled,brandTonesConfigured:e.brandTonesConfigured,hidden:e.hidden})}},{key:"_handleProofitAvailability",value:function(e){this._handler.onProofitAvailability({id:e.id,kind:"realtime_proofit_availability",available:e.available,quota:e.quota})}},{key:"_handleProofitSubmit",value:function(e){this._handler.onProofitSubmit({id:e.id,kind:"realtime_proofit_submit_resp",status:e.status})}},{key:"_handleProofitProgress",value:function(e){"in_progress"===e.status?this._handler.onProofitProgress((0,l._)({kind:"realtime_proofit_in_progress"},e)):"completed"===e.status?this._handler.onProofitCompleted((0,l._)({kind:"realtime_proofit_completed"},e)):"error"===e.status?this._handler.onProofitProgressProblem((0,l._)({kind:"realtime_proofit_progress_error"},e)):"rejected"===e.status&&this._handler.onProofitProgressProblem((0,l._)({kind:"realtime_proofit_progress_rejected"},e))}},{key:"_handleProofitCancelled",value:function(e){this._handler.onProofitCancelled({id:e.id,kind:"realtime_proofit_cancel_resp",refunded:e.refunded,quota:e.quota})}},{key:"_handleShortenItFinished",value:function(e){this._handler.onShortenItFinished({kind:"shorten_it_finished",alertId:I.tI.Id.create(e.alertId)})}},{key:"_handlePublishedAck",value:function(e){this._handleCommandAck(e),this._handler.onPublishedAck({kind:"published_ack",survey:e.survey})}},{key:"_handleShowSurvey",value:function(e){this._handler.onShowSurvey({kind:"show_survey",survey:e.survey})}},{key:"_handleFinish",value:function(e){this._log.trace("_handleFinish"),this._handler.onBeforeFinish({kind:"before_finish"}),this._changesQueue.ackRevision(e.rev);var t=this._createFinishEvent(e);this._handler.onFinish(t)}},{key:"_handleAsyncCheckProgress",value:function(e){this._handler.onAsyncCheckProgress({kind:"async_check_progress",check:e.check,revision:e.rev,progress:e.progress})}},{key:"_handleAsyncCheckFinished",value:function(e){this._handler.onBeforeAsyncCheckFinish({kind:"before_async_check_finish"}),this._asyncChecksManager.finish(e),this._handler.onAsyncCheckFinish({kind:"async_check_finished",check:e.check,revision:e.rev,outcomeScores:e.outcomeScores})}},{key:"_handleSubmitOtAck",value:function(e){this._log.trace("<<< Acknowledge for "+e.action,{message:e}),this._fsm.is(D.WAITING_FOR_ACK)?(this._handleAck(e),this._changesQueue.ackOperation(e.id),this._fsm.event(L.ACK)):this._log.error("Got an unexpected submit_ot ack",{curentState:D[this._fsm.current]})}},{key:"_sendNextOtChunk",value:function(e){var t=this;if(0===e.chunks.length){this._log.trace("no more chunks, sending final submit_ot message");var i=this;return g.TX((0,s._)((function(){return(0,u.YH)(this,(function(t){switch(t.label){case 0:return[4,i._sendMessage(e.submitOt)];case 1:return[2,t.sent()]}}))})),(function(e){return new Error("failed to send final submit_ot message: ".concat(e))}))}this._log.trace("sending next submit_ot chunk");var n=this;return(0,p.pipe)(g.TX((0,s._)((function(){var t;return(0,u.YH)(this,(function(i){switch(i.label){case 0:return t=e.chunks.splice(0,1)[0],[4,n._sendMessage(t)];case 1:return i.sent(),[2,t]}}))})),(function(e){return new Error("failed to send next chunk message: ".concat(e))})),g.cy((function(i){return t._waitForOtChunkAck(i,e)})))}},{key:"_waitForOtChunkAck",value:function(e,t){var i=this;return(0,p.pipe)(this._otChunksNotifier.waitFor(e.id,t),g.cy(this._sendNextOtChunk.bind(this)),g.qE((function(e){return i._log.error("failed sending OT chunks",e),e})))}},{key:"_handleSubmitOtChunkAck",value:function(e){this._log.trace("<<< Acknowledge for "+e.action,{message:e}),this._otChunksNotifier.notify(e.id)}},{key:"_handleCommandAck",value:function(e){this._log.trace("<<< Acknowledge for "+e.action,{message:e}),this._commandsRequester.onValue(e.id),this._handleAck(e)}},{key:"_handleAck",value:function(e){(0,p.pipe)(G(e,this._asyncChecksManager),f.fold(p.constNull,this._handler.onAck))}},{key:"_handlePong",value:function(e){var t=window.performance.now();this._handler.onPong({kind:"pong",latency:(0,p.pipe)(f.fromNullable(this._pingsMap.get(e.id)),f.map((function(e){return t-e})))})}},{key:"_handleSynonyms",value:function(e){var t=this._parseSynonymsResult(e);this._handler.onSynonyms({kind:"synonyms",synonyms:t,word:e.token,position:e.synonyms.pos}),this._synonymsRequester.onValue(e.id,t)}},{key:"_handleTouchTypistTriggerResponse",value:function(e){this._handler.onTouchTypistTriggerResponse((0,l._)({kind:"trigger_touch_typist"},e))}},{key:"_handleSnippets",value:function(e){this._handler.onSnippets({kind:"get_snippets_list_response",snippets:e}),this._snippetsRequester.onValue(e.id,e)}},{key:"_handleTextStats",value:function(e){e.readingTime=j.R.calculateReadingTime(e.words),e.speakingTime=j.R.calculateSpeakingTime(e.words),this._handler.onStats({kind:"stats",stats:e}),this._statsRequester.onValue(e.id,e)}},{key:"_handleSDUIAdd",value:function(e,t){var i=this;(0,p.pipe)(this._toSduiIdDslSchemaTuple(e,t),f.map((function(t){var n=(0,d._)(t,2),s=n[0],r=n[1];return i._handler.onSDUI({kind:"sdui_add",sdui:r,sduiRootId:s,rev:e.rev})})))}},{key:"_handleSDUIRemove",value:function(e){this._handler.onSDUI({kind:"sdui_remove",sduiRootId:I.dV.Id.create(e.sduiRootId)})}},{key:"_handleSDUIUpdate",value:function(e,t){var i=this;(0,p.pipe)(this._toSduiIdDslSchemaTuple(e,t),f.map((function(t){var n=(0,d._)(t,2),s=n[0],r=n[1];return i._handler.onSDUI({kind:"sdui_update",sdui:r,sduiRootId:s,rev:e.rev})})))}},{key:"_handleUnexpectedSDUIMessage",value:function(e){var t;(null===(t=this._clientConfigs)||void 0===t?void 0:t.sdui)?this._log.error("skip ".concat(e.id," due to not configured dslParser.")):this.sendDebugReport(String(e.id),"got unexpected sdui message without sending sduiConfig")()}},{key:"_toSduiIdDslSchemaTuple",value:function(e,t){var i=e.sdui,n=e.rev,s=e.id,r=e.sduiRootId,o=this,a=I.dV.Id.create(r);return void 0===i?(this.sendDebugReport(String(s),"got unexpected empty sdui content for ".concat(n))(),this._log.error("skip ".concat(s," due to empty sdui content"),{messageId:s,rev:n}),f.none):(0,p.pipe)(t(i),h.fold((function(e){return o.sendDebugReport(String(s),e.message)(),o._log.error("skip ".concat(s," due to incorrect sdui content"),{messageId:s,message:e.message,rawSdui:i,rev:n}),f.none}),(function(e){return f.some([a,e])})))}},{key:"_createFinishEvent",value:function(e){return{kind:"finish",revision:e.rev,score:(0,p.pipe)(f.fromNullable(e.generalScore),f.filter((function(e){return e>=0})),f.map((function(t){return{errorRateScore:e.score,rank:t}}))),lowestScore:(0,p.pipe)(f.fromNullable(e.lowestGeneralScore),f.filter((function(e){return e>=0})),f.map((function(t){return{errorRateScore:e.score,rank:t}}))),scoreStatus:f.fromNullable(e.scoresStatus),removed:new Set(e.removed),dialect:e.dialect,outcomeScores:T.QB.OutcomeScores.normalize(e.outcomeScores),foreign:e.foreign}}},{key:"_parseSynonymsResult",value:function(e){var t=this,i=function(e){return e.derived};return{id:e.id.toString(),originalWord:e.token,synonymsOrGroups:function(e){return 0===e.synonyms.meanings.length?f.none:1===e.synonyms.meanings.length?f.some(h.left(e.synonyms.meanings[0].synonyms.map(i))):f.some(h.right(e.synonyms.meanings.map((function(n){return void 0===n.meaning&&t._log.warn("Absent meaning in synonyms group.",{token:e.token}),{meaning:Boolean(n.meaning)?n.meaning:"",words:n.synonyms.map(i)}}))))}(e),pname:e.synonyms.pname}}},{key:"_trySend",value:function(e){void 0===this._timeout&&e===D.SESSION_INBOUND?this._timeout=window.setTimeout(this._send,this._sendDelay):e!==D.WAITING_FOR_OT||this._changesQueue.isEmpty?this._log.trace("_trySend(".concat(D[e],") send timeout already set or not waiting for ot, ignoring")):(this._log.trace("_trySend(".concat(D[e],") moving to READY")),this._fsm.event(L.READY),this._handler.onReady({kind:"ready"}))}},{key:"_shouldHaveSeparateRevision",value:function(e){return"set_context"===e.action}},{key:"_pushChangesTask",value:function(e){var t=this;this._log.debug("pushChanges(".concat(D[this._fsm.current],"):"),JSON.stringify(e));var i,n=this,r=(i=(0,s._)((function(){var t;return(0,u.YH)(this,(function(i){switch(i.label){case 0:n._log.debug("pushChanges(".concat(D[n._fsm.current],"): starting new session")),i.label=1;case 1:return i.trys.push([1,3,,4]),n.resetReconnectInfo(),n._resetIdGenerators(),n._cleanupOldSession("new session started by pushing RESET state"),[4,n._startSession()];case 2:return i.sent(),[2,n._pushChanges(e)];case 3:return t=i.sent(),n._log.warn("pushChanges(".concat(D[n._fsm.current],"): failed sending start message: "),t),[2,h.left(t)];case 4:return[2]}}))})),function(){return i.apply(this,arguments)});return E.lY.isReset(e)&&this._fsm.is(D.SESSION_INBOUND,D.WAITING_FOR_ACK)?(this._log.debug("pushChanges(".concat(D[this._fsm.current],"): got reset while active session, starting new session")),r):y.uC((function(){return t._pushChanges(e)}))}},{key:"_pushChanges",value:function(e){var t=this;if(!this._canSend())return this._log.debug("pushChanges: cannot send, rejecting changes",e.kind),h.left(new w.Xb("Cannot accepts changes as WS connection is down"));var i=function(e){t._asyncChecksManager.stage(t._changesQueue.localRevision);var i=t._changesQueue.pushChanges(e);return t._textSize=e.prevLen+e.length,t._trySend(t._fsm.current),h.right(f.some(i))};return E.lY.isDelta(e)?this._fsm.is(D.WAITING_FOR_OT)?h.left(new w.r1("Capi is waiting for reset change but got a delta, dropping change")):i(e):E.lY.isReset(e)?i(E.lY.delta(e.delta)):(this._changesQueue.isEmpty||this.ping(),h.right(f.none))}},{key:"_sendInbandCommand",value:function(e,t){return this._sendLazyInbandCommand((function(){return e}),t)}},{key:"_sendTrackedInbandCommand",value:function(e,t){return this._sendLazyTrackedInbandCommand((function(){return e}),t)}},{key:"_sendLazyInbandCommand",value:function(e,t){return(0,p.pipe)(this._sendLazyTrackedInbandCommand(e,t),g.Tj(b.Up("result")))}},{key:"_sendLazyTrackedInbandCommand",value:function(e,t){var i=this;return function(){var n=e();if(i._log.trace("_sendInbandCommand(".concat(D[i._fsm.current],"): "),n.action),i._canSend()){var s=i._changesQueue.isEmpty,r=i._changesQueue.pushCommand(n),o=t.watchRequest(r);return s?(i._log.trace("_sendInbandCommand: Q.isEmpty, sending command immediately"),i._send()):(i._log.trace("_sendInbandCommand: Q.notEmpty, delaying sending command"),i._trySend(i._fsm.current)),o.then(h.map((function(e){return{result:e,queuedId:r}})))}return i._log.debug("_sendInbandCommand: cannot send, rejecting command",n.action),Promise.resolve(h.left(new w.Xb("Cannot send commands as WS connection is down")))}}},{key:"_processSubmitOTMessage",value:function(e){if(N.isChunkedChange(e)){var t=e.chunks.map((function(e){return{id:e.id,action:"submit_ot_chunk",chunk:e.chunk}})),i=t.splice(0,1)[0],n={chunks:t,submitOt:{id:e.id,action:"submit_ot",rev:e.rev,doc_len:e.change.prevLen,chunked:!0}};return this._waitForOtChunkAck(i,n)(),i}return{id:e.id,action:"submit_ot",rev:e.rev,doc_len:e.change.prevLen,deltas:[e.change.delta],deltasString:e.deltasString,chunked:!1}}},{key:"_sendMessage",value:function(e){var t=this;return this._log.isEnabled(m.y7.$.TRACE)&&this._log.trace("Sending >>>> ".concat(e.action,", id: ").concat(e.id)),this._handler.onMessageSent({kind:"message_sent",message:e}),"ping"===e.action&&this._pingsMap.set(e.id,window.performance.now()),(0,_.Y0)(this._conn,"_sendMessage should never be called without a connection").send(e).catch((function(e){return t._log.debug("fail on send",e)})).then((function(){if(void 0!==t._reconnectInfo){var e,i=null!==(e=t._reconnectInfo.messagesSent)&&void 0!==e?e:0;t._setReconnectInfo((0,c._)((0,l._)({},t._reconnectInfo),{messagesSent:i+1}))}}))}},{key:"_checkedTextSize",get:function(){return this._changesQueue.stagedAmount}},{key:"_clear",value:function(e){this._log.debug("clearing message queue, reason: "+e),this._pingsMap.clear(),this._changesQueue.isEmpty||this._log.warn("clean queue with messages",{reason:e,queue:this._changesQueue.toJSON()}),this._changesQueue.clear(e),this._externalCommandsRequester.clear(e),this._asyncChecksManager.reset(),this._resetTimer()}},{key:"_handleError",value:function(e){var t=this;return(0,s._)((function(){return(0,u.YH)(this,(function(i){switch(e.error){case I.O4.CANNOT_GET_TEXT_STATS:t._statsRequester.onError(e.id,new Error("Server Error"));break;case I.O4.CANNOT_FIND_SYNONYM:t._synonymsRequester.onError(e.id,new Error("can not find synonym"));break;case I.O4.RUNTIME_ERROR:t._fsm.is(D.WAITING_FOR_ACK)?(t._log.error("Got runtime_error for submit_ot",{message:e}),t._clear("runtime_error on submit_ot")):(t._handler.onError((0,l._)({kind:"error"},e)),t._clear("runtime_error"));break;default:t._handler.onError((0,l._)({kind:"error"},e)),t._log.error("Error",{message:e})}return[2]}))}))()}}]),e}(),Z=function(){function e(){(0,r._)(this,e),(0,a._)(this,"_pendingRevision",void 0),(0,a._)(this,"_finishedRevisions",void 0),(0,a._)(this,"_wasChecked",{plagiarism:!1,ai_detector:!1,writing_expert_check:!1}),(0,a._)(this,"_toggleChecksRequests",new Map),this.reset()}return(0,o._)(e,[{key:"getCheckState",value:function(e){return this._pendingRevision>this._finishedRevisions[e]?this._wasChecked[e]?"checking":"full":"idle"}},{key:"getState",value:function(){return{plagiarism:this.getCheckState("plagiarism"),ai_detector:this.getCheckState("ai_detector"),writing_expert_check:this.getCheckState("writing_expert_check")}}},{key:"stage",value:function(e){this._pendingRevision=Math.max(this._pendingRevision,e)}},{key:"finish",value:function(e){this._finishedRevisions[e.check]=Math.max(this._finishedRevisions[e.check],e.rev),this._wasChecked[e.check]=!0}},{key:"reset",value:function(){this._pendingRevision=0,this._finishedRevisions={plagiarism:-1,ai_detector:-1,writing_expert_check:-1}}},{key:"resetCheck",value:function(e){this._finishedRevisions[e]=-1}},{key:"pushChecksByMessageId",value:function(e,t){this._toggleChecksRequests.set(e,t)}},{key:"popChecksByMessageId",value:function(e){var t=this._toggleChecksRequests.get(e)||{};return this._toggleChecksRequests.delete(e),t}}]),e}(),G=function(e,t){switch(e.action){case"option":return f.some({kind:"option_ack"});case"set_context":case"submit_ot":return f.some({kind:"set_context_ack",revision:e.rev});case"submit_recipients":return f.some({kind:"submit_recipients_ack"});case"toggle_checks":return f.some({kind:"toggle_checks_ack",checks:t.popChecksByMessageId(e.id)});case"feedback":return f.some({kind:"feedback_ack",outcomeScores:e.scores?T.QB.OutcomeScores.normalize(e.scores):void 0,scoreStatus:e.scoresStatus});case"published":return f.some({kind:"published_ack",survey:e.survey});case"submit_survey_result":return f.some({kind:"submit_survey_result_ack"});case"submit_ot_chunk":case"shorten_it_submit":case"perfstats":case"user_action":case"debug_report":case"update_context_info":return f.none;default:return(0,_.xb)(e)}};!function(e){e.validate=function(e){var t=e.extra_properties.drilldownTree;return void 0===t?h.right(e):(0,p.pipe)(e,h.fromPredicate(I.tI.withTransformJson,(function(){return i("no transformJSON")})),h.chain((function(e){var t=e.transformJson.alternatives;return(0,p.pipe)(t,h.fromOption((function(){return i("no alternatives")})))})),h.chain((function(s){var r=s.alternatives;return t.length>0&&n(r)(t)?h.right(e):h.left(i("incomplete tree"))})));function i(t){return new Error("Incorrect drilldownTree: ".concat(JSON.stringify(e.extra_properties.drilldownTree)," - ").concat(t))}function n(e){return function(t){return t.every((function(t){var i=(0,d._)(t,2),s=i[0],r=i[1];return void 0!==e[s]&&(!!I.cq.isLeaf(r)||n(e)(r))}))}}}}(V||(V={}))},93910:(e,t,i)=>{i.d(t,{Mk:()=>h});var n=i(19147),s=i(6922),r=i(23988),o=i(10334),a=i(17171),l=i(19224),c=i(60575),d=i(58526),u=function(){function e(t,i){(0,n._)(this,e),(0,r._)(this,"_innerCon",void 0),(0,r._)(this,"_addTimer",void 0),this._innerCon=t,this._addTimer=i}return(0,s._)(e,[{key:"send",value:function(e){return this._innerCon.send(this._addTimer(e))}},{key:"close",value:function(e){return this._innerCon.close(e)}},{key:"_ws",get:function(){return this._innerCon._ws}},{key:"state",get:function(){return this._innerCon.state}}]),e}(),p=function(){return Math.trunc(window.performance.now())};function m(e,t){return new d.O2(e,t)}var h=function(){function e(t,i){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:p,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:l.A,d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:m,h=this;(0,n._)(this,e),(0,r._)(this,"_innerWs",void 0),(0,r._)(this,"_idGenerator",void 0),(0,r._)(this,"_bufferSize",void 0),(0,r._)(this,"_clientClock",void 0),(0,r._)(this,"_timerIdGenerator",void 0),(0,r._)(this,"_defaultConnection",void 0),(0,r._)(this,"_log",void 0),(0,r._)(this,"_timers",void 0),(0,r._)(this,"_connection",void 0),this._innerWs=t,this._idGenerator=i,this._bufferSize=s,this._clientClock=o,this._timerIdGenerator=a,this._defaultConnection=d,this._log=c.Bx.Logging.getLogger("coreclients.capi.latencyMeasuringWSHandler"),this._timers=[],this._connection=null,this._innerWs=t.onDisconnect((function(){h._timers=[]})).onMessage((function(e,t){h._processTimerResponse(t)})).withConnection((function(e,t){return new u(h._defaultConnection(e,t),(function(e){return h._addTimerToRequest(e)}))})).onConnect((function(e){h._connection=e}))}return(0,s._)(e,[{key:"onConnecting",value:function(e){return this._innerWs.onConnecting(e),this}},{key:"onConnect",value:function(e){return this._innerWs.onConnect(e),this}},{key:"onDisconnect",value:function(e){return this._innerWs.onDisconnect(e),this}},{key:"onMessage",value:function(e){return this._innerWs.onMessage(e),this}},{key:"connect",value:function(e){return this._innerWs.connect(e)}},{key:"isDisconnected",value:function(){return this._innerWs.isDisconnected()}},{key:"_addTimerToRequest",value:function(e){if("string"==typeof e)return e;switch(e.action){case"ping":case"submit_ot":return(0,a._)((0,o._)({},e),{timer:{client_clock:this._clientClock(),id:this._timerIdGenerator()}});default:return e}}},{key:"_processTimerResponse",value:function(e){var t=this;switch(e.action){case"pong":case"finished":return void(e.timer&&(this._timers.push({id:e.timer.id,name:e.timer.name,client_clock:this._clientClock()}),this._timers.length>=this._bufferSize&&setTimeout((function(){return t._flush()}),0)));default:return}}},{key:"_flush",value:function(){this._timers.length>0&&(null===this._connection?this._log.warn("tried flushing when not connected"):(this._connection.send({id:this._idGenerator.newId(),action:"perfstats",timers:this._timers}),this._timers=[]))}}]),e}()},78044:(e,t,i)=>{i.d(t,{C:()=>a});var n=i(19147),s=i(6922),r=i(23988),o=i(86562),a=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(0,n._)(this,e),(0,r._)(this,"_capacity",void 0),(0,r._)(this,"_start",void 0),(0,r._)(this,"_allowOverflow",void 0),(0,r._)(this,"_nextId",void 0),this._capacity=t,this._start=i,this._allowOverflow=s,this._nextId=i}return(0,s._)(e,[{key:"id",get:function(){return this._nextId}},{key:"newId",value:function(){var e=this._nextId;if(e>this._capacity){if(!this._allowOverflow)throw new o.zU("ids limit reached: "+this._capacity);this._nextId=e=0}return this._nextId++,e}},{key:"reset",value:function(){this._nextId=this._start}}]),e}()},76099:(e,t,i)=>{i.d(t,{D:()=>n});var n,s=i(10334),r=i(17171),o=i(50659),a=i(87574),l=i(19840),c=i(11864);!function(e){e.Top=e=>o.createElement(t,(0,r._)((0,s._)({},e),{where:"top"})),e.Bottom=e=>o.createElement(t,(0,r._)((0,s._)({},e),{where:"bottom"}));const t=e=>o.createElement(a.F.div,(0,r._)((0,s._)({onTransitionEnd:e.onTransitionEnd},(0,l.Ly)(e.className,"top"===e.where?d.fixedTop:d.fixedBottom)),{"aria-label":e["aria-label"],role:e.role}),e.children)}(n||(n={}));const d=c.Ks.stylesheet({fixedTop:[{position:"fixed",top:0,height:0}],fixedBottom:[{position:"fixed",bottom:0}]})},46013:(e,t,i)=>{i.d(t,{h:()=>Ue});var n=i(98383),s=i(78429),r=i(23988),o=i(84647),a=i(60575),l=i(86562),c=i(65390),d=i(58193);class u{constructor(){(0,r._)(this,"_log",a.Bx.Logging.getLogger("AlertManager.repository",a.y7.$.DEBUG)),(0,r._)(this,"_allAlerts",new Map),(0,r._)(this,"_capiAlertsIdMapping",new Map),(0,r._)(this,"add",(e=>{this._allAlerts.set(e.id,e)})),(0,r._)(this,"remove",(e=>{this._log.trace("AllAlerts: Clean alert from all alerts",e.toLiteString()),(0,l.V1)(0===e.references,"can not dispose alert in use",(()=>e.toString())),(0,l.V1)(!1===e.isValid,"can not dispose valid alert",(()=>e.toString())),(0,l.V1)(this._allAlerts.delete(e.id),"alert should exist in alerts list",(()=>e.toString())),e.dispose()})),(0,r._)(this,"addToCapiMapping",(e=>{e.isValid||(0,o.pipe)(e.rawId,c.fold((()=>this._log.debug("skip register of local alert in capi mapping",e)),(t=>{this._log.trace("register alert in capi mapping",e.toLiteString()),(0,l.V1)(void 0===this._capiAlertsIdMapping.get(t),"unexpected overlap of rawid alert",(()=>e.toString())),e.validate(),this._capiAlertsIdMapping.set(t,e.id)})))})),(0,r._)(this,"removeFromCapiMapping",(e=>{e.isValid&&((0,o.pipe)(e.rawId,d.Mi((t=>{this._log.trace("clean valid alert capi mapping for: "+e.toLiteString()),(0,l.V1)(this._capiAlertsIdMapping.delete(t),"valid alert should had valid raw id",(()=>e.toString()))}))),e.invalidate())})),(0,r._)(this,"getByAlertId",(e=>c.fromNullable(this._allAlerts.get(e)))),(0,r._)(this,"getByRawAlertId",(e=>(0,o.pipe)(c.fromNullable(this._capiAlertsIdMapping.get(e)),c.chain(this.getByAlertId)))),(0,r._)(this,"swapRaw",((e,t)=>{const i=(0,o.pipe)(e.rawId,c.exists((e=>this._capiAlertsIdMapping.has(e)))),n=(0,o.pipe)(e.rawId,c.exists((e=>this._capiAlertsIdMapping.has(e))));(0,l.V1)(i||n,"At least one of the swapped alerts should be registered in the system");const s=e._raw;e.silentPatchWithRawAlert(t._raw),t.silentPatchWithRawAlert(s),i&&this._capiAlertsIdMapping.set(d.$v(e.rawId),e.id),n&&this._capiAlertsIdMapping.set(d.$v(t.rawId),t.id)})),(0,r._)(this,"toArray",(()=>Array.from(this._allAlerts.values()))),(0,r._)(this,"toMap",(()=>this._allAlerts)),(0,r._)(this,"toJSON",(()=>({allAlerts:Array.from(this._allAlerts.entries()),idMapping:Array.from(this._capiAlertsIdMapping.entries())})))}}var p,m=i(10334),h=i(17171),g=i(65011),f=i(80074),v=i(66799),_=i(38832),b=i(54463),y=i(36840),k=i(66202),S=i(55172),C=i(96719),E=i(60608),w=i(42543),A=i(15491),I=i(78339),x=i(19657),T=i(95168),F=i(11298),R=i(12884),K=i(89769),M=i(68533),O=i(36094),N=i(82718),B=i(60269),P=i(24946),D=i(62822),L=i(41139),U=i(22809),j=i(91612),V=i(44277),$=i(59042),H=i(30186),Z=i(30396),G=i(53987),W=i(41949);!function(e){var t=e.group=W.fn.group;function i(e){return i=>(0,o.pipe)(e,$.b.foldMap(t)(s,r,n),(0,H.c)(t.concat)(i))}e.eq=W.fn.eq,e.applyDiff=i,e.fromAlerts=function(e){const t=a.Bx.Logging.getLogger("DocumentCounters");return e.pipe(Z.S(((e,t)=>({alerts:t,counters:i(U.A.Diff.toRegistered(U.A.diff(e.alerts,t)))(e.counters)})),{alerts:U.A.empty,counters:W.fn.group.empty}),T.M((({counters:e})=>{W.fn.isValid(e)||t.error("Counters can not be below zero",W.fn.show.show(e))})),A.T((({counters:e})=>e)))};const n=e=>G.K.toUnmutedOnly(e.counters),s=(0,o.flow)(n,t.inverse),r=(e,i)=>t.concat(n(i),s(e))}(p||(p={}));var z,q=i(45819),Q=i(82094),J=i(80993),Y=i(36916),X=i(74416),ee=i(62597);!function(e){function t(e){const{left:t,right:i}=(0,o.pipe)(e,Q.x1(c.fromNullable),Q.LV((e=>"GeneralScore"!==e)),Q.rO(((e,t)=>{return{lensId:(i=e,i===ee.J.SpecialId.Plagiarism?k.right(ee.J.SpecialId.Plagiarism):ee.J.OutcomeId.toOutcomeId(i)),score:X.w.fromNumber(t)};var i})),Q.rT((0,q.Jq)(k.either))),n=(0,o.pipe)(i,Q.Tj((({lensId:e,score:t})=>(0,o.tuple)(e,t))),(e=>new Map(Object.values(e))));return(0,o.pipe)(Y.T7(c.fromPredicate((0,o.not)(Q.Im))(t),c.fromPredicate((0,o.not)(J.Im))(n)),c.getOrElse((()=>Y.pG(new Map))))}e.empty=new Map,e.eq=J.nZ(ee.J.Id.ord,X.w.ord),e.fromCapi=function(e){return e.pipe(I.p((0,y.Ub)(b.om.is("finish"),(0,y.M4)(b.om.is("async_check_finished"),b.zE.is("plagiarism")),b.om.is("feedback_ack"))),A.T((e=>e.outcomeScores)),I.p(y.O9),A.T(t),T.M(Y.qE((e=>{Q.Im(e)||a.Bx.Logging.getLogger("LensesScores").error("failed to parse capi scores",e)}))),I.p((0,y.Ub)(Y.ES,Y.FG)),A.T((e=>e.right)))}}(z||(z={}));var te=i(889),ie=i(84011),ne=i(85982),se=i(49004),re=i(28986),oe=i(91242),ae=i(77396),le=i(38886),ce=i(13110),de=i(40711),ue=i(88761),pe=i(38260),me=i(88105),he=i(63967);const ge=(0,y.Bj)(a.Bx.Logging.getLogger),fe=(0,o.flow)(pe.Tj((({beingAppliedAlert:e,undo:t,reversedAlternative:i})=>ne.TX((()=>{const n={action:v.yp.ACCEPTED,commit:()=>ge("AlertManager.ops").debug(`_applyTransformJson(${e.toLiteString()}):commit()`),undo:t,reversedAlternative:e.registerReversedAlternative(i)},s=e.switchToApplied(n),r=he.vs.create(s.state.from,ue.Y.create(e));return[s.id,r]}),k.toError))),ne.ED);function ve(e){const t=_.EF.compose(e.alternatives.map(g.Tj((e=>e.alternative))),e.currentFullText);return(0,o.pipe)(me.E.nonEmpty(t.composedDelta)?c.some(t):c.none,c.map((({composedDelta:t,reversedAlternatives:i})=>({changeWithFormatting:(0,o.pipe)(t,de.N.getEnrichedWithFormattingDelta(e.currentFullText),(t=>se.lY.delta(t,e.originalTextLength))),correctRevAlternatives:(0,o.pipe)(i,C.s.tapFailure((({rejected:e})=>a.Bx.Logging.getLogger("AlertManager.ops").error("failed to generate reverse alternative",e))),C.s.foldSuccess(le.Tj((t=>({reversedAlternative:t.reversedAlternative,alternative:g.Es(e.alternatives[t.alternativeIndex]),alert:e.alerts[t.alternativeIndex].alert})))))}))))}var _e;function be(e,t,i){return k.fromPredicate(e,(e=>{const n=new l.zU(t,e.toString());return a.Bx.Logging.getLogger("AlertManager.ops").error(t,{error:n,extra:i}),n}))}!function(e){const t=(0,o.flow)(((e,t)=>k.tryCatch((()=>he.vs.create(e,t)),k.toError)),k.map((e=>(0,o.tuple)(e[0].id,e))),ie.of);e.prepare=ie.cy((0,o.tupled)(t)),e.prepareFromAlert=ne.cy((e=>t(e.state.from,ue.Y.create(e))))}(_e||(_e={}));const ye=(e,t)=>be(he.Fc.isNotDisposed,e,t);function ke(e){return ne.cy(c.fold((0,o.constant)(ne.pG(void 0)),e))}var Se,Ce,Ee,we,Ae,Ie;!function(e){e.mock={undoApplied:()=>ne.pG(void 0)}}(Se||(Se={}));class xe{_applyFeedbackToAlert(e,t,i,n){return ne.TX((()=>{this._alertsRepo.removeFromCapiMapping(e);const s=this._createFeedbackUndoable(e,t,n);return e.changeState(he.Fc.State.Applied.create(s,i,he.Fc.State.Applied.Method.ByCard,ue.Y.create(e)))}),k.toError)}_createFeedbackUndoable(e,t,i){return{action:t,replacement:e.replaceText,commit:i,undo:()=>this._alertsRepo.addToCapiMapping(e)}}_commitFeedbackToCapi(e,t){return(0,o.pipe)(e.rawId,c.fold((0,o.constant)((()=>this._log.debug("skip feedback for local alert",e))),(e=>this._sendFeedback((0,m._)({id:e},t)))))}_sendFeedback(e){return()=>{ae.hq(this._capiClient.sendFeedback(e)).catch(this._handleCapiError("alert feedback"))}}_commitShortenItSubmitToCapi(e){return(0,o.pipe)(e.rawId,c.fold((0,o.constant)((()=>this._log.debug("skip shorten-it-submit for local alert",e))),(e=>this._shortenItSubmit(e))))}_shortenItSubmit(e){return()=>{ae.hq(this._capiClient.shortenItSubmit(e)).catch(this._handleCapiError("shorten-it-submit"))}}_switchToBeingApplied(e,t,i){return ne.TX((()=>(this._alertsRepo.removeFromCapiMapping(e),e.switchToBeingAppliedState(t,i))),k.toError)}constructor(e,t,i,n){(0,r._)(this,"_positionManager",void 0),(0,r._)(this,"_getContent",void 0),(0,r._)(this,"_capiClient",void 0),(0,r._)(this,"_alertsRepo",void 0),(0,r._)(this,"_log",void 0),(0,r._)(this,"_sendUpdate",void 0),(0,r._)(this,"_sendSingleUpdate",void 0),(0,r._)(this,"_flushChanges",void 0),(0,r._)(this,"changes",void 0),(0,r._)(this,"events",void 0),(0,r._)(this,"undoApplied",void 0),(0,r._)(this,"_dismissBatch",void 0),(0,r._)(this,"_applyAlert",void 0),(0,r._)(this,"_applyTransformJson",void 0),(0,r._)(this,"_alertFeedback",void 0),(0,r._)(this,"_alertBatchFeedback",void 0),(0,r._)(this,"_notifyAlertUpdated",void 0),(0,r._)(this,"_releaseRef",void 0),(0,r._)(this,"_changeMuteState",void 0),(0,r._)(this,"_changeGapValue",void 0),(0,r._)(this,"_confirmApplied",void 0),(0,r._)(this,"_changeTakeawayFeedback",void 0),(0,r._)(this,"_shortenItSummaryNotFound",void 0),(0,r._)(this,"_commitShortenItSummaryRequest",void 0),(0,r._)(this,"_dismissShortenItTransformGroup",void 0),(0,r._)(this,"_changeToneAIToneAlternative",void 0),(0,r._)(this,"_handleCapiError",void 0),(0,r._)(this,"_applyAlertData",void 0),(0,r._)(this,"_sendApplyFeedback",void 0),(0,r._)(this,"_sendApplyTextFeedback",void 0),(0,r._)(this,"_sendApplyTransformJsonFeedback",void 0),this._positionManager=e,this._getContent=t,this._capiClient=i,this._alertsRepo=n,this._log=a.Bx.Logging.getLogger("AlertManager.ops"),this._sendUpdate=e=>ne.TX((()=>this.events.next({updated:new Map(e)})),k.toError),this._sendSingleUpdate=ne.cy((e=>this._sendUpdate([e]))),this._flushChanges=ne.TX((()=>this.changes.next(se.lY.flush())),k.toError),this.changes=new w.B7,this.events=new w.B7,this.undoApplied=(e,t)=>{return(0,o.pipe)((()=>this._positionManager.getTextLength()),ie.cy((t=>{const n={alertsToUpdate:[],reversedDelta:new re.R,undo:o.constVoid},s=e.filter(he.Fc.isApplied).reduce(((e,t)=>{const n=t.state.undoable;return he.Do.isWithAlternative(n)?(0,o.pipe)(n.reversedAlternative,c.fold((()=>{v.tI.withTransformJson(t._raw)&&this._log.error("No reversed delta registered for alert",{alert:t.toLiteString()}),i(e,t)}),(0,o.flow)((e=>e()),k.map((e=>e.delta)),k.fold((e=>{this._log.error("Could not retrieve reversed delta",{e,alert:t.toLiteString()})}),(n=>{i(e,t),(0,o.pipe)(n,_.EF.fromRawDelta,(t=>t.rebase(e.reversedDelta)),c.fold((()=>{e.reversedDelta=e.reversedDelta.compose(n)}),(({delta:t})=>{e.reversedDelta=e.reversedDelta.compose(t)})))}))))):i(e,t),e}),n);return s.alertsToUpdate.length>0?(0,o.pipe)(ne.TX((()=>{const e=(0,o.pipe)(s.reversedDelta,de.N.getEnrichedWithFormattingDelta(this._getContent()));this.changes.next(se.lY.delta(e,t))}),k.toError),ne.oW(this._flushChanges),ne.oW((0,o.pipe)(s.undo,ie.Tj(k.right))),ne.g$((0,o.pipe)(s.alertsToUpdate,ne.ED,ne.cy(this._sendUpdate)))):ne.pG(void 0)})));function i(e,i){e.undo=(0,o.flow)(e.undo,i.state.undoable.undo),e.alertsToUpdate.push(_e.prepare((()=>[ue.Y.create(i),ue.Y.create(i.changeState(t===he.Fc.State.Applied.Method.ByCard?he.Fc.State.init:he.Fc.State.Removed.create(he.Fc.State.Removed.Reason.bulkAcceptUserResponse)))])))}},this._dismissBatch=(e,t)=>(0,o.pipe)(this._flushChanges,ne.g$((0,o.pipe)(e,le.Tj((0,o.flow)(ie.of,ie.Tj(ye("_dismissBatch: Cannot send feedback for already disposed",t)),ne.cy((e=>this._applyFeedbackToAlert(e,v.yp.IGNORE,he.Kz.sidebar,this._commitFeedbackToCapi(e,{kind:v.yp.IGNORE,subtype:t})))),_e.prepareFromAlert)),ne.ED,ne.cy(this._sendUpdate)))),this._applyAlert=({alert:e,replacementText:t,source:i,method:n,feedbackSubtype:s,reason:r,gbPrompt:a})=>(0,o.pipe)(e,be(he.Fc.isRegistered,"can not apply alert in non registered state"),ie.of,ne.oW(this._flushChanges),ne.cy((e=>this._switchToBeingApplied(e,i,n))),ne.cy((({beingAppliedAlert:e,undo:i})=>(0,o.pipe)(e.getReplaceEither.bind(e),ne.wg,ne.wu((()=>new Error("Cannot apply alert with tJSON")),(n=>{this._log.debug(`_applyAlert(${e.toLiteString()}, rrange: ${n})`);const o=n.start,l=n.end-n.start,c=(new re.R).retain(o).delete(t.length).insert(e.replaceText);return{alert:e,undo:i,reverseDelta:c,replacementText:t,removeLen:l,feedbackSubtype:s,pos:o,reason:r,gbPrompt:a}}))))),ne.cy(this._applyAlertData)),this._applyTransformJson=({alerts:e,source:t,method:i,feedbackSubtype:n,drilldownSuggestionIds:s,reason:r,gbPrompt:a})=>(0,o.pipe)(this._flushChanges,ne.g$((0,o.pipe)(e,ne.bm((e=>(0,o.pipe)(e.alternative,ne.Tj((t=>(0,o.tuple)(t,function(e){switch(e._raw.point){case"AllCapsBoldification":return _.UA.fromAlternativeBoldified;case"Lists":return _.UA.fromAlternativeListified;default:return _.UA.fromAlternative}}(e.alert))))))))),ne.cy((t=>ne.TX((()=>({alternatives:t,alerts:e,originalTextLength:this._positionManager.getTextLength(),currentFullText:this._getContent()})),k.toError))),ne.Tj(ve),ke((e=>(0,o.pipe)(e.correctRevAlternatives,le.Tj((({alert:e,alternative:l,reversedAlternative:c})=>(0,o.pipe)(this._switchToBeingApplied(e,t,i),ne.W6((e=>ne.BK(this._sendApplyTransformJsonFeedback(e.beingAppliedAlert,l.alternativeIndex,n,s,r,a)))),ne.Tj((e=>(0,h._)((0,m._)({},e),{reversedAlternative:c})))))),ne.ED,ne.cy((t=>(0,o.pipe)(ne.TX((()=>this.changes.next(e.changeWithFormatting)),k.toError),ne.oW(this._flushChanges),ie.g$((0,o.pipe)(fe(t),ne.cy(this._sendUpdate)))))))))),this._alertFeedback=(e,t,i)=>{this._log.debug(`_alertFeedback(${e.toLiteString()}, feedbackType: ${t.kind}, source: ${i})`),he.Fc.isHidden(e)&&this._log.error("Sending feedback for a hidden alert",{alert:e,feedbackType:t.kind});const n=this._commitFeedbackToCapi(e,t);return(0,o.pipe)(e,ye("_alertFeedback: Cannot send feedback for already disposed",t),ie.of,ne.cy((e=>t.kind!==v.yp.LOOKED||e.isRead?v.MW.willRemoveAlert(t.kind)?(0,o.pipe)(this._flushChanges,ne.g$(this._applyFeedbackToAlert(e,t.kind,i,n)),_e.prepareFromAlert,this._sendSingleUpdate):(0,o.pipe)(n,ne.BK):(0,o.pipe)(_e.prepare((()=>[ue.Y.create(e),(e.isRead=!0,ue.Y.create(e))])),this._sendSingleUpdate,ie.oW(n)))))},this._alertBatchFeedback=(e,t,i)=>(0,o.pipe)(e,le.x1((e=>e.rawId)),ce.ci,c.fold((0,o.constant)(o.constVoid),(e=>this._sendFeedback({kind:t,alertIds:e,subtype:i})))),this._notifyAlertUpdated=(0,o.flow)((e=>[[e[0].id,e]]),this._sendUpdate),this._releaseRef=(e,t)=>(0,o.pipe)(ne.TX((()=>{this._log.debug(`_releaseRef ${e} on (${t.toLiteString()}) refs: ${t._refNames}`,{shouldBeRemoved:he.Fc.shouldBeRemoved(t)}),he.Fc.shouldBeRemoved(t)&&this.events.next({removed:new Map([[t.id,ue.Y.create(t)]])})}),k.toError)),this._changeMuteState=(e,t)=>{const i=(0,o.pipe)(e,C.s.fromArray((0,o.flow)(ye("_changeMuteState: Cannot send Mute feedback for already disposed",t),k.chain(be((e=>c.isSome(e.muteCategory)||he.Fc.belongsToAnySpecialCategory(e)),"Alert is not muting")))));return(0,o.pipe)(i,C.s.foldSuccess(le.Tj((e=>_e.prepare((()=>[ue.Y.create(e),(e.mute=t,ue.Y.create(e))]))))),ne.ED,ne.Tj(ce.ci),ke(this._sendUpdate),ne.Tj((0,o.constant)(i)))},this._changeGapValue=(e,t)=>(0,o.pipe)(e,be(he.Fc.isOneGap,"can not change gap value for a non one gap alert"),ie.of,ne.cy((e=>_e.prepare((()=>[ue.Y.create(e),ue.Y.create(e.changeGapValue(t))])))),this._sendSingleUpdate),this._confirmApplied=(0,o.flow)(le.Tj((e=>_e.prepare((()=>[ue.Y.create(e),ue.Y.create(e.changeState(he.Fc.State.Removed.create(he.Fc.State.Removed.Reason.bulkAcceptUserResponse)))])))),ne.ED,ne.cy(this._sendUpdate)),this._changeTakeawayFeedback=(e,t)=>(0,o.pipe)(e,be(he.Fc.isTakeaway,"can not change feedback for non-takeaway alert"),ie.of,ne.cy((e=>{const i=ue.Y.create(e),n=e.setFeedback(t),s=ue.Y.create(n);return(0,o.pipe)(_e.prepare((()=>[i,s])),this._sendSingleUpdate,ne.Tj((()=>n)))}))),this._shortenItSummaryNotFound=e=>(0,o.pipe)(e,ye("_shortenItSummaryNotFound: Cannot change state to not-found for already disposed"),k.chain(be(he.Fc.isShortenIt,"cannot change state to not-found for a non shorten-it alert")),ie.of,ne.cy((e=>{const t=ue.Y.create(e),i=e.changeSummaryState("notFound"),n=ue.Y.create(i);return(0,o.pipe)(_e.prepare((()=>[t,n])),this._sendSingleUpdate,ne.Tj((()=>i)))}))),this._commitShortenItSummaryRequest=e=>(0,o.pipe)(e,ye("_commitShortenItSummaryRequest: Cannot send shorten_it_submit message for already disposed"),k.chain(be(he.Fc.isShortenIt,"cannot send shorten_it_submit for a non shorten-it alert")),ie.of,ne.cy((e=>{const t=ue.Y.create(e),i=e.changeSummaryState("requestSent"),n=ue.Y.create(i);return(0,o.pipe)(_e.prepare((()=>[t,n])),this._sendSingleUpdate,ne.Tj((()=>i)),ie.oW(this._commitShortenItSubmitToCapi(e)))}))),this._dismissShortenItTransformGroup=(e,t)=>(0,o.pipe)(e,ye("_dismissShortenItTransformGroup: Cannot dismiss transform group for already disposed",t),k.chain(be(he.Fc.isShortenIt,"cannot dismiss transform group for a non shorten-it alert")),ie.of,ne.cy((e=>{const i=ue.Y.create(e),n=e.dismissTransformGroup(t),s=ue.Y.create(n);return(0,o.pipe)(_e.prepare((()=>[i,s])),this._sendSingleUpdate,ne.Tj((()=>n)))}))),this._changeToneAIToneAlternative=(e,t)=>(0,o.pipe)(e,be(he.Fc.isToneAI,"Cannot change tone for a non-ToneAI alert."),ie.of,ne.cy((e=>ne.TX((()=>{const i=[(0,o.tuple)(e.id,he.vs.create(ue.Y.create(e),ue.Y.create(e.setSelectedToneAlternativeIdx(t))))];return this.events.next({updated:new Map(i)}),e}),k.toError)))),this._handleCapiError=e=>t=>{oe.zN.isDroppedError(t)?this._log.debug(`Stopped listening for ${e} message acknowledge`,t):oe.Xb.isNotConnectedError(t)?this._log.warn(`Failed to send ${e} as CAPI was not connected`,t):this._log.error(`Failed to send ${e}`,t)},this._applyAlertData=({pos:e,removeLen:t,reverseDelta:i,undo:n,replacementText:s,alert:r,feedbackSubtype:a,reason:l,gbPrompt:d})=>(0,o.pipe)(ne.TX((()=>{let o=this._positionManager.getTextLength(),u=!1;const p={action:v.yp.ACCEPTED,replacement:s,commit:()=>{u||this._log.debug(`_applyAlert(${r.toLiteString()}):commit()`)},reversedAlternative:c.none,undo:()=>{u=!0,this._log.debug(`_applyAlert(${r.toLiteString()}):undo()`);const e=this._positionManager.getTextLength();e!==o&&this._log.error(`Text has changed while uncommitted apply is present. Expected: ${o}, actual: ${e}`);const t=se.lY.delta(i,e);this.changes.next(t),this.changes.next(se.lY.flush()),n()}};return this._sendApplyTextFeedback(r,s,a,l,d)(),this.changes.next(se.lY.delta((new re.R).retain(e).delete(t).insert(s),o)),this.changes.next(se.lY.flush()),o=this._positionManager.getTextLength(),p}),k.toError),ne.cy((e=>ne.TX((()=>r.switchToApplied(e)),k.toError))),_e.prepareFromAlert,this._sendSingleUpdate),this._sendApplyFeedback=(e,t)=>e.state.method===he.Fc.State.Applied.Method.ByCard?this._commitFeedbackToCapi(e,t):o.constVoid,this._sendApplyTextFeedback=(e,t,i,n,s)=>this._sendApplyFeedback(e,{kind:v.yp.ACCEPTED,replacementText:t,subtype:i,reason:n,gbPrompt:s}),this._sendApplyTransformJsonFeedback=(e,t,i,n,s,r)=>{const o={kind:v.yp.ACCEPTED,alternativeIndex:t,subtype:i,drilldownSuggestionIds:n,reason:s,gbPrompt:r},a=he.Fc.isOneGap(e)?(0,h._)((0,m._)({},o),{gapValue:e.gapValue}):he.Fc.isShortenIt(e)?(0,h._)((0,m._)({},o),{dismissedTransformGroups:Array.from(e.dismissedTransformGroups)}):o;return this._sendApplyFeedback(e,a)}}}!function(e){e.toString=k.fold((({id:e})=>`rid:${e}`),(e=>`aid:${e.toString()}`))}(Ce||(Ce={})),function(e){e.match=function(e){return t=>t instanceof he.Un?e.alertAddOrUpdate(t):t instanceof Map?e.rangeChange(t):"_tag"in t?e.alertRemove(t):e.alertChange(t)}}(Ee||(Ee={})),function(e){e.defaultValidator=he.Fc.isDuplicatedBy}(we||(we={}));class Te{static _prepareUpdate(e,t){const i=(0,h._)((0,m._)({},e.toRawAlert()),{rev:t.rev});return(0,o.pipe)(t.extraProperties,d.Mi((e=>i.extra_properties=e))),(0,o.pipe)(t.muted,d.Mi((e=>i.muted=e))),v.tI.withTransformJson(i)&&(0,o.pipe)(t.transformJson,d.Mi((e=>i.transformJson=e))),i}_processBatch(e){return e.reduce(((e,t)=>(Ee.match({alertAddOrUpdate:t=>{(0,o.pipe)(t.rawId,c.fold((()=>{e.toAdd.set(t.id,t)}),(i=>{(0,o.pipe)(this._alertsRepo.getByRawAlertId(i),c.filter((e=>e.allowUpdate)),c.map((()=>{(0,o.pipe)(c.fromNullable(e.toAddOrUpdate.get(i)),c.map((t=>{this._log.debug("got overlap in batch on update"),e.toUpdate.delete(t.id),e.toDispose.set(t.id,t)}))),e.toUpdate.set(t.id,t)})),c.getOrElse((()=>{(0,o.pipe)(c.fromNullable(e.toAddOrUpdate.get(i)),c.map((t=>{this._log.info("got overlap in batch on add"),e.toAdd.delete(t.id),e.toDispose.set(t.id,t)}))),e.toAdd.set(t.id,t)}))),e.toAddOrUpdate.set(i,t)})))},rangeChange:t=>{(0,l.V1)(void 0===e.rangeChanges,"unexpected rangeChanges duplicate"),e.rangeChanges=t},alertRemove:t=>{e.toRemoveUnfiltered.push(t)},alertChange:t=>{e.toChangeUnfiltered.push(t)}})(t),e)),{toAdd:new Map,toRemoveUnfiltered:[],toChangeUnfiltered:[],toUpdate:new Map,toAddOrUpdate:new Map,rangeChanges:void 0,toDispose:new Map})}_getMergeTarget(e,t){return(0,o.pipe)(e,k.swap,c.fromEither,c.chain((e=>e.mergedIn)),c.chain((e=>{const i=(0,o.pipe)(this._alertsRepo.getByRawAlertId(e),c.map((e=>k.right(e))),c.alt((()=>(0,o.pipe)(c.fromNullable(t.get(e)),c.map((e=>k.left(e)))))));return c.isNone(i)&&this._log.warn("Merge from CAPI: Cannot find alert to merge into.",{capiId:e}),i})),c.filter(Fe((e=>!!e.allowUpdate||(this._log.warn("Merge from CAPI: Trying to merge in a non-updatable alert, skipping. ",{target:e.toLiteString()}),!1)))))}_addAlerts(e,t){return e.length>0&&this._log.debug("_addAlerts, count = "+e.length,{alerts:e.map((e=>e.toLiteString()))}),(0,o.pipe)(e,le.pb(this._validateAlertAdd),le.TS({alertsToAdd:new Map,alertsToUpdate:new Map,alertsToRemove:t},((e,t)=>{this._log.trace("Adding alert: "+t.toLiteString());const i=this._getAlertsWithMatchingRanges(t.getNotEnclosingHighlightRanges()[0]),n=this._tryToMatchInvalid(t,i);switch(this._log.trace("Adding alert match result",{inc:t.id,match:n}),n.type){case Ae.Type.Merged:{const i=n.result[1];he.Fc.isNotRegistered(i.alert)?he.Fc.isRemoved(i.alert)&&this._log.warn("unexpected merge into removed alert",{alert:i,newAlert:t}):this._alertsRepo.addToCapiMapping(i.alert),e.alertsToUpdate.set(i.id,n.result);break}case Ae.Type.Restored:{const t=n.result[1];(0,l.V1)(!e.alertsToRemove.has(t.id),"can't update alert which we wanted to remove earlier"),this._alertsRepo.addToCapiMapping(t.alert),e.alertsToUpdate.set(t.id,n.result);break}case Ae.Type.Unmatched:{const t=n.result,s=i.filter((i=>he.Fc.isDuplicateCandidate(i,c.isNone(i.rawId))&&this._alertDuplicateValidator(t,i)&&!e.alertsToRemove.has(i.id)));(0,l.V1)(t.allowDuplicates||he.Fc.isApplicableAlert(t),"BaseAlertImpl must allow duplicates or be an ApplicableAlert type");const r=t.allowDuplicates?{result:Ie.Add,toRemove:c.none}:this._tryAddAlert(t,s);switch(r.result){case Ie.Add:case Ie.OverwriteExisting:this._log.debug("AllAlerts: Append alert to all alerts",t.toLiteString()),this._alertsRepo.addToCapiMapping(t),(0,l.V1)(!e.alertsToRemove.has(t.id),"can't add alert which we wanted to remove earlier",(()=>t.toLiteString())),this._alertsRepo.add(t),e.alertsToAdd.set(t.id,ue.Y.create(t)),(0,o.pipe)(r.toRemove,d.Mi((t=>{if(e.alertsToAdd.has(t.id)){this._alertsRepo.removeFromCapiMapping(t);const e=t.changeState(he.Fc.State.Removed.create(he.Fc.State.Removed.Reason.canceled));this._terminateAlertChecking(e),this._alertsRepo.remove(e)}else this._log.debug("schedule to remove duplicate",t.toLiteString()),e.alertsToRemove.set(t.id,{alert:t,reason:he.Fc.State.Removed.Reason.duplicated});e.alertsToAdd.delete(t.id),e.alertsToUpdate.delete(t.id)})));break;case Ie.Skip:this._log.debug("Skip alert with low priority",t.id);break;default:(0,l.xb)(r.result)}break}default:(0,l.xb)(n)}return e})))}_updateAlerts(e,t){this._log.debug(`_updateAlerts, to update = ${e.length}`,{alerts:e.map((e=>e.toLiteString()))}),(0,o.pipe)(e,le.TS(t,((e,t)=>(this._log.trace("Updating alert: "+t.toLiteString()),(0,o.pipe)(this._alertsRepo.getByRawAlertId(d.$v(t.rawId)),c.fold((()=>this._log.warn("tried to update unknown alert",t)),(i=>{const n=t._raw;t.dispose();const s=e.has(i.id)?e.get(i.id)[0]:ue.Y.create(i);i.enqueueRawAlertForUpdate(n),e.set(i.id,he.vs.create(s,ue.Y.create(i)))}))),e))))}_startAlertsChecking(e,t,i){this._log.debug(`_startAlertsChecking, to update = ${e.length}`,{alerts:e.map((([e,t])=>[e.toLiteString(),t]))});const n=(e,t)=>{const i=e.changeState(he.Fc.State.Registered.create(he.Fc.CheckingState.CHECKING));return this._recheckedAlerts.add(e.id),ue.Y.create(t.size>0?i.enqueueRangesRemove(t):i)};(0,o.pipe)(e,le.TS({updatedAlerts:t,addedAlerts:i},((e,[t,i])=>((0,o.pipe)(this._alertsRepo.getByAlertId(t.id),c.fold((()=>{this._log.warn("tried to start checking unknown alert",{alert:t,ranges:i})}),(()=>{if(e.addedAlerts.has(t.id))e.addedAlerts.set(t.id,n(t,i));else{const s=e.updatedAlerts.has(t.id)?e.updatedAlerts.get(t.id)[0]:ue.Y.create(t);e.updatedAlerts.set(t.id,he.vs.create(s,n(t,i)))}}))),e))))}_removeAlerts(e,t){e.forEach(((e,i)=>{(0,o.pipe)(this._alertsRepo.getByAlertId(i),c.fold((()=>{this._log.warn("tried to remove unknown alert",e)}),(()=>(0,o.pipe)(t.get(i),c.fromNullable,c.map(g.Es),c.filter((e=>he.Fc.isNotDisposed(e.alert))),c.alt((()=>(0,o.pipe)(e.alert,c.fromPredicate(he.Fc.isNotDisposed),c.map(ue.Y.create)))),d.Mi((n=>{const s=this._applyRemoveToAlert(e);this._terminateAlertChecking(s),t.set(i,he.vs.create(n,ue.Y.create(s)))}))))))}))}_getAlertsWithMatchingRanges(e){return(0,o.pipe)(this._positionManager.findIntersections(e),le.pb((0,y.M4)(te.a.is,te.l.isVisible)),le.pb((0,y.AU)(te.l.isEnclosingView)),le.x1((e=>this._alertsRepo.getByAlertId(e.meta.alertId))),le.pb((e=>!(he.Fc.isApplied(e)&&e.getAppliedRanges().length>0))))}_tryToMatchInvalid(e,t){return(0,l.V1)(!e.isValid,"added alert should be invalid"),(0,l.V1)(he.Fc.isRegistered(e),"added alert should be in registered state",(()=>e.toString())),(0,o.pipe)(c.fromNullable(t.find((t=>!t.isValid&&t.canBeMergedWith(e)))),c.fold((()=>({result:e,type:Ae.Type.Unmatched})),(t=>{(0,l.V1)((0,o.pipe)(t.rawId,d.Lw((0,o.flow)(this._alertsRepo.getByRawAlertId,c.isNone))),"CAPI mapping should not contain invalid alerts"),this._log.debug(`Merging new alert (${e}) into the existing one aid(${t})`);const i=ue.Y.create(t);return t.patchWithRawAlert(e._raw),e.dispose(),t.allowUpdate&&he.Fc.isCapiDone(t)?{result:he.vs.create(i,ue.Y.create(t.changeState(he.Fc.State.init))),type:Ae.Type.Restored}:{result:he.vs.create(i,ue.Y.create(t)),type:Ae.Type.Merged}})))}_tryAddAlert(e,t){return(0,o.pipe)(ce.ci(t),c.map((t=>{(0,l.V1)(1===t.length,"Only one visible alert to one range is expected while _tryEnqueueAlert",`got ${t.map((e=>e.toString()))} with input (${e.toString()})`);const i=t[0];return i.extraProperties.priority<=e.extraProperties.priority?{result:Ie.OverwriteExisting,toRemove:c.some(i)}:(e.dispose(),{result:Ie.Skip,toRemove:c.none})})),c.getOrElse((()=>({result:Ie.Add,toRemove:c.none}))))}_cleanupPendingAlerts(e){e.removed.forEach((e=>{this._heuristicallyRemovedAlerts.delete(e)&&this._log.info("unexpected alert remove from finish msg",e)})),this._heuristicallyRemovedAlerts.size>0&&this._log.debug("we had heuristically removed alerts which were not confirmed by capi",{size:this._heuristicallyRemovedAlerts.size}),this._heuristicallyRemovedAlerts.clear()}_finishAlertsChecking(){return(0,o.pipe)(Array.from(this._recheckedAlerts.values()),le.x1((e=>{const t=this._alertsRepo.getByAlertId(e);c.isNone(t)&&(this._log.error("tried to finish checking on missing alert",e),this._recheckedAlerts.delete(e));const i=(0,o.pipe)(t,c.filter((e=>he.Fc.isRegistered(e))),c.map((e=>(0,o.tuple)(e.id,this._finishAlertChecking(e)))));return c.isNone(i)&&this._log.error("tried to update checking state on non-registered alert",e),i})),(e=>({updated:new Map(e)})))}constructor(e,t,i){(0,r._)(this,"_positionManager",void 0),(0,r._)(this,"_alertsRepo",void 0),(0,r._)(this,"_alertDuplicateValidator",void 0),(0,r._)(this,"_log",void 0),(0,r._)(this,"_heuristicallyRemovedAlerts",void 0),(0,r._)(this,"process",void 0),(0,r._)(this,"reset",void 0),(0,r._)(this,"_processAlertsBatch",void 0),(0,r._)(this,"_collectChanges",void 0),(0,r._)(this,"_validateAlertAdd",void 0),(0,r._)(this,"_recheckedAlerts",void 0),(0,r._)(this,"_terminateAlertChecking",void 0),(0,r._)(this,"_applyRemoveToAlert",void 0),(0,r._)(this,"_finishAlertChecking",void 0),this._positionManager=e,this._alertsRepo=t,this._alertDuplicateValidator=i,this._log=a.Bx.Logging.getLogger("AlertManager.pipeline",a.y7.$.DEBUG),this._heuristicallyRemovedAlerts=new Map,this.process=e=>(this._log.trace(`process, to process = ${e.length}`),this._collectChanges(this._processAlertsBatch(e))),this.reset=e=>(this._cleanupPendingAlerts(e),this._finishAlertsChecking()),this._processAlertsBatch=e=>{const{toAdd:t,toUpdate:i,toAddOrUpdate:n,toRemoveUnfiltered:s,toChangeUnfiltered:r,toDispose:a,rangeChanges:u}=this._processBatch(e),p=e=>(0,o.pipe)(this._alertsRepo.getByAlertId(e),c.getOrElse((()=>t.get(e)||i.get(e)||a.get(e))));r.forEach((e=>(0,o.pipe)(c.fromNullable(n.get(e.id)),c.fold((()=>(0,o.pipe)(this._alertsRepo.getByRawAlertId(e.id),c.map((t=>{const s=t.copy(!1),r=Te._prepareUpdate(s,e);c.isSome(e.transformJson)?s.updateAlertWithManagedData(r):s.patchWithRawAlert(r),i.set(s.id,s),n.set(e.id,s)})),c.getOrElse((()=>this._log.info("Change from CAPI: Cannot find internal AlertId."))))),(t=>{const n=Te._prepareUpdate(t,e);i.has(t.id)?t.patchWithRawAlert(n):t.updateAlertWithManagedData(n)})))));const m=s.reduce(((e,s)=>{const r=(0,o.pipe)(s,k.fold((({id:e})=>(0,o.pipe)(this._alertsRepo.getByRawAlertId(e),c.map((e=>he.Fc.isRegistered(e)?e:void 0)),c.getOrElse((()=>this._heuristicallyRemovedAlerts.has(e)?void this._heuristicallyRemovedAlerts.delete(e):n.get(e))))),p));return void 0===r?(k.isLeft(s)?this._log.debug("Remove from CAPI: Cannot find internal AlertId. capiId: #"+JSON.stringify(s.left)):this._log.error("Cannot find existing alert by id",s.right),e):((0,o.pipe)(this._getMergeTarget(s,n),c.filter(Fe((e=>e.lensId!==r.lensId?(this._log.warn("Trying to merge alerts from different lenses",{source:r,target:e}),!1):c.isNone(r.rawId)?(this._log.warn("Trying to merge into local alert",{source:r,target:e}),!1):r.references>e.references))),c.fold((()=>{e.set(r.id,{alert:r,reason:(0,o.pipe)(s,k.swap,c.fromEither,c.chain((e=>e.hint)),c.chain((e=>e===b.QN.NotFixed?c.some(he.Fc.State.Removed.Reason.capiDismiss):c.none)),c.getOrElse((()=>he.Fc.State.Removed.Reason.capiDone)))})}),k.fold((e=>{this._log.debug("swap raw alerts with new alert",{source:r.toString(),newTarget:e.toString()}),this._alertsRepo.swapRaw(r,e);const s=d.$v(r.rawId);(0,l.V1)(void 0===i.get(e.id),"Added alert should not be present in the updated alerts map",(()=>i.get(e.id).toString()));const o=r.copy();i.set(o.id,o),n.set(s,o),t.delete(e.id),a.set(e.id,e)}),(t=>{this._log.debug("swap raw alerts with existing alert",{source:r.toString(),existingTarget:t.toString()}),this._alertsRepo.swapRaw(r,t),e.set(t.id,{alert:t,reason:he.Fc.State.Removed.Reason.capiDismiss})})))),e)}),new Map),h=new Map;return u&&u.forEach(((e,t)=>{(0,o.pipe)(t,p,c.fromPredicate((n=>n?he.Fc.isInteractable(n)?!i.has(n.id)||(this._log.debug("skip range change on updateHolder alert",n.toLiteString()),!1):(this._log.debug("skip range change on non-interactable alert",n.toLiteString()),!1):(this._log.warn("got range changes for unknown alert",{alertId:t,alertRanges:e}),!1))),c.chain((i=>(0,o.pipe)(i.onRangeChange(e),c.map((e=>{switch(e.state){case he.Fc.Transition.State.Pending:return h.set(i.id,[i,e.removedRanges]);case he.Fc.Transition.State.Dispose:return(0,o.pipe)(i.rawId,c.fold((()=>this._log.debug("dispose by range change on unknown rid",i.id)),(e=>this._heuristicallyRemovedAlerts.set(e,i)))),m.set(t,{alert:i,reason:he.Fc.State.Removed.Reason.textChange});default:return(0,l.xb)(e)}}))))))})),m.forEach((({alert:e})=>{this._log.trace("check cancellations from toRemove: "+e.toLiteString()),(0,o.pipe)(e.rawId,c.fold((()=>{t.get(e.id)&&(this._log.debug("cancel add local alert for: "+e.toLiteString()),t.delete(e.id),m.delete(e.id),a.set(e.id,e)),(0,l.V1)(!1===i.has(e.id),"Added local alert should not be present in the updated alerts map",(()=>i.get(e.id).toString()))}),(s=>{const r=n.get(s);r&&(n.delete(s),t.delete(r.id)?(this._log.debug("cancel add for: "+r.toLiteString()),this._log.debug("cancel remove for: "+e.toLiteString()),m.delete(e.id),a.set(e.id,e),a.set(r.id,r)):i.delete(r.id)?(this._log.debug("cancel update for: "+r.toLiteString()),r.id!==e.id&&(this._log.debug("marking update to dispose: "+r.toLiteString()),a.set(r.id,r))):this._log.error("_addOrUpdateAlert toAdd || toUpdate mapping in unsync state!",r))}))),this._log.trace("check if local orphan toRemove: "+e.toLiteString()),(0,o.pipe)(this._alertsRepo.getByAlertId(e.id),c.fold((()=>{this._log.debug("cancel delete for: "+e.toLiteString()),m.delete(e.id)}),o.constVoid))})),a.size>0&&this._log.debug(`_cancelAlerts, to cancel = ${a.size}`,{alerts:Array.from(a.values()).map((e=>e.toLiteString()))}),a.forEach((e=>{h.delete(e.id)&&this._log.debug("cancel startChecking for: "+e.toLiteString());try{e.dispose()}catch(t){this._log.warn("unexpected error on disposing canceled alert",t,e)}})),{toAdd:t,toUpdate:i,toRemove:m,toStartChecking:h}},this._collectChanges=({toAdd:e,toUpdate:t,toRemove:i,toStartChecking:n})=>{const{alertsToAdd:s,alertsToUpdate:r,alertsToRemove:o}=this._addAlerts(Array.from(e.values()),i);return t.size>0&&this._updateAlerts(Array.from(t.values()),r),n.size>0&&this._startAlertsChecking(Array.from(n.values()),r,s),o.size>0&&this._removeAlerts(o,r),{added:s,updated:r}},this._validateAlertAdd=e=>{try{const t=!he.Fc.isPremium(e)||void 0!==e.categoryHuman;return e._raw.impact!==v.tI.Impact.Critical&&e._raw.impact!==v.tI.Impact.Advanced&&c.isSome(e.rawId)&&this._log.warn("CAPI provides corrupted impact prop",{alert:e,raw:v.tI.clearUserTextFields(e._raw)}),t||(this._log.error("CAPI provides corrupted alert",{alert:e,raw:v.tI.clearUserTextFields(e._raw)}),e.dispose()),(0,o.pipe)(e.rawId,c.exists((e=>c.isSome(this._alertsRepo.getByRawAlertId(e)))))?(this._log.warn("unexpected overlap on rawId for non-updatable alert",{alert:e,raw:v.tI.clearUserTextFields(e._raw)}),e.dispose(),!1):e.lensType===ee.J.Type.Plagiarism&&X.w.isMax(e.progress)?(this._log.info("CAPI provides a Plagiarism alert with an invalid progress",{alert:e,raw:v.tI.clearUserTextFields(e._raw)}),e.dispose(),!1):t}catch(t){this._log.error("Cannot validate alert",t);try{e.dispose()}catch(e){this._log.warn("Cannot dispose invalid alert",e)}return!1}},this._recheckedAlerts=new Set,this._terminateAlertChecking=({id:e})=>{this._recheckedAlerts.delete(e)&&this._log.debug("Stopped watching checking state for alert",e)},this._applyRemoveToAlert=({alert:e,reason:t})=>(this._alertsRepo.removeFromCapiMapping(e),t!==he.Fc.State.Removed.Reason.textChange&&t!==he.Fc.State.Removed.Reason.duplicated&&e.clearCapiId(),e.changeState(he.Fc.State.Removed.create(t))),this._finishAlertChecking=e=>{(0,l.V1)(this._recheckedAlerts.delete(e.id),"tried to finish checking on alert which had not been marked as checking"),this._log.debug("Stopped watching checking state for alert",e.id);const t=ue.Y.create(e);return he.vs.create(t,ue.Y.create(e.changeState(he.Fc.State.Registered.create(he.Fc.CheckingState.IDLE))))}}}function Fe(e){return k.fold(e,e)}!function(e){let t;!function(e){e.Unmatched="Unmatched",e.Merged="Merged",e.Restored="Restored"}(t=e.Type||(e.Type={}))}(Ae||(Ae={})),function(e){e.Skip="Skip",e.Add="Add",e.OverwriteExisting="OverwriteExisting"}(Ie||(Ie={}));var Re=i(11783);class Ke{flushAlerts(){this._flush.next()}loadAlerts(e){const t=new Map;return(0,y.z2)(e)&&(this._log.debug(`${e.length} external alert(s) where loaded`),e.map(Re.P.splitById).map((({id:e,local:t})=>({id:e,alert:he.Fc.create((0,o.pipe)(t,v.tI.matchBy(o.identity,(e=>(0,h._)((0,m._)({},e),{transformJson:{highlights:e.transformJson.highlights,alternatives:(0,o.pipe)(e.transformJson.alternatives,c.map(_.EF.Group.fromSerialized))}})),o.identity),this._transformRawAlert),this._ops,this._positionManager,this._alternativeManager)}))).forEach((({id:e,alert:i})=>{this._addAlertBuffered(i),e&&t.set(e,i.id)}))),t}toString(){return JSON.stringify(this,void 0,2)}toJSON(){return{repo:this._alertsRepository}}dispose(){this._subs.forEach((e=>e.unsubscribe())),this._subs=[]}_getTypeFilter(e){switch(e){case"alert":return e=>!he.Fc.isPlagiarism(e);case"plagiarism":return e=>he.Fc.isPlagiarism(e);default:return(0,l.xb)(e)}}_addAlertBuffered(e){this._log.trace(`_addAlert(${e.toLiteString()})`),this._addAlerts.next(e)}_handleFreePremium(e){this._log.trace(`_handleFreePremium(${e.id})`),Boolean(e.updatable)&&(0,o.pipe)(this._alertsRepository.getByRawAlertId(e.id),c.filter(he.Fc.isNotDisposed),d.Mi((()=>this._removeAlertBuffered(k.left({id:e.id,mergedIn:c.none,hint:c.none})))));const t=he.Fc.create(this._transformRawAlert(e),this._ops,this._positionManager,this._alternativeManager);this.flushAlerts(),this._freePremiumAlerts.next(t)}_changeAlertBuffered(e){this._log.trace(`_changeAlert(${e.id})`),this._changeAlerts.next(e)}_removeAlertBuffered(e){this._log.trace(`_removeAlert(${Ce.toString(e)})`),this._removeAlerts.next(e)}_getAllAlertsAsArray(){return this._alertsRepository.toArray().filter(he.Fc.isNotRemoved)}constructor(e,t,i,n,s,l,d,m=we.defaultValidator,h=new u,v=e.rangeChanged){(0,r._)(this,"_positionManager",void 0),(0,r._)(this,"_alternativeManager",void 0),(0,r._)(this,"_getContent",void 0),(0,r._)(this,"_capiEvents",void 0),(0,r._)(this,"_capiClient",void 0),(0,r._)(this,"_documentCounters",void 0),(0,r._)(this,"_transformRawAlert",void 0),(0,r._)(this,"_alertDuplicateValidator",void 0),(0,r._)(this,"_alertsRepository",void 0),(0,r._)(this,"rangeChanged",void 0),(0,r._)(this,"_state",void 0),(0,r._)(this,"state",void 0),(0,r._)(this,"lensesScores",void 0),(0,r._)(this,"_log",void 0),(0,r._)(this,"_subs",void 0),(0,r._)(this,"_addAlerts",void 0),(0,r._)(this,"_removeAlerts",void 0),(0,r._)(this,"_changeAlerts",void 0),(0,r._)(this,"_freePremiumAlerts",void 0),(0,r._)(this,"_flush",void 0),(0,r._)(this,"_alertsPerRevision",void 0),(0,r._)(this,"_ops",void 0),(0,r._)(this,"_pipeline",void 0),(0,r._)(this,"changes",void 0),(0,r._)(this,"loadScores",void 0),(0,r._)(this,"undoApplied",void 0),(0,r._)(this,"_invalidateAlerts",void 0),(0,r._)(this,"_removeInvalidAlerts",void 0),(0,r._)(this,"_onCapiEvent",void 0),(0,r._)(this,"_emitDomainEvent",void 0),(0,r._)(this,"_prepareDiff",void 0),(0,r._)(this,"_disposeAlert",void 0),this._positionManager=e,this._alternativeManager=t,this._getContent=i,this._capiEvents=n,this._capiClient=s,this._documentCounters=l,this._transformRawAlert=d,this._alertDuplicateValidator=m,this._alertsRepository=h,this.rangeChanged=v,this._state=f.s.create(V.z.empty),this.state=this._state.view(V.z.toCheckingResult),this.lensesScores=f.s.create(z.empty),this._log=a.Bx.Logging.getLogger(Ke.loggerName,a.y7.$.TRACE,a.y7.I.Manager.getColor()),this._subs=[],this._addAlerts=new w.B7,this._removeAlerts=new w.B7,this._changeAlerts=new w.B7,this._freePremiumAlerts=new w.B7,this._flush=new w.B7,this._alertsPerRevision=0,this._pipeline=new Te(this._positionManager,this._alertsRepository,this._alertDuplicateValidator),this._invalidateAlerts=()=>{this.flushAlerts();const[e,t]=S.jB(this._getAllAlertsAsArray(),(e=>e.isValid));this._log.debug("Invalidate alerts...",{valid:e.length,invalid:t.length}),e.forEach((e=>{this._alertsRepository.removeFromCapiMapping(e),e.clearCapiId()})),t.forEach((e=>e.clearCapiId()))},this._removeInvalidAlerts=e=>{this._log.debug(`Removing invalid alerts by type '${e}'...`);const t=this._getTypeFilter(e),i=this._getAllAlertsAsArray().filter((e=>!e.isValid&&he.Fc.isNotDisposed(e)&&he.Fc.isRegistered(e)&&t(e)));i.forEach((e=>this._removeAlertBuffered(k.right(e.id)))),this._log.debug(`${i.length} invalid alerts removed`),this.flushAlerts(),this._log.isEnabled(a.y7.$.TRACE)&&this._log.trace("Removed alerts",i.map((e=>e.toString())))},this._onCapiEvent=e=>{try{switch("alert_received"===e.kind&&this._alertsPerRevision++,e.kind){case"alert_received":case"plagiarism_alert_received":if(!1===e.alert.hidden&&void 0===e.alert.cardLayout)return void this._log.warn("got alert with empty mapping",{pname:e.alert.pname});"unlocked"===e.alert.extra_properties.free_premium?this._handleFreePremium(e.alert):this._addAlertBuffered(he.Fc.create(this._transformRawAlert(e.alert),this._ops,this._positionManager,this._alternativeManager));break;case"alert_removed":this._log.debug(`Remove from capi #${e.alertId}, merged in #${c.getOrElse((()=>"None"))(e.mergedIn)}, hint: ${c.getOrElse((()=>"None"))(e.hint)}`),(0,o.pipe)(this._alertsRepository.getByRawAlertId(e.alertId),c.exists(he.Fc.isBulkApplied))||this._removeAlertBuffered(k.left({id:e.alertId,mergedIn:e.mergedIn,hint:e.hint}));break;case"alert_changed":this._log.debug("Alert change from capi #"+e.alertId),this._changeAlertBuffered({id:e.alertId,rev:e.rev,extraProperties:c.fromNullable(e.extraProperties),transformJson:c.fromNullable(e.transformJson),muted:c.fromNullable(e.muted)});break;case"finish":this._log.debug(`Alerts per revision (#${e.revision}): ${this._alertsPerRevision}`),this._alertsPerRevision=0,"idle"===this._capiClient.checkingState&&this._emitDomainEvent(this._pipeline.reset(e))}}catch(t){a.sw.isErrorLike(t)?this._log.error("Cannot handle CAPI event.",t,{capiEvent:e}):this._log.error("Cannot handle CAPI event.",{capiEvent:e,error:t})}},this._emitDomainEvent=e=>{(0,o.pipe)(e,this._prepareDiff,j.z.createDiff,C.s.recover((e=>this._log.error("conflicts on diff creating",e))),(e=>(this._log.debug("_emitDomainEvent",U.A.Diff.show.show(e)),e)),V.z.applyDiff,E.Tj(C.s.recover((e=>this._log.error("conflicts on diff apply",e)))),(e=>this._state.modify(e)))},this._prepareDiff=({added:e,updated:t=new Map,removed:i=new Map})=>(t.forEach(((e,n)=>{(0,o.pipe)(e,g.gp,he.Fc.fromAlertModel,he.Fc.shouldBeRemoved)&&(t.delete(n),i.set(n,e[0]))})),i.forEach((0,o.flow)(he.Fc.fromAlertModel,this._disposeAlert)),{added:e,updated:t,removed:i}),this._disposeAlert=e=>{if(he.Fc.isApplied(e)&&e.state.undoable.commit(),he.Fc.isNotRegistered(e))try{this._alertsRepository.remove(e)}catch(t){this._log.error("Cannot remove alert.",t),he.Fc.isNotDisposed(e)&&e.dispose()}else this._log.error("unexpected remove of registered alert",e.toString())},this._ops=new xe(this._positionManager,this._getContent,this._capiClient,this._alertsRepository),this.loadScores=e=>{this.lensesScores.set(e)},this.undoApplied=this._ops.undoApplied,this.changes=this._ops.changes;const _=this.rangeChanged.pipe(A.T((({affected:e})=>e)),I.p((e=>e.length>0)),A.T((e=>x.$z((e=>e.meta.alertId),e.filter(te.a.is)))),I.p((e=>e.size>0)),T.M((e=>this._log.debug("Range[s] changed",e))),F.u()),$=R.Y(250).pipe(K.Z(0),M.h(this._flush)),H=O.uj(this._log);this._subs.push(H("_alertsInvalidation",this._capiEvents.pipe(I.p((e=>b.om.is("session_started")(e)&&e.isNewSession)),T.M(this._invalidateAlerts),N.K(B.h(this._capiEvents.pipe(I.p(b.om.is("finish")),P.s(1),D.u("alert")),this._capiEvents.pipe(I.p(b.om.is("async_check_finished")),P.s(1),D.u("plagiarism")))),T.M(this._removeInvalidAlerts))),H("_capiEvents",this._capiEvents.pipe(T.M(this._onCapiEvent))),H("_alertsProccesing",this._addAlerts.pipe(M.h(this._freePremiumAlerts),M.h(this._removeAlerts),M.h(this._changeAlerts),M.h(_),L.r($),I.p(y.z2),A.T(this._pipeline.process),T.M(this._emitDomainEvent))),H("_alertsBuffer",_.pipe(M.h(this._capiEvents.pipe(I.p(b.om.is("before_finish","before_async_check_finish","async_check_finished")))),D.u(O.q6),T.M(this._flush))),H("_alertOpsAlertChanges",this._ops.events.pipe(T.M(this._emitDomainEvent))),H("_lensesScoresChanges",z.fromCapi(this._capiEvents).pipe(T.M(O.H9(this.lensesScores)))),H("documentCountersChanges",p.fromAlerts(this._state.view(j.z.iso.wrap)).pipe(T.M(O.H9(this._documentCounters))))),(0,y.hJ)("alerts",(()=>this.toString())),(0,y.hJ)("triggerRemove",(e=>{this._removeAlertBuffered(k.right(e))}))}}(0,r._)(Ke,"loggerName","AlertManager");var Me,Oe=i(92802);!function(e){e.create=function(e){const t=t=>(0,o.pipe)(e.get(),U.A.get(t),c.map(he.Fc.fromAlertModel)),i=e=>(0,o.pipe)(t(e),c.filter(he.Fc.isInteractable)),n=e=>(0,o.pipe)(t(e),c.filter(he.Fc.isRegistered)),s=(0,o.flow)(n,c.filter((0,y.M4)(he.Fc.isNotDisposed,(0,Oe.AU)(he.Fc.isInPremiumLens),(0,Oe.AU)(he.Fc.isHidden)))),r=(0,o.flow)(s,c.isSome);return{getById:t,getRegistered:n,getInteractable:i,getValidForFeedback:s,isValidForFeedback:r,isRegistered:e=>(0,o.pipe)(n(e),c.isSome),isInteractable:e=>(0,o.pipe)(i(e),c.isSome)}}}(Me||(Me={}));var Ne=i(53397),Be=i(23121);class Pe{apply(e,t){const{alternativeIndex:i,source:n}=t;return this._log.trace("apply",e),(0,o.pipe)(this._findAlert(e),k.chain(k.fromPredicate(he.Fc.isApplicableAlert,(()=>new Error("cannot apply not applicable alert")))),k.chain((e=>(0,o.pipe)(Be.zb((()=>e.apply(t))),k.mapLeft((t=>(this._log.error("apply single alert error",{error:t,alert:e.toLiteAlert(),alternativeIndex:i,source:n}),t)))))))}applyBulk(e,t){this._log.trace("applyBulk",e),this.sendBatchFeedback(e,v.l.BULK_ACCEPTED,t);const i=(0,o.pipe)(e,C.s.fromArray((e=>(0,o.pipe)(this._findAlert(e),k.mapLeft((t=>(0,o.tuple)(t,{id:e}))),k.chain(k.fromPredicate(he.Fc.isRegisteredApplicableAlert,(e=>(0,o.tuple)(new Error("cannot apply not applicable or non-registered alert"),e.toLiteAlert())))),k.chain(k.fromPredicate((e=>v.tI.withTransformJson(e._raw)),(e=>(0,o.tuple)(new Error("Only alerts with transformJSON can be bulk applied"),e.toLiteAlert())))),k.mapLeft((([e,t])=>(this._log.error(e.message,t),e)))))));return(0,o.pipe)(i,C.s.flatMap(le.JI(),(e=>(0,o.pipe)(this._ops._applyTransformJson({alerts:e.map((e=>({alert:e,alternative:he.Fc.getApplicableAlternative(e,0)}))),source:he.Kz.api,method:he.Fc.State.Applied.Method.Bulk,feedbackSubtype:t}),ne.AU((t=>()=>(this._log.error("applyBulk error",t),C.s.of([],e.map((e=>e.id))))),(()=>()=>C.s.of(e.map((e=>e.id))))))())))}confirmApplied(e){return this._log.trace("commitApplied",e),(0,o.pipe)(e,C.s.fromArray((0,o.flow)(this._findAlert,k.map(he.Un.castApplied))),k.mapLeft((e=>new Error(`Error on trying to confirm applied alerts: ${e.rejected.join(",")}`))),k.chain((e=>this._ops._confirmApplied(e)())))}dismissBatch(e,t){return this._log.trace("dismissBatch",e),(0,o.pipe)(e.map((0,o.flow)(this._findAlert,k.map((e=>[e])))),(0,Ne.fold)(Le),k.chain((e=>this._ops._dismissBatch(e,t)())))}applyFeedback(e,t,i){return this._log.trace("sendFeedback",{alertId:e,type:t.kind}),(0,o.pipe)(this._findAlert(e),k.chain((e=>this._ops._alertFeedback(e,t,i)())))}sendBatchFeedback(e,t,i){return this._log.trace("sendBatchFeedback",{alertIds:e,type:t}),(0,o.pipe)(e,C.s.fromArray(this._findAlert),C.s.tapFailure((e=>this._log.error("Cannot send batch feedback for alerts",e.rejected))),C.s.foldSuccess((e=>k.right(this._ops._alertBatchFeedback(e,t,i)()))))}takeReference(e,t){return this._log.trace("takeReference",{alertId:e.id,from:t}),(0,o.pipe)(this._findAlert(e.id),k.chain((e=>e.takeReference(t))))}changeMuteState(e,t){return this._log.trace("changeMuteState",e),(0,o.pipe)(e,C.s.fromArray((e=>this._findAlert(e.id))),C.s.flatMap(le.JI(),(e=>(0,o.pipe)(this._ops._changeMuteState(e,t)(),k.mapLeft((e=>(this._log.error("Can not change mute state",e),e))),Be.$v))))}changeGapValue(e,t){return(0,o.pipe)(this._findAlert(e),k.chain((e=>this._ops._changeGapValue(e,t)())))}changeTakeawayFeedback(e,t){return(0,o.pipe)(this._findAlert(e),k.chain((e=>this._ops._changeTakeawayFeedback(e,t)())))}shortenItSummaryNotFound(e){return(0,o.pipe)(this._findAlert(e),k.chain((e=>this._ops._shortenItSummaryNotFound(e)())))}sendShortenItSummaryRequest(e){return(0,o.pipe)(this._findAlert(e),k.chain((e=>this._ops._commitShortenItSummaryRequest(e)())))}dismissShortenItTransformGroup(e,t){return(0,o.pipe)(this._findAlert(e),k.chain((e=>this._ops._dismissShortenItTransformGroup(e,t)())))}changeToneAIToneAlternative(e,t){return(0,o.pipe)(this._findAlert(e),k.chain((e=>this._ops._changeToneAIToneAlternative(e,t)())))}constructor(e,t){(0,r._)(this,"_alertsReader",void 0),(0,r._)(this,"_ops",void 0),(0,r._)(this,"_log",void 0),(0,r._)(this,"_findAlert",void 0),(0,r._)(this,"undoBulk",void 0),(0,r._)(this,"getHighlightRanges",void 0),(0,r._)(this,"hasNewRangesForUpdate",void 0),(0,r._)(this,"applyPendingRangesUpdate",void 0),(0,r._)(this,"getAppliedRanges",void 0),this._alertsReader=e,this._ops=t,this._log=a.Bx.Logging.getLogger("AlertsServiceImpl"),this._findAlert=e=>(0,o.pipe)(e,this._alertsReader.getById,k.fromOption((()=>new Error(`alert ${e} not found in the repo`)))),this.undoBulk=(0,o.flow)(pe.x1((0,o.flow)(this._alertsReader.getById,c.filter(he.Fc.isBulkApplied))),(e=>this._ops.undoApplied(e,he.Fc.State.Applied.Method.Bulk)()),k.getOrElse((e=>{throw this._log.error("Could not undo bulk-applied alerts",e),e}))),this.getHighlightRanges=(0,o.flow)(this._findAlert,k.map((e=>e.getHighlightRanges()))),this.hasNewRangesForUpdate=(0,o.flow)(this._findAlert,k.map((e=>e.hasNewRangesForUpdate))),this.applyPendingRangesUpdate=(0,o.flow)(this._findAlert,k.map((e=>e.applyPendingRangesUpdate()))),this.getAppliedRanges=(0,o.flow)(this._alertsReader.getById,k.fromOption((()=>new Error("alert not found in the repo"))),k.filterOrElse(he.Fc.isApplicableAlert,(e=>new Error(`alert is not applicable: ${e.alertType}`))),k.map((e=>e.getAppliedRanges())))}}const De=le.JI(),Le=(0,k.getApplyMonoid)(De);function Ue(e,t,i,r,o){const a=new s.hI,l=new n.jQ,c=new u,d=new Ke(a,l,e,r,i,o,t,void 0,c),p=Me.create(d.state);return{positionManager:a,altManager:l,alertManager:d,alertsRepository:c,alertsReader:p,alertsService:new Pe(p,d._ops)}}},99854:(e,t,i)=>{i.d(t,{F:()=>_});var n=i(23988),s=i(84647),r=i(60575),o=i(49004),a=i(88105),l=i(54463),c=i(66202),d=i(65390),u=i(94855),p=i(86562),m=i(78339),h=i(82718),g=i(24946),f=i(62822),v=i(89769);class _{pushChanges(e){return()=>o.lY.isReset(e)&&!this._capiConnection.wasStarted?(this._log.debug("Got new Reset, triggering connection"),this._initialDelta=e,this._capiConnection.connect(this._connectFromResetSource,!1).then((([e,t])=>c.right(void 0!==t?d.some(t):d.none))).catch((e=>(this._log.warn("failed to connect to CAPI",e),c.left(e))))):this._capiConnection.wasStarted?this._isReady?this._capi.pushChanges(e)():(this._log.debug("Skipped sending change to CAPI as it is not ready yet"),this._initialDelta&&o.lY.isDelta(e)&&(this._log.debug("Got change while establishing new CAPI connection, appending to initial Delta"),(0,s.pipe)(this._initialDelta.compose(e),c.fold((()=>{this._log.error("Got invalid change while establishing new CAPI connection, skiping")}),(e=>{this._initialDelta=e})))),this._capiConnection.isIdle?(this._log.debug("received new change while CAPI is idle, connecting"),this._capiConnection.connect(this._connectFromIdleSource,!1).catch((e=>this._log.warn("failed to connect to CAPI",e))).then((()=>c.right(d.none)))):(this._log.debug("capi is not idle, skip capi reconnect"),Promise.resolve(c.right(d.none)))):(this._log.debug("Skipped sending change to CAPI as it is not started yet, triggering new connection"),this._capiConnection.connect(this._connectFromIdleSource,!1).catch((e=>this._log.warn("failed to connect to CAPI",e))).then((()=>c.right(d.none))))}registerExternalMessageHandler(e){this._capi.registerExternalMessageHandler(e)}get checkingState(){return this._capi.checkingState}get asyncChecksState(){return this._capi.asyncChecksState}_checkConnected(){this._capiConnection.isIdle?(this._log.debug("received new command while CAPI connection is idle, connecting"),this._capiConnection.connect(this._connectFromIdleSource,!1).catch((e=>this._log.warn("failed to connect to CAPI",e)))):this._log.trace("already connected or cannot connect, skipping")}dispose(){this._subs.forEach((e=>e.unsubscribe()))}constructor(e,t,i,o){(0,n._)(this,"_events",void 0),(0,n._)(this,"_capi",void 0),(0,n._)(this,"_ded",void 0),(0,n._)(this,"_capiConnection",void 0),(0,n._)(this,"_log",void 0),(0,n._)(this,"_subs",void 0),(0,n._)(this,"_initialDelta",void 0),(0,n._)(this,"_isReady",void 0),(0,n._)(this,"_connectFromIdleSource",void 0),(0,n._)(this,"_connectFromResetSource",void 0),(0,n._)(this,"setSessionOption",void 0),(0,n._)(this,"sendFeedback",void 0),(0,n._)(this,"requestDocStats",void 0),(0,n._)(this,"requestSynonyms",void 0),(0,n._)(this,"requestSnippets",void 0),(0,n._)(this,"requestWritingExpert",void 0),(0,n._)(this,"triggerTouchTypist",void 0),(0,n._)(this,"shortenItSubmit",void 0),(0,n._)(this,"enablePlagiarismSearch",void 0),(0,n._)(this,"disablePlagiarismSearch",void 0),(0,n._)(this,"enableWritingExpert",void 0),(0,n._)(this,"disableWritingExpert",void 0),(0,n._)(this,"realtimeProofitSubmit",void 0),(0,n._)(this,"realtimeProofitCancel",void 0),(0,n._)(this,"submitRecipients",void 0),(0,n._)(this,"submitScoreSurveyResult",void 0),(0,n._)(this,"submitSurvey",void 0),(0,n._)(this,"sendUserAction",void 0),(0,n._)(this,"sendDebugReport",void 0),(0,n._)(this,"ping",void 0),(0,n._)(this,"getText",void 0),(0,n._)(this,"close",void 0),(0,n._)(this,"isClosed",void 0),(0,n._)(this,"resetReconnectInfo",void 0),(0,n._)(this,"updateContextInfo",void 0),(0,n._)(this,"setContext",void 0),(0,n._)(this,"published",void 0),(0,n._)(this,"enqueueExternalCommand",void 0),this._events=e,this._capi=t,this._ded=i,this._capiConnection=o,this._log=r.Bx.Logging.getLogger("CapiSyncManager"),this._subs=[],this._isReady=!1,this._connectFromIdleSource=()=>{this._ded.flushChanges();const e=this._ded.getContents();return this._log.debug("sending ded current delta",a.E.anonymizeTextAndStringAttrs(e.delta)),e},this._connectFromResetSource=()=>{const e=this._initialDelta?this._initialDelta:this._ded.getContents();return this._initialDelta=void 0,e},this.setSessionOption=e=>(0,s.pipe)(u.BK((()=>this._checkConnected())),u.cy((()=>this._capi.setSessionOption(e)))),this.sendFeedback=e=>(0,s.pipe)(this._capi.sendFeedback(e),u.AU((e=>(0,s.pipe)(u.BK((()=>this._checkConnected())),u.AU(p.xb,(()=>u.kb(e))))),(()=>u.pG(void 0)))),this.requestDocStats=(0,s.pipe)(u.BK((()=>this._checkConnected())),u.cy((()=>this._capi.requestDocStats))),this.requestSynonyms=(e,t)=>(0,s.pipe)(u.BK((()=>this._checkConnected())),u.cy((()=>this._capi.requestSynonyms(e,t)))),this.requestSnippets=e=>(0,s.pipe)(u.BK((()=>this._checkConnected())),u.cy((()=>this._capi.requestSnippets(e)))),this.requestWritingExpert=()=>(0,s.pipe)(u.BK((()=>this._checkConnected())),u.cy((()=>this._capi.requestWritingExpert()))),this.triggerTouchTypist=e=>(0,s.pipe)(u.BK((()=>this._checkConnected())),u.cy((()=>this._capi.triggerTouchTypist(e)))),this.shortenItSubmit=e=>(0,s.pipe)(u.BK((()=>this._checkConnected())),u.cy((()=>this._capi.shortenItSubmit(e)))),this.enablePlagiarismSearch=(0,s.pipe)(u.BK((()=>this._checkConnected())),u.cy((()=>this._capi.enablePlagiarismSearch))),this.disablePlagiarismSearch=(0,s.pipe)(u.BK((()=>this._checkConnected())),u.cy((()=>this._capi.disablePlagiarismSearch))),this.enableWritingExpert=(0,s.pipe)(u.BK((()=>this._checkConnected())),u.cy((()=>this._capi.enableWritingExpert))),this.disableWritingExpert=(0,s.pipe)(u.BK((()=>this._checkConnected())),u.cy((()=>this._capi.disableWritingExpert))),this.realtimeProofitSubmit=e=>(0,s.pipe)(u.BK((()=>this._checkConnected())),u.cy((()=>this._capi.realtimeProofitSubmit(e)))),this.realtimeProofitCancel=(0,s.pipe)(u.BK((()=>this._checkConnected())),u.cy((()=>this._capi.realtimeProofitCancel))),this.submitRecipients=e=>(0,s.pipe)(u.BK((()=>this._checkConnected())),u.cy((()=>this._capi.submitRecipients(e)))),this.submitScoreSurveyResult=(e,t)=>(0,s.pipe)(u.BK((()=>this._checkConnected())),u.cy((()=>this._capi.submitScoreSurveyResult(e,t)))),this.submitSurvey=e=>(0,s.pipe)(u.BK((()=>this._checkConnected())),u.cy((()=>this._capi.submitSurvey(e)))),this.sendUserAction=(e,t)=>(0,s.pipe)(u.BK((()=>this._checkConnected())),u.cy((()=>this._capi.sendUserAction(e,t)))),this.sendDebugReport=(e,t)=>(0,s.pipe)(u.BK((()=>this._checkConnected())),u.cy((()=>this._capi.sendDebugReport(e,t)))),this.ping=(0,s.pipe)(u.BK((()=>this._checkConnected())),u.cy((()=>this._capi.ping))),this.getText=()=>this._capi.getText(),this.close=e=>this._capi.close(e),this.isClosed=()=>this._capi.isClosed(),this.resetReconnectInfo=()=>this._capi.resetReconnectInfo(),this.updateContextInfo=e=>(0,s.pipe)(u.BK((()=>this._checkConnected())),u.cy((()=>this._capi.updateContextInfo(e)))),this.setContext=e=>(0,s.pipe)(u.BK((()=>this._checkConnected())),u.cy((()=>this._capi.setContext(e)))),this.published=()=>(0,s.pipe)(u.BK((()=>this._checkConnected())),u.cy((()=>this._capi.published()))),this.enqueueExternalCommand=e=>(0,s.pipe)(u.BK((()=>this._checkConnected())),u.cy((()=>this._capi.enqueueExternalCommand(e)))),this._subs.push(this._events.pipe(m.p(l.om.is("ready")),h.K(this._events.pipe(m.p(l.om.is("disconnect")),g.s(1),f.u(!1),v.Z(!0))),v.Z(!1)).subscribe((e=>{this._isReady=e})))}}},85199:(e,t,i)=>{function n(e){const t=t=>{e.next(t)};return{onSessionStarted:t,onWaitForOT:t,onReady:t,onSessionInbound:t,beforeAlert:t,onAlert:t,onRemove:t,onChange:t,onSynonyms:t,onPlagiarism:t,onTextInfo:t,onEmotions:t,onBeforeAsyncCheckFinish:t,onAsyncCheckFinish:t,onAsyncCheckProgress:t,onError:t,onBeforeFinish:t,onFinish:t,onConnect:t,onDisconnect:t,onQueueMsgDropped:t,onAck:t,onPong:t,onMessageReceived:t,onMessageSent:t,onAutoComplete:t,onAttentionHeatmap:t,onAttentionInfo:t,onProofitAvailability:t,onProofitCancelled:t,onProofitCompleted:t,onProofitProgress:t,onProofitProgressProblem:t,onProofitSubmit:t,onShortenItFinished:t,onSDUI:t,onGbRuleCreated:t,onReconnectInfo:t,onShowSurvey:t,onTouchTypistTriggerResponse:t}}i.d(t,{U:()=>n})},9637:(e,t,i)=>{i.d(t,{u:()=>a});var n=i(23988),s=i(54463),r=i(36840),o=i(80837);class a{dispose(){this._subs.dispose()}constructor(e,t=new Set){(0,n._)(this,"_events",void 0),(0,n._)(this,"_debugTools",void 0),(0,n._)(this,"_subs",void 0),(0,n._)(this,"_allMessages",void 0),this._events=e,this._debugTools=t,this._subs=new o.y.Keeper,this._allMessages=[],this._debugTools.has("captureCapiMessages")&&(this._subs.push(this._events.subscribe((e=>{s.om.is("message_sent")(e)&&this._allMessages.push({direction:"SENT",data:e.message}),s.om.is("message_received")(e)&&this._allMessages.push({direction:"RECEIVED",data:e.message})}))),(0,r.hJ)("popAllMessages",(()=>JSON.stringify(this._allMessages.splice(0,this._allMessages.length)))))}}},64014:(e,t,i)=>{i.d(t,{$:()=>B});var n=i(23988),s=i(10334),r=i(17171),o=i(84647),a=i(60575),l=i(66799),c=i(54463),d=i(91242),u=i(94855),p=i(65390),m=i(66202),h=i(58193),g=i(77396),f=i(42543),v=i(78339),_=i(15491),b=i(6987),y=i(36094),k=i(21216),S=i(14342),C=i(68594),E=i(82718),w=i(19711),A=i(62822),I=i(89769),x=i(21662),T=i(11298),F=i(68101),R=i(62723),K=i(83541),M=i(60269),O=i(52869),N=i(46669);class B{get checkingState(){return this._capi.checkingState}get asyncChecksState(){return this._capi.asyncChecksState}dispose(){this._subs.forEach((e=>e.unsubscribe()))}_updateAsyncChecksState(){this._sessionChecksState.asyncChecksState.set(this._capi.asyncChecksState)}constructor(e,t,i,B,P,D=0){(0,n._)(this,"_capi",void 0),(0,n._)(this,"events",void 0),(0,n._)(this,"_sessionChecksState",void 0),(0,n._)(this,"_log",void 0),(0,n._)(this,"_subs",void 0),(0,n._)(this,"_checkingStateInt",void 0),(0,n._)(this,"pushChanges",void 0),(0,n._)(this,"setSessionOption",void 0),(0,n._)(this,"resetReconnectInfo",void 0),(0,n._)(this,"sendFeedback",void 0),(0,n._)(this,"requestDocStats",void 0),(0,n._)(this,"requestSynonyms",void 0),(0,n._)(this,"requestSnippets",void 0),(0,n._)(this,"requestWritingExpert",void 0),(0,n._)(this,"triggerTouchTypist",void 0),(0,n._)(this,"shortenItSubmit",void 0),(0,n._)(this,"enablePlagiarismSearch",void 0),(0,n._)(this,"disablePlagiarismSearch",void 0),(0,n._)(this,"enableWritingExpert",void 0),(0,n._)(this,"disableWritingExpert",void 0),(0,n._)(this,"realtimeProofitSubmit",void 0),(0,n._)(this,"realtimeProofitCancel",void 0),(0,n._)(this,"submitRecipients",void 0),(0,n._)(this,"submitScoreSurveyResult",void 0),(0,n._)(this,"submitSurvey",void 0),(0,n._)(this,"sendUserAction",void 0),(0,n._)(this,"sendDebugReport",void 0),(0,n._)(this,"ping",void 0),(0,n._)(this,"getText",void 0),(0,n._)(this,"close",void 0),(0,n._)(this,"isClosed",void 0),(0,n._)(this,"updateContextInfo",void 0),(0,n._)(this,"setContext",void 0),(0,n._)(this,"published",void 0),(0,n._)(this,"enqueueExternalCommand",void 0),(0,n._)(this,"registerExternalMessageHandler",void 0),this._capi=e,this.events=t,this._sessionChecksState=i,this._log=a.Bx.Logging.getLogger("CheckingStateCAPIClient"),this._subs=[],this._checkingStateInt=new f.B7,this.pushChanges=e=>(0,o.pipe)(this._capi.pushChanges(e),u.Tj((e=>(this._checkingStateInt.next(this._capi.checkingState),this._updateAsyncChecksState(),e)))),this.setSessionOption=e=>(0,o.pipe)(u.oF((()=>(e.kind===l.XM.Context&&(this._sessionChecksState.score.set(p.none),this._sessionChecksState.scoreStatus.set(p.none),this._checkingStateInt.next(this._capi.checkingState)),m.right(null)))),u.cy((()=>this._capi.setSessionOption(e)))),this.resetReconnectInfo=()=>this._capi.resetReconnectInfo(),this.sendFeedback=e=>this._capi.sendFeedback(e),this.requestDocStats=()=>this._capi.requestDocStats(),this.requestSynonyms=(e,t)=>this._capi.requestSynonyms(e,t),this.requestSnippets=e=>this._capi.requestSnippets(e),this.requestWritingExpert=()=>this._capi.requestWritingExpert(),this.triggerTouchTypist=e=>this._capi.triggerTouchTypist(e),this.shortenItSubmit=e=>this._capi.shortenItSubmit(e),this.enablePlagiarismSearch=()=>this._capi.enablePlagiarismSearch(),this.disablePlagiarismSearch=()=>this._capi.disablePlagiarismSearch(),this.enableWritingExpert=()=>this._capi.enableWritingExpert(),this.disableWritingExpert=()=>this._capi.disableWritingExpert(),this.realtimeProofitSubmit=e=>this._capi.realtimeProofitSubmit(e),this.realtimeProofitCancel=()=>this._capi.realtimeProofitCancel(),this.submitRecipients=e=>this._capi.submitRecipients(e),this.submitScoreSurveyResult=(e,t)=>this._capi.submitScoreSurveyResult(e,t),this.submitSurvey=e=>this._capi.submitSurvey(e),this.sendUserAction=(e,t)=>this._capi.sendUserAction(e,t),this.sendDebugReport=(e,t)=>this._capi.sendDebugReport(e,t),this.ping=()=>this._capi.ping(),this.getText=()=>this._capi.getText(),this.close=e=>this._capi.close(e),this.isClosed=()=>this._capi.isClosed(),this.updateContextInfo=e=>this._capi.updateContextInfo(e),this.setContext=e=>this._capi.setContext(e),this.published=()=>this._capi.published(),this.enqueueExternalCommand=e=>this._capi.enqueueExternalCommand(e),this.registerExternalMessageHandler=e=>this._capi.registerExternalMessageHandler(e),this._log.debug("Constructing client with _hasAlertsCache = "+B);const L=c.om.is("session_started"),U=c.om.is("session_started","queue_msgs_dropped");this._subs.push(this.events.subscribe((e=>{"finish"===e.kind&&this._checkingStateInt.next(this._capi.checkingState)})),this.events.pipe(v.p(U),_.T(L),b.n(y.$x(k.of(void 0).pipe(S.c(1e3)))),_.T((()=>this._capi.checkingState))).subscribe(this._checkingStateInt));const j=t.pipe(v.p(L),C.i(1),E.K(t.pipe(v.p(c.om.is("finish")),w.$(),A.u(!1),I.Z(!0))),I.Z(!1)),V=this._checkingStateInt.pipe(x.E(j,((e,t)=>t&&"full"===e?"checking":e)),T.u()),$=V.pipe(F.v((e=>"full"!==e))),H=V.pipe(v.p((e=>"full"===e)),b.n((()=>$.pipe(R.z(K.timer(D),(e=>e)),I.Z("full")))));this._subs.push(t.subscribe((e=>{"text_info"===e.kind?i.textInfo.set(p.some(e.data)):"finish"===e.kind?(i.score.set(e.score),i.scoreStatus.set(e.scoreStatus)):"feedback_ack"===e.kind?((0,o.pipe)(e,p.fromPredicate(c.om.isUserFeedbackWithGeneralScore),p.map((e=>e.outcomeScores.GeneralScore)),p.map((e=>Math.trunc(100*e))),h.Mi((e=>i.score.modify((0,o.flow)(p.map((t=>(0,r._)((0,s._)({},t),{rank:e}))),h.NW(p.some({errorRateScore:0,rank:e}))))))),(0,o.pipe)(e,p.fromPredicate(c.om.isUserFeedbackWithScoreStatus),p.map((e=>e.scoreStatus)),h.Mi((e=>i.scoreStatus.set(p.some(e)))))):"async_check_finished"===e.kind&&this._updateAsyncChecksState()}))),this._subs.push(M.h($,H).pipe(O.j((e=>B&&"idle"!==e)),I.Z(P>1?B?"checking":"full":"idle"),N.F()).subscribe((e=>{this._log.debug("Switching checking state to "+e),i.checkingState.set(e),"full"===e&&g.hq(this.sendFeedback({kind:l.hN.RECHECK_SHOWN})).catch((e=>{d.Xb.isNotConnectedError(e)?this._log.error("tried to send RECHECK_SHOWN event to Capi when not connected and failed to wait for new connection",e):this._log.error("Failed to send RECHECK_SHOWN event on Capi",e)}))})))}}},77338:(e,t,i)=>{i.d(t,{_:()=>_});var n=i(23988),s=i(84647),r=i(58508),o=i(91242),a=i(66799),l=i(36840),c=i(65390),d=i(77396),u=i(94855),p=i(78339),m=i(24946),h=i(15491),g=i(36094);const f=1e4,v=200;class _{get checkingState(){return this._capi.checkingState}get asyncChecksState(){return this._capi.asyncChecksState}_untilWaitingForOT(e){return this._untilEvent(e,"wait_for_ot")}_untilFinished(e){return this._untilEvent(e,"finish")}_untilEvent(e,t){return o.Xb.isNotConnectedError(e)?(0,s.pipe)(this._events,p.p((e=>e.kind===t)),m.s(1),h.T(l.Yi),g.FM,c.some):c.none}constructor(e,t){(0,n._)(this,"_events",void 0),(0,n._)(this,"_capi",void 0),(0,n._)(this,"retryCommandWhen",void 0),(0,n._)(this,"pushChanges",void 0),(0,n._)(this,"setSessionOption",void 0),(0,n._)(this,"resetReconnectInfo",void 0),(0,n._)(this,"sendFeedback",void 0),(0,n._)(this,"requestSynonyms",void 0),(0,n._)(this,"requestSnippets",void 0),(0,n._)(this,"requestWritingExpert",void 0),(0,n._)(this,"shortenItSubmit",void 0),(0,n._)(this,"requestDocStats",void 0),(0,n._)(this,"enablePlagiarismSearch",void 0),(0,n._)(this,"disablePlagiarismSearch",void 0),(0,n._)(this,"enableWritingExpert",void 0),(0,n._)(this,"disableWritingExpert",void 0),(0,n._)(this,"triggerTouchTypist",void 0),(0,n._)(this,"realtimeProofitSubmit",void 0),(0,n._)(this,"realtimeProofitCancel",void 0),(0,n._)(this,"submitRecipients",void 0),(0,n._)(this,"submitScoreSurveyResult",void 0),(0,n._)(this,"submitSurvey",void 0),(0,n._)(this,"sendUserAction",void 0),(0,n._)(this,"sendDebugReport",void 0),(0,n._)(this,"ping",void 0),(0,n._)(this,"getText",void 0),(0,n._)(this,"close",void 0),(0,n._)(this,"isClosed",void 0),(0,n._)(this,"updateContextInfo",void 0),(0,n._)(this,"setContext",void 0),(0,n._)(this,"published",void 0),(0,n._)(this,"enqueueExternalCommand",void 0),(0,n._)(this,"registerExternalMessageHandler",void 0),this._events=e,this._capi=t,this.retryCommandWhen=(0,l.Ub)(o.zN.isDroppedError,o.MU.isTimeoutError),this.pushChanges=e=>this._capi.pushChanges(e),this.setSessionOption=e=>this._capi.setSessionOption(e),this.resetReconnectInfo=()=>this._capi.resetReconnectInfo(),this.sendFeedback=e=>{switch(e.kind){case a.DG.MUTE:case a.DG.UNMUTE:return(0,s.pipe)(d.NQ(this._capi.sendFeedback(e),(e=>this._untilWaitingForOT(e)),f),(0,o.L5)([r.Oh(2),r.Ed(v)],this.retryCommandWhen));case a.hN.RECHECK_SHOWN:return(0,s.pipe)(this._capi.sendFeedback(e),u.NW((()=>u.pG((0,l.Yi)()))));default:return this._capi.sendFeedback(e)}},this.requestSynonyms=(e,t)=>(0,s.pipe)(d.NQ(this._capi.requestSynonyms(e,t),(e=>this._untilFinished(e)),f),(0,o.L5)([r.Oh(2),r.Ed(v)],this.retryCommandWhen)),this.requestSnippets=e=>(0,s.pipe)(d.NQ(this._capi.requestSnippets(e),(e=>this._untilFinished(e)),f),(0,o.L5)([r.Oh(2),r.Ed(v)],this.retryCommandWhen)),this.requestWritingExpert=()=>(0,s.pipe)(d.NQ(this._capi.requestWritingExpert(),(e=>this._untilFinished(e)),f),(0,o.L5)([r.Oh(2),r.Ed(v)],this.retryCommandWhen)),this.shortenItSubmit=e=>(0,s.pipe)(d.NQ(this._capi.shortenItSubmit(e),(e=>this._untilFinished(e)),f),(0,o.L5)([r.Oh(2),r.Ed(v)],this.retryCommandWhen)),this.requestDocStats=(0,s.pipe)(d.NQ(this._capi.requestDocStats,(e=>this._untilFinished(e)),f),(0,o.L5)([r.Oh(2),r.Ed(v)],this.retryCommandWhen)),this.enablePlagiarismSearch=(0,s.pipe)(d.NQ(this._capi.enablePlagiarismSearch,(e=>this._untilFinished(e)),f),(0,o.L5)([r.Oh(2),r.Ed(v)],this.retryCommandWhen)),this.disablePlagiarismSearch=()=>this._capi.disablePlagiarismSearch(),this.enableWritingExpert=(0,s.pipe)(d.NQ(this._capi.enableWritingExpert,(e=>this._untilFinished(e)),f),(0,o.L5)([r.Oh(2),r.Ed(v)],this.retryCommandWhen)),this.disableWritingExpert=()=>this._capi.disableWritingExpert(),this.triggerTouchTypist=e=>this._capi.triggerTouchTypist(e),this.realtimeProofitSubmit=e=>this._capi.realtimeProofitSubmit(e),this.realtimeProofitCancel=()=>this._capi.realtimeProofitCancel(),this.submitRecipients=e=>(0,s.pipe)(d.NQ(this._capi.submitRecipients(e),(e=>this._untilFinished(e)),f),(0,o.L5)([r.Oh(2),r.Ed(v)],this.retryCommandWhen)),this.submitScoreSurveyResult=(e,t)=>this._capi.submitScoreSurveyResult(e,t),this.submitSurvey=e=>this._capi.submitSurvey(e),this.sendUserAction=(e,t)=>this._capi.sendUserAction(e,t),this.sendDebugReport=(e,t)=>this._capi.sendDebugReport(e,t),this.ping=()=>this._capi.ping(),this.getText=()=>this._capi.getText(),this.close=e=>this._capi.close(e),this.isClosed=()=>this._capi.isClosed(),this.updateContextInfo=e=>this._capi.updateContextInfo(e),this.setContext=e=>this._capi.setContext(e),this.published=()=>this._capi.published(),this.enqueueExternalCommand=e=>this._capi.enqueueExternalCommand(e),this.registerExternalMessageHandler=e=>this._capi.registerExternalMessageHandler(e)}}},11555:(e,t,i)=>{i.d(t,{d:()=>r});var n=i(77396),s=i(42543);class r{static init(e,t,i,n,o,a){const l=new s.B7;return new r(e,t,i,n,o,a,l),l}constructor(e,t,i,n,s,o,a){const l=r.NamedChangesSink.factory(a),c={pm:l(r.Receiver.PM,n),dm:l(r.Receiver.PM,s),capi:l(r.Receiver.CAPI,i),userTextEcho:l(r.Receiver.UserText,e)};r.Producer.create(r.Producer.UserText,{changes:e.changes})(c.dm,c.pm,c.capi),r.Producer.create(r.Producer.ALERT_APPLY,o)(c.userTextEcho),t.subscribe((t=>{"before_alert"===t.kind&&e.flushChanges()}))}}!function(e){let t,i,s,r;!function(e){e.DEd="denali_editor",e.UserText="user_text",e.DOX="remote_document",e.ALERT_APPLY="alert_synonyms_manager"}(t=e.Producer||(e.Producer={})),function(e){e.create=function(e,t){return(...i)=>t.changes.subscribe((t=>{i.forEach((i=>i.pushChanges(e,t)))}))}}(t=e.Producer||(e.Producer={})),function(e){e.DEd="denali_editor",e.UserText="user_text",e.DOX="remote_document",e.CAPI="checking_service",e.PM="position_manager"}(i=e.Receiver||(e.Receiver={})),function(e){function t(e,t,i){return{pushChanges:(s,r)=>{try{let o=t.pushChanges(r);"function"==typeof o&&(o=n.hq(o)),void 0!==o&&o.catch((t=>i.next({exception:t,details:{from:s,to:e}})))}catch(t){i.next({exception:t,details:{from:s,to:e}})}}}}e.factory=function(e){return(i,n)=>t(i,n,e)},e.create=t}(s=e.NamedChangesSink||(e.NamedChangesSink={})),function(e){e.create=e=>({changes:e.changes,pushChanges(t){e.pushChanges(t,"user")},getContents:()=>e.getContents(),flushChanges:()=>e.flushChanges()})}(r=e.UserTextChangesSync||(e.UserTextChangesSync={}))}(r||(r={}))},21138:(e,t,i)=>{i.d(t,{MA:()=>r,pH:()=>s,vr:()=>n});var n,s,r,o=i(10334),a=i(17171),l=i(84647),c=i(49004),d=i(88105),u=i(36840),p=i(94855),m=i(60269),h=i(21216);!function(e){e.noopSync={pushChanges:u.Yi},e.ignoreResult=function(e){return{pushChanges:t=>{e.pushChanges(t)}}},e.ignoreTEResult=function(e){return{pushChanges:(0,l.flow)(e.pushChanges,p.Tj(u.Yi))}},e.pushDeleteThenInsert=function(e){return{pushChanges:t=>{(c.lY.isDelta(t)?c.lY.fromArrayOfDeltas(d.E.splitToDeleteThenInsert(t.delta).filter(d.E.nonEmpty),t.prevLen):[t]).forEach((t=>e.pushChanges(t)))}}}}(n||(n={})),function(e){e.merge=function(e){return{changes:m.h(...e.map((e=>e.changes)))}}}(s||(s={})),function(e){e.noopSync=e=>(0,a._)((0,o._)({},n.noopSync),{changes:h.of(e)})}(r||(r={}))},69774:(e,t,i)=>{i.d(t,{K:()=>n});var n,s=i(10334),r=i(17171),o=i(80074),a=i(89769),l=i(62723),c=i(30396),d=i(36094),u=i(22814),p=i(22809),m=i(53717);!function(e){var t=e.defaultState={alerts:p.A.empty,lenses:m.x.monoid.empty};e.get=(e,n,s)=>n.pipe(a.Z(new Map),l.z(e.pipe(a.Z(p.A.empty),c.S(((e,t)=>i(t,s.lensFilters)(e)),t)),h)),e.getMock=(e,t)=>{const i=o.s.create(n.defaultState);return n.get(e,t,u.v.create(u.v.defaultLensFilters,u.v.defaultTextFilters)).subscribe(d.H9(i)),i};const i=(e,t)=>i=>{const n=p.A.Diff.toRegistered(p.A.diff(i.alerts,e));return{alerts:e,lenses:m.x.applyDiff(t)(n)(i.lenses)}},h=(e,t)=>(0,r._)((0,s._)({},t),{lenses:m.x.updatePercentiles(e)(t.lenses)})}(n||(n={}))},61606:(e,t,i)=>{i.d(t,{g:()=>s});var n=i(66799);const s={disabledFeedbacks:Object.keys(n.yp).map((e=>n.yp[e])).filter((e=>e!==n.yp.CLOSED))}},27004:(e,t,i)=>{i.d(t,{m:()=>s});var n=i(27584);const s=(e,t=0,i=0)=>{let s=null,r=null;const o=()=>{var e;null===(e=s)||void 0===e||e.unsubscribe(),s=null},a=()=>{var e;null===(e=r)||void 0===e||e.unsubscribe(),r=null};return{htmlElementHandlers:{onMouseEnter:()=>{a(),s=(0,n.O)(t).subscribe((()=>e.onHover()))},onMouseLeave:()=>{o(),r=(0,n.O)(i).subscribe((()=>{a(),e.onBlur()}))}},reset:()=>{o(),a()}}}},98514:(e,t,i)=>{i.d(t,{Jc:()=>C});var n,s,r=i(23988),o=i(38886),a=i(84647),l=i(80074),c=i(65390),d=i(83288),u=i(55172),p=i(36840),m=i(22835),h=i(58193),g=i(62597),f=i(15491),v=i(42543),_=i(30396),b=i(46669),y=i(21662),k=i(83541),S=i(45653);!function(e){const t=e=>t=>(0,a.pipe)(t,c.map((0,a.flow)(o.x1((t=>e.getAlertByMark(t))),o.di(d.contramap((({alert:{lensType:e,lensPriority:t}})=>({type:e,priority:t})))(g.J.ord)))));e.fromMarksEvents=(e,i)=>({activeHighlights:(0,a.pipe)(i.activeMarks,f.T(t(e))),hoveredHighlights:(0,a.pipe)(i.hoveredMarks,f.T(t(e)))})}(n||(n={})),function(e){e.Mock=class{constructor(){(0,r._)(this,"alertHovered",new v.B7),(0,r._)(this,"alertClicked",new v.B7),(0,r._)(this,"highlightedAlert",l.s.create(c.none))}}}(s||(s={}));class C{constructor(e,t,i,s,o,a){(0,r._)(this,"_ded",void 0),(0,r._)(this,"_markAlertMapper",void 0),(0,r._)(this,"_alertsReader",void 0),(0,r._)(this,"_activeAlertChanges",void 0),(0,r._)(this,"_alertFilter",void 0),(0,r._)(this,"_resolveClickedAlert",void 0),(0,r._)(this,"_impl",void 0),(0,r._)(this,"alertHovered",void 0),(0,r._)(this,"alertClicked",void 0),this._ded=e,this._markAlertMapper=t,this._alertsReader=i,this._activeAlertChanges=s,this._alertFilter=o,this._resolveClickedAlert=a,this._impl=new E(n.fromMarksEvents(this._markAlertMapper,this._ded),this._alertsReader,this._activeAlertChanges,this._alertFilter,this._resolveClickedAlert),this.alertHovered=this._impl.alertHovered,this.alertClicked=this._impl.alertClicked}}class E{constructor(e,t,i,n,s){(0,r._)(this,"_highlightEvents",void 0),(0,r._)(this,"_alertsReader",void 0),(0,r._)(this,"_activeAlertChanges",void 0),(0,r._)(this,"_alertFilter",void 0),(0,r._)(this,"_resolveClickedAlert",void 0),(0,r._)(this,"alertHovered",void 0),(0,r._)(this,"alertClicked",void 0),this._highlightEvents=e,this._alertsReader=t,this._activeAlertChanges=i,this._alertFilter=n,this._resolveClickedAlert=s,this.alertHovered=this._highlightEvents.hoveredHighlights.pipe(f.T(c.map(o.Tj((({alert:e})=>e)))),_.S(((e,t)=>(0,a.pipe)(t,c.chain((t=>(0,a.pipe)(e,c.filter((e=>-1!==t.indexOf(e))),c.fold((()=>c.fromNullable(t[0])),c.some)))))),c.none),f.T(c.filter((e=>this._alertsReader.isInteractable(e.id)&&!S.A.isPlagiarism(e)))),b.F()),this.alertClicked=this._highlightEvents.activeHighlights.pipe(y.E(this._activeAlertChanges,this._alertFilter),_.S(((e,[t,i,n])=>{const s=t=>(0,a.pipe)(e,c.exists((e=>e.alert.id===t.alert.id))),r=e=>(0,a.pipe)(i,c.exists((t=>t.alert.id===e.alert.id))),o=e=>n(e.alert);var l;return(0,a.pipe)(t,c.chain((e=>(0,a.pipe)(e,null!==(l=this._resolveClickedAlert)&&void 0!==l?l:u.EV([(0,p.M4)(s,r),r,(0,p.M4)(s,o),o,s]),c.fold((()=>c.fromNullable(e[0])),c.some),c.map((e=>m.yo(e,{highlightIndex:e.alert.hasNestedHighlights?0:e.highlightIndex})))))))}),h.Ie()),k.shareReplay({refCount:!0,bufferSize:1}))}}},22814:(e,t,i)=>{i.d(t,{v:()=>g});var n=i(10334),s=i(17171),r=i(92802),o=i(84647),a=i(46669),l=i(15491),c=i(36840),d=i(58193),u=i(63967),p=i(62597);const m=(0,c.M4)(u.Fc.isRegistered,(0,r.AU)(u.Fc.isMuted)),h=e=>t=>(0,c.M4)(m,e(t));var g;!function(e){e.create=function(e,t){const i=h((t=>e[t]));return{lensFilters:new Map(Object.entries(e)),alertVisibleInText:e=>h((e=>t[e]))(e),alertVisibleInSidebar:i,getLensesFilter:t=>e[t],alertCanBeDisplayed:m,alertIsBulkAcceptable:e=>(0,c.M4)(i(e),u.Fc.isBulkAcceptable)}};const t=e=>t=>e===t.lensId,i=()=>e=>(0,o.pipe)(e.freePremium,d.gR("unlocked"));e.getAlertVisibleInTextFilter=function(e,t){return t.pipe(a.F(((e,t)=>e.currentLens.id===t.currentLens.id)),l.T((t=>({filter:(0,c.Ub)(e.alertVisibleInText(t.currentLens.id),u.Fc.isBulkApplied,(e=>u.Fc.isWithTeaser(e)&&p.J.isCheetah(t.currentLens.id))),lensId:t.currentLens.id}))))};var r=e.defaultLensFilters={[p.J.SpecialId.Clarity]:t(p.J.SpecialId.Clarity),[p.J.SpecialId.Correctness]:t(p.J.SpecialId.Correctness),[p.J.SpecialId.Delivery]:t(p.J.SpecialId.Delivery),[p.J.SpecialId.Engagement]:t(p.J.SpecialId.Engagement),[p.J.SpecialId.Vox]:t(p.J.SpecialId.Vox),[p.J.SpecialId.KnowledgeHub]:t(p.J.SpecialId.KnowledgeHub),[p.J.SpecialId.FreePremiumAlerts]:(0,c.Ub)(i(),t(p.J.SpecialId.Premium)),[p.J.SpecialId.Plagiarism]:t(p.J.SpecialId.Plagiarism),[p.J.SpecialId.DraftAI]:o.constFalse,[p.J.SpecialId.Cheetah]:o.constFalse,[p.J.SpecialId.Premium]:t(p.J.SpecialId.Premium),[p.J.SpecialId.AllAlerts]:u.Fc.belongsToAllAlerts,[p.J.SpecialId.Closed]:o.constFalse,[p.J.SpecialId.PredictionTakeaways]:u.Fc.belongsToPredictionTakeaways,[p.J.SpecialId.PredictionEmogenie]:u.Fc.belongsToPredictionEmogenie,[p.J.SpecialId.RealTimeProofit]:t(p.J.SpecialId.RealTimeProofit)};e.defaultTextFilters=(0,s._)((0,n._)({},r),{[p.J.SpecialId.Closed]:u.Fc.isInline,[p.J.SpecialId.FreePremiumAlerts]:(0,c.Ub)(i(),t(p.J.SpecialId.Premium)),[p.J.SpecialId.Premium]:g.defaultLensFilters[p.J.SpecialId.Premium]})}(g||(g={}))},32260:(e,t,i)=>{i.d(t,{o:()=>n});var n,s=i(23988),r=i(84647),o=i(60575),a=i(65390),l=i(86562),c=i(36840),d=i(889),u=i(63967),p=i(22809),m=i(45653);!function(e){e.Impl=class{constructor(e,t,i,n){(0,s._)(this,"_checkingState",void 0),(0,s._)(this,"_positionManager",void 0),(0,s._)(this,"_alertsReader",void 0),(0,s._)(this,"_alertCanBeDisplayed",void 0),(0,s._)(this,"_log",void 0),(0,s._)(this,"findClosestAlertHighlight",void 0),(0,s._)(this,"findNextAlertInText",void 0),(0,s._)(this,"findPremiumAlert",void 0),this._checkingState=e,this._positionManager=t,this._alertsReader=i,this._alertCanBeDisplayed=n,this._log=o.Bx.Logging.getLogger("AlertSearchService"),this.findClosestAlertHighlight=(e,t)=>(0,r.pipe)(this._positionManager.findClosestToPosition(e,(e=>d.a.is(e)&&d.l.isVisible(e)&&!d.l.isApplied(e)&&(0,r.pipe)(this._alertsReader.getRegistered(e.meta.alertId),a.exists((i=>this._alertCanBeDisplayed(i)&&t(i)&&i.getHighlightRanges().some((t=>t.meta.id===e.meta.id))))))),a.chain((e=>(0,r.pipe)(this._alertsReader.getRegistered(e.meta.alertId),a.map((t=>{const i={alert:m.A.fromModel(t),highlightIndex:t.getHighlightRanges().findIndex((t=>t.meta.id===e.meta.id))};return i.highlightIndex<0&&(this._log.error("findClosestAlertRange returned a range which doesn't exist in alert.highlightRanges",{alert:i.alert.toString(),range:JSON.stringify(e),positionManagerRanges:JSON.stringify(this._positionManager.findRanges((e=>d.a.is(e)&&e.meta.alertId===t.id))),hasPendingRanges:t.hasNewRangesForUpdate}),i.highlightIndex=0),i})))))),this.findNextAlertInText=({alert:e,highlightIndex:t},i)=>{const n=e.getHighlightRanges();return(0,l.V1)(t<n.length,"AHI is out of highlightRanges length",`hr length: ${n.length}, ahi: ${t}`),this.findClosestAlertHighlight(n[t].end,i)},this.findPremiumAlert=()=>(0,r.pipe)(this._checkingState.get(),p.A.find((0,r.flow)(u.Fc.fromAlertModel,(0,c.M4)(u.Fc.isRegistered,u.Fc.isPremium))),a.map((e=>({alert:m.A.fromModel(e.alert),highlightIndex:0}))))}}}(n||(n={}))},37262:(e,t,i)=>{i.d(t,{h_:()=>F});var n=i(10334),s=i(17171),r=i(53397),o=i(84647),a=i(80074),l=i(60575),c=i(65390),d=i(86562),u=i(36840),p=i(58193),m=i(66202),h=i(22835),g=i(55172),f=i(62597),v=i(63967),_=i(65621),b=i(19711),y=i(15491),k=i(89769),S=i(78339),C=i(6987),E=i(83541),w=i(60269),A=i(21662),I=i(95168),x=i(36094),T=i(87275);function F(e,t){return(i,n)=>t.findClosestAlertHighlight(e(n),i)}const R=e=>e.pipe(_.J(),b.$((([e,t])=>"idle"!==e&&"idle"===t)),y.T((()=>{}))),K=e=>e.pipe(k.Z("idle"),_.J(),b.$((([e,t])=>"idle"===t)),S.p((([e])=>"full"===e)),y.T((()=>{}))),M=(e,t)=>{const i=R(e);return t.bigPaste.pipe(C.n((()=>i)),y.T((()=>{})),E.shareReplay({bufferSize:1,refCount:!0}))};var O,N;!function(e){const t=(0,u.Bj)(l.Bx.Logging.getLogger);e.focusFirstCardAfterBigCheck=(e,i,n,s,r)=>{const a=R(i),l=K(i),d=M(i,s);return(0,o.pipe)(w.h(a,l,d),A.E(e,r,n),S.p((([e,t,i,n])=>n&&!i&&T.os.hasCards(t)&&c.isNone(T.Tt.getActiveItem(t.currentLens)))),y.T((()=>T.os.Effect.FocusBehavior.focusFirst)),I.M((e=>t("AutoFocus.sideEffects.focusFirstCardAfterBigCheck").trace("emit: ",e))))},e.getSideEffect=(e,t)=>{const i=(0,o.pipe)(e,y.T((e=>t=>i=>{switch(t.kind){case T.os.Effect.FocusBehaviorType.noFocus:return i;case T.os.Effect.FocusBehaviorType.unFocus:return T.os.Prism.getLensWithItems().modify(e.unselectItem(),i);case T.os.Effect.FocusBehaviorType.focusFirst:return(0,o.pipe)(e.findFirstAlert(i.currentLens),c.fold((()=>i),(t=>T.os.Prism.getLensWithItems().modify(e.selectItemByAlert(t),i))));case T.os.Effect.FocusBehaviorType.focusNext:return(0,o.pipe)(e.findNextAlert(i.currentLens),c.fold((()=>i),(t=>T.os.Prism.getLensWithItems().modify(e.selectItemByAlert(t),i))));case T.os.Effect.FocusBehaviorType.focusAlert:return T.os.Prism.getLensWithItems().modify(e.selectItemByAlert(t.alertHighlight),i);default:(0,d.xb)(t)}})(t)));return{id:"autoFocusEffect",when:f.J.isWithAlertsId,what:T.os.Effect.ItemsApplicator.create(i)}};var i=e.whenFirstOpeningDocumentWithAlerts=e=>()=>e.firstOpeningOfDocumentWithAlerts.get(),h=e.whenShouldVerifyCurrentLens=(e,i)=>n=>{const s="AutoFocus.stateValidator.whenShouldVerifyCurrentLens";return!(!T.os.hasItems(n)||!i.shouldVerify(n.currentLens)||((0,o.pipe)(T.os.getActiveAlert(e)(n),c.filter(v.Fc.isInDuplicatedState),c.fold((()=>t(s).debug("Current alert removed, should verify current lens...")),(e=>t(s).info("Current alert removed as it's a duplicate, should verify current lens...",e.toString())))),0))},g=e.whenNoActiveCard=e=>e.currentLens.items.size>0&&c.isNone(T.Tt.getActiveItem(e.currentLens)),_=e.behaviorToEffect=e=>i=>n=>(0,o.pipe)(i(n)?e(n):c.none,p.Mi((e=>t("AutoFocus.stateValidator").debug(`'behavior triggered: ${e.kind}`))));e.getDefaultBehavior=(e,t)=>(0,o.pipe)([(0,o.pipe)(h(e,t),_((()=>c.some(T.os.Effect.FocusBehavior.focusNext))))],(0,r.fold)((0,r.getFunctionMonoid)(c.getFirstMonoid())())),e.getAlwaysFocusBehavior=(e,t)=>(0,o.pipe)([(0,o.pipe)((0,u.Ub)(g,h(e,t)),_((()=>c.some(T.os.Effect.FocusBehavior.focusNext))))],(0,r.fold)((0,r.getFunctionMonoid)(c.getFirstMonoid())())),e.getFocusFromCacheBehavior=(e,t,n,s,a,l)=>(0,o.pipe)([(0,o.pipe)(h(s,a),_((()=>c.some(T.os.Effect.FocusBehavior.focusNext)))),(0,o.pipe)((0,u.M4)((()=>t.get()),(0,u.M4)((0,u.M4)((0,u.M4)(i(n),(()=>e)),g),(0,o.pipe)(l,c.map((e=>(0,o.not)(e.willShowBulkAccept))),c.getOrElse((()=>o.constTrue))))),_((()=>c.some(T.os.Effect.FocusBehavior.focusFirst))))],(0,r.fold)((0,r.getFunctionMonoid)(c.getFirstMonoid())())),e.getFirstApiAlignmentOverride=function(){const e=a.s.create(!0);return(t,i)=>{let n=i;return e.get()&&i===v.Kz.api&&(n=v.Kz.text),e.set(!1),n}},e.getShouldAutoFocus=(e,t,i)=>n=>e.get()&&(0,o.pipe)(n,T.os.getActiveAlert(i),c.chain((({id:e})=>t.getById(e))),c.filter((0,u.Ub)((e=>"APPLIED"===e.state.type&&"ByCard"===e.state.method),v.Fc.isDuplicated,v.Fc.isCapiDone)),c.isSome),e.getStateTransformer=(e,i,r,a,l,u,p)=>({state:h,metadata:g})=>{const f=t("AutoFocus.stateTransformer");if(!T.os.hasCards(h)||!T.os.hasItems(h))return f.trace("state has no items, returning original state"),m.left({state:h,metadata:g});const v=e(h);if(f.trace("effect: ",{state:h,metadata:g,effect:v}),c.isNone(v))return f.trace("no effect selected, returning original state"),m.left({state:h,metadata:g});if(u(v.value),v.value.kind===T.os.Effect.FocusBehaviorType.unFocus||v.value.kind===T.os.Effect.FocusBehaviorType.noFocus)return m.left({state:T.os.Prism.getLensWithItems().modify(a.unselectItem(),h),metadata:g});const _=l(h);return f.trace("shouldAutoFocus",{alertSource:h.alertSource,shouldAutoFocus:_}),(0,o.pipe)(v,c.chain((e=>{switch(e.kind){case T.os.Effect.FocusBehaviorType.noFocus:case T.os.Effect.FocusBehaviorType.unFocus:return c.none;case T.os.Effect.FocusBehaviorType.focusFirst:return(0,o.pipe)(a.findFirstAlert(h.currentLens),c.map((e=>(0,s._)((0,n._)({},e),{lensId:h.currentLens.id}))));case T.os.Effect.FocusBehaviorType.focusNext:return i(h);case T.os.Effect.FocusBehaviorType.focusAlert:return c.some((0,s._)((0,n._)({},e.alertHighlight),{lensId:h.currentLens.id}));default:(0,d.xb)(e)}})),c.map((e=>((0,d.V1)(c.isSome(r.getRegistered(e.alert.id)),"lens alert should be in registered state",(()=>e.alert.toString())),e))),c.fold((()=>(f.trace("no alert selected, returning original state"),h.currentLens.kind===T.Iw.active?m.right(m.right({lensId:p.get(),alertSource:h.alertSource,options:{order:h.switchOrder,toFocus:T.os.Effect.FocusBehavior.noFocus}})):m.left({state:h,metadata:g}))),(({alert:e,highlightIndex:t,lensId:i})=>{if(f.trace("selected alert to focus",e),h.currentLens.meta.filter(e)){if(_){const i={alert:e,highlightIndex:t};return(0,o.pipe)(h.currentLens.items.find(a.hasAlert(e.id)),c.fold((()=>(f.trace("shouldAutoFocus: true, no such item in a lens for given alert",e.id),m.left({state:h,metadata:g}))),(()=>(f.trace("shouldAutoFocus: true, selecting alert"),m.left({state:T.os.Prism.getLensWithItems().modify(a.selectItemByAlert(i),h),metadata:{sourceId:"LSM.updateActiveState"}})))))}return f.trace("shouldAutoFocus: false"),m.left({state:h,metadata:g})}return f.trace("alert is not from current lens, recreating lens view"),m.right(_?m.left({alertHighlight:{alert:e,highlightIndex:t},alertSource:h.alertSource,options:{lensId:i,order:h.switchOrder,toFocus:T.os.Effect.FocusBehavior.focusFirst}}):m.right({lensId:i,alertSource:h.alertSource,options:{order:h.switchOrder,toFocus:T.os.Effect.FocusBehavior.noFocus}}))})))}}(O||(O={})),function(e){const t=e=>t=>i=>{switch(t.kind){case T.os.Effect.FocusBehaviorType.noFocus:return i;case T.os.Effect.FocusBehaviorType.unFocus:return T.os.Prism.getLensWithItems().modify(e.unselectItem(),i);case T.os.Effect.FocusBehaviorType.focusFirst:return(0,o.pipe)(i.currentLens.items.find((0,o.not)(e.isScheduledToDispose)),c.map(h.Up("value")),c.fold((0,o.constant)(i),(t=>T.os.Prism.getLensWithItems().modify(e.selectItemById(t.id),i))));case T.os.Effect.FocusBehaviorType.focusNext:return(0,o.pipe)(i.currentLens.cardIndex,c.chain((t=>(0,o.pipe)(g.rq(i.currentLens.items.values(),t,c.fromPredicate((0,o.not)(e.isScheduledToDispose))),c.map(h.Up("value"))))),c.fold((0,o.constant)(i),(t=>T.os.Prism.getLensWithItems().modify(e.selectItemById(t.id),i))));case T.os.Effect.FocusBehaviorType.focusAlert:return T.os.Prism.getLensWithItems().modify(e.selectItemByAlert(t.alertHighlight),i);default:(0,d.xb)(t)}},i=(0,u.Bj)(l.Bx.Logging.getLogger);e.focusFirstCardAfterBigCheck=(e,t,n,s)=>{const r=R(t),a=K(t),l=M(t,s);return(0,o.pipe)(w.h(r,a,l),C.n(x._F.rafScheduler),C.n(x._F.rafScheduler),A.E(e,n),S.p((([e,t,i])=>i&&T.os.hasCards(t)&&c.isNone(T.Tt.getActiveItem(t.currentLens)))),y.T((()=>T.os.Effect.FocusBehavior.focusFirst)),I.M((e=>i("AutoFocus.sideEffects.focusFirstCardAfterBigCheck").trace("emit: ",e))))},e.getSideEffect=(e,i)=>{const n=(0,o.pipe)(e,y.T(t(i)));return{id:"sduiAutoFocusEffect",when:f.J.isWithAlertsId,what:T.os.Effect.ItemsApplicator.create(n)}},e.getShouldAutoFocus=(e,t,i)=>n=>e.get()&&(0,o.pipe)(n,T.os.getActiveAlert(i),c.chain((({id:e})=>t.getById(e))),c.filter((0,u.Ub)((e=>!("REMOVED"===e.state.type&&"textChange"===e.state.reason)),v.Fc.isDuplicated,v.Fc.isCapiDone)),c.isSome),e.getStateTransformer=(e,r,a,d,u,p)=>({state:h,metadata:g})=>{const f=i("AutoFocus.stateTransformer",l.y7.$.TRACE);if(!T.os.hasCards(h)||!T.os.hasItems(h))return f.trace("state has no items, returning original state"),m.left({state:h,metadata:g});const v=e(h);if(c.isNone(v))return f.trace("no effect selected, returning original state"),m.left({state:h,metadata:g});if(f.trace("effect: ",{state:h,metadata:g,effect:v}),u(v.value),v.value.kind===T.os.Effect.FocusBehaviorType.unFocus||v.value.kind===T.os.Effect.FocusBehaviorType.noFocus)return m.left({state:T.os.Prism.getLensWithItems().modify(a.unselectItem(),h),metadata:g});const _=d(h);return f.trace("shouldAutoFocus",{alertSource:h.alertSource,shouldAutoFocus:_}),(0,o.pipe)(v,c.map((e=>({effect:e,applicator:t(a)}))),c.fold((()=>(f.trace("no effect selected, returning original state"),h.currentLens.kind===T.Iw.active?m.right(m.right({lensId:p.get(),alertSource:h.alertSource,options:{order:h.switchOrder,toFocus:T.os.Effect.FocusBehavior.noFocus}})):m.left({state:h,metadata:g}))),(({effect:e,applicator:t})=>{f.trace(`effect selected: ${e.kind}`);const i=t(e)(h);return _?(f.trace("shouldAutoFocus: true, selecting an item in the lens"),m.left({state:i,metadata:{sourceId:"LSM.updateActiveState"}})):(f.trace("current lens is empty"),e.kind===T.os.Effect.FocusBehaviorType.focusNext?(f.trace("no items to select in the current lens, trying to switch"),(0,o.pipe)(h,r,c.fold((()=>(f.trace("next alert not found in other lenses, reset cardIndex"),m.left({state:h.patch({currentLens:(0,s._)((0,n._)({},h.currentLens),{cardIndex:c.none})}),metadata:{sourceId:"LSM.updateActiveState"}}))),(({lensId:e})=>(f.trace(`found next alert in lens: ${e}. Switching the lens`),m.right(m.right({lensId:e,alertSource:h.alertSource,options:{order:h.switchOrder,toFocus:T.os.Effect.FocusBehavior.noFocus}}))))))):(f.trace("shouldAutoFocus: false"),m.left({state:h,metadata:g})))})))}}(N||(N={}))},40808:(e,t,i)=>{i.d(t,{M7:()=>B,cm:()=>N});var n,s=i(38886),r=i(65011),o=i(84647),a=i(60575),l=i(66799),c=i(86562),d=i(66202),u=i(59042),p=i(65390),m=i(63967),h=i(62597),g=i(22809),f=i(95168),v=i(78339),_=i(15491),b=i(68533),y=i(62822),k=i(19711),S=i(82718),C=i(7323),E=i(11298),w=i(6987),A=i(36094),I=i(65621),x=i(88423),T=i(90405),F=i(80159),R=i(60269),K=i(92141);!function(e){let t;!function(e){e.apply="apply",e.dismiss="dismiss",e.bulkUndo="bulkUndo",e.ignore="ignore",e.highlight="highlight",e.individualUndo="individualUndo",e.confirmed="confirmed",e.confirmedAll="confirmedAll"}(t=e.Kind||(e.Kind={})),e.isApply=function(e){return e.kind===t.apply},e.isBulkUndo=function(e){return e.kind===t.bulkUndo},e.isConfirmAll=function(e){return e.kind===t.confirmedAll},e.isHighlight=function(e){return e.kind===t.highlight},e.isIndividualUndo=function(e){return e.kind===t.individualUndo},e.create=(e,i)=>R.h(e.pipe(v.p(K.X9.isBulkAction),_.T((e=>{switch(e.type){case K.X9.Type.bulkApply:return{kind:t.apply,alertIds:e.alertIds};case K.X9.Type.bulkDismiss:return{kind:t.dismiss};case K.X9.Type.bulkHighlight:return{kind:t.highlight,alert:e.alert,clickPoint:e.clickPoint};case K.X9.Type.bulkIgnore:return{kind:t.ignore,alertId:e.alertId};case K.X9.Type.bulkIndividualUndo:return{kind:t.individualUndo,alertId:e.alertId};case K.X9.Type.bulkLooksGood:return{kind:t.confirmedAll,alertIds:e.alertIds};case K.X9.Type.bulkUndo:return{kind:t.bulkUndo,alertIds:e.alertIds};default:(0,c.xb)(e)}}))),i.pipe(v.p(F.G.isBulkAction),_.T((e=>{switch(e.type){case F.G.Type.confirmed:return{kind:t.confirmed,alertId:e.alertId};case F.G.Type.undone:return{kind:t.individualUndo,alertId:e.alertHighlight.alert.id};default:(0,c.xb)(e)}}))))}(n||(n={}));var M=i(45653),O=i(87275);const N=e=>{const t=e[0];switch((0,c.V1)(void 0!==t,"undoables should had at least one item"),t.action){case l.yp.IGNORE:return{kind:"ignore"};case l.yp.ADD_TO_DICTIONARY:return{kind:"addToDictionary",word:t.replacement};case l.yp.WRONG_SUGGESTION:case l.yp.OFFENSIVE_CONTENT:return{kind:"report"};case l.yp.ACCEPTED:return e.length>1?{kind:"bulkAccept",count:e.length}:{kind:"replace",word:t.replacement};case l.Fc.SYNONYM_ACCEPTED:return{kind:"replaceSynonym"};case l.yj.DISMISS_BY_LENS:return{kind:"ignoreAll",alerts:e.length};case l.yp.LIKE:return{kind:"markAsHelpful"};case l.yp.DISLIKE:return{kind:"markAsNotHelpful"};case l.yp.ACKNOWLEDGED:return{kind:"acknowledge"};default:throw new Error("Invalid undoable action "+t.action)}};function B(e,t,i){return e().pipe(f.M((e=>{"closedByUser"===e&&t()})),v.p((e=>"shown"!==e)),_.T((e=>["undo","bulkUndo"].includes(e)?e:"commit")),b.h(i().pipe(y.u("commit"))),k.$())}var P,D,L;function U(e,t){return[{id:`${e}_showUndoNotifications`,when:o.constTrue,what:O.os.Effect.Applicator.create(t.pipe(S.K(C.t)))},{id:`${e}_changeLensWhenThereWasNoPreviouslyFocusedAlert`,when:e=>e!==h.J.SpecialId.Closed,what:O.os.Effect.SwitchLens.create(t.pipe(v.p((e=>p.isNone(e.previouslyFocused))),_.T((({lensId:e})=>({lensId:e,alertSource:m.Kz.sidebar,options:{toFocus:O.os.Effect.FocusBehavior.noFocus}})))))},{id:`${e}_focusPreviouslyActiveAlert`,when:e=>e!==h.J.SpecialId.Closed,what:O.os.Effect.SwitchAlert.create(t.pipe(_.T((e=>(0,o.pipe)(e.previouslyFocused,p.map((t=>({alertHighlight:t,alertSource:m.Kz.sidebar,options:{lensId:e.lensId}})))))),T.oE))}]}function j(e){return!m.Fc.isCitationDetection(e)}function V(e,t,i){return(0,o.pipe)(e,p.map((e=>{const n=t.find((t=>t.id===e.activeAlert.id));return(0,c.V1)(void 0!==n,"Undone alerts should contain previously focused alert",e.activeAlert.id),(0,c.V1)((0,o.pipe)(i.getById(n.id),p.isSome),"Undone alerts should exist in alert list",n.id),(0,c.V1)(m.Fc.isRegistered(n),"Undoed alert should be in registered state",(()=>String(n))),{alert:M.A.fromModel(n),highlightIndex:e.activeHighlightIndex}})))}!function(e){e.create=function(e,t,i){return U("individual_undo_applied",e.pipe(v.p(n.isIndividualUndo),f.M((({alertId:e})=>(0,o.pipe)(e,t.getById,d.fromOption((()=>new c.zU("Could not find alert by id while processing individual undo event",e))),d.filterOrElse(m.Fc.isApplied,(e=>new c.zU("Alert is not in the applied state",e.toString()))),d.chain((e=>i.undoApplied([e],m.Fc.State.Applied.Method.Bulk)())),d.getOrElse((e=>a.Bx.Logging.getLogger("BulkAcceptedIndividualUndoSideEffect").error("Could not process an individual undo event",e)))))),S.K(C.t),E.u()))}}(P||(P={})),function(e){e.create=function(e,t,i,r){return U("bulk_undo_applied",e.pipe(v.p(n.isBulkUndo),w.n(A._F.rafScheduler),_.T((({alertIds:e})=>e.map(t.getById))),_.T(s.oE),f.M((e=>{(0,o.pipe)(i.undoApplied(e,m.Fc.State.Applied.Method.Bulk)(),d.fold((e=>a.Bx.Logging.getLogger("BulkUndoSideEffect").error("Could not perform bulk undo",e)),(()=>r.onBulkUndo(e.length))))})),S.K(C.t),E.u()))}}(D||(D={})),function(e){e.create=function(e,t,i,n,a,l){return U("undo_applied",e.state.pipe(I.J(),_.T((([e,t])=>(0,o.pipe)(g.A.diff(e,t),u.b.reduce([],o.identity,((e,t)=>(m.Fc.isApplied(t.alert)&&!m.Fc.isBulkApplied(t.alert)&&e.push(t.alert),e)),o.identity)))),_.T((0,o.flow)(s.pb(j),s.Tj((e=>(0,o.pipe)(e.takeReference("undoNotification"),d.bimap((t=>(0,o.tuple)(e,t)),(t=>(0,o.tuple)(e,t)))))))),_.T(s.sj),_.T((({left:e,right:t})=>(s.J_(e)&&l.warn("can not take alertRef",e),t))),v.p(s.J_),w.n((s=>{const c=i.get(),u=s.map((([e])=>e)),h=u.map((e=>e.state.undoable)),g=s.map(r.gp);return a(h).pipe(_.T((i=>"undo"===i?(0,o.pipe)(e.undoApplied(u,m.Fc.State.Applied.Method.ByCard)(),d.fold((e=>(l.error("Got error during undo",e),p.none)),(()=>O.os.hasCards(c)?p.some({lensId:c.currentLens.id,previouslyFocused:V(O.os.getActiveItem(n)(c),u,t)}):p.none))):p.none)),x.j((()=>g.forEach((e=>e.dispose())))),T.oE)})),E.u()))}}(L||(L={}))},49470:(e,t,i)=>{i.d(t,{kr:()=>x,uF:()=>I});var n,s=i(10334),r=i(50659),o=i(87574),a=i(19840),l=i(86562),c=(i(80300),i(86922)),d=i(19967),u=i(76099),p=i(27917),m=i(19772),h=i(46669),g=i(21662),f=i(95168),v=i(62723),_=i(89769),b=i(92141),y=i(79334),k=i(97291),S=i(70751),C=i(36840),E=i(24290),w=i(21216),A=i(15491);!function(e){var t=e.OutcomeContext=r.createContext({navigateToAllAlerts:C.Yi});e.BackToAllAlertsButton=({density:e=w.of("cozy")})=>{const{backToAllAlerts:i}=r.useContext(c.S.Context).sidebar;return r.createElement(t.Consumer,null,(({navigateToAllAlerts:t})=>r.createElement(d.$n.Flat,{name:"to-all-alerts",tag:E.f.div,className:S.j.toAllAlertsButton,onClick:t,"aria-label":e.pipe(A.T((e=>"compact"===e?i:void 0)))},e.pipe(A.T((e=>"cozy"===e&&r.createElement("span",{className:S.j.toAllAlertsText},i)))),r.createElement(p.In.Close,{width:13}))))}}(n||(n={}));const I=n.OutcomeContext;var x;!function(e){e.SeeAlerts=({cardsViewportState:e,actionEvents:t,cardsAmount:i})=>{const n=r.useContext(c.S.Context).sidebar;return m.R.useSubscriptionTo(e.pipe(h.F(),g.E(i),f.M((([e,i])=>{switch(e){case y.X$.above:case y.X$.below:t.next({type:b.X9.Type.moreAlertsButtonShow,position:e,cardsAmount:i});break;case y.X$.hidden:break;default:(0,l.xb)(e)}})))),r.createElement(o.F.Fragment,null,e.pipe(h.F(),v.z(i,((e,i)=>{switch(e){case y.X$.above:return r.createElement("div",{className:S.j.seeAlertsContainer},r.createElement(d.$n.Primary,{name:"top-see-alerts",className:S.j.topSeeAlerts,onClick:()=>t.next({type:b.X9.Type.switchToClosestByViewport,position:e,cardsAmount:i})},n.seeAlerts(i),r.createElement(p.In.Arrow,{width:"12",direction:p.bO.up})),r.createElement("div",{className:S.j.topStack}));case y.X$.below:return r.createElement("div",{className:S.j.seeAlertsContainer},r.createElement(d.$n.Primary,{name:"bottom-see-alerts",className:S.j.bottomSeeAlerts,onClick:()=>t.next({type:b.X9.Type.switchToClosestByViewport,position:e,cardsAmount:i})},n.seeAlerts(i),r.createElement(p.In.Arrow,{width:"12",direction:p.bO.down})),r.createElement("div",{className:S.j.bottomStack}));case y.X$.hidden:return null;default:return(0,l.xb)(e)}})),_.Z(null)))},e.Rechecking=({className:e})=>r.createElement(o.F.div,(0,s._)({key:"lensview-loader"},(0,a.Ly)(e,S.j.rechecking)),r.createElement(k.$6,null)),e.FixedContent=({onTransitionEnd:e,label:t,children:i})=>r.createElement(u.D.Top,{onTransitionEnd:e,className:S.j.fixedLensContent,"aria-label":t,role:"region"},i)}(x||(x={}))},70751:(e,t,i)=>{i.d(t,{j:()=>P});var n=i(13607),s=i(27199),r=i(11864),o=i(43292);const a=4.15,l=n.o1-.5,c="0 3px 7px 0 rgba(129, 137, 169, .2)",d="0 -3px 7px 0 rgba(129, 137, 169, .2)",u={marginTop:0,height:r.Ks.percent(100)},p={position:"absolute",overflow:"hidden",marginTop:0,marginLeft:r.Ks.rem(-1*l),paddingTop:r.Ks.rem(4),paddingRight:r.Ks.rem(2),paddingLeft:r.Ks.rem(l),width:`calc(100% + ${r.Ks.rem(l)})`,height:r.Ks.percent(100)},m={position:"absolute",top:r.Ks.rem(n.xl),visibility:"hidden",height:`calc(100vh - ${r.Ks.rem(n.xl)})`},h={paddingRight:r.Ks.rem(2),width:r.Ks.percent(100),height:r.Ks.percent(100)},g={zIndex:n.k2,width:r.Ks.rem(n.NE),$nest:{[`@media (${n.P9})`]:{width:r.Ks.rem(n.rQ)},[`@media (${n.oB})`]:{width:r.Ks.rem(n.gx)},[`@media (${n.ri})`]:{width:r.Ks.rem(n.Bi)}}},f={width:r.Ks.rem(27)},v={margin:`0 ${r.Ks.rem(.25)} 0 auto`,lineHeight:r.Ks.rem(1.8)},_={marginRight:r.Ks.rem(1)},b={position:"relative",paddingTop:r.Ks.rem(1),height:r.Ks.rem(a),background:`linear-gradient(-180deg, ${s.Q1.CoreNeutral0} 78%, rgba(255, 255, 255, 0) 100%)`,$nest:{"&:before":{position:"absolute",top:0,left:r.Ks.rem(-2),width:r.Ks.rem(2),height:r.Ks.percent(100),background:"inherit",content:"''"}}},y={paddingBottom:r.Ks.rem(.2)},k={maxWidth:r.Ks.rem(11),textAlign:"center",whiteSpace:"normal",lineHeight:r.Ks.rem(1)},S={position:"absolute",right:0,left:0,display:"flex",height:r.Ks.rem(2),background:s.Q1.CoreNeutral0,alignItems:"center",justifyContent:"center"},C={top:r.Ks.rem(-1.15),boxShadow:c,$nest:{"&:before":(0,o.k)(r.Ks.rem(.25),-10,r.Ks.rem(-.4),c,r.Ks.rem(n.OC)),"&:after":(0,o.k)(r.Ks.rem(.5),-20,r.Ks.rem(-.8),c,r.Ks.rem(n.OC))}},E={bottom:0,boxShadow:d,$nest:{"&:before":(0,o.k)(r.Ks.rem(.25),-10,r.Ks.rem(.4),d,r.Ks.rem(n.OC)),"&:after":(0,o.k)(r.Ks.rem(.5),-20,r.Ks.rem(.8),d,r.Ks.rem(n.OC))}},w={position:"absolute",zIndex:n.yg,display:"flex",pointerEvents:"all"},A={top:r.Ks.rem(.15)},I={bottom:r.Ks.rem(1.3)},x={position:"absolute",top:r.Ks.rem(a),display:"flex",width:`calc(100% - ${r.Ks.rem(2)})`,height:`calc(100vh - ${r.Ks.rem(a)})`,pointerEvents:"none",justifyContent:"center"},T=r.Ks.rem(2),F={paddingRight:T},R={display:"flex",marginTop:r.Ks.rem(.8125),marginLeft:r.Ks.rem(2.1875),paddingRight:T,color:s.Q1.CoreNeutral90,textTransform:"none",letterSpacing:0,fontWeight:"bold",fontSize:r.Ks.rem(.875),lineHeight:r.Ks.rem(1.125),justifyContent:"space-between",$nest:{'& div[role="button"]':{marginTop:r.Ks.rem(-.3875),$nest:{"&[data-name='bulk-accept-mini-button']":{marginTop:r.Ks.rem(-.75)}}},'& div[data-role="counter"]':{position:r.Ks.important("absolute")},"& h2":{fontSize:r.Ks.rem(.875),margin:0}}},K={position:"absolute",zIndex:n.k2,overflow:"visible",width:r.Ks.percent(100)},M={position:"absolute",right:r.Ks.rem(3),paddingLeft:r.Ks.rem(1),borderRadius:r.Ks.rem(n.H0),color:s.Q1.CoreNeutral90,letterSpacing:r.Ks.px(.25),fontSize:r.Ks.rem(.75),lineHeight:r.Ks.rem(1),$nest:{"@media (max-width: 840px)":{paddingLeft:0,$nest:{"& > span":{display:"none"}}}}},O={position:"relative",marginTop:r.Ks.rem(.05),fontWeight:300},N={marginLeft:r.Ks.rem(2.5)},B={margin:`${r.Ks.rem(.5)} 0`,backgroundColor:s.Q1.CoreNeutral0,userSelect:"none",$nest:{"&:before":{position:"absolute",left:r.Ks.rem(-.5),width:r.Ks.rem(.5),height:r.Ks.percent(100),backgroundColor:s.Q1.CoreNeutral0,content:"''"}}},P=r.Ks.stylesheet({viewport:[u],lensviewContentWrapper:[p],fakeTop:[m],rechecking:[h],fixedLensContent:[g],splitSharedAssistantsLensContent:[g,f],lensCounter:[v],headerBtn:[_],headerWrapper:[b],infoIcon:[y],infoTooltip:[k],stack:[S],topStack:[S,C],bottomStack:[S,E],seeAlerts:[w],topSeeAlerts:[w,A],bottomSeeAlerts:[w,I],seeAlertsContainer:[x],lensTitle:[R],header:[K],toAllAlertsButton:[M],toAllAlertsText:[O],plagiarismLensTitle:[R,N],cardWrapper:[B],flexContainer:[{display:"flex"}],priorityTitleWrapper:[F]})},12070:(e,t,i)=>{i.d(t,{h:()=>x});var n=i(10334),s=i(17171),r=i(50659),o=i(84647),a=i(80074),l=i(87574),c=i(34980),d=i(65390),u=i(41548),p=i(35098),m=i(19772),h=i(60269),g=i(95168),f=i(68533),v=i(62723),_=i(68594),b=i(6987),y=i(54988),k=i(36094),S=i(78339),C=i(65141),E=i(15491),w=i(39946),A=i(82315);const I=e=>{const t=r.useContext(p.L.Context).pipe(E.T((e=>e.rect))),{visibilityOverlay:i,customStyles:I,onboardingStep:x}=function({stepId:e,onboardingViewModel:t,denaliEditorModel:i,getFirstTargetRect:l,overlay:p,completionTrigger:E},w){const A=r.useContext(u.q.Context),I=a.s.create({display:"none",pointerEvents:"none"}),x=a.s.create(!1),T=t.subscribeForStep(e),F=a.s.create(d.none);return m.R.useSubscriptionTo(h.h(T.state.pipe(g.M((e=>{"popup"!==e&&"popover"!==e||!p||x.set(!0),I.modify((t=>(0,s._)((0,n._)({},t),{pointerEvents:"dot"===e?"all":"none"})))})),f.h(i.changes,w),v.z(A,F.pipe(_.i(1))),g.M((([e,t,r])=>((e,t)=>requestAnimationFrame((()=>{i.flushChanges(),(0,o.pipe)(t,d.map(c.W.relativeToRoot),d.fold((()=>{I.set({display:"none"})}),(({top:t,left:i,width:r,height:o})=>{I.modify((a=>(0,s._)((0,n._)({},a),{position:"absolute",left:i/e+"rem",top:t/e+"rem",width:r/e+"rem",height:o/e+"rem",display:"block"})))})))})))(t,r)))),T.state.view((e=>"dot"===e||"popup"===e||"popover"===e)).pipe(b.n((e=>e?l():y.w)),g.M(k.H9(F))),h.h(k.vh(x.pipe(_.i(1),S.p((e=>!e))))(!!p),E).pipe(g.M(t.getStepCompletionCallback(e))),x.pipe(b.n(k.vh(C.R(document,"click",{capture:!0,passive:!0}))),g.M((()=>x.set(!1)))))),{visibilityOverlay:x,customStyles:I,onboardingStep:T}}(e,t);return r.createElement(r.Fragment,null,e.overlay&&e.overlay(i),r.createElement("div",{className:w.c.editor},r.createElement(l.F.div,{style:I,className:w.c.onboardingPopup},r.createElement(A.UX,(0,s._)((0,n._)({},e),{onboardingStep:x,viewportRect:t,eventType:"none"}),r.createElement(l.F.div,{style:I.view((({width:e,height:t})=>({width:e,height:t})))})))))},x=e=>e.onboardingViewModel.isStepEnabled(e.stepId)?r.createElement(I,e):null},86284:(e,t,i)=>{i.d(t,{G:()=>a});var n=i(19147),s=i(23988),r=i(49165),o=function e(t,i){var r=this;(0,n._)(this,e),(0,s._)(this,"_innerWSHandler",void 0),(0,s._)(this,"_dlpDataSanitizer",void 0),(0,s._)(this,"onConnecting",void 0),(0,s._)(this,"onConnect",void 0),(0,s._)(this,"onDisconnect",void 0),(0,s._)(this,"onMessage",void 0),(0,s._)(this,"connect",void 0),(0,s._)(this,"isDisconnected",void 0),this._innerWSHandler=t,this._dlpDataSanitizer=i,this.onConnecting=function(e){return r._innerWSHandler.onConnecting(e),r},this.onConnect=function(e){return r._innerWSHandler.onConnect(e),r},this.onDisconnect=function(e){return r._innerWSHandler.onDisconnect((function(t){return r._dlpDataSanitizer.clear(),e(t)})),r},this.onMessage=function(e){return r._innerWSHandler.onMessage((function(t,i){e(t,r._dlpDataSanitizer.unsanitizeMessage(i))})),r},this.connect=function(e){return r._innerWSHandler.connect(e)},this.isDisconnected=function(){return r._innerWSHandler.isDisconnected()}},a=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.Wm,i=arguments.length>1?arguments[1]:void 0,a=this;(0,n._)(this,e),(0,s._)(this,"_dlpDataSanitizer",void 0),(0,s._)(this,"sanitizeWS",(function(e,t){return e.writer((function(e){return t(a._dlpDataSanitizer.sanitizeMessage(e))}))})),(0,s._)(this,"sanitizeStaticWS",(function(e,t){return e.writer((function(e){return t(a._dlpDataSanitizer.sanitizeStaticMessage(e))}))})),(0,s._)(this,"sanitizeWSHandler",(function(e){return new o(e,a._dlpDataSanitizer)})),this._dlpDataSanitizer=new r.oQ(t,i)}},35240:(e,t,i)=>{i.d(t,{r:()=>n});var n="4.0.7"},31044:(e,t,i)=>{var n;i.d(t,{Z:()=>n}),function(e){e.Inline="inline",e.Popover="popover",e.Short="short",e.Long="long",e.StandalonePlagiarism="standalone-plagiarism"}(n||(n={}))},67739:(e,t,i)=>{i.d(t,{c:()=>x});var n=i(84647),s=i(66799),r=i(54463),o=i(63967),a=i(88761),l=i(22809),c=i(80837),d=i(65621),u=i(15491),p=i(78339),m=i(36840),h=i(65390),g=i(59042),f=i(38886),v=i(60575),_=i(77413),b=i(78930),y=i(2855),k=i(60336),S=i(94146);function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function E(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function w(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function A(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var n,s,r=[],o=!0,a=!1;try{for(i=i.call(e);!(o=(n=i.next()).done)&&(r.push(n.value),!t||r.length!==t);o=!0);}catch(e){a=!0,s=e}finally{try{o||null==i.return||i.return()}finally{if(a)throw s}}return r}}(e,t)||I(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e,t){if(e){if("string"==typeof e)return C(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(i):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?C(e,t):void 0}}var x=function(){function e(t,i,E){var A=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new S.n,x=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),w(this,"_getByRawAlertId",void 0),w(this,"popoverManager",void 0),w(this,"state",void 0),w(this,"_sduiManager",void 0),w(this,"_subs",void 0),w(this,"_log",void 0),w(this,"alertIdResolver",void 0),w(this,"findFirstCardWithContent",void 0),w(this,"onSessionStarted",void 0),w(this,"onFirstCheckingFinished",void 0),w(this,"notifyAlertsChanged",void 0),w(this,"loadItems",void 0),w(this,"_toRemovedAlertIdsByClient",void 0),this._getByRawAlertId=E,this.popoverManager=A,this._subs=new c.y.Keeper,this._log=v.Bx.Logging.getLogger("SDUIManager",v.y7.$.TRACE,v.y7.I.Manager.getColor()),this.findFirstCardWithContent=function(e){return x._sduiManager.findFirstCardWithContent(e)},this.onSessionStarted=function(){return x._sduiManager.onSessionStarted()},this.onFirstCheckingFinished=function(){return x._sduiManager.onFirstCheckingFinished()},this.notifyAlertsChanged=function(){return x._sduiManager.notifyAlertsChanged()},this.loadItems=function(e){return x._sduiManager.loadItems(e)},this._toRemovedAlertIdsByClient=function(e){var t=function(e,t,i){return(0,m.Ub)(o.Fc.isRemovedByTextChange,o.Fc.isDuplicated)(t.alert)?(0,n.pipe)(i,h.fromNullable,h.chain((function(e){return e.alert.rawId})),h.alt((function(){return t.alert.rawId})),h.fold((function(){return e}),(function(i){var n,s,r=o.Fc.isRemovedByTextChange(t.alert)?b.BG.TextChange:b.BG.RemoveDuplicate;return x._log.debug("[Optimistic update] alert ".concat(o.Fc.State.Type.REMOVED," by ").concat(r," ").concat(a.Y.show.show(t))),e.set(r,(s=null!==(n=e.get(r))&&void 0!==n?n:[],function(e){if(Array.isArray(e))return C(e)}(s)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(s)||I(s)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).concat([y.W.AlertId.from(i)]))}))):e};return e.pipe(d.J(),u.T((0,n.tupled)(l.A.diff)),u.T((function(e){return g.b.reduce(new Map,(function(e,i){return t(e,i)}),(function(e,i,n){return t(e,n,i)}),n.identity)(e)})),p.p((function(e){return(0,n.pipe)(Array.from(e.values()),f.Bq,(0,m.AU)(f.Im))})))};var T=i.pipe(p.p(k.Q.isSduiEvent),u.T(b.nK.fromSource(b.BG.CAPI))),F=(0,n.flow)(s.tI.Id.create,this._getByRawAlertId,h.map((function(e){return y.W.AlertId.from(e.id)})));this._sduiManager=new _.Z(T,F,A),this.alertIdResolver=F,this.state=this._sduiManager.state,this._subs.push(t.subscribe((function(e){return x._sduiManager.notifyAlertsChanged()})),this._toRemovedAlertIdsByClient(t).subscribe((function(e){return e.forEach((function(e,t){return x.pushRemovedAlerts([e,t])}))})),i.pipe(p.p(r.om.is("session_started")),p.p((function(e){return e.isNewSession}))).subscribe((function(e){return x._sduiManager.onSessionStarted()})),i.pipe(p.p(r.om.is("finish")),p.p((function(e){return 0===e.revision}))).subscribe((function(e){return x._sduiManager.onFirstCheckingFinished()})))}var t,i;return t=e,(i=[{key:"onAlertsRefEmpty",get:function(){return this._sduiManager.onAlertsRefEmpty}},{key:"pushRemovedRoot",value:function(e){this._sduiManager.pushRemovedRoot(e)}},{key:"pushRemovedAlerts",value:function(e){var t=A(e,2),i=t[0],n=t[1];this._sduiManager.pushRemovedAlerts([i,n])}},{key:"pushRemovedDenaliAlerts",value:function(e){var t=A(e,2),i=t[0],n=t[1];this._sduiManager.pushRemovedAlerts([i.map(y.W.AlertId.from),n])}},{key:"pushSwitchView",value:function(e){this._sduiManager.pushSwitchView(e)}},{key:"resolveStrongAlertRefAlerts",value:function(e){return this._sduiManager.resolveStrongAlertRefAlerts(e)}},{key:"flush",value:function(){this._sduiManager.flush()}},{key:"dispose",value:function(){this._subs.dispose(),this._sduiManager.dispose()}}])&&E(t.prototype,i),e}()},39061:(e,t,i)=>{i.d(t,{G:()=>c});var n=i(84647),s=i(91242),r=i(77396),o=i(60575);function a(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var c=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),l(this,"_capiSDUIClient",void 0),l(this,"_log",void 0),this._capiSDUIClient=t,this._log=o.Bx.Logging.getLogger("SDUIFeedbackServiceImpl")}var t,i;return t=e,(i=[{key:"sendUserAction",value:function(e,t){var i=this;this._log.debug("Sending user action",{componentId:e,userAction:t}),(0,n.pipe)(this._capiSDUIClient.sendUserAction(e,t),r.hq,(function(e){return e.catch((function(e){s.zN.isDroppedError(e)?i._log.debug("Stopped listening for sendUserAction message acknowledge",e):s.Xb.isNotConnectedError(e)?i._log.warn("Failed to sendUserAction as CAPI was not connected",e):i._log.error("Failed to sendUserAction",e)}))}))}}])&&a(t.prototype,i),e}()},39427:(e,t,i)=>{i.d(t,{s:()=>f});var n=i(60575),s=i(91283),r=i(65390),o=i(59042),a=i(80837),l=i(89769),c=i(65621),d=i(15491),u=i(73231),p=i(84647);function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function h(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function g(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var f=function(){function e(t){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),g(this,"_state",new Map),g(this,"_subs",new a.y.Keeper),g(this,"_log",n.Bx.Logging.getLogger("SDUIInlineManager",n.y7.$.TRACE,n.y7.I.Manager.getColor())),this._subs.push(t.pipe(l.Z(u.k.empty),c.J(),d.T((function(e){var t,i,n=(i=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var n,s,r=[],o=!0,a=!1;try{for(i=i.call(e);!(o=(n=i.next()).done)&&(r.push(n.value),!t||r.length!==t);o=!0);}catch(e){a=!0,s=e}finally{try{o||null==i.return||i.return()}finally{if(a)throw s}}return r}}(t,i)||function(e,t){if(e){if("string"==typeof e)return m(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(i):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?m(e,t):void 0}}(t,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=n[0],r=n[1];return u.k.diff(s,r)})),d.T((function(e){return i._processSDUIItems(e)}))).subscribe())}var t,i;return t=e,(i=[{key:"getInlineItemForAlert",value:function(e){return r.fromNullable(this._state.get(e))}},{key:"_processSDUIItems",value:function(e){var t=this;(0,p.pipe)(e,o.b.forEach((function(e){v(e)&&(t._log.trace("inline item removed",{alertIds:e.alertIds,itemId:e.id}),e.alertIds.forEach((function(e){return t._state.delete(e)})))}),(function(e,i){v(i)&&(t._log.trace("inline item updated",{alertIds:i.alertIds,itemId:i.id}),i.alertIds.forEach((function(e){return t._state.set(e,i)})))}),(function(e){v(e)&&(t._log.trace("inline item added",{alertIds:e.alertIds,itemId:e.id}),e.alertIds.forEach((function(i){return t._state.set(i,e)})))})))}},{key:"dispose",value:function(){this._subs.dispose()}}])&&h(t.prototype,i),e}(),v=function(e){return(0,p.pipe)(s.cK.findFirst(e.content,"inlineCard"),r.isSome)}},39902:(e,t,i)=>{i.d(t,{$:()=>d});var n=i(50659),s=i(22773),r=i(42061),o=i(53651),a=i(8966),l=i(99331),c=i(74836);const d=n.forwardRef((function(e,t){var i,d;const{buttonProps:u,isPressed:p,ref:m,inProgress:h,variant:g}=(0,s.aC)(e,t),f=null!=(i=e.accessibilityLabel)?i:e.text,{isFocusVisible:v,focusProps:_}=(0,r.og)();let b=e.iconEnd,y=e.iconStart;"premium"===g&&(null!=e.iconEnd&&(b=a.p),null!=e.iconStart&&(y=a.p)),"pro"===g&&(b=void 0,null!=e.iconStart&&(y=l.c)),"enterprise"===g&&(b=void 0,y=void 0);const k="small"===e.size?"text-xsmall":"text-small";return n.createElement("button",{className:(0,s.uB)(e,p,h,v),tabIndex:null!=(d=e.tabIndex)?d:0,ref:m,...u,..._},null!=y&&n.createElement(o.I,{icon:y,accessibilityLabel:f,variant:"inherit"}),n.createElement(c.E,{as:"span",variant:k,weight:["primary","ghost","premium","pro","enterprise","critical"].includes(g)?"bold":"normal"},e.text),null!=b&&n.createElement(o.I,{icon:b,accessibilityLabel:f,variant:"inherit"}),null!=e.shortcut&&!["premium","critical","pro","enterprise"].includes(g)&&n.createElement(c.E,{variant:k,className:"gds-button-shortcut",as:"kbd"},e.shortcut))}))},54242:(e,t,i)=>{i.d(t,{v:()=>h});var n=i(50659),s=i(12174);const r=(0,i(13970).w)("color",(({title:e,titleId:t,desc:i,descId:s,...r})=>n.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16","aria-hidden":"true",stroke:"transparent","aria-labelledby":t,"aria-describedby":s,...r},i?n.createElement("desc",{id:s},i):null,e?n.createElement("title",{id:t},e):null,n.createElement("path",{stroke:"#646B81",strokeLinecap:"round",d:"M6 13.25h4"}),n.createElement("path",{fill:"#646B81",d:"m10.66 11.102.465.184zm0 0-.465-.185zm-2.663.652H10.4v-1H7.997zm3.693-2.9c0-1.54-1.308-3.617-3.692-3.617v1c1.718 0 2.692 1.508 2.692 2.616zm-1.291 2.9a.7.7 0 0 0 .207-.034 1 1 0 0 0 .328-.175.66.66 0 0 0 .191-.26l-.93-.368a.35.35 0 0 1 .096-.139q.026-.018.021-.014h-.002l.017-.003a.4.4 0 0 1 .072-.007zm.726-.468c.21-.53.565-1.597.565-2.433h-1c0 .634-.29 1.55-.495 2.064zm-3.128.468H10.4v-1H7.997zm3.693-2.9c0-1.54-1.308-3.617-3.692-3.617v1c1.718 0 2.692 1.508 2.692 2.616zm-1.291 2.9a.7.7 0 0 0 .207-.034 1 1 0 0 0 .328-.175.66.66 0 0 0 .191-.26l-.93-.368a.35.35 0 0 1 .096-.139q.026-.018.021-.014h-.002l.017-.003a.4.4 0 0 1 .072-.007zm.726-.468c.21-.53.565-1.597.565-2.433h-1c0 .634-.29 1.55-.495 2.064z"}),n.createElement("path",{fill:"#646B81",d:"m5.337 11.102-.465.184zm0 0 .465-.185zM8 11.754H5.6v-1H8zm-3.692-2.9c0-1.54 1.308-3.617 3.692-3.617v1c-1.719 0-2.692 1.508-2.692 2.616zm1.291 2.9a.7.7 0 0 1-.207-.034 1 1 0 0 1-.328-.175.66.66 0 0 1-.192-.26l.93-.368a.35.35 0 0 0-.096-.139q-.025-.018-.02-.014h.002l-.018-.003a.4.4 0 0 0-.071-.007zm-.727-.468c-.21-.53-.564-1.597-.564-2.433h1c0 .634.29 1.55.494 2.064zM8 11.754H5.6v-1H8zm-3.692-2.9c0-1.54 1.308-3.617 3.692-3.617v1c-1.719 0-2.692 1.508-2.692 2.616zm1.291 2.9a.7.7 0 0 1-.207-.034 1 1 0 0 1-.328-.175.66.66 0 0 1-.192-.26l.93-.368a.35.35 0 0 0-.096-.139q-.025-.018-.02-.014h.002l-.018-.003a.4.4 0 0 0-.071-.007zm-.727-.468c-.21-.53-.564-1.597-.564-2.433h1c0 .634.29 1.55.494 2.064zM13.5 5.5a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0M10.5 3.5a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0M7 3.5a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0M4 5.5a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0"}))));var o=i(99331),a=i(8966),l=i(7644),c=i(67787);const d={border:0,clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"};function u(e){let{children:t,elementType:i="div",isFocusable:s,style:r,...o}=e,{visuallyHiddenProps:a}=function(e={}){let{style:t,isFocusable:i}=e,[s,r]=(0,n.useState)(!1),{focusWithinProps:o}=(0,c.Rb)({isDisabled:!i,onFocusWithinChange:e=>r(e)});return{visuallyHiddenProps:{...o,style:(0,n.useMemo)((()=>s?t:t?{...d,...t}:d),[s])}}}(e);return n.createElement(i,(0,l.v6)(o,a),t)}var p=i(53651),m=i(74836);const h=e=>{const{variant:t="neutral",showIcon:i=!0,iconStart:r,inline:o=!1,label:a,accessibilityLabel:l,className:c,...d}=e;return n.createElement("div",{className:(0,s.$)("gds-tag",`gds-tag-${t}`,o&&"gds-tag-inline",c),...d},i?n.createElement(g,{variant:t,iconStart:r}):null,n.createElement(f,{label:a,accessibilityLabel:l}))},g=({variant:e,iconStart:t})=>{switch(e){case"premium":return n.createElement(p.I,{className:"gds-tag-icon",icon:a.p,variant:"premium",accessibilityLabel:"Premium feature",size:"small"});case"pro":return n.createElement(p.I,{className:"gds-tag-icon",icon:o.c,variant:"inherit",accessibilityLabel:"Premium feature",size:"small"});case"tip":return n.createElement(p.I,{className:"gds-tag-icon",variant:"inherit",icon:r,accessibilityLabel:"Tip:",size:"small"});default:return t?n.createElement(p.I,{variant:"inherit",accessibilityLabel:"",className:"gds-tag-icon",icon:t,size:"small"}):null}},f=({label:e,accessibilityLabel:t})=>n.createElement(n.Fragment,null,null!=t?n.createElement(u,null,t):null,n.createElement(m.E,{variant:"text-xsmall",as:"span",className:"gds-tag-label","aria-hidden":null!=t},e))},20015:(e,t,i)=>{i.d(t,{R:()=>s});var n=i(50659);const s=(0,i(13970).w)("color",(({title:e,titleId:t,desc:i,descId:s,...r})=>n.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16","aria-hidden":"true",stroke:"transparent","aria-labelledby":t,"aria-describedby":s,...r},i?n.createElement("desc",{id:s},i):null,e?n.createElement("title",{id:t},e):null,n.createElement("path",{stroke:"#646B81",strokeLinecap:"round",d:"m2 3 5 5-5 5M9 3l5 5-5 5"}))))},99331:(e,t,i)=>{i.d(t,{c:()=>s});var n=i(50659);const s=(0,i(13970).w)("color",(({title:e,titleId:t,desc:i,descId:s,...r})=>n.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",viewBox:"0 0 16 16","aria-hidden":"true",stroke:"transparent","aria-labelledby":t,"aria-describedby":s,...r},i?n.createElement("desc",{id:s},i):null,e?n.createElement("title",{id:t},e):null,n.createElement("path",{stroke:"#646B81",strokeLinecap:"round",strokeLinejoin:"round",d:"m8 2 1.481 3.961 4.225.185-3.31 2.633 1.13 4.075L8 10.52l-3.527 2.334 1.13-4.075-3.31-2.633L6.52 5.96z"}))))}}]);