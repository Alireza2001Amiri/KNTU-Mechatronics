"use strict";(self.webpackChunk_grammarly_denali_app=self.webpackChunk_grammarly_denali_app||[]).push([[3857],{52267:(e,t,s)=>{s.d(t,{ai:()=>S});var i=s(23988),o=s(38260),r=s(84647),n=s(60575),h=s(44869),l=s(36840),d=s(11924),a=s(6987),_=s(36094),y=s(62822),p=s(60269),u=s(42543),c=s(80837),f=s(68745),v=s(83541),b=s(35413),k=s(78339),m=s(88423),g=s(65141),w=s(15491),G=s(95168),K=s(54988),H=s(22013);class S{dispose(){this._subs.dispose()}_bindSources(e){const t=(0,r.pipe)(this._createHotkey,H.L.combineProviders(e),o.Tj((e=>e.isActive.pipe(a.n(_.vh(e.bind(this._bindHotkey(e.hotkey).pipe(y.u(e.action)))))))));this._subs.push(p.h(...t).subscribe())}constructor(e,t,s){(0,i._)(this,"bindingSources",void 0),(0,i._)(this,"_isAppleSystem",void 0),(0,i._)(this,"_registeredHotkeys",void 0),(0,i._)(this,"_hotkeyEvents",void 0),(0,i._)(this,"_subs",void 0),(0,i._)(this,"_logger",void 0),(0,i._)(this,"_modifiers",void 0),(0,i._)(this,"modifiersPressed",void 0),(0,i._)(this,"_createHotkey",void 0),(0,i._)(this,"_bindHotkey",void 0),(0,i._)(this,"_handleGlobalEvent",void 0),(0,i._)(this,"_listenGlobalInput",void 0),(0,i._)(this,"_listenGlobalKeyUp",void 0),(0,i._)(this,"_listenGlobalKeydown",void 0),this.bindingSources=e,this._isAppleSystem=t,this._registeredHotkeys=new Map,this._hotkeyEvents=new u.B7,this._subs=new c.y.Keeper,this._logger=n.Bx.Logging.getLogger("hotkeyManager"),this._modifiers=new f.t(new Set),this.modifiersPressed=this._modifiers.pipe(v.skipBy(h.ee(l._3))),this._createHotkey=e=>{const{key:t,modifiers:s,source:i=d._.Keydown,preventDefault:o=!0}=e;return{id:E(),key:t.toLowerCase(),modifiers:s,source:i,preventDefault:o,toString:()=>H.L.HotkeyOptions.toString(this._isAppleSystem)(e)}},this._bindHotkey=e=>b.v((()=>(this._registeredHotkeys.set(e.id,e),this._hotkeyEvents.pipe(k.p((t=>t===e.id)),y.u(_.q6))))).pipe(m.j((()=>{this._registeredHotkeys.delete(e.id)}))),this._handleGlobalEvent=(e,t)=>{const s=Array.from(this._registeredHotkeys.values()).filter(t);if(0===s.length)return;if(s.length>1)return void this._logger.error(`Multiple hotkeys registered in the same context: ${s}`);const i=s[0];this._hotkeyEvents.next(i.id),i.preventDefault&&e.preventDefault()},this._listenGlobalInput=()=>g.R(document,"input").subscribe((e=>{const t=e;if("historyUndo"===t.inputType){const t=e=>"UNDO"===e.key;this._handleGlobalEvent(e,t)}else if("historyRedo"===t.inputType){const t=e=>"REDO"===e.key;this._handleGlobalEvent(e,t)}})),this._listenGlobalKeyUp=e=>g.R(document,"keyup").pipe(w.T(e),G.M(this._modifiers)).subscribe(),this._listenGlobalKeydown=e=>g.R(document,"keydown").subscribe((t=>{const s=e(t),i=(o={short:s.has(d.l.short),alt:s.has(d.l.alt),shift:s.has(d.l.shift),key:t.key.toLowerCase(),keyCode:t.which||t.keyCode},e=>e.modifiers.has(d.l.short)===o.short&&e.modifiers.has(d.l.alt)===o.alt&&e.modifiers.has(d.l.shift)===o.shift&&(e.key===o.key||e.modifiers.size>0&&e.key===String.fromCharCode(o.keyCode)));var o;this._modifiers.next(s),this._handleGlobalEvent(t,i)})),this._bindSources(e);const o=(r=t,e=>{const t=new Set;return(r?e.metaKey&&!e.ctrlKey:e.ctrlKey&&!e.metaKey)&&t.add(d.l.short),e.altKey&&t.add(d.l.alt),e.shiftKey&&t.add(d.l.shift),t});var r;this._subs.push(this._listenGlobalKeydown(o),this._listenGlobalKeyUp(o)),s&&this._subs.push(this._listenGlobalInput())}}const E=(()=>{let e=1;return()=>e++})();var C;!function(e){e.Mock=class{constructor(){(0,i._)(this,"modifiersPressed",K.w),(0,i._)(this,"dispose",l.Yi)}}}(C||(C={}))},41831:(e,t,s)=>{var i;s.d(t,{th:()=>i}),function(e){var t=e.from=function(e){return e};e.of=function(){for(var e=arguments.length,s=new Array(e),i=0;i<e;i++)s[i]=arguments[i];return t(s)}}(i||(i={}))}}]);